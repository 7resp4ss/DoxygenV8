<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>V8 Project: /mnt/V8SourceCode/src/sandbox/external-pointer-table-inl.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">V8 Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('external-pointer-table-inl_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">external-pointer-table-inl.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="external-pointer-table-inl_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright 2021 the V8 project authors. All rights reserved.</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Use of this source code is governed by a BSD-style license that can be</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// found in the LICENSE file.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#ifndef V8_SANDBOX_EXTERNAL_POINTER_TABLE_INL_H_</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#define V8_SANDBOX_EXTERNAL_POINTER_TABLE_INL_H_</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="external-pointer-table_8h.html">src/sandbox/external-pointer-table.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Include the non-inl header before the rest of the headers.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="compactible-external-entity-table-inl_8h.html">src/sandbox/compactible-external-entity-table-inl.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="external-pointer_8h.html">src/sandbox/external-pointer.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#ifdef V8_COMPRESS_POINTERS</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacev8.html">v8</a> {</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacev8_1_1internal.html#a5031451934208565c827c86d9eb86c5a">internal</a> {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keywordtype">void</span> ExternalPointerTableEntry::MakeExternalPointerEntry(<a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> <a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>,</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                                                         <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbc">ExternalPointerTag</a> tag,</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                                                         <span class="keywordtype">bool</span> mark_as_alive) {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="comment">// The 2nd most significant byte must be empty as we store the tag in int.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(0, <a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a> &amp; <a class="code" href="namespacev8_1_1internal.html#a6587dc44973ce8b6139d4f4da5691d31">kExternalPointerTagAndMarkbitMask</a>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a986dc8f4ec6dcd0644efe205c13f8eb7">DCHECK_NE</a>(tag, <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbca83290c791d98230a5ca3ca39539a08a7">kExternalPointerFreeEntryTag</a>);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a986dc8f4ec6dcd0644efe205c13f8eb7">DCHECK_NE</a>(tag, <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbca0e288db8a77a95b08252312c190c4620">kExternalPointerEvacuationEntryTag</a>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  Payload new_payload(<a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>, tag);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="v8config_8h.html#a67bd29db07c711b0fb11ff1c324ebb60">V8_UNLIKELY</a>(mark_as_alive)) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    new_payload.SetMarkBit();</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  payload_.store(new_payload, std::memory_order_relaxed);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  MaybeUpdateRawPointerForLSan(<a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;}</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> ExternalPointerTableEntry::GetExternalPointer(</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="namespacev8_1_1internal.html#ab06255cf21187dad77fbfe7fc722a216">ExternalPointerTagRange</a> tag_range)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keyword">auto</span> payload = payload_.load(std::memory_order_relaxed);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(payload.ContainsPointer());</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">return</span> payload.Untag(tag_range);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keywordtype">void</span> ExternalPointerTableEntry::SetExternalPointer(<a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> <a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                                   <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbc">ExternalPointerTag</a> tag) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">// The 2nd most significant byte must be empty as we store the tag in int.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(0, <a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a> &amp; <a class="code" href="namespacev8_1_1internal.html#a6587dc44973ce8b6139d4f4da5691d31">kExternalPointerTagAndMarkbitMask</a>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(payload_.load(std::memory_order_relaxed).ContainsPointer());</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  Payload new_payload(<a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>, tag);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">// Writing an entry currently also marks it as alive. In the future, we might</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// want to drop this and instead use write barriers where necessary.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  new_payload.SetMarkBit();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  payload_.store(new_payload, std::memory_order_relaxed);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  MaybeUpdateRawPointerForLSan(<a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordtype">bool</span> ExternalPointerTableEntry::HasExternalPointer(</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="namespacev8_1_1internal.html#ab06255cf21187dad77fbfe7fc722a216">ExternalPointerTagRange</a> tag_range)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keyword">auto</span> payload = payload_.load(std::memory_order_relaxed);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (!payload.ContainsPointer()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">return</span> payload.IsTaggedWithTagIn(tag_range);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> ExternalPointerTableEntry::ExchangeExternalPointer(</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> <a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>, <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbc">ExternalPointerTag</a> tag) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment">// The 2nd most significant byte must be empty as we store the tag in int.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(0, <a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a> &amp; <a class="code" href="namespacev8_1_1internal.html#a6587dc44973ce8b6139d4f4da5691d31">kExternalPointerTagAndMarkbitMask</a>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  Payload new_payload(<a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>, tag);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// Writing an entry currently also marks it as alive. In the future, we might</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// want to drop this and instead use write barriers where necessary.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  new_payload.SetMarkBit();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  Payload old_payload =</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      payload_.exchange(new_payload, std::memory_order_relaxed);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(old_payload.ContainsPointer());</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  MaybeUpdateRawPointerForLSan(<a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">return</span> old_payload.Untag(tag);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbc">ExternalPointerTag</a> ExternalPointerTableEntry::GetExternalPointerTag()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keyword">auto</span> payload = payload_.load(std::memory_order_relaxed);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(payload.ContainsPointer());</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">return</span> payload.ExtractTag();</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> ExternalPointerTableEntry::ExtractManagedResourceOrNull()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keyword">auto</span> payload = payload_.load(std::memory_order_relaxed);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbc">ExternalPointerTag</a> tag = payload.ExtractTag();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal.html#a8e5c39cbfcba3ac3deea71d575ceebbf">IsManagedExternalPointerType</a>(tag)) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">return</span> payload.Untag(tag);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacev8_1_1internal.html#acf6bafb5b8483a580f375393c413ee02">kNullAddress</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keywordtype">void</span> ExternalPointerTableEntry::MakeZappedEntry() {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  Payload new_payload(<a class="code" href="namespacev8_1_1internal.html#acf6bafb5b8483a580f375393c413ee02">kNullAddress</a>, <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbcaa88b7743bdecef555feef8bb3d823ae9">kExternalPointerZappedEntryTag</a>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  payload_.store(new_payload, std::memory_order_relaxed);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;}</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordtype">void</span> ExternalPointerTableEntry::MakeFreelistEntry(uint32_t next_entry_index) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// The next freelist entry is stored in the lower bits of the entry.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  static_assert(<a class="code" href="namespacev8_1_1internal.html#a677d3b38e89879fc0a176da6da2d82fc">kMaxExternalPointers</a> &lt;= std::numeric_limits&lt;uint32_t&gt;::max());</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  Payload new_payload(next_entry_index, <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbca83290c791d98230a5ca3ca39539a08a7">kExternalPointerFreeEntryTag</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  payload_.store(new_payload, std::memory_order_relaxed);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;uint32_t ExternalPointerTableEntry::GetNextFreelistEntryIndex()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keyword">auto</span> payload = payload_.load(std::memory_order_relaxed);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">return</span> payload.ExtractFreelistLink();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacev8_1_1internal_1_1compiler.html#a626ccee89b85d763b0ce03356a9f1fcb">ExternalPointerTableEntry::Mark</a>() {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keyword">auto</span> old_payload = payload_.load(std::memory_order_relaxed);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(old_payload.ContainsPointer());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">auto</span> new_payload = old_payload;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  new_payload.SetMarkBit();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">// We don&#39;t need to perform the CAS in a loop: if the new value is not equal</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">// to the old value, then the mutator must&#39;ve just written a new value into</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">// the entry. This in turn must&#39;ve set the marking bit already (see e.g.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">// SetExternalPointer), so we don&#39;t need to do it again.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordtype">bool</span> success = payload_.compare_exchange_strong(old_payload, new_payload,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                                  std::memory_order_relaxed);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(success || old_payload.HasMarkBitSet());</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="src_2base_2macros_8h.html#a280b0798f270f4b3f361c9ab64832956">USE</a>(success);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keywordtype">void</span> ExternalPointerTableEntry::MakeEvacuationEntry(<a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> handle_location) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  Payload new_payload(handle_location, <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbca0e288db8a77a95b08252312c190c4620">kExternalPointerEvacuationEntryTag</a>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  payload_.store(new_payload, std::memory_order_relaxed);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordtype">bool</span> ExternalPointerTableEntry::HasEvacuationEntry()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keyword">auto</span> payload = payload_.load(std::memory_order_relaxed);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">return</span> payload.ContainsEvacuationEntry();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordtype">void</span> ExternalPointerTableEntry::Evacuate(ExternalPointerTableEntry&amp; dest,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                         EvacuateMarkMode <a class="code" href="flag-definitions_8h.html#adaf90f045d5cd2710edd625b8685472a">mode</a>) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keyword">auto</span> payload = payload_.load(std::memory_order_relaxed);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// We expect to only evacuate entries containing external pointers.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(payload.ContainsPointer());</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="flag-definitions_8h.html#adaf90f045d5cd2710edd625b8685472a">mode</a>) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">case</span> EvacuateMarkMode::kTransferMark:</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">case</span> EvacuateMarkMode::kLeaveUnmarked:</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(!payload.HasMarkBitSet());</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">case</span> EvacuateMarkMode::kClearMark:</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(payload.HasMarkBitSet());</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      payload.ClearMarkBit();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  dest.payload_.store(payload, std::memory_order_relaxed);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">#if defined(LEAK_SANITIZER)</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  dest.raw_pointer_for_lsan_ = raw_pointer_for_lsan_;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">// LEAK_SANITIZER</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">// The destination entry takes ownership of the pointer.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  MakeZappedEntry();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1turboshaft.html#a2b5e79bd829824237e784a6cde29309e">ExternalPointerTable::Get</a>(<a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                  <a class="code" href="namespacev8_1_1internal.html#ab06255cf21187dad77fbfe7fc722a216">ExternalPointerTagRange</a> tag_range)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  uint32_t <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> = HandleToIndex(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> == 0 || at(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>).HasExternalPointer(tag_range));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">return</span> at(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>).GetExternalPointer(tag_range);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keywordtype">void</span> ExternalPointerTable::Set(<a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>, <a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> <a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                               <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbc">ExternalPointerTag</a> tag) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a986dc8f4ec6dcd0644efe205c13f8eb7">DCHECK_NE</a>(<a class="code" href="namespacev8_1_1internal.html#a7d9d03c72a6418e2aba25f8a52114027">kNullExternalPointerHandle</a>, <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  uint32_t <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> = HandleToIndex(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// TODO(saelo): This works for now, but once we actually free the external</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// object here, this will probably become awkward: it&#39;s likely not intuitive</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// that a set_foo() call on some object causes another object to be freed.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">// Probably at that point we should instead just forbid re-setting the</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// external pointers if they are managed (via a DCHECK).</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  FreeManagedResourceIfPresent(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  TakeOwnershipOfManagedResourceIfNecessary(<a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>, <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>, tag);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  at(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>).SetExternalPointer(<a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>, tag);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> <a class="code" href="namespacev8_1_1internal_1_1wasm_1_1liftoff.html#ac9db9305895095093f18131d6572030d">ExternalPointerTable::Exchange</a>(<a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                       <a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> <a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>, <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbc">ExternalPointerTag</a> tag) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a986dc8f4ec6dcd0644efe205c13f8eb7">DCHECK_NE</a>(<a class="code" href="namespacev8_1_1internal.html#a7d9d03c72a6418e2aba25f8a52114027">kNullExternalPointerHandle</a>, <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(!<a class="code" href="namespacev8_1_1internal.html#a8e5c39cbfcba3ac3deea71d575ceebbf">IsManagedExternalPointerType</a>(tag));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  uint32_t <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> = HandleToIndex(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">return</span> at(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>).ExchangeExternalPointer(<a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>, tag);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbc">ExternalPointerTag</a> ExternalPointerTable::GetTag(</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  uint32_t <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> = HandleToIndex(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">return</span> at(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>).GetExternalPointerTag();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">void</span> ExternalPointerTable::Zap(<a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// Zapping the null entry is a nop. This is useful as we reset the handle of</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">// managed resources to the kNullExternalPointerHandle when the entry is</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">// deleted. See SweepAndCompact.</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a> == <a class="code" href="namespacev8_1_1internal.html#a7d9d03c72a6418e2aba25f8a52114027">kNullExternalPointerHandle</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  uint32_t <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> = HandleToIndex(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  at(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>).MakeZappedEntry();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> ExternalPointerTable::AllocateAndInitializeEntry(</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    Space* <a class="code" href="flag-definitions_8h.html#a087fd0337c14e102a4a2abccd41a39ad">space</a>, <a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> initial_value, <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbc">ExternalPointerTag</a> tag) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="flag-definitions_8h.html#a087fd0337c14e102a4a2abccd41a39ad">space</a>-&gt;BelongsTo(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  uint32_t <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> = AllocateEntry(<a class="code" href="flag-definitions_8h.html#a087fd0337c14e102a4a2abccd41a39ad">space</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  at(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>).MakeExternalPointerEntry(initial_value, tag,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                     <a class="code" href="flag-definitions_8h.html#a087fd0337c14e102a4a2abccd41a39ad">space</a>-&gt;allocate_black());</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a> = IndexToHandle(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  TakeOwnershipOfManagedResourceIfNecessary(initial_value, <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>, tag);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacev8_1_1internal_1_1compiler.html#a626ccee89b85d763b0ce03356a9f1fcb">ExternalPointerTable::Mark</a>(Space* <a class="code" href="flag-definitions_8h.html#a087fd0337c14e102a4a2abccd41a39ad">space</a>, <a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                <a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> handle_location) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="flag-definitions_8h.html#a087fd0337c14e102a4a2abccd41a39ad">space</a>-&gt;BelongsTo(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">// The handle_location must always contain the given handle. Except if the</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">// slot is lazily-initialized. In that case, the handle may transition from</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">// the null handle to a valid handle. However, in that case the</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">// newly-allocated entry will already have been marked as alive during</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// allocation, and so we don&#39;t need to do anything here.</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> current_handle = <a class="code" href="classv8_1_1base_1_1AsAtomicImpl.html#a776bcde4b303aceccd6491599a7cf1d5">base::AsAtomic32::Acquire_Load</a>(</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a>*<span class="keyword">&gt;</span>(handle_location));</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a> == <a class="code" href="namespacev8_1_1internal.html#a7d9d03c72a6418e2aba25f8a52114027">kNullExternalPointerHandle</a> || <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a> == current_handle);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">// If the handle is null, it doesn&#39;t have an EPT entry; no mark is needed.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a> == <a class="code" href="namespacev8_1_1internal.html#a7d9d03c72a6418e2aba25f8a52114027">kNullExternalPointerHandle</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  uint32_t <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> = HandleToIndex(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="flag-definitions_8h.html#a087fd0337c14e102a4a2abccd41a39ad">space</a>-&gt;Contains(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// If the table is being compacted and the entry is inside the evacuation</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">// area, then allocate and set up an evacuation entry for it.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  MaybeCreateEvacuationEntry(<a class="code" href="flag-definitions_8h.html#a087fd0337c14e102a4a2abccd41a39ad">space</a>, <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>, handle_location);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// Even if the entry is marked for evacuation, it still needs to be marked as</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// alive as it may be visited during sweeping before being evacuation.</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  at(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>).Mark();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keywordtype">void</span> ExternalPointerTable::Evacuate(Space* from_space, Space* to_space,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                    <a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                    <a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> handle_location,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                    EvacuateMarkMode <a class="code" href="flag-definitions_8h.html#adaf90f045d5cd2710edd625b8685472a">mode</a>) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(from_space-&gt;BelongsTo(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(to_space-&gt;BelongsTo(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(IsValidHandle(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>));</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keyword">auto</span> handle_ptr = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a>*<span class="keyword">&gt;</span>(handle_location);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">// Unlike Mark(), we require that the mutator is stopped, so we can simply</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">// verify that the location stores the handle with a non-atomic load.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>, *handle_ptr);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">// If the handle is null, it doesn&#39;t have an EPT entry; no evacuation is</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="comment">// needed.</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a> == <a class="code" href="namespacev8_1_1internal.html#a7d9d03c72a6418e2aba25f8a52114027">kNullExternalPointerHandle</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  uint32_t from_index = HandleToIndex(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(from_space-&gt;Contains(from_index));</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  uint32_t to_index = AllocateEntry(to_space);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  at(from_index).Evacuate(at(to_index), <a class="code" href="flag-definitions_8h.html#adaf90f045d5cd2710edd625b8685472a">mode</a>);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> new_handle = IndexToHandle(to_index);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> addr = at(to_index).ExtractManagedResourceOrNull()) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    ManagedResource* resource = <span class="keyword">reinterpret_cast&lt;</span>ManagedResource*<span class="keyword">&gt;</span>(addr);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(resource-&gt;ept_entry_, <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    resource-&gt;ept_entry_ = new_handle;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// Update slot to point to new handle.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="classv8_1_1base_1_1AsAtomicImpl.html#a5270f8e0e12986ee3a35cdf4703adedd">base::AsAtomic32::Relaxed_Store</a>(handle_ptr, new_handle);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">// static</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordtype">bool</span> ExternalPointerTable::IsValidHandle(<a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  uint32_t <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> = <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a> &gt;&gt; kExternalPointerIndexShift;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a> == <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> &lt;&lt; kExternalPointerIndexShift;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">// static</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;uint32_t ExternalPointerTable::HandleToIndex(<a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(IsValidHandle(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>));</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  uint32_t <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> = <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a> &gt;&gt; kExternalPointerIndexShift;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">#if defined(LEAK_SANITIZER)</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// When LSan is active, we use &quot;fat&quot; entries that also store the raw pointer</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">// to that LSan can find live references. However, we do this transparently:</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">// we simply multiply the handle by two so that `(handle &gt;&gt; index_shift) * 8`</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">// still produces the correct offset of the entry in the table. However, this</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">// is not secure as an attacker could reference the raw pointer instead of</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">// the encoded pointer in an entry, thereby bypassing the type checks. As</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// such, this mode must only be used in testing environments. Alternatively,</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">// all places that access external pointer table entries must be made aware</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="comment">// that the entries are 16 bytes large when LSan is active.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> /= 2;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">// LEAK_SANITIZER</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a16b382527f19b805fc8f856668f2270b">DCHECK_LE</a>(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>, <a class="code" href="namespacev8_1_1internal.html#a677d3b38e89879fc0a176da6da2d82fc">kMaxExternalPointers</a>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">// static</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> ExternalPointerTable::IndexToHandle(uint32_t <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a16b382527f19b805fc8f856668f2270b">DCHECK_LE</a>(<a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a>, <a class="code" href="namespacev8_1_1internal.html#a677d3b38e89879fc0a176da6da2d82fc">kMaxExternalPointers</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a> = <a class="code" href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">index</a> &lt;&lt; kExternalPointerIndexShift;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">#if defined(LEAK_SANITIZER)</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a> *= 2;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">// LEAK_SANITIZER</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a986dc8f4ec6dcd0644efe205c13f8eb7">DCHECK_NE</a>(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>, <a class="code" href="namespacev8_1_1internal.html#a7d9d03c72a6418e2aba25f8a52114027">kNullExternalPointerHandle</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;}</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacev8_1_1internal_1_1anonymous__namespace_02read-only-promotion_8cc_03.html#a996ff47de27ce5f127bdcc0bff48b7f9">ExternalPointerTable::Contains</a>(Space* <a class="code" href="flag-definitions_8h.html#a087fd0337c14e102a4a2abccd41a39ad">space</a>,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                    <a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="flag-definitions_8h.html#a087fd0337c14e102a4a2abccd41a39ad">space</a>-&gt;BelongsTo(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="flag-definitions_8h.html#a087fd0337c14e102a4a2abccd41a39ad">space</a>-&gt;Contains(HandleToIndex(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>));</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordtype">void</span> ExternalPointerTable::Space::NotifyExternalPointerFieldInvalidated(</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> field_address, <a class="code" href="namespacev8_1_1internal.html#ab06255cf21187dad77fbfe7fc722a216">ExternalPointerTagRange</a> tag_range) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// We do not currently support invalidating fields containing managed</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// external pointers. If this is ever needed, we would probably need to free</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// the managed object here as we may otherwise fail to do so during sweeping.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(!<a class="code" href="namespacev8_1_1internal.html#a8e5c39cbfcba3ac3deea71d575ceebbf">IsManagedExternalPointerType</a>(tag_range));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a> = <a class="code" href="classv8_1_1base_1_1AsAtomicImpl.html#a776bcde4b303aceccd6491599a7cf1d5">base::AsAtomic32::Acquire_Load</a>(</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a>*<span class="keyword">&gt;</span>(field_address));</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="namespacev8_1_1internal_1_1anonymous__namespace_02read-only-promotion_8cc_03.html#a996ff47de27ce5f127bdcc0bff48b7f9">Contains</a>(HandleToIndex(<a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>)));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  AddInvalidatedField(field_address);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;}</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keywordtype">void</span> ExternalPointerTable::ManagedResource::ZapExternalPointerTableEntry() {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordflow">if</span> (owning_table_) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    owning_table_-&gt;Zap(ept_entry_);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  ept_entry_ = <a class="code" href="namespacev8_1_1internal.html#a7d9d03c72a6418e2aba25f8a52114027">kNullExternalPointerHandle</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordtype">void</span> ExternalPointerTable::TakeOwnershipOfManagedResourceIfNecessary(</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> <a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>, <a class="code" href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">ExternalPointerHandle</a> <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>, <a class="code" href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbc">ExternalPointerTag</a> tag) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal.html#a8e5c39cbfcba3ac3deea71d575ceebbf">IsManagedExternalPointerType</a>(tag) &amp;&amp; <a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a> != <a class="code" href="namespacev8_1_1internal.html#acf6bafb5b8483a580f375393c413ee02">kNullAddress</a>) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    ManagedResource* resource = <span class="keyword">reinterpret_cast&lt;</span>ManagedResource*<span class="keyword">&gt;</span>(<a class="code" href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">value</a>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(resource-&gt;ept_entry_, <a class="code" href="namespacev8_1_1internal.html#a7d9d03c72a6418e2aba25f8a52114027">kNullExternalPointerHandle</a>);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    resource-&gt;owning_table_ = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    resource-&gt;ept_entry_ = <a class="code" href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">handle</a>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="keywordtype">void</span> ExternalPointerTable::FreeManagedResourceIfPresent(uint32_t entry_index) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">// In the future, this would be where we actually delete the external</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// resource. Currently, the deletion still happens elsewhere, and so here we</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">// instead set the resource&#39;s handle to the null handle so that the resource</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="comment">// does not attempt to zap its entry when it is eventually destroyed.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">Address</a> addr = at(entry_index).ExtractManagedResourceOrNull()) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    ManagedResource* resource = <span class="keyword">reinterpret_cast&lt;</span>ManagedResource*<span class="keyword">&gt;</span>(addr);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// This can currently only happen during snapshot stress mode as we cannot</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">// normally serialized managed resources. In snapshot stress mode, the new</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// isolate will be destroyed and the old isolate (really, the old isolate&#39;s</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// external pointer table) therefore effectively retains ownership of the</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// resource. As such, we need to save and restore the relevant fields of</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">// the external resource. Once the external pointer table itself destroys</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// the managed resource when freeing the corresponding table entry, this</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// workaround can be removed again.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <a class="code" href="src_2base_2logging_8h.html#a96a75539aa82216cdde2250a11126ea0">DCHECK_IMPLIES</a>(!<a class="code" href="namespacev8_1_1internal.html#aa9db791c05a0359859a321dcfec42e37">v8_flags</a>.stress_snapshot,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                   resource-&gt;ept_entry_ == IndexToHandle(entry_index));</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    resource-&gt;ept_entry_ = <a class="code" href="namespacev8_1_1internal.html#a7d9d03c72a6418e2aba25f8a52114027">kNullExternalPointerHandle</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}  <span class="comment">// namespace internal</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}  <span class="comment">// namespace v8</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">// V8_COMPRESS_POINTERS</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">// V8_SANDBOX_EXTERNAL_POINTER_TABLE_INL_H_</span></div>
<div class="ttc" id="aclassv8_1_1base_1_1AsAtomicImpl_html_a5270f8e0e12986ee3a35cdf4703adedd"><div class="ttname"><a href="classv8_1_1base_1_1AsAtomicImpl.html#a5270f8e0e12986ee3a35cdf4703adedd">v8::base::AsAtomicImpl::Relaxed_Store</a></div><div class="ttdeci">static void Relaxed_Store(T *addr, std::remove_reference_t&lt; T &gt; new_value)</div><div class="ttdef"><b>Definition:</b> <a href="atomic-utils_8h_source.html#l00106">atomic-utils.h:106</a></div></div>
<div class="ttc" id="aclassv8_1_1base_1_1AsAtomicImpl_html_a776bcde4b303aceccd6491599a7cf1d5"><div class="ttname"><a href="classv8_1_1base_1_1AsAtomicImpl.html#a776bcde4b303aceccd6491599a7cf1d5">v8::base::AsAtomicImpl::Acquire_Load</a></div><div class="ttdeci">static T Acquire_Load(T *addr)</div><div class="ttdef"><b>Definition:</b> <a href="atomic-utils_8h_source.html#l00078">atomic-utils.h:78</a></div></div>
<div class="ttc" id="acompactible-external-entity-table-inl_8h_html"><div class="ttname"><a href="compactible-external-entity-table-inl_8h.html">compactible-external-entity-table-inl.h</a></div></div>
<div class="ttc" id="aexternal-pointer-table_8h_html"><div class="ttname"><a href="external-pointer-table_8h.html">external-pointer-table.h</a></div></div>
<div class="ttc" id="aexternal-pointer_8h_html"><div class="ttname"><a href="external-pointer_8h.html">external-pointer.h</a></div></div>
<div class="ttc" id="aflag-definitions_8h_html_a087fd0337c14e102a4a2abccd41a39ad"><div class="ttname"><a href="flag-definitions_8h.html#a087fd0337c14e102a4a2abccd41a39ad">space</a></div><div class="ttdeci">too high values may cause the compiler to set high thresholds for inlining to as much as possible avoid inlined allocation of objects that cannot escape trace load stores from virtual maglev objects use TurboFan fast string builder analyze liveness of environment slots and zap dead values trace TurboFan load elimination emit data about basic block usage in builtins to this enable builtin reordering when run mksnapshot flag for emit warnings when applying builtin profile data verify register allocation in TurboFan randomly schedule instructions to stress dependency tracking enable store store elimination in TurboFan rewrite far to near simulate GC compiler thread race related to allow float parameters to be passed in simulator mode JS Wasm Run additional turbo_optimize_inlined_js_wasm_wrappers enables Turboshaft s StaticAssert and CheckTurboshaftTypeOf operations Wasm code into JS functions via the JS to Wasm wrappers are still inlined in TurboFan For controlling whether to at see turbo inline js wasm calls enable Turboshaft s loop unrolling enable an additional Turboshaft phase that performs optimizations based on type information enable Turbolev features that we want to ship in the not too far future trace individual Turboshaft reduction steps trace intermediate Turboshaft reduction steps trace Turboshaft s if else to switch reducer invocation count threshold for early optimization Enables optimizations which favor memory size over execution speed Enables sampling allocation profiler with X as a sample interval min size of a semi the new space consists of two semi spaces max size of the preconfigured old space Collect garbage after Collect garbage after keeps maps alive for&lt; n &gt; old space garbage collections print one detailed trace line in allocation gc speed threshold for starting incremental marking via a task in percent of available space</div><div class="ttdef"><b>Definition:</b> <a href="flag-definitions_8h_source.html#l02215">flag-definitions.h:2213</a></div></div>
<div class="ttc" id="aflag-definitions_8h_html_adaf90f045d5cd2710edd625b8685472a"><div class="ttname"><a href="flag-definitions_8h.html#adaf90f045d5cd2710edd625b8685472a">mode</a></div><div class="ttdeci">too high values may cause the compiler to set high thresholds for inlining to as much as possible avoid inlined allocation of objects that cannot escape trace load stores from virtual maglev objects use TurboFan fast string builder analyze liveness of environment slots and zap dead values trace TurboFan load elimination emit data about basic block usage in builtins to this enable builtin reordering when run mksnapshot flag for emit warnings when applying builtin profile data verify register allocation in TurboFan randomly schedule instructions to stress dependency tracking enable store store elimination in TurboFan rewrite far to near simulate GC compiler thread race related to allow float parameters to be passed in simulator mode JS Wasm Run additional turbo_optimize_inlined_js_wasm_wrappers enables Turboshaft s StaticAssert and CheckTurboshaftTypeOf operations Wasm code into JS functions via the JS to Wasm wrappers are still inlined in TurboFan For controlling whether to at see turbo inline js wasm calls enable Turboshaft s loop unrolling enable an additional Turboshaft phase that performs optimizations based on type information enable Turbolev features that we want to ship in the not too far future trace individual Turboshaft reduction steps trace intermediate Turboshaft reduction steps trace Turboshaft s if else to switch reducer invocation count threshold for early optimization Enables optimizations which favor memory size over execution speed Enables sampling allocation profiler with X as a sample interval min size of a semi the new space consists of two semi spaces max size of the preconfigured old space Collect garbage after Collect garbage after keeps maps alive for&lt; n &gt; old space garbage collections print one detailed trace line in allocation gc speed threshold for starting incremental marking via a task in percent of available threshold for starting incremental marking immediately in percent of available Use a single schedule for determining a marking schedule between JS and C objects schedules the minor GC task with kUserVisible priority max worker number of concurrent for NumberOfWorkerThreads start background threads that allocate memory concurrent_array_buffer_sweeping use parallel threads to clear weak refs in the atomic pause trace progress of the incremental marking trace object counts and memory usage report a tick only when allocated zone memory changes by this amount TracingFlags::gc_stats TracingFlags::gc_stats track native contexts that are expected to be garbage collected verify heap pointers before and after GC memory reducer runs GC with ReduceMemoryFootprint flag Maximum number of memory reducer GCs scheduled Old gen GC speed is computed directly from gc tracer counters Perform compaction on full GCs based on V8 s default heuristics Perform compaction on every full GC Perform code space compaction when finalizing a full GC with stack Stress GC compaction to flush out bugs with moving objects flush of baseline code when it has not been executed recently Use time base code flushing instead of age Use a progress bar to scan large objects in increments when incremental marking is active force incremental marking for small heaps and run it more often Release pooled large pages after X seconds prints number of allocations and enables analysis mode for gc fuzz e g stress stress scavenge force scavenge at random points between and reclaim otherwise unreachable unmodified wrapper objects when possible discard the memory pool before invoking the GC on memory pressure or last resort GCs Delay before memory reducer start virtual randomize memory reservations by ignoring any hints passed when allocating pages use incremental marking for CppHeap cppheap_concurrent_marking c value for membalancer A special constant to balance between memory and space tradeoff The smaller the more memory it uses enable use of SSE4 instructions if available enable use of SAHF instruction if enable use of AVX VNNI instructions if available enable use of POPCNT instruction if available force all emitted branches to be in long mode(MIPS/PPC only)&quot;) DEFINE_BOOL(partial_constant_pool</div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1anonymous__namespace_02read-only-promotion_8cc_03_html_a996ff47de27ce5f127bdcc0bff48b7f9"><div class="ttname"><a href="namespacev8_1_1internal_1_1anonymous__namespace_02read-only-promotion_8cc_03.html#a996ff47de27ce5f127bdcc0bff48b7f9">v8::internal::anonymous_namespace{read-only-promotion.cc}::Contains</a></div><div class="ttdeci">bool Contains(const HeapObjectSet &amp;s, Tagged&lt; HeapObject &gt; o)</div><div class="ttdef"><b>Definition:</b> <a href="read-only-promotion_8cc_source.html#l00032">read-only-promotion.cc:32</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1turboshaft_html_a2b5e79bd829824237e784a6cde29309e"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1turboshaft.html#a2b5e79bd829824237e784a6cde29309e">v8::internal::compiler::turboshaft::Get</a></div><div class="ttdeci">const Operation &amp; Get(const Graph &amp;graph, OpIndex index)</div><div class="ttdef"><b>Definition:</b> <a href="graph_8h_source.html#l01242">graph.h:1242</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_html_a626ccee89b85d763b0ce03356a9f1fcb"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler.html#a626ccee89b85d763b0ce03356a9f1fcb">v8::internal::compiler::Mark</a></div><div class="ttdeci">uint32_t Mark</div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00026">node.h:26</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1wasm_1_1liftoff_html_ac9db9305895095093f18131d6572030d"><div class="ttname"><a href="namespacev8_1_1internal_1_1wasm_1_1liftoff.html#ac9db9305895095093f18131d6572030d">v8::internal::wasm::liftoff::Exchange</a></div><div class="ttdeci">void Exchange(LiftoffAssembler *lasm, Register dst, Register lhs, Register rhs)</div><div class="ttdef"><b>Definition:</b> <a href="liftoff-assembler-arm-inl_8h_source.html#l01116">liftoff-assembler-arm-inl.h:1116</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_a0cfab207d565dcf62ebf50f3987e05de"><div class="ttname"><a href="namespacev8_1_1internal.html#a0cfab207d565dcf62ebf50f3987e05de">v8::internal::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="heap-snapshot-generator_8cc_source.html#l01698">heap-snapshot-generator.cc:1698</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_a5031451934208565c827c86d9eb86c5a"><div class="ttname"><a href="namespacev8_1_1internal.html#a5031451934208565c827c86d9eb86c5a">v8::internal::internal</a></div><div class="ttdeci">internal</div><div class="ttdef"><b>Definition:</b> <a href="wasm-objects-inl_8h_source.html#l00453">wasm-objects-inl.h:453</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_a6587dc44973ce8b6139d4f4da5691d31"><div class="ttname"><a href="namespacev8_1_1internal.html#a6587dc44973ce8b6139d4f4da5691d31">v8::internal::kExternalPointerTagAndMarkbitMask</a></div><div class="ttdeci">constexpr uint64_t kExternalPointerTagAndMarkbitMask</div><div class="ttdef"><b>Definition:</b> <a href="v8-internal_8h_source.html#l00353">v8-internal.h:353</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_a677d3b38e89879fc0a176da6da2d82fc"><div class="ttname"><a href="namespacev8_1_1internal.html#a677d3b38e89879fc0a176da6da2d82fc">v8::internal::kMaxExternalPointers</a></div><div class="ttdeci">constexpr size_t kMaxExternalPointers</div><div class="ttdef"><b>Definition:</b> <a href="v8-internal_8h_source.html#l00342">v8-internal.h:342</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_a7d9d03c72a6418e2aba25f8a52114027"><div class="ttname"><a href="namespacev8_1_1internal.html#a7d9d03c72a6418e2aba25f8a52114027">v8::internal::kNullExternalPointerHandle</a></div><div class="ttdeci">constexpr ExternalPointerHandle kNullExternalPointerHandle</div><div class="ttdef"><b>Definition:</b> <a href="v8-internal_8h_source.html#l00375">v8-internal.h:375</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_a8c89f00da07e125218128b9fbf0a321c"><div class="ttname"><a href="namespacev8_1_1internal.html#a8c89f00da07e125218128b9fbf0a321c">v8::internal::handle</a></div><div class="ttdeci">IndirectHandle&lt; T &gt; handle(Tagged&lt; T &gt; object, Isolate *isolate)</div><div class="ttdef"><b>Definition:</b> <a href="handles-inl_8h_source.html#l00072">handles-inl.h:72</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_a8e5c39cbfcba3ac3deea71d575ceebbf"><div class="ttname"><a href="namespacev8_1_1internal.html#a8e5c39cbfcba3ac3deea71d575ceebbf">v8::internal::IsManagedExternalPointerType</a></div><div class="ttdeci">static constexpr bool IsManagedExternalPointerType(ExternalPointerTagRange tag_range)</div><div class="ttdef"><b>Definition:</b> <a href="v8-internal_8h_source.html#l00700">v8-internal.h:700</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_aa5178998e7ae493acf744bc92b1fbdbc"><div class="ttname"><a href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbc">v8::internal::ExternalPointerTag</a></div><div class="ttdeci">ExternalPointerTag</div><div class="ttdef"><b>Definition:</b> <a href="v8-internal_8h_source.html#l00552">v8-internal.h:552</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_aa5178998e7ae493acf744bc92b1fbdbca0e288db8a77a95b08252312c190c4620"><div class="ttname"><a href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbca0e288db8a77a95b08252312c190c4620">v8::internal::kExternalPointerEvacuationEntryTag</a></div><div class="ttdeci">@ kExternalPointerEvacuationEntryTag</div><div class="ttdef"><b>Definition:</b> <a href="v8-internal_8h_source.html#l00656">v8-internal.h:656</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_aa5178998e7ae493acf744bc92b1fbdbca83290c791d98230a5ca3ca39539a08a7"><div class="ttname"><a href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbca83290c791d98230a5ca3ca39539a08a7">v8::internal::kExternalPointerFreeEntryTag</a></div><div class="ttdeci">@ kExternalPointerFreeEntryTag</div><div class="ttdef"><b>Definition:</b> <a href="v8-internal_8h_source.html#l00657">v8-internal.h:657</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_aa5178998e7ae493acf744bc92b1fbdbcaa88b7743bdecef555feef8bb3d823ae9"><div class="ttname"><a href="namespacev8_1_1internal.html#aa5178998e7ae493acf744bc92b1fbdbcaa88b7743bdecef555feef8bb3d823ae9">v8::internal::kExternalPointerZappedEntryTag</a></div><div class="ttdeci">@ kExternalPointerZappedEntryTag</div><div class="ttdef"><b>Definition:</b> <a href="v8-internal_8h_source.html#l00655">v8-internal.h:655</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_aa6b3743bd5d773c552654f2a6c3efa4a"><div class="ttname"><a href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">v8::internal::DCHECK</a></div><div class="ttdeci">DCHECK(IsNull(value)||IsNativeContext(value)||value==Smi::uninitialized_deserialization_value())</div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_aa9db791c05a0359859a321dcfec42e37"><div class="ttname"><a href="namespacev8_1_1internal.html#aa9db791c05a0359859a321dcfec42e37">v8::internal::v8_flags</a></div><div class="ttdeci">V8_EXPORT_PRIVATE FlagValues v8_flags</div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_ab06255cf21187dad77fbfe7fc722a216"><div class="ttname"><a href="namespacev8_1_1internal.html#ab06255cf21187dad77fbfe7fc722a216">v8::internal::ExternalPointerTagRange</a></div><div class="ttdeci">TagRange&lt; ExternalPointerTag &gt; ExternalPointerTagRange</div><div class="ttdef"><b>Definition:</b> <a href="v8-internal_8h_source.html#l00662">v8-internal.h:662</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_ab4955debfb9384e59e3d4e9fcab5b0a0"><div class="ttname"><a href="namespacev8_1_1internal.html#ab4955debfb9384e59e3d4e9fcab5b0a0">v8::internal::Address</a></div><div class="ttdeci">uintptr_t Address</div><div class="ttdef"><b>Definition:</b> <a href="memcopy_8h_source.html#l00022">memcopy.h:22</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_aba548aae398799ae5ad2a11ff110178b"><div class="ttname"><a href="namespacev8_1_1internal.html#aba548aae398799ae5ad2a11ff110178b">v8::internal::ExternalPointerHandle</a></div><div class="ttdeci">uint32_t ExternalPointerHandle</div><div class="ttdef"><b>Definition:</b> <a href="v8-internal_8h_source.html#l00363">v8-internal.h:363</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_ac1a33b5fd9af1653d346746cdb5c1ac0"><div class="ttname"><a href="namespacev8_1_1internal.html#ac1a33b5fd9af1653d346746cdb5c1ac0">v8::internal::value</a></div><div class="ttdeci">return value</div><div class="ttdef"><b>Definition:</b> <a href="map-inl_8h_source.html#l00912">map-inl.h:912</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_acf6bafb5b8483a580f375393c413ee02"><div class="ttname"><a href="namespacev8_1_1internal.html#acf6bafb5b8483a580f375393c413ee02">v8::internal::kNullAddress</a></div><div class="ttdeci">static constexpr Address kNullAddress</div><div class="ttdef"><b>Definition:</b> <a href="v8-internal_8h_source.html#l00053">v8-internal.h:53</a></div></div>
<div class="ttc" id="anamespacev8_html"><div class="ttname"><a href="namespacev8.html">v8</a></div><div class="ttdoc">This file provides additional API on top of the default one for making API calls, which come from emb...</div><div class="ttdef"><b>Definition:</b> <a href="api-arguments-inl_8h_source.html#l00019">api-arguments-inl.h:19</a></div></div>
<div class="ttc" id="asrc_2base_2logging_8h_html_a16b382527f19b805fc8f856668f2270b"><div class="ttname"><a href="src_2base_2logging_8h.html#a16b382527f19b805fc8f856668f2270b">DCHECK_LE</a></div><div class="ttdeci">#define DCHECK_LE(v1, v2)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2logging_8h_source.html#l00489">logging.h:489</a></div></div>
<div class="ttc" id="asrc_2base_2logging_8h_html_a3e1cfef60e774a81f30eaddf26a3a274"><div class="ttname"><a href="src_2base_2logging_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a></div><div class="ttdeci">#define CHECK(condition)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2logging_8h_source.html#l00124">logging.h:124</a></div></div>
<div class="ttc" id="asrc_2base_2logging_8h_html_a96a75539aa82216cdde2250a11126ea0"><div class="ttname"><a href="src_2base_2logging_8h.html#a96a75539aa82216cdde2250a11126ea0">DCHECK_IMPLIES</a></div><div class="ttdeci">#define DCHECK_IMPLIES(v1, v2)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2logging_8h_source.html#l00492">logging.h:492</a></div></div>
<div class="ttc" id="asrc_2base_2logging_8h_html_a986dc8f4ec6dcd0644efe205c13f8eb7"><div class="ttname"><a href="src_2base_2logging_8h.html#a986dc8f4ec6dcd0644efe205c13f8eb7">DCHECK_NE</a></div><div class="ttdeci">#define DCHECK_NE(v1, v2)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2logging_8h_source.html#l00485">logging.h:485</a></div></div>
<div class="ttc" id="asrc_2base_2logging_8h_html_af9c313d74155f7f201955a939e24c71f"><div class="ttname"><a href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a></div><div class="ttdeci">#define DCHECK_EQ(v1, v2)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2logging_8h_source.html#l00484">logging.h:484</a></div></div>
<div class="ttc" id="asrc_2base_2macros_8h_html_a280b0798f270f4b3f361c9ab64832956"><div class="ttname"><a href="src_2base_2macros_8h.html#a280b0798f270f4b3f361c9ab64832956">USE</a></div><div class="ttdeci">#define USE(...)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2macros_8h_source.html#l00293">macros.h:293</a></div></div>
<div class="ttc" id="av8config_8h_html_a67bd29db07c711b0fb11ff1c324ebb60"><div class="ttname"><a href="v8config_8h.html#a67bd29db07c711b0fb11ff1c324ebb60">V8_UNLIKELY</a></div><div class="ttdeci">#define V8_UNLIKELY(condition)</div><div class="ttdef"><b>Definition:</b> <a href="v8config_8h_source.html#l00660">v8config.h:660</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_19225156eb7ba052e31d1a736469917a.html">mnt</a></li><li class="navelem"><a class="el" href="dir_3536f6d353061322e9ef91134b76e9ed.html">V8SourceCode</a></li><li class="navelem"><a class="el" href="dir_fbd53c45610d490c9fb8d0716db4e3a3.html">src</a></li><li class="navelem"><a class="el" href="dir_d9ad92fcb1c9e950b685c3ac072f4391.html">sandbox</a></li><li class="navelem"><a class="el" href="external-pointer-table-inl_8h.html">external-pointer-table-inl.h</a></li>
    <li class="footer">Generated on Thu Jun 12 2025 16:00:24 for V8 Project by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
