<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>V8 Project: /mnt/V8SourceCode/src/compiler/string-builder-optimizer.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">V8 Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('string-builder-optimizer_8cc_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">string-builder-optimizer.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="string-builder-optimizer_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright 2022 the V8 project authors. All rights reserved.</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Use of this source code is governed by a BSD-style license that can be</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// found in the LICENSE file.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="string-builder-optimizer_8h.html">src/compiler/string-builder-optimizer.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="bits_8h.html">src/base/bits.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="src_2base_2logging_8h.html">src/base/logging.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="small-vector_8h.html">src/base/small-vector.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="access-builder_8h.html">src/compiler/access-builder.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="graph-assembler_8h.html">src/compiler/graph-assembler.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="js-graph_8h.html">src/compiler/js-graph.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="js-heap-broker_8h.html">src/compiler/js-heap-broker.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="js-operator_8h.html">src/compiler/js-operator.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="node-matchers_8h.html">src/compiler/node-matchers.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="node-properties_8h.html">src/compiler/node-properties.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="node_8h.html">src/compiler/node.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="opcodes_8h.html">src/compiler/opcodes.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="operator_8h.html">src/compiler/operator.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="schedule_8h.html">src/compiler/schedule.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="compiler_2turbofan-types_8h.html">src/compiler/turbofan-types.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="code_8h.html">src/objects/code.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="map-inl_8h.html">src/objects/map-inl.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="utils_2utils_8h.html">src/utils/utils.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="zone-containers_8h.html">src/zone/zone-containers.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacev8.html">v8</a> {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacev8_1_1internal.html#a5031451934208565c827c86d9eb86c5a">internal</a> {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">namespace </span>compiler {</div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html">   33</a></span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// Returns true if {node} is a kStringConcat or a kNewConsString.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a28cca41977bd3a107541928d45cf58de">   36</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a28cca41977bd3a107541928d45cf58de">IsConcat</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">return</span> node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>() == IrOpcode::kStringConcat ||</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;         node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>() == IrOpcode::kNewConsString;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">// Returns true if {node} is considered as a literal string by the string</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// builder optimizer:</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//    - it&#39;s a literal string</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//    - or it&#39;s a kStringFromSingleCharCode</span></div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#ae6ef7bb53ae6b483ee9b5fca46a40eed">   45</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#ae6ef7bb53ae6b483ee9b5fca46a40eed">IsLiteralString</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1JSHeapBroker.html">JSHeapBroker</a>* <a class="code" href="flag-definitions_8h.html#a1e4d6c2aea5c663dda8b8fca8b9199a5">broker</a>) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">switch</span> (node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>()) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask.html#a0ada1f75f62be73dabab73507ca7bc14">IrOpcode::kHeapConstant</a>: {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <a class="code" href="structv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl.html">HeapObjectMatcher</a> m(node);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">return</span> m.<a class="code" href="structv8_1_1internal_1_1compiler_1_1ValueMatcher.html#a6665883b23b5b528f20e3cb52dfe5c5c">HasResolvedValue</a>() &amp;&amp; m.<a class="code" href="structv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl.html#a81577df449591950f722a82e54537a8a">Ref</a>(<a class="code" href="flag-definitions_8h.html#a1e4d6c2aea5c663dda8b8fca8b9199a5">broker</a>).IsString() &amp;&amp;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;             m.<a class="code" href="structv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl.html#a81577df449591950f722a82e54537a8a">Ref</a>(<a class="code" href="flag-definitions_8h.html#a1e4d6c2aea5c663dda8b8fca8b9199a5">broker</a>).AsString().IsContentAccessible();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringFromSingleCharCode:</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// Returns true if {node} has at least one concatenation or phi in its uses.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a6c83f2f5945121347b6d5081b073784e">   60</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a6c83f2f5945121347b6d5081b073784e">HasConcatOrPhiUse</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* <a class="code" href="flag-definitions_8h.html#a2e89dcc15f540da766f7767b13e377e1">use</a> : node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a9ebd76ae3786acc626d9c4f3cc3f8557">uses</a>()) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a28cca41977bd3a107541928d45cf58de">IsConcat</a>(<a class="code" href="flag-definitions_8h.html#a2e89dcc15f540da766f7767b13e377e1">use</a>) || <a class="code" href="flag-definitions_8h.html#a2e89dcc15f540da766f7767b13e377e1">use</a>-&gt;opcode() == IrOpcode::kPhi) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}  <span class="comment">// namespace</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a97207e88f4f3e5fd39bc7182b8613ccf">   71</a></span>&#160;<a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3">OneOrTwoByteAnalysis::State</a> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a97207e88f4f3e5fd39bc7182b8613ccf">OneOrTwoByteAnalysis::ConcatResultIsOneOrTwoByte</a>(</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3">State</a> a, <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3">State</a> b) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(a != <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a25c2dc47991b3df171ed5192bcf70390">State::kUnknown</a> &amp;&amp; b != <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a25c2dc47991b3df171ed5192bcf70390">State::kUnknown</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">if</span> (a == <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a57d2af567823567ab5671b3297f22932">State::kOneByte</a> &amp;&amp; b == <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a57d2af567823567ab5671b3297f22932">State::kOneByte</a>) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a57d2af567823567ab5671b3297f22932">State::kOneByte</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">if</span> (a == <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7aae2709672066521147bc71cc3d59f6">State::kTwoByte</a> || b == <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7aae2709672066521147bc71cc3d59f6">State::kTwoByte</a>) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7aae2709672066521147bc71cc3d59f6">State::kTwoByte</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b">State::kCantKnow</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;}</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">   83</a></span>&#160;std::optional&lt;std::pair&lt;int64_t, int64_t&gt;&gt; <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">OneOrTwoByteAnalysis::TryGetRange</a>(</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">switch</span> (node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>()) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kChangeTaggedToFloat64:</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kTruncateFloat64ToWord32:</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">TryGetRange</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(0));</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kInt32Add:</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kInt32AddWithOverflow:</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kInt64Add:</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kInt64AddWithOverflow:</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kFloat32Add:</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kFloat64Add: {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      std::optional&lt;std::pair&lt;int64_t, int64_t&gt;&gt; left =</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">TryGetRange</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(0));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      std::optional&lt;std::pair&lt;int64_t, int64_t&gt;&gt; right =</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">TryGetRange</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(1));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">if</span> (left.has_value() &amp;&amp; right.has_value()) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <a class="code" href="namespaceunibrow.html#ab0275d47f9778d486eafe88b18c5851d">int32_t</a> high_bound;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1base_1_1bits.html#ac27d6b4ca0983d91ae080c5822aad3b5">base::bits::SignedAddOverflow32</a>(<span class="keyword">static_cast&lt;</span><a class="code" href="namespaceunibrow.html#ab0275d47f9778d486eafe88b18c5851d">int32_t</a><span class="keyword">&gt;</span>(left-&gt;second),</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                            <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceunibrow.html#ab0275d47f9778d486eafe88b18c5851d">int32_t</a><span class="keyword">&gt;</span>(right-&gt;second),</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                            &amp;high_bound)) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;          <span class="comment">// The range would overflow a 32-bit integer.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">return</span> std::pair{left-&gt;first + right-&gt;first, high_bound};</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kInt32Sub:</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kInt32SubWithOverflow:</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kInt64Sub:</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kInt64SubWithOverflow:</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask.html#a9fc841766cd28604a5aa910b1e05e3c4">IrOpcode::kFloat32Sub</a>:</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask.html#a88caf89879cb4c2e74a6847dcc0d2cf0">IrOpcode::kFloat64Sub</a>: {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      std::optional&lt;std::pair&lt;int64_t, int64_t&gt;&gt; left =</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">TryGetRange</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(0));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      std::optional&lt;std::pair&lt;int64_t, int64_t&gt;&gt; right =</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">TryGetRange</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(1));</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">if</span> (left.has_value() &amp;&amp; right.has_value()) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">if</span> (left-&gt;first - right-&gt;second &lt; 0) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          <span class="comment">// The range would contain negative values.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">return</span> std::pair{left-&gt;first - right-&gt;second,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                         left-&gt;second - right-&gt;first};</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kWord32And:</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kWord64And: {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="comment">// Note that the minimal value for &quot;a &amp; b&quot; is always 0, regardless of the</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="comment">// max for &quot;a&quot; or &quot;b&quot;. And the maximal value is the min of &quot;max of a&quot; and</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="comment">// &quot;max of b&quot;.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      std::optional&lt;std::pair&lt;int64_t, int64_t&gt;&gt; left =</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">TryGetRange</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(0));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      std::optional&lt;std::pair&lt;int64_t, int64_t&gt;&gt; right =</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">TryGetRange</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(1));</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">if</span> (left.has_value() &amp;&amp; right.has_value()) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">return</span> std::pair{0, std::min(left-&gt;second, right-&gt;second)};</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (left.has_value()) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">return</span> std::pair{0, left-&gt;second};</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (right.has_value()) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">return</span> std::pair{0, right-&gt;second};</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kInt32Mul:</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kInt32MulWithOverflow:</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kInt64Mul:</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask.html#affd391dfee47b71c7d8dfacbe50913b6">IrOpcode::kFloat32Mul</a>:</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask.html#ab7d19f55ab5ae0815e96b07377977f33">IrOpcode::kFloat64Mul</a>: {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      std::optional&lt;std::pair&lt;int64_t, int64_t&gt;&gt; left =</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">TryGetRange</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(0));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      std::optional&lt;std::pair&lt;int64_t, int64_t&gt;&gt; right =</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">TryGetRange</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(1));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordflow">if</span> (left.has_value() &amp;&amp; right.has_value()) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="namespaceunibrow.html#ab0275d47f9778d486eafe88b18c5851d">int32_t</a> high_bound;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1base_1_1bits.html#ae084bb91ce53c3748808f66bd49a8a51">base::bits::SignedMulOverflow32</a>(<span class="keyword">static_cast&lt;</span><a class="code" href="namespaceunibrow.html#ab0275d47f9778d486eafe88b18c5851d">int32_t</a><span class="keyword">&gt;</span>(left-&gt;second),</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                            <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceunibrow.html#ab0275d47f9778d486eafe88b18c5851d">int32_t</a><span class="keyword">&gt;</span>(right-&gt;second),</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                            &amp;high_bound)) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          <span class="comment">// The range would overflow a 32-bit integer.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">return</span> std::pair{left-&gt;first * right-&gt;first,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                         left-&gt;second * right-&gt;second};</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kCall: {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="structv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl.html">HeapObjectMatcher</a> m(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(0));</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> (m.<a class="code" href="structv8_1_1internal_1_1compiler_1_1ValueMatcher.html#a6665883b23b5b528f20e3cb52dfe5c5c">HasResolvedValue</a>() &amp;&amp; m.<a class="code" href="structv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl.html#a81577df449591950f722a82e54537a8a">Ref</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a6604e4259eeac2f76d92d867da5acf0c">broker</a>()).IsCode()) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1CodeRef.html">CodeRef</a> <a class="code" href="flag-definitions_8h.html#ae0e79c88adf5166f9befeb542c2acd8f">code</a> = m.<a class="code" href="structv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl.html#a81577df449591950f722a82e54537a8a">Ref</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a6604e4259eeac2f76d92d867da5acf0c">broker</a>()).AsCode();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="flag-definitions_8h.html#ae0e79c88adf5166f9befeb542c2acd8f">code</a>.object()-&gt;is_builtin()) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          <a class="code" href="namespacev8_1_1internal.html#acc2e164143496f18b5ec68f8ab70af52">Builtin</a> builtin = <a class="code" href="flag-definitions_8h.html#ae0e79c88adf5166f9befeb542c2acd8f">code</a>.object()-&gt;builtin_id();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          <span class="keywordflow">switch</span> (builtin) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="comment">// TODO(dmercadier): handle more builtins.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="keywordflow">case</span> Builtin::kMathRandom:</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;              <span class="keywordflow">return</span> std::pair{0, 1};</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;              <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#define CONST_CASE(op, matcher)                                       \</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">  case IrOpcode::k##op: {                                             \</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">    matcher m(node);                                                  \</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">    if (m.HasResolvedValue()) {                                       \</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor">      if (m.ResolvedValue() &lt; 0 ||                                    \</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">          m.ResolvedValue() &gt;= std::numeric_limits&lt;int32_t&gt;::min()) { \</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">        return std::nullopt;                                          \</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">      }                                                               \</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">      return std::pair{m.ResolvedValue(), m.ResolvedValue()};         \</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">    } else {                                                          \</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">      return std::nullopt;                                            \</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor">    }                                                                 \</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">  }</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <a class="code" href="string-builder-optimizer_8cc.html#ab0daa3141dc1b3c77114b8246f9cf9a5">CONST_CASE</a>(Float32Constant, <a class="code" href="structv8_1_1internal_1_1compiler_1_1FloatMatcher.html">Float32Matcher</a>)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <a class="code" href="string-builder-optimizer_8cc.html#ab0daa3141dc1b3c77114b8246f9cf9a5">CONST_CASE</a>(Float64Constant, <a class="code" href="structv8_1_1internal_1_1compiler_1_1FloatMatcher.html">Float64Matcher</a>)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <a class="code" href="string-builder-optimizer_8cc.html#ab0daa3141dc1b3c77114b8246f9cf9a5">CONST_CASE</a>(Int32Constant, <a class="code" href="structv8_1_1internal_1_1compiler_1_1IntMatcher.html">Int32Matcher</a>)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <a class="code" href="string-builder-optimizer_8cc.html#ab0daa3141dc1b3c77114b8246f9cf9a5">CONST_CASE</a>(Int64Constant, <a class="code" href="structv8_1_1internal_1_1compiler_1_1IntMatcher.html">Int64Matcher</a>)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="string-builder-optimizer_8cc.html#ab0daa3141dc1b3c77114b8246f9cf9a5">CONST_CASE</a>(<a class="code" href="namespacev8_1_1internal_1_1compiler.html#a3c392be439ddfcced9509a98e8aa385d">NumberConstant</a>, <a class="code" href="structv8_1_1internal_1_1compiler_1_1FloatMatcher.html">NumberMatcher</a>)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#undef CONST_CASE</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">// Tries to determine whether {node} is a 1-byte or a 2-byte string. This</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">// function assumes that {node} is part of a string builder: if it&#39;s a</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">// concatenation and its left hand-side is something else than a literal string,</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">// it returns only whether the right hand-side is 1/2-byte: the String builder</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">// analysis will take care of propagating the state of the left hand-side.</span></div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a91d8d12ae70310a081961516aa83ab45">  228</a></span>&#160;<a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3">OneOrTwoByteAnalysis::State</a> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a91d8d12ae70310a081961516aa83ab45">OneOrTwoByteAnalysis::OneOrTwoByte</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// TODO(v8:13785,dmercadier): once externalization can no longer convert a</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// 1-byte into a 2-byte string, compute the proper OneOrTwoByte state.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b">State::kCantKnow</a>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a2e452ee78560b16697c49d89eff9d225">states_</a>[node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ad92692ef35b67abdadbe3881fe9050ab">id</a>()] != <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a25c2dc47991b3df171ed5192bcf70390">State::kUnknown</a>) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a2e452ee78560b16697c49d89eff9d225">states_</a>[node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ad92692ef35b67abdadbe3881fe9050ab">id</a>()];</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">switch</span> (node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>()) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask.html#a0ada1f75f62be73dabab73507ca7bc14">IrOpcode::kHeapConstant</a>: {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <a class="code" href="structv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl.html">HeapObjectMatcher</a> m(node);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">if</span> (m.<a class="code" href="structv8_1_1internal_1_1compiler_1_1ValueMatcher.html#a6665883b23b5b528f20e3cb52dfe5c5c">HasResolvedValue</a>() &amp;&amp; m.<a class="code" href="structv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl.html#a81577df449591950f722a82e54537a8a">Ref</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a6604e4259eeac2f76d92d867da5acf0c">broker</a>()).IsString()) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringRef.html">StringRef</a> <span class="keywordtype">string</span> = m.<a class="code" href="structv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl.html#a81577df449591950f722a82e54537a8a">Ref</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a6604e4259eeac2f76d92d867da5acf0c">broker</a>()).AsString();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">if</span> (<span class="keywordtype">string</span>.<span class="keywordtype">object</span>()-&gt;IsOneByteRepresentation()) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a2e452ee78560b16697c49d89eff9d225">states_</a>[node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ad92692ef35b67abdadbe3881fe9050ab">id</a>()] = <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a57d2af567823567ab5671b3297f22932">State::kOneByte</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a57d2af567823567ab5671b3297f22932">State::kOneByte</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<span class="keywordtype">string</span>.<span class="keywordtype">object</span>()-&gt;IsTwoByteRepresentation());</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a2e452ee78560b16697c49d89eff9d225">states_</a>[node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ad92692ef35b67abdadbe3881fe9050ab">id</a>()] = <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7aae2709672066521147bc71cc3d59f6">State::kTwoByte</a>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7aae2709672066521147bc71cc3d59f6">State::kTwoByte</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a2e452ee78560b16697c49d89eff9d225">states_</a>[node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ad92692ef35b67abdadbe3881fe9050ab">id</a>()] = <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b">State::kCantKnow</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b">State::kCantKnow</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringFromSingleCharCode: {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* input = node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(0);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">switch</span> (input-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>()) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">case</span> IrOpcode::kStringCharCodeAt: {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3">State</a> state = <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a91d8d12ae70310a081961516aa83ab45">OneOrTwoByte</a>(input-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(0));</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a2e452ee78560b16697c49d89eff9d225">states_</a>[node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ad92692ef35b67abdadbe3881fe9050ab">id</a>()] = state;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <span class="keywordflow">return</span> state;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          std::optional&lt;std::pair&lt;int64_t, int64_t&gt;&gt; range =</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;              <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">TryGetRange</a>(input);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          <span class="keywordflow">if</span> (!range.has_value()) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a2e452ee78560b16697c49d89eff9d225">states_</a>[node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ad92692ef35b67abdadbe3881fe9050ab">id</a>()] = <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b">State::kCantKnow</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b">State::kCantKnow</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (range-&gt;first &gt;= 0 &amp;&amp; range-&gt;second &lt; 255) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a2e452ee78560b16697c49d89eff9d225">states_</a>[node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ad92692ef35b67abdadbe3881fe9050ab">id</a>()] = <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a57d2af567823567ab5671b3297f22932">State::kOneByte</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a57d2af567823567ab5671b3297f22932">State::kOneByte</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="comment">// For values greater than 0xFF, with the current analysis, we have</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="comment">// no way of knowing if the result will be on 1 or 2 bytes. For</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="comment">// instance, `String.fromCharCode(0x120064 &amp; 0xffff)` will</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="comment">// be a 1-byte string, although the analysis will consider that its</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="comment">// range is [0, 0xffff].</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a2e452ee78560b16697c49d89eff9d225">states_</a>[node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ad92692ef35b67abdadbe3881fe9050ab">id</a>()] = <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b">State::kCantKnow</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b">State::kCantKnow</a>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringConcat:</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kNewConsString: {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* lhs = node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(1);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* rhs = node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(2);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#ae6ef7bb53ae6b483ee9b5fca46a40eed">IsLiteralString</a>(rhs, <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a6604e4259eeac2f76d92d867da5acf0c">broker</a>()));</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3">State</a> rhs_state = <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a91d8d12ae70310a081961516aa83ab45">OneOrTwoByte</a>(rhs);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="comment">// OneOrTwoByte is only called for Nodes that are part of a String</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">// Builder. As a result, a StringConcat/NewConsString is either:</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="comment">//  - between 2 string literal if it is the 1st concatenation of the</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="comment">//    string builder.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="comment">//  - between the beginning of the string builder and a literal string.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="comment">// Thus, if {lhs} is not a literal string, we ignore its State: the</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="comment">// analysis should already have been done on its predecessors anyways.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3">State</a> lhs_state =</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#ae6ef7bb53ae6b483ee9b5fca46a40eed">IsLiteralString</a>(lhs, <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a6604e4259eeac2f76d92d867da5acf0c">broker</a>()) ? <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a91d8d12ae70310a081961516aa83ab45">OneOrTwoByte</a>(lhs) : rhs_state;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3">State</a> node_state = <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a97207e88f4f3e5fd39bc7182b8613ccf">ConcatResultIsOneOrTwoByte</a>(rhs_state, lhs_state);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a2e452ee78560b16697c49d89eff9d225">states_</a>[node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ad92692ef35b67abdadbe3881fe9050ab">id</a>()] = node_state;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordflow">return</span> node_state;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a2e452ee78560b16697c49d89eff9d225">states_</a>[node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ad92692ef35b67abdadbe3881fe9050ab">id</a>()] = <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b">State::kCantKnow</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b">State::kCantKnow</a>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a79c7ac8e832d797235bd223f7f6ab76d">  317</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a79c7ac8e832d797235bd223f7f6ab76d">StringBuilderOptimizer::BlockShouldFinalizeStringBuilders</a>(</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* block) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#af1a711c8d5520dff78858ddefd2ad668">DCHECK_LT</a>(block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#aa45dc7cdf35066f2b39ecdf335f55229">id</a>().<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock_1_1Id.html#a8356d2f9171417907e0a85a959704135">ToInt</a>(), <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab0f33012df119a1c62c12ab471a239d4">blocks_to_trimmings_map_</a>.size());</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab0f33012df119a1c62c12ab471a239d4">blocks_to_trimmings_map_</a>[block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#aa45dc7cdf35066f2b39ecdf335f55229">id</a>().<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock_1_1Id.html#a8356d2f9171417907e0a85a959704135">ToInt</a>()].has_value();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;}</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a9370028d5cca630c223f43f7f613d4ca">  323</a></span>&#160;<a class="code" href="classv8_1_1internal_1_1ZoneVector.html">ZoneVector&lt;Node*&gt;</a> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a9370028d5cca630c223f43f7f613d4ca">StringBuilderOptimizer::GetStringBuildersToFinalize</a>(</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* block) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a79c7ac8e832d797235bd223f7f6ab76d">BlockShouldFinalizeStringBuilders</a>(block));</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab0f33012df119a1c62c12ab471a239d4">blocks_to_trimmings_map_</a>[block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#aa45dc7cdf35066f2b39ecdf335f55229">id</a>().<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock_1_1Id.html#a8356d2f9171417907e0a85a959704135">ToInt</a>()].value();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;}</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#aad734b86fa06299e3d73795b1a45bc54">  329</a></span>&#160;<a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3">OneOrTwoByteAnalysis::State</a> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#aad734b86fa06299e3d73795b1a45bc54">StringBuilderOptimizer::GetOneOrTwoByte</a>(</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a79ddf0a18c0476c96e329aa7110940a7">ConcatIsInStringBuilder</a>(node));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">// TODO(v8:13785,dmercadier): once externalization can no longer convert a</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// 1-byte into a 2-byte string, return the proper OneOrTwoByte status for the</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// node (= remove the next line and uncomment the 2 after).</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b">OneOrTwoByteAnalysis::State::kCantKnow</a>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// int string_builder_number = GetStringBuilderIdForConcat(node);</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">// return string_builders_[string_builder_number].one_or_two_bytes;</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;}</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afa8213096c61872f3e7624c0e3050f29">  340</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afa8213096c61872f3e7624c0e3050f29">StringBuilderOptimizer::IsStringBuilderEnd</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a> = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(node);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a96a75539aa82216cdde2250a11126ea0">DCHECK_IMPLIES</a>(<a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a7af3652974ec23df14261aa2864c2a78">State::kEndStringBuilder</a> ||</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                     <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a663af9d6453261674d573c62f976737d">State::kEndStringBuilderLoopPhi</a>,</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                 <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id != <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">kInvalidId</a> &amp;&amp;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                     StringBuilderIsValid(<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a39003d4e1380f93f1147728c38038195">string_builders_</a>[<a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id]));</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a7af3652974ec23df14261aa2864c2a78">State::kEndStringBuilder</a> ||</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;         <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a663af9d6453261674d573c62f976737d">State::kEndStringBuilderLoopPhi</a>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad2eb4d4b64ac6f7d6dae7abf01933b06">  350</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad2eb4d4b64ac6f7d6dae7abf01933b06">StringBuilderOptimizer::IsNonLoopPhiStringBuilderEnd</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afa8213096c61872f3e7624c0e3050f29">IsStringBuilderEnd</a>(node) &amp;&amp; !<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a659c5eadc8319cd54f78df984ca97916">IsLoopPhi</a>(node);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a9a9731ac16087c0d17e6d44c403aaf21">  354</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a9a9731ac16087c0d17e6d44c403aaf21">StringBuilderOptimizer::IsStringBuilderConcatInput</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a> = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(node);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a96a75539aa82216cdde2250a11126ea0">DCHECK_IMPLIES</a>(<a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ac20bd90d7c7da487270b7f0c9161bd09">State::kConfirmedInStringBuilder</a>,</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                 <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id != <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">kInvalidId</a> &amp;&amp;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                     StringBuilderIsValid(<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a39003d4e1380f93f1147728c38038195">string_builders_</a>[<a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id]));</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ac20bd90d7c7da487270b7f0c9161bd09">State::kConfirmedInStringBuilder</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a79ddf0a18c0476c96e329aa7110940a7">  362</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a79ddf0a18c0476c96e329aa7110940a7">StringBuilderOptimizer::ConcatIsInStringBuilder</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a28cca41977bd3a107541928d45cf58de">IsConcat</a>(node));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a> = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(node);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a96a75539aa82216cdde2250a11126ea0">DCHECK_IMPLIES</a>(<a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ac20bd90d7c7da487270b7f0c9161bd09">State::kConfirmedInStringBuilder</a> ||</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                     <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a> ||</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                     <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a7af3652974ec23df14261aa2864c2a78">State::kEndStringBuilder</a>,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                 <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id != <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">kInvalidId</a> &amp;&amp;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                     StringBuilderIsValid(<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a39003d4e1380f93f1147728c38038195">string_builders_</a>[<a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id]));</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ac20bd90d7c7da487270b7f0c9161bd09">State::kConfirmedInStringBuilder</a> ||</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;         <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a> ||</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;         <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a7af3652974ec23df14261aa2864c2a78">State::kEndStringBuilder</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a1dfe5315cf65deb7536b96f92e05140a">  375</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a1dfe5315cf65deb7536b96f92e05140a">StringBuilderOptimizer::GetStringBuilderIdForConcat</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a28cca41977bd3a107541928d45cf58de">IsConcat</a>(node));</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a> = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(node);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ac20bd90d7c7da487270b7f0c9161bd09">State::kConfirmedInStringBuilder</a> ||</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;         <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a> ||</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;         <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a7af3652974ec23df14261aa2864c2a78">State::kEndStringBuilder</a>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a986dc8f4ec6dcd0644efe205c13f8eb7">DCHECK_NE</a>(<a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">kInvalidId</a>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7651fef55e0ee6bc716d3b69dcf37c1b">  385</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7651fef55e0ee6bc716d3b69dcf37c1b">StringBuilderOptimizer::IsFirstConcatInStringBuilder</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a79ddf0a18c0476c96e329aa7110940a7">ConcatIsInStringBuilder</a>(node)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a> = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(node);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">// Duplicates the {input_idx}th input of {node} if it has multiple uses, so that</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">// the replacement only has one use and can safely be marked as</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">// State::kConfirmedInStringBuilder and properly optimized in</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">// EffectControlLinearizer (in particular, this will allow to safely remove</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">// StringFromSingleCharCode that are only used for a StringConcat that we</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">// optimize).</span></div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a3cf3a8f3f0ff2c0d9ab3f6e681a867fa">  397</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a3cf3a8f3f0ff2c0d9ab3f6e681a867fa">StringBuilderOptimizer::ReplaceConcatInputIfNeeded</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                                        <span class="keywordtype">int</span> input_idx) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#ae6ef7bb53ae6b483ee9b5fca46a40eed">IsLiteralString</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(input_idx), <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a005472dd868bea3495a4ef94577d1522">broker</a>())) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* input = node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(input_idx);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(input-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a3da04276e5cf4a3bceaa3c5aa84a7fb7">op</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Operator.html#a6f9adac9859f8dc4d27961976d7560e8">EffectOutputCount</a>(), 0);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(input-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a3da04276e5cf4a3bceaa3c5aa84a7fb7">op</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Operator.html#ae2fc3b6586e790545e777fde3cec35c7">ControlOutputCount</a>(), 0);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">if</span> (input-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ab216b6b31f349566aa2d7dd26ee630b0">UseCount</a>() &gt; 1) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    input = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a27f13bdc20a0f6f78f14bd7b5526d5c5">graph</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1TFGraph.html#a74ddea578fcea4c330478ad00b00006b">CloneNode</a>(input);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ab6aa5c0ce7d3ad1349cebfe168377ebe">ReplaceInput</a>(input_idx, input);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> node_status = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(node);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a986dc8f4ec6dcd0644efe205c13f8eb7">DCHECK_NE</a>(node_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a>, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">kInvalidId</a>);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(input, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ac20bd90d7c7da487270b7f0c9161bd09">State::kConfirmedInStringBuilder</a>, node_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">// If all of the predecessors of {node} are part of a string builder and have</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">// the same id, returns this id. Otherwise, returns kInvalidId.</span></div>
<div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#aff19dd8c9326aec36198ff86799c0128">  414</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#aff19dd8c9326aec36198ff86799c0128">StringBuilderOptimizer::GetPhiPredecessorsCommonId</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node) {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>(), IrOpcode::kPhi);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">kInvalidId</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacev8_1_1internal.html">i</a> = 0; <a class="code" href="namespacev8_1_1internal.html">i</a> &lt; node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a3da04276e5cf4a3bceaa3c5aa84a7fb7">op</a>()-&gt;ValueInputCount(); <a class="code" href="namespacev8_1_1internal.html">i</a>++) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* input = <a class="code" href="classv8_1_1internal_1_1compiler_1_1NodeProperties.html#a7053cfe3857d7d48ad3d005d633c94cf">NodeProperties::GetValueInput</a>(node, <a class="code" href="namespacev8_1_1internal.html">i</a>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a> = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(input);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a>:</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">State::kInStringBuilder</a>:</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a5de143ed3332e093d8e2a0517de15f2a">State::kPendingPhi</a>:</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">kInvalidId</a>) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;          <span class="comment">// Initializind {id}.</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;          <span class="keywordtype">id</span> = <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">id</span> != <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;          <span class="comment">// 2 inputs belong to different StringBuilder chains.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">kInvalidId</a>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>:</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380af4fa4b4b7a8441c10964d3d0c84b990f">State::kUnvisited</a>:</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">kInvalidId</a>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <a class="code" href="namespacev8_1_1internal.html#acdec713c25068019f935e35976f5b666">UNREACHABLE</a>();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#a986dc8f4ec6dcd0644efe205c13f8eb7">DCHECK_NE</a>(<span class="keywordtype">id</span>, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">kInvalidId</a>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordflow">return</span> id;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;}</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">// Returns true if {first} comes before {second} in {block}.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#acad9c3baa7b040c6b7137be7e1dc556d">  446</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#acad9c3baa7b040c6b7137be7e1dc556d">ComesBeforeInBlock</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* first, <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* second, <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* block) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node : *block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a7c5532f9ebd4587b01183d55a9062033">nodes</a>()) {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> (node == first) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (node == second) {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#acdec713c25068019f935e35976f5b666">UNREACHABLE</a>();</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;}</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a35812856566625589473e49f76e3b843">  458</a></span>&#160;<span class="keyword">static</span> constexpr <span class="keywordtype">int</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a35812856566625589473e49f76e3b843">kMaxPredecessors</a> = 15;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">// Compute up to {kMaxPredecessors} predecessors of {start} that are not past</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">// {end}, and store them in {dst}. Returns true if there are less than</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">// {kMaxPredecessors} such predecessors and false otherwise.</span></div>
<div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a1b2deb5afd0e7ee81bbd36c4c7aa0328">  463</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a1b2deb5afd0e7ee81bbd36c4c7aa0328">ComputePredecessors</a>(</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* start, <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* <a class="code" href="namespacev8_1_1internal_1_1compiler.html#a51dcb90ae077172b12d63271c7e7ba0c">end</a>,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="classv8_1_1base_1_1SmallVector.html">base::SmallVector&lt;BasicBlock*, kMaxPredecessors&gt;</a>* dst) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  dst-&gt;<a class="code" href="classv8_1_1base_1_1SmallVector.html#ad8177749a526ab128a35c4ec8b0cddf7">push_back</a>(start);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordtype">size_t</span> stack_pointer = 0;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">while</span> (stack_pointer &lt; dst-&gt;<a class="code" href="flag-definitions_8h.html#a3df0b28b666e942ffb9d7d04acdb9715">size</a>()) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* current = (*dst)[stack_pointer++];</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> (current == <a class="code" href="namespacev8_1_1internal_1_1compiler.html#a51dcb90ae077172b12d63271c7e7ba0c">end</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* pred : current-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#ad7747f3d0300996ac24e2b3bdaf1d364">predecessors</a>()) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keywordflow">if</span> (std::find(dst-&gt;<a class="code" href="classv8_1_1base_1_1SmallVector.html#a2f92240eb4f14cfa46552a2b35cc4e70">begin</a>(), dst-&gt;<a class="code" href="classv8_1_1base_1_1SmallVector.html#a61255d85c4f174e5705b3f725214f121">end</a>(), pred) == dst-&gt;<a class="code" href="classv8_1_1base_1_1SmallVector.html#a61255d85c4f174e5705b3f725214f121">end</a>()) {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">if</span> (dst-&gt;<a class="code" href="classv8_1_1base_1_1SmallVector.html#a376b32218e50b6efec68f577c009885d">size</a>() == <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a35812856566625589473e49f76e3b843">kMaxPredecessors</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        dst-&gt;<a class="code" href="classv8_1_1base_1_1SmallVector.html#ad8177749a526ab128a35c4ec8b0cddf7">push_back</a>(pred);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;}</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">// Returns false if {node} makes its string input escape this use. For instance,</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">// a Phi or a Store make their input escape, but a kStringLength consumes its</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">// inputs.</span></div>
<div class="line"><a name="l00484"></a><span class="lineno"><a class="line" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a254b932e6ccf797dc1d3c9917336600d">  484</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a254b932e6ccf797dc1d3c9917336600d">OpcodeIsAllowed</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1IrOpcode.html#a12e212665e666e61e7d32a0ae9a31e80">IrOpcode::Value</a> op) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">switch</span> (op) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringLength:</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringConcat:</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kNewConsString:</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringCharCodeAt:</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringCodePointAt:</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringIndexOf:</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kObjectIsString:</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringToLowerCaseIntl:</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringToNumber:</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringToUpperCaseIntl:</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringEqual:</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringLessThan:</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kStringLessThanOrEqual:</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kCheckString:</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kCheckStringOrStringWrapper:</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">case</span> IrOpcode::kTypedStateValues:</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;}</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">// Returns true if {sb_child_block} can be a valid successor for</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">// {previous_block} in the string builder, considering that {other_child_block}</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">// is another successor of {previous_block} (which uses the string builder that</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">// is in {previous_block}).We are mainly checking for the following scenario:</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">//               |</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">//               v</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">//       +---&gt; LoopPhi</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">//       |       |</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">//       |       v</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">//       |      node ----------&gt; other_child</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">//       |       |</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">//       |       v</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">//       |     child</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">//       |      ...</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">//       |       |</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">//       +-------+</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">// Where {node} and {child} are inside a loop (and could be part of a string</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">// builder), but {other_child} is not, and the control flow doesn&#39;t exit the</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">// loop in between {node} and {child}. The string builder should not be used in</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">// such situations, because by the time {other_child} is reached, its input will</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">// be invalid, because {child} will have mutated it. (here, node&#39;s block would</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">// be {previous_block}, child&#39;s would be {sb_child_block} and other_child&#39;s</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">// would be {other_child_block}).</span></div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a0f6616ec658f329b8899c513f70ef30a">  533</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a0f6616ec658f329b8899c513f70ef30a">ValidControlFlowForStringBuilder</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* sb_child_block,</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                      <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* other_child_block,</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                      <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* previous_block,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                      <a class="code" href="classv8_1_1internal_1_1ZoneVector.html">ZoneVector&lt;BasicBlock*&gt;</a> loop_headers) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">if</span> (loop_headers.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#a40b4c6f563e6b4253b77a7351e3c88b2">empty</a>()) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="comment">// Due to how we visit the graph, {sb_child_block} is the block that</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="comment">// VisitGraph is currently visiting, which means that it has to be in all the</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">// loops of {loop_headers} (and in particular in the latest one).</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">// {other_child_block} on the other hand could be in the loop or not, which is</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// what this function tries to determine.</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(loop_headers.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#af1e14717af927853f497f9c0e47d4e2d">back</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a5645be1794e86c2cff02dacdedeb12f0">LoopContains</a>(sb_child_block));</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">if</span> (sb_child_block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#aebd20273b715c4e966c748800c301804">IsLoopHeader</a>()) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// {sb_child_block} starts a loop. This is OK for {other_child_block} only</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// if {other_child_block} is before the loop (because if it&#39;s after, then</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// the value it will receive will be invalid), or if both</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// {other_child_block} and {previous_block} are inside the loop. The latter</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">// case corresponds to:</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">//  +--------&gt; sb_child_block</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">//  |         /             \</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">    //  |        |               \</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">    //  |        v                v</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">//  | previous_block         other_child_block</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">//  |        |</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">//  +--------+</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">// Where {other_child_block} eventually reaches {previous_block} (or exits</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">// the loop through some other path).</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">return</span> other_child_block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a151491c34ac00cd5a85d3b26f39fb44c">rpo_number</a>() &lt; sb_child_block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a151491c34ac00cd5a85d3b26f39fb44c">rpo_number</a>() ||</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;           (sb_child_block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a5645be1794e86c2cff02dacdedeb12f0">LoopContains</a>(previous_block) &amp;&amp;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            (sb_child_block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a5645be1794e86c2cff02dacdedeb12f0">LoopContains</a>(other_child_block)));</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">// Both {sb_child_block} and {other_child_block} should be in the same loop.</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">return</span> loop_headers.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#af1e14717af927853f497f9c0e47d4e2d">back</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a5645be1794e86c2cff02dacdedeb12f0">LoopContains</a>(other_child_block);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;}</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">// Return true if {maybe_dominator} dominates {maybe_dominee} and is less than</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">// {kMaxDominatorSteps} steps away (to avoid going back too far if</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">// {maybe_dominee} is much deeper in the graph that {maybe_dominator}).</span></div>
<div class="line"><a name="l00573"></a><span class="lineno"><a class="line" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a898c935b8b8006e40d2953cf1f7820b5">  573</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a898c935b8b8006e40d2953cf1f7820b5">IsClosebyDominator</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* maybe_dominator,</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                        <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* maybe_dominee) {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> kMaxDominatorSteps = 10;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordflow">if</span> (maybe_dominee-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#afd9fcb33de7a485da4ccc0ef13755274">dominator_depth</a>() + kMaxDominatorSteps &lt;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      maybe_dominator-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#afd9fcb33de7a485da4ccc0ef13755274">dominator_depth</a>()) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">// {maybe_dominee} is too far from {maybe_dominator} to compute quickly if</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">// it&#39;s dominated by {maybe_dominator} or not.</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordflow">while</span> (maybe_dominee != maybe_dominator &amp;&amp;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;         maybe_dominator-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#afd9fcb33de7a485da4ccc0ef13755274">dominator_depth</a>() &lt;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;             maybe_dominee-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#afd9fcb33de7a485da4ccc0ef13755274">dominator_depth</a>()) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    maybe_dominee = maybe_dominee-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a6853118281daccde0c37140e6c75187e">dominator</a>();</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordflow">return</span> maybe_dominee == maybe_dominator;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;}</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">// Returns true if {node} is a Phi that has both {input1} and {input2} as</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">// inputs.</span></div>
<div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#ac933348317640264b24e39e0aa65674d">  592</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#ac933348317640264b24e39e0aa65674d">IsPhiContainingGivenInputs</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* input1, <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* input2,</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                <a class="code" href="classv8_1_1internal_1_1compiler_1_1Schedule.html">Schedule</a>* schedule) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordflow">if</span> (node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>() != IrOpcode::kPhi ||</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      schedule-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Schedule.html#adba2b547f951366974d25caad19e575e">block</a>(node)-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#aebd20273b715c4e966c748800c301804">IsLoopHeader</a>()) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordtype">bool</span> has_input1 = <span class="keyword">false</span>, has_input2 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* input : node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a5fd30f94dda21206092c9021e826e52a">inputs</a>()) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">if</span> (input == input1) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      has_input1 = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (input == input2) {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      has_input2 = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">return</span> has_input1 &amp;&amp; has_input2;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;}</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">// Returns true if {phi} has 3 inputs (including the Loop or Merge), and its</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">// first two inputs are either Phi themselves, or StringConcat/NewConsString.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">// This is used to quickly eliminate Phi nodes that cannot be part of a String</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">// Builder.</span></div>
<div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a65e21c951599d9d613063d6b5101729d">  613</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a65e21c951599d9d613063d6b5101729d">PhiInputsAreConcatsOrPhi</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* phi) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(phi-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>(), IrOpcode::kPhi);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordflow">return</span> phi-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a9fddec0f808d54a0b5d97fda3a1043ea">InputCount</a>() == 3 &amp;&amp;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;         (phi-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(0)-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>() == IrOpcode::kPhi ||</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a28cca41977bd3a107541928d45cf58de">IsConcat</a>(phi-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(0))) &amp;&amp;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;         (phi-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(1)-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>() == IrOpcode::kPhi ||</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a28cca41977bd3a107541928d45cf58de">IsConcat</a>(phi-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(1)));</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;}</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;}  <span class="comment">// namespace</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">// Check that the uses of {node} are valid, assuming that {string_builder_child}</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">// is the following node in the string builder. In a nutshell, for uses of a</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">// node (that is part of the string builder) to be valid, they need to all</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">// appear before the next node of the string builder (because after, the node is</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">// not valid anymore because we mutate SlicedString and the backing store in</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">// place). For instance:</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">//     s1 = &quot;123&quot; + &quot;abc&quot;;</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">//     s2 = s1 + &quot;def&quot;;</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">//     l = s1.length();</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">// In this snippet, if `s1` and `s2` are part of the string builder, then the</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">// uses of `s1` are not actually valid, because `s1.length()` appears after the</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">// next node of the string builder (`s2`) has been computed.</span></div>
<div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7a0494d886654ff17b43a6176845a204">  638</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7a0494d886654ff17b43a6176845a204">StringBuilderOptimizer::CheckNodeUses</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node,</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                           <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* string_builder_child,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                           <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(string_builder_child).state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">State::kInStringBuilder</a> ||</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;         <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(string_builder_child).state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a5de143ed3332e093d8e2a0517de15f2a">State::kPendingPhi</a>);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* child_block = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7bace7152c5fa75a7b342f3b64354cab">schedule</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Schedule.html#adba2b547f951366974d25caad19e575e">block</a>(string_builder_child);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">if</span> (node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#ab216b6b31f349566aa2d7dd26ee630b0">UseCount</a>() == 1) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* node_block = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7bace7152c5fa75a7b342f3b64354cab">schedule</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Schedule.html#adba2b547f951366974d25caad19e575e">block</a>(node);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordtype">bool</span> is_loop_phi = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a659c5eadc8319cd54f78df984ca97916">IsLoopPhi</a>(node);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordtype">bool</span> child_is_in_loop =</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      is_loop_phi &amp;&amp; <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab66e1432c44f25fdef1c0b6fac9b197a">LoopContains</a>(node, string_builder_child);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <a class="code" href="classv8_1_1base_1_1SmallVector.html">base::SmallVector&lt;BasicBlock*, kMaxPredecessors&gt;</a> current_predecessors;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordtype">bool</span> predecessors_computed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* other_child : node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a9ebd76ae3786acc626d9c4f3cc3f8557">uses</a>()) {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">if</span> (other_child == string_builder_child) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* other_child_block = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7bace7152c5fa75a7b342f3b64354cab">schedule</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Schedule.html#adba2b547f951366974d25caad19e575e">block</a>(other_child);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a254b932e6ccf797dc1d3c9917336600d">OpcodeIsAllowed</a>(other_child-&gt;opcode())) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="comment">// {other_child} could write {node} (the beginning of the string builder)</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="comment">// in memory (or keep it alive through other means, such as a Phi). This</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="comment">// means that if {string_builder_child} modifies the string builder, then</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="comment">// the value stored by {other_child} will become out-dated (since</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="comment">// {other_child} will probably just write a pointer to the string in</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="comment">// memory, and the string pointed by this pointer will be updated by the</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="comment">// string builder).</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keywordflow">if</span> (is_loop_phi &amp;&amp; child_is_in_loop &amp;&amp;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;          !node_block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a5645be1794e86c2cff02dacdedeb12f0">LoopContains</a>(other_child_block)) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="comment">// {other_child} keeps the string alive, but this is only after the</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="comment">// loop, when {string_builder_child} isn&#39;t alive anymore, so this isn&#39;t</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="comment">// an issue.</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span> (other_child_block == child_block) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="comment">// Both {child} and {other_child} are in the same block, we need to make</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="comment">// sure that {other_child} comes first.</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> other_status = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(other_child);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keywordflow">if</span> (other_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a> != <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">kInvalidId</a>) {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(other_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a>, <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="comment">// {node} flows into 2 different nodes of the string builder, both of</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="comment">// which are in the same BasicBlock, which is not supported. We need to</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="comment">// invalidate {other_child} as well, or the input of {child} could be</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="comment">// wrong. In theory, we could keep one of {other_child} and {child} (the</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="comment">// one that comes the later in the BasicBlock), but it&#39;s simpler to keep</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="comment">// neither, and end the string builder on {node}.</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(other_child, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#acad9c3baa7b040c6b7137be7e1dc556d">ComesBeforeInBlock</a>(other_child, string_builder_child, child_block)) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">if</span> (is_loop_phi) {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <span class="keywordflow">if</span> ((child_is_in_loop &amp;&amp; !node_block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a5645be1794e86c2cff02dacdedeb12f0">LoopContains</a>(other_child_block)) ||</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          (!child_is_in_loop &amp;&amp; node_block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a5645be1794e86c2cff02dacdedeb12f0">LoopContains</a>(other_child_block))) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="comment">// {child} is in the loop and {other_child} isn&#39;t (or the other way</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="comment">// around). In that case, we skip {other_child}: it will be tested</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="comment">// later when we leave the loop (if {child} is in the loop) or has</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="comment">// been tested earlier while we were inside the loop (if {child} isn&#39;t</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="comment">// in the loop).</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a0f6616ec658f329b8899c513f70ef30a">ValidControlFlowForStringBuilder</a>(child_block, other_child_block,</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                                 node_block, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7670f2950fa8b9bd40854c2904f16f67">loop_headers_</a>)) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#ac933348317640264b24e39e0aa65674d">IsPhiContainingGivenInputs</a>(other_child, node, string_builder_child,</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                   <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7bace7152c5fa75a7b342f3b64354cab">schedule</a>())) {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="comment">// {other_child} is a Phi that merges {child} and {node} (and maybe some</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="comment">// other nodes that we don&#39;t care about for now: if {other_child} merges</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="comment">// more than 2 nodes, it won&#39;t be added to the string builder anyways).</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <a class="code" href="classv8_1_1base_1_1SmallVector.html">base::SmallVector&lt;BasicBlock*, kMaxPredecessors&gt;</a> other_predecessors;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordtype">bool</span> all_other_predecessors_computed =</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a1b2deb5afd0e7ee81bbd36c4c7aa0328">ComputePredecessors</a>(other_child_block, node_block, &amp;other_predecessors);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="comment">// Making sure that {child_block} isn&#39;t in the predecessors of</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">// {other_child_block}. Otherwise, the use of {node} in {other_child}</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">// would be invalid.</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">if</span> (std::find(other_predecessors.<a class="code" href="classv8_1_1base_1_1SmallVector.html#a2f92240eb4f14cfa46552a2b35cc4e70">begin</a>(), other_predecessors.<a class="code" href="classv8_1_1base_1_1SmallVector.html#a61255d85c4f174e5705b3f725214f121">end</a>(),</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                  child_block) != other_predecessors.<a class="code" href="classv8_1_1base_1_1SmallVector.html#a61255d85c4f174e5705b3f725214f121">end</a>()) {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="comment">// {child} is in the predecessor of {other_child}, which is definitely</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="comment">// invalid (because it means that {other_child} uses an out-dated version</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="comment">// of {node}, since {child} modified it).</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <span class="keywordflow">if</span> (all_other_predecessors_computed) {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="comment">// {child} is definitely not in the predecessors of {other_child}, which</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="comment">// means that it&#39;s either a successor of {other_child} (which is safe),</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="comment">// or it&#39;s in another path of the graph alltogether (which is also</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="comment">// safe).</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="comment">// We didn&#39;t compute all the predecessors of {other_child}, so it&#39;s</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="comment">// possible that {child_block} is one of the predecessor that we didn&#39;t</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="comment">// compute.</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="comment">// Trying to see if we can find {other_child_block} in the</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="comment">// predecessors of {child_block}: that would mean that {other_child}</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="comment">// is guaranteed to be scheduled before {child}, making it safe.</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">if</span> (!predecessors_computed) {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;          <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a1b2deb5afd0e7ee81bbd36c4c7aa0328">ComputePredecessors</a>(child_block, node_block, &amp;current_predecessors);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          predecessors_computed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keywordflow">if</span> (std::find(current_predecessors.<a class="code" href="classv8_1_1base_1_1SmallVector.html#a2f92240eb4f14cfa46552a2b35cc4e70">begin</a>(), current_predecessors.<a class="code" href="classv8_1_1base_1_1SmallVector.html#a61255d85c4f174e5705b3f725214f121">end</a>(),</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                      other_child_block) == current_predecessors.<a class="code" href="classv8_1_1base_1_1SmallVector.html#a61255d85c4f174e5705b3f725214f121">end</a>()) {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          <span class="comment">// We didn&#39;t find {other_child} in the predecessors of {child}. It</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          <span class="comment">// means that either {other_child} comes after in the graph (which</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          <span class="comment">// is unsafe), or that {other_child} and {child} are on two</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;          <span class="comment">// independent subgraphs (which is safe). We have no efficient way</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;          <span class="comment">// to know which one of the two this is, so, we fall back to a</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;          <span class="comment">// stricter approach: the use of {node} in {other_child} is</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          <span class="comment">// guaranteed to be safe if {other_child_block} dominates</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;          <span class="comment">// {child_block}.</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a898c935b8b8006e40d2953cf1f7820b5">IsClosebyDominator</a>(other_child_block, child_block)) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;}</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">// Check that the uses of the predecessor(s) of {child} in the string builder</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">// are valid, with respect to {child}. This sounds a bit backwards, but we can&#39;t</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">// check if uses are valid before having computed what the next node in the</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">// string builder is. Hence, once we&#39;ve established that {child} is in the</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">// string builder, we check that the uses of the previous node(s) of the</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">// string builder are valid. For non-loop phis (ie, merge phis), we simply check</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">// that the uses of their 2 predecessors are valid. For loop phis, this function</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">// is called twice: one for the outside-the-loop input (with {input_if_loop_phi}</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">// = 0), and once for the inside-the-loop input (with  {input_if_loop_phi} = 1).</span></div>
<div class="line"><a name="l00775"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a4bc4b34398bd65e94024d18f227c0a1e">  775</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a4bc4b34398bd65e94024d18f227c0a1e">StringBuilderOptimizer::CheckPreviousNodeUses</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* child, <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>,</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                                                   <span class="keywordtype">int</span> input_if_loop_phi) {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a28cca41977bd3a107541928d45cf58de">IsConcat</a>(child)) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7a0494d886654ff17b43a6176845a204">CheckNodeUses</a>(child-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(1), child, <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keywordflow">if</span> (child-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>() == IrOpcode::kPhi) {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* child_block = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7bace7152c5fa75a7b342f3b64354cab">schedule</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Schedule.html#adba2b547f951366974d25caad19e575e">block</a>(child);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">if</span> (child_block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#aebd20273b715c4e966c748800c301804">IsLoopHeader</a>()) {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7a0494d886654ff17b43a6176845a204">CheckNodeUses</a>(child-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(input_if_loop_phi), child, <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(child-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a9fddec0f808d54a0b5d97fda3a1043ea">InputCount</a>(), 3);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7a0494d886654ff17b43a6176845a204">CheckNodeUses</a>(child-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(0), child, <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>) &amp;&amp;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;             <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7a0494d886654ff17b43a6176845a204">CheckNodeUses</a>(child-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(1), child, <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <a class="code" href="namespacev8_1_1internal.html#acdec713c25068019f935e35976f5b666">UNREACHABLE</a>();</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;}</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab665a8a005ea4df2e7622565e9cad94c">  793</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab665a8a005ea4df2e7622565e9cad94c">StringBuilderOptimizer::VisitNode</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* block) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a28cca41977bd3a107541928d45cf58de">IsConcat</a>(node)) {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* lhs = node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(1);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* rhs = node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(2);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#ae6ef7bb53ae6b483ee9b5fca46a40eed">IsLiteralString</a>(rhs, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a005472dd868bea3495a4ef94577d1522">broker</a>())) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#ae6ef7bb53ae6b483ee9b5fca46a40eed">IsLiteralString</a>(lhs, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a005472dd868bea3495a4ef94577d1522">broker</a>())) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="comment">// This node could start a string builder. However, we won&#39;t know until</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="comment">// we&#39;ve properly inspected its uses, found a Phi somewhere down its use</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="comment">// chain, made sure that the Phi was valid, etc. Pre-emptively, we do a</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="comment">// quick check (with HasConcatOrPhiUse) that this node has a</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="comment">// StringConcat/NewConsString in its uses, and if so, we set its state as</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="comment">// kBeginConcat, and increment the {string_builder_count_}. The goal of</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="comment">// the HasConcatOrPhiUse is mainly to avoid incrementing</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="comment">// {string_builder_count_} too often for things that are obviously just</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="comment">// regular concatenations of 2 constant strings and that can&#39;t be</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="comment">// beginning of string builders.</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a6c83f2f5945121347b6d5081b073784e">HasConcatOrPhiUse</a>(lhs)) {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a>, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#af912c31e7de4a332a04184af2af6380f">string_builder_count_</a>);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a39003d4e1380f93f1147728c38038195">string_builders_</a>.push_back(</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder.html">StringBuilder</a>{node, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#af912c31e7de4a332a04184af2af6380f">string_builder_count_</a>), <span class="keyword">false</span>,</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                          <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a25c2dc47991b3df171ed5192bcf70390">OneOrTwoByteAnalysis::State::kUnknown</a>});</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#af912c31e7de4a332a04184af2af6380f">string_builder_count_</a>++;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="comment">// A concatenation between 2 literal strings has no predecessor in the</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="comment">// string builder, and there is thus no more checks/bookkeeping required</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="comment">// ==&gt; early return.</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> lhs_status = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(lhs);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="keywordflow">switch</span> (lhs_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a>) {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a>:</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">State::kInStringBuilder</a>:</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">State::kInStringBuilder</a>, lhs_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a5de143ed3332e093d8e2a0517de15f2a">State::kPendingPhi</a>: {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* phi_block = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7bace7152c5fa75a7b342f3b64354cab">schedule</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Schedule.html#adba2b547f951366974d25caad19e575e">block</a>(lhs);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;          <span class="keywordflow">if</span> (phi_block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a5645be1794e86c2cff02dacdedeb12f0">LoopContains</a>(block)) {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="comment">// This node uses a PendingPhi and is inside the loop. We</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            <span class="comment">// speculatively set it to kInStringBuilder.</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">State::kInStringBuilder</a>, lhs_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a>);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="comment">// This node uses a PendingPhi but is not inside the loop, which</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <span class="comment">// means that the PendingPhi was never resolved to a kInConcat or a</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="comment">// kInvalid, which means that it&#39;s actually not valid (because we</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <span class="comment">// visit the graph in RPO order, which means that we&#39;ve already</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            <span class="comment">// visited the whole loop). Thus, we set the Phi to kInvalid, and</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="comment">// thus, we also set the current node to kInvalid.</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(lhs, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;          }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>:</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380af4fa4b4b7a8441c10964d3d0c84b990f">State::kUnvisited</a>:</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;          <a class="code" href="namespacev8_1_1internal.html#acdec713c25068019f935e35976f5b666">UNREACHABLE</a>();</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">opcode</a>() == IrOpcode::kPhi &amp;&amp;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;             <a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a65e21c951599d9d613063d6b5101729d">PhiInputsAreConcatsOrPhi</a>(node)) {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">if</span> (!block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#aebd20273b715c4e966c748800c301804">IsLoopHeader</a>()) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="comment">// This Phi merges nodes after a if/else.</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#aff19dd8c9326aec36198ff86799c0128">GetPhiPredecessorsCommonId</a>(node);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">kInvalidId</a>) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">State::kInStringBuilder</a>, <span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="comment">// This Phi merges a value from inside the loop with one from before.</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a3da04276e5cf4a3bceaa3c5aa84a7fb7">op</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Operator.html#a2ea0f97044ee07b76f525f48360a75ce">ValueInputCount</a>(), 2);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> first_input_status = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">InputAt</a>(0));</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="keywordflow">switch</span> (first_input_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a>) {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a>:</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">State::kInStringBuilder</a>:</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a5de143ed3332e093d8e2a0517de15f2a">State::kPendingPhi</a>, first_input_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a>);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a5de143ed3332e093d8e2a0517de15f2a">State::kPendingPhi</a>:</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>:</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380af4fa4b4b7a8441c10964d3d0c84b990f">State::kUnvisited</a>:</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;          <a class="code" href="namespacev8_1_1internal.html#acdec713c25068019f935e35976f5b666">UNREACHABLE</a>();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  }</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a> = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(node);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">State::kInStringBuilder</a> ||</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.state == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a5de143ed3332e093d8e2a0517de15f2a">State::kPendingPhi</a>) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// We make sure that this node being in the string builder doesn&#39;t conflict</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">// with other uses of the previous node of the string builder. Note that</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="comment">// loop phis can never have the kInStringBuilder state at this point. We</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="comment">// thus check their uses when we finish the loop and set the phi&#39;s status to</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">// InStringBuilder.</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a4bc4b34398bd65e94024d18f227c0a1e">CheckPreviousNodeUses</a>(node, <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>, 0)) {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="comment">// Updating following PendingPhi if needed.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* <a class="code" href="flag-definitions_8h.html#a2e89dcc15f540da766f7767b13e377e1">use</a> : node-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a9ebd76ae3786acc626d9c4f3cc3f8557">uses</a>()) {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="flag-definitions_8h.html#a2e89dcc15f540da766f7767b13e377e1">use</a>-&gt;opcode() == IrOpcode::kPhi) {</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> use_status = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(<a class="code" href="flag-definitions_8h.html#a2e89dcc15f540da766f7767b13e377e1">use</a>);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keywordflow">if</span> (use_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a> == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a5de143ed3332e093d8e2a0517de15f2a">State::kPendingPhi</a>) {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;          <span class="comment">// Finished the loop.</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(<a class="code" href="flag-definitions_8h.html#a2e89dcc15f540da766f7767b13e377e1">use</a>, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">State::kInStringBuilder</a>, <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;          <span class="keywordflow">if</span> (use_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a> == <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id &amp;&amp;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;              <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a4bc4b34398bd65e94024d18f227c0a1e">CheckPreviousNodeUses</a>(<a class="code" href="flag-definitions_8h.html#a2e89dcc15f540da766f7767b13e377e1">use</a>, <a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>, 1)) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a39003d4e1380f93f1147728c38038195">string_builders_</a>[<a class="code" href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">status</a>.id].has_loop_phi = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <span class="comment">// One of the uses of {node} is a pending Phi that hasn&#39;t the</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <span class="comment">// correct id (is that even possible?), or the uses of {node} are</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <span class="comment">// invalid. Either way, both {node} and {use} are invalid.</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(node, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">SetStatus</a>(<a class="code" href="flag-definitions_8h.html#a2e89dcc15f540da766f7767b13e377e1">use</a>, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;          }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    }</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;}</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">// For each potential string builder, checks that their beginning has status</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">// kBeginStringBuilder, and that they contain at least one phi. Then, all of</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">// their &quot;valid&quot; nodes are switched from status State::InStringBuilder to status</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">// State::kConfirmedInStringBuilder (and &quot;valid&quot; kBeginStringBuilder are left</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">// as kBeginStringBuilder while invalid ones are switched to kInvalid). Nodes</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">// are considered &quot;valid&quot; if they are before any kPendingPhi in the string</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">// builder. Put otherwise, switching status from kInStringBuilder to</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">// kConfirmedInStringBuilder is a cheap way of getting rid of kInStringBuilder</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">// nodes that are invalid before one of their predecessor is a kPendingPhi that</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">// was never switched to kInStringBuilder. An example:</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">//               StringConcat [1]</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">//             kBeginStringBuilder</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">//                    |</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">//                    |</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">//                    v</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">//          -----&gt; Loop Phi [2] ---------------</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">//          |   kInStringBuilder              |</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">//          |         |                       |</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">//          |         |                       |</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">//          |         v                       v</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">//          |    StringConcat [3]        StringConcat [4]</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">//          |    kInStringBuilder        kInStringBuilder</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">//          |         |                       |</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">//          ----------|                       |</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">//                                            v</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">//                                 -----&gt; Loop Phi [5] ------------&gt;</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">//                                 |      kPendingPhi</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">//                                 |          |</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">//                                 |          |</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">//                                 |          v</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">//                                 |     StringConcat [6]</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">//                                 |     kInStringBuilder</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">//                                 |          |</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">//                                 -----------|</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">// In this graph, nodes [1], [2], [3] and [4] are part of the string builder. In</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">// particular, node 2 has at some point been assigned the status kPendingPhi</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">// (because all loop phis start as kPendingPhi), but was later switched to</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">// status kInStringBuilder (because its uses inside the loop were compatible</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">// with the string builder), which implicitly made node [3] a valid part of the</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">// string builder. On the other hand, node [5] was never switched to status</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">// kInStringBuilder, which means that it is not valid, and any successor of [5]</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">// isn&#39;t valid either (remember that we speculatively set nodes following a</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">// kPendingPhi to kInStringBuilder). Thus, rather than having to iterate through</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">// the successors of kPendingPhi nodes to invalidate them, we simply update the</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">// status of valid nodes to kConfirmedInStringBuilder, after which any</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">// kInStringBuilder node is actually invalid.</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">// In this function, we also collect all the possible ends for each string</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">// builder (their can be multiple possible ends if there is a branch before the</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">// end of a string builder), as well as where trimming for a given string</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">// builder should be done (either right after the last node, or at the beginning</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">// of the blocks following this node). For an example of string builder with</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">// multiple ends, consider this code:</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">//     let s = &quot;a&quot; + &quot;b&quot;</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">//     for (...) {</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">//         s += &quot;...&quot;;</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">//     if (...) return s + &quot;abc&quot;;</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">//     else return s + &quot;def&quot;;</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">// Which would produce a graph that looks like:</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">//                     kStringConcat</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">//                            |</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">//                            |</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">//                            v</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">//               -------&gt; Loop Phi---------------</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">//               |            |                 |</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">//               |            |                 |</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">//               |            v                 |</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">//               |      kStringConcat           |</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">//               |            |                 |</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">//               -------------|                 |</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">//                                              |</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">//                                              |</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">//                  ------------------------------------------</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">//                  |                                        |</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">//                  |                                        |</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">//                  |                                        |</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">//                  v                                        v</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">//            kStringConcat [1]                        kStringConcat [2]</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">//                  |                                        |</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">//                  |                                        |</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">//                  v                                        v</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">//               Return                                   Return</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">// In this case, both kStringConcat [1] and [2] are valid ends for the string</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">// builder.</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a0125d8ee2a195da90d7e72977b1ec9c1"> 1016</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a0125d8ee2a195da90d7e72977b1ec9c1">StringBuilderOptimizer::FinalizeStringBuilders</a>() {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html">OneOrTwoByteAnalysis</a> one_or_two_byte_analysis(<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a27f13bdc20a0f6f78f14bd7b5526d5c5">graph</a>(), <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a01d7434ee6bb3a5a868650f1a6164e89">temp_zone</a>(), <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a005472dd868bea3495a4ef94577d1522">broker</a>());</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="comment">// We use {to_visit} to iterate through a string builder, and {ends} to</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="comment">// collect its ending. To save some memory, these 2 variables are declared a</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="comment">// bit early, and we .clear() them at the beginning of each iteration (which</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="comment">// shouldn&#39;t free their memory), rather than allocating new memory for each</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="comment">// string builder.</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <a class="code" href="classv8_1_1internal_1_1ZoneVector.html">ZoneVector&lt;Node*&gt;</a> to_visit(<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a01d7434ee6bb3a5a868650f1a6164e89">temp_zone</a>());</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <a class="code" href="classv8_1_1internal_1_1ZoneVector.html">ZoneVector&lt;Node*&gt;</a> ends(<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a01d7434ee6bb3a5a868650f1a6164e89">temp_zone</a>());</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keywordtype">bool</span> one_string_builder_or_more_valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> string_builder_id = 0;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;       string_builder_id &lt; <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#af912c31e7de4a332a04184af2af6380f">string_builder_count_</a>; string_builder_id++) {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder.html">StringBuilder</a>* string_builder = &amp;<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a39003d4e1380f93f1147728c38038195">string_builders_</a>[string_builder_id];</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* start = string_builder-&gt;<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder.html#a7b9968eee9d203fc125fa372bd82e47e">start</a>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> start_status = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(start);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">if</span> (start_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a> != <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a> ||</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        !string_builder-&gt;<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder.html#a4c61c49d81c9ca974b191d8ac7fbd614">has_loop_phi</a>) {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="comment">// {start} has already been invalidated, or the string builder doesn&#39;t</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="comment">// contain a loop Phi.</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      *string_builder = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a35efd05ad4de91827826311e8cf06758">kInvalidStringBuilder</a>;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a0c39c3079c84e53f1239b6221ff0d5a9">UpdateStatus</a>(start, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">State::kInvalid</a>);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(start_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a>, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a>);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(start_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a>, string_builder_id);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    one_string_builder_or_more_valid = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3">OneOrTwoByteAnalysis::State</a> one_or_two_byte =</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        one_or_two_byte_analysis.<a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a91d8d12ae70310a081961516aa83ab45">OneOrTwoByte</a>(start);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    to_visit.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#ad6915e7dc3166e620124772a3b9adce1">clear</a>();</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    ends.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#ad6915e7dc3166e620124772a3b9adce1">clear</a>();</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    to_visit.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#af4d3701d605c7c9ed301a2ef3880784f">push_back</a>(start);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">while</span> (!to_visit.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#a40b4c6f563e6b4253b77a7351e3c88b2">empty</a>()) {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* curr = to_visit.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#af1e14717af927853f497f9c0e47d4e2d">back</a>();</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      to_visit.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#ad6b06f58d8462c313c06681d4833668f">pop_back</a>();</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> curr_status = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(curr);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="keywordflow">if</span> (curr_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a> == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ac20bd90d7c7da487270b7f0c9161bd09">State::kConfirmedInStringBuilder</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <a class="code" href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">DCHECK</a>(curr_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a> == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">State::kInStringBuilder</a> ||</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;             curr_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a> == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a>);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <a class="code" href="src_2base_2logging_8h.html#a96a75539aa82216cdde2250a11126ea0">DCHECK_IMPLIES</a>(curr_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a> == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a>,</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                     curr == start);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <a class="code" href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a>(curr_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a>, start_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a>);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keywordflow">if</span> (curr_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a> != <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">State::kBeginStringBuilder</a>) {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a0c39c3079c84e53f1239b6221ff0d5a9">UpdateStatus</a>(curr, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ac20bd90d7c7da487270b7f0c9161bd09">State::kConfirmedInStringBuilder</a>);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a28cca41977bd3a107541928d45cf58de">IsConcat</a>(curr)) {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        one_or_two_byte = <a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a97207e88f4f3e5fd39bc7182b8613ccf">OneOrTwoByteAnalysis::ConcatResultIsOneOrTwoByte</a>(</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            one_or_two_byte, one_or_two_byte_analysis.<a class="code" href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a91d8d12ae70310a081961516aa83ab45">OneOrTwoByte</a>(curr));</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="comment">// Duplicating string inputs if needed, and marking them as</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="comment">// InStringBuilder (so that EffectControlLinearizer doesn&#39;t lower them).</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a3cf3a8f3f0ff2c0d9ab3f6e681a867fa">ReplaceConcatInputIfNeeded</a>(curr, 1);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a3cf3a8f3f0ff2c0d9ab3f6e681a867fa">ReplaceConcatInputIfNeeded</a>(curr, 2);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      <span class="comment">// Check if {curr} is one of the string builder&#39;s ends: if {curr} has no</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="comment">// uses that are part of the string builder, then {curr} ends the string</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      <span class="comment">// builder.</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordtype">bool</span> has_use_in_string_builder = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* next : curr-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html#a9ebd76ae3786acc626d9c4f3cc3f8557">uses</a>()) {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a> next_status = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">GetStatus</a>(next);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keywordflow">if</span> ((next_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a> == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">State::kInStringBuilder</a> ||</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;             next_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a> == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ac20bd90d7c7da487270b7f0c9161bd09">State::kConfirmedInStringBuilder</a>) &amp;&amp;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            next_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a> == curr_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">id</a>) {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;          <span class="keywordflow">if</span> (next_status.<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">state</a> == <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">State::kInStringBuilder</a>) {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            <span class="comment">// We only add to {to_visit} when the state is kInStringBuilder to</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            <span class="comment">// make sure that we don&#39;t revisit already-visited nodes.</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            to_visit.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#af4d3701d605c7c9ed301a2ef3880784f">push_back</a>(next);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;          }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a659c5eadc8319cd54f78df984ca97916">IsLoopPhi</a>(curr) || !<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab66e1432c44f25fdef1c0b6fac9b197a">LoopContains</a>(curr, next)) {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            <span class="comment">// The condition above is true when:</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            <span class="comment">//  - {curr} is not a loop phi: in that case, {next} is (one of) the</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <span class="comment">//    nodes in the string builder after {curr}.</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            <span class="comment">//  - {curr} is a loop phi, and {next} is not inside the loop: in</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <span class="comment">//    that case, {node} is (one of) the nodes in the string builder</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <span class="comment">//    that are after {curr}. Note that we ignore uses of {curr}</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            <span class="comment">//    inside the loop, since if {curr} has no uses **after** the</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            <span class="comment">//    loop, then it&#39;s (one of) the end of the string builder.</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            has_use_in_string_builder = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;          }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      <span class="keywordflow">if</span> (!has_use_in_string_builder) {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        ends.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#af4d3701d605c7c9ed301a2ef3880784f">push_back</a>(curr);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    }</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="comment">// Note that there is no need to check that the ends have no conflicting</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="comment">// uses, because none of the ends can be alive at the same time, and thus,</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="comment">// uses of the different ends can&#39;t be alive at the same time either. The</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">// reason that ens can&#39;t be alive at the same time is that if 2 ends were</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="comment">// alive at the same time, then there exist a node n that is a predecessors</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="comment">// of both ends, and that has 2 successors in the string builder (and alive</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">// at the same time), which is not possible because CheckNodeUses prevents</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">// it.</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="comment">// Collecting next blocks where trimming is required (blocks following a</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="comment">// loop Phi where the Phi is the last in a string builder), and setting</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="comment">// kEndStringBuilder state to nodes where trimming should be done right</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="comment">// after computing the node (when the last node in a string builder is not a</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="comment">// loop phi).</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* <a class="code" href="namespacev8_1_1internal_1_1compiler.html#a51dcb90ae077172b12d63271c7e7ba0c">end</a> : ends) {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a659c5eadc8319cd54f78df984ca97916">IsLoopPhi</a>(<a class="code" href="namespacev8_1_1internal_1_1compiler.html#a51dcb90ae077172b12d63271c7e7ba0c">end</a>)) {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* phi_block = <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7bace7152c5fa75a7b342f3b64354cab">schedule</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1Schedule.html#adba2b547f951366974d25caad19e575e">block</a>(<a class="code" href="namespacev8_1_1internal_1_1compiler.html#a51dcb90ae077172b12d63271c7e7ba0c">end</a>);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* block : phi_block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a9081b99e50e2d8e6d55b12a303763ce7">successors</a>()) {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;          <span class="keywordflow">if</span> (phi_block-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a5645be1794e86c2cff02dacdedeb12f0">LoopContains</a>(block)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab0f33012df119a1c62c12ab471a239d4">blocks_to_trimmings_map_</a>[block-&gt;id().ToInt()].has_value()) {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab0f33012df119a1c62c12ab471a239d4">blocks_to_trimmings_map_</a>[block-&gt;id().ToInt()] =</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                <a class="code" href="classv8_1_1internal_1_1ZoneVector.html">ZoneVector&lt;Node*&gt;</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a01d7434ee6bb3a5a868650f1a6164e89">temp_zone</a>());</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;          }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;          <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab0f33012df119a1c62c12ab471a239d4">blocks_to_trimmings_map_</a>[block-&gt;id().ToInt()]-&gt;push_back(<a class="code" href="namespacev8_1_1internal_1_1compiler.html#a51dcb90ae077172b12d63271c7e7ba0c">end</a>);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        }</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a0c39c3079c84e53f1239b6221ff0d5a9">UpdateStatus</a>(<a class="code" href="namespacev8_1_1internal_1_1compiler.html#a51dcb90ae077172b12d63271c7e7ba0c">end</a>, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a663af9d6453261674d573c62f976737d">State::kEndStringBuilderLoopPhi</a>);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a0c39c3079c84e53f1239b6221ff0d5a9">UpdateStatus</a>(<a class="code" href="namespacev8_1_1internal_1_1compiler.html#a51dcb90ae077172b12d63271c7e7ba0c">end</a>, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a7af3652974ec23df14261aa2864c2a78">State::kEndStringBuilder</a>);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    }</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    string_builder-&gt;<a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder.html#a7f3a4a3455946b28a0a0d7274dcf2473">one_or_two_bytes</a> = one_or_two_byte;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  }</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="keywordflow">if</span> (one_string_builder_or_more_valid) {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a005472dd868bea3495a4ef94577d1522">broker</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1compiler_1_1JSHeapBroker.html#a5e0cdc4e2fb09a325e4da3afa2d59a3a">isolate</a>()-&gt;set_has_turbofan_string_builders();</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  }</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <a class="code" href="src_2base_2macros_8h.html#a280b0798f270f4b3f361c9ab64832956">USE</a>(one_string_builder_or_more_valid);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;}</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div>
<div class="line"><a name="l01152"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a472d50a648b015d88b0f5f339edd8bbe"> 1152</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a472d50a648b015d88b0f5f339edd8bbe">StringBuilderOptimizer::VisitGraph</a>() {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="comment">// Initial discovery of the potential string builders.</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">BasicBlock</a>* block : *<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7bace7152c5fa75a7b342f3b64354cab">schedule</a>()-&gt;rpo_order()) {</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">// Removing finished loops.</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">while</span> (!<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7670f2950fa8b9bd40854c2904f16f67">loop_headers_</a>.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#a40b4c6f563e6b4253b77a7351e3c88b2">empty</a>() &amp;&amp;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;           <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7670f2950fa8b9bd40854c2904f16f67">loop_headers_</a>.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#af1e14717af927853f497f9c0e47d4e2d">back</a>()-&gt;loop_end() == block) {</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7670f2950fa8b9bd40854c2904f16f67">loop_headers_</a>.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#ad6b06f58d8462c313c06681d4833668f">pop_back</a>();</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">// Adding new loop if necessary.</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">if</span> (block-&gt;IsLoopHeader()) {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7670f2950fa8b9bd40854c2904f16f67">loop_headers_</a>.<a class="code" href="classv8_1_1internal_1_1ZoneVector.html#af4d3701d605c7c9ed301a2ef3880784f">push_back</a>(block);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="comment">// Visiting block content.</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classv8_1_1internal_1_1compiler_1_1Node.html">Node</a>* node : *block-&gt;nodes()) {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab665a8a005ea4df2e7622565e9cad94c">VisitNode</a>(node, block);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="comment">// Finalize valid string builders (moving valid nodes to status</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <span class="comment">// kConfirmedInStringBuilder or kEndStringBuilder), and collecting the</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="comment">// trimming points.</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a0125d8ee2a195da90d7e72977b1ec9c1">FinalizeStringBuilders</a>();</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;}</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; </div>
<div class="line"><a name="l01176"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a13ea9f1d6757798b8968ee9b7ae01b24"> 1176</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a13ea9f1d6757798b8968ee9b7ae01b24">StringBuilderOptimizer::Run</a>() { <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a472d50a648b015d88b0f5f339edd8bbe">VisitGraph</a>(); }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"><a class="line" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad938bcfd329e739f5a09eb7b88678081"> 1178</a></span>&#160;<a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad938bcfd329e739f5a09eb7b88678081">StringBuilderOptimizer::StringBuilderOptimizer</a>(<a class="code" href="classv8_1_1internal_1_1compiler_1_1JSGraph.html">JSGraph</a>* jsgraph,</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                               <a class="code" href="classv8_1_1internal_1_1compiler_1_1Schedule.html">Schedule</a>* schedule,</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                               <a class="code" href="classv8_1_1internal_1_1Zone.html">Zone</a>* temp_zone,</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                               <a class="code" href="classv8_1_1internal_1_1compiler_1_1JSHeapBroker.html">JSHeapBroker</a>* <a class="code" href="flag-definitions_8h.html#a1e4d6c2aea5c663dda8b8fca8b9199a5">broker</a>)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    : jsgraph_(jsgraph),</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      schedule_(schedule),</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      temp_zone_(temp_zone),</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      broker_(<a class="code" href="flag-definitions_8h.html#a1e4d6c2aea5c663dda8b8fca8b9199a5">broker</a>),</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      blocks_to_trimmings_map_(schedule-&gt;BasicBlockCount(), temp_zone),</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      status_(jsgraph-&gt;<a class="code" href="flag-definitions_8h.html#a06b2b7e5d08192bb493bba69cb19a7a8">graph</a>()-&gt;NodeCount(),</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;              <a class="code" href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">Status</a>{kInvalidId, <a class="code" href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380">State</a>::<a class="code" href="namespacev8_1_1internal_1_1compiler.html#a4307712b5db9d879cc68bef07f992093">kUnvisited</a>}, temp_zone),</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      string_builders_(temp_zone),</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      loop_headers_(temp_zone) {}</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;}  <span class="comment">// namespace compiler</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;}  <span class="comment">// namespace internal</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;}  <span class="comment">// namespace v8</span></div>
<div class="ttc" id="aaccess-builder_8h_html"><div class="ttname"><a href="access-builder_8h.html">access-builder.h</a></div></div>
<div class="ttc" id="abits_8h_html"><div class="ttname"><a href="bits_8h.html">bits.h</a></div></div>
<div class="ttc" id="aclassv8_1_1base_1_1SmallVector_html"><div class="ttname"><a href="classv8_1_1base_1_1SmallVector.html">v8::base::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="small-vector_8h_source.html#l00022">small-vector.h:22</a></div></div>
<div class="ttc" id="aclassv8_1_1base_1_1SmallVector_html_a2f92240eb4f14cfa46552a2b35cc4e70"><div class="ttname"><a href="classv8_1_1base_1_1SmallVector.html#a2f92240eb4f14cfa46552a2b35cc4e70">v8::base::SmallVector::begin</a></div><div class="ttdeci">T * begin()</div><div class="ttdef"><b>Definition:</b> <a href="small-vector_8h_source.html#l00132">small-vector.h:132</a></div></div>
<div class="ttc" id="aclassv8_1_1base_1_1SmallVector_html_a376b32218e50b6efec68f577c009885d"><div class="ttname"><a href="classv8_1_1base_1_1SmallVector.html#a376b32218e50b6efec68f577c009885d">v8::base::SmallVector::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="small-vector_8h_source.html#l00144">small-vector.h:144</a></div></div>
<div class="ttc" id="aclassv8_1_1base_1_1SmallVector_html_a61255d85c4f174e5705b3f725214f121"><div class="ttname"><a href="classv8_1_1base_1_1SmallVector.html#a61255d85c4f174e5705b3f725214f121">v8::base::SmallVector::end</a></div><div class="ttdeci">T * end()</div><div class="ttdef"><b>Definition:</b> <a href="small-vector_8h_source.html#l00135">small-vector.h:135</a></div></div>
<div class="ttc" id="aclassv8_1_1base_1_1SmallVector_html_ad8177749a526ab128a35c4ec8b0cddf7"><div class="ttname"><a href="classv8_1_1base_1_1SmallVector.html#ad8177749a526ab128a35c4ec8b0cddf7">v8::base::SmallVector::push_back</a></div><div class="ttdeci">void push_back(T x)</div><div class="ttdef"><b>Definition:</b> <a href="small-vector_8h_source.html#l00191">small-vector.h:191</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1ZoneVector_html"><div class="ttname"><a href="classv8_1_1internal_1_1ZoneVector.html">v8::internal::ZoneVector&lt; Node * &gt;</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1ZoneVector_html_a40b4c6f563e6b4253b77a7351e3c88b2"><div class="ttname"><a href="classv8_1_1internal_1_1ZoneVector.html#a40b4c6f563e6b4253b77a7351e3c88b2">v8::internal::ZoneVector::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition:</b> <a href="zone-containers_8h_source.html#l00239">zone-containers.h:239</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1ZoneVector_html_ad6915e7dc3166e620124772a3b9adce1"><div class="ttname"><a href="classv8_1_1internal_1_1ZoneVector.html#ad6915e7dc3166e620124772a3b9adce1">v8::internal::ZoneVector::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="zone-containers_8h_source.html#l00233">zone-containers.h:233</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1ZoneVector_html_ad6b06f58d8462c313c06681d4833668f"><div class="ttname"><a href="classv8_1_1internal_1_1ZoneVector.html#ad6b06f58d8462c313c06681d4833668f">v8::internal::ZoneVector::pop_back</a></div><div class="ttdeci">void pop_back()</div><div class="ttdef"><b>Definition:</b> <a href="zone-containers_8h_source.html#l00309">zone-containers.h:309</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1ZoneVector_html_af1e14717af927853f497f9c0e47d4e2d"><div class="ttname"><a href="classv8_1_1internal_1_1ZoneVector.html#af1e14717af927853f497f9c0e47d4e2d">v8::internal::ZoneVector::back</a></div><div class="ttdeci">T &amp; back()</div><div class="ttdef"><b>Definition:</b> <a href="zone-containers_8h_source.html#l00267">zone-containers.h:267</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1ZoneVector_html_af4d3701d605c7c9ed301a2ef3880784f"><div class="ttname"><a href="classv8_1_1internal_1_1ZoneVector.html#af4d3701d605c7c9ed301a2ef3880784f">v8::internal::ZoneVector::push_back</a></div><div class="ttdeci">void push_back(const T &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="zone-containers_8h_source.html#l00303">zone-containers.h:303</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1Zone_html"><div class="ttname"><a href="classv8_1_1internal_1_1Zone.html">v8::internal::Zone</a></div><div class="ttdef"><b>Definition:</b> <a href="zone_8h_source.html#l00043">zone.h:43</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1BasicBlock_1_1Id_html_a8356d2f9171417907e0a85a959704135"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1BasicBlock_1_1Id.html#a8356d2f9171417907e0a85a959704135">v8::internal::compiler::BasicBlock::Id::ToInt</a></div><div class="ttdeci">int ToInt() const</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8h_source.html#l00048">schedule.h:48</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1BasicBlock_html"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html">v8::internal::compiler::BasicBlock</a></div><div class="ttdef"><b>Definition:</b> <a href="schedule_8h_source.html#l00029">schedule.h:30</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1BasicBlock_html_a151491c34ac00cd5a85d3b26f39fb44c"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a151491c34ac00cd5a85d3b26f39fb44c">v8::internal::compiler::BasicBlock::rpo_number</a></div><div class="ttdeci">int32_t rpo_number() const</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8h_source.html#l00156">schedule.h:156</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1BasicBlock_html_a5645be1794e86c2cff02dacdedeb12f0"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a5645be1794e86c2cff02dacdedeb12f0">v8::internal::compiler::BasicBlock::LoopContains</a></div><div class="ttdeci">bool LoopContains(BasicBlock *block) const</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8cc_source.html#l00039">schedule.cc:39</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1BasicBlock_html_a6853118281daccde0c37140e6c75187e"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a6853118281daccde0c37140e6c75187e">v8::internal::compiler::BasicBlock::dominator</a></div><div class="ttdeci">BasicBlock * dominator() const</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8h_source.html#l00138">schedule.h:138</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1BasicBlock_html_a7c5532f9ebd4587b01183d55a9062033"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a7c5532f9ebd4587b01183d55a9062033">v8::internal::compiler::BasicBlock::nodes</a></div><div class="ttdeci">NodeVector * nodes()</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8h_source.html#l00159">schedule.h:159</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1BasicBlock_html_a9081b99e50e2d8e6d55b12a303763ce7"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#a9081b99e50e2d8e6d55b12a303763ce7">v8::internal::compiler::BasicBlock::successors</a></div><div class="ttdeci">BasicBlockVector &amp; successors()</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8h_source.html#l00082">schedule.h:82</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1BasicBlock_html_aa45dc7cdf35066f2b39ecdf335f55229"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#aa45dc7cdf35066f2b39ecdf335f55229">v8::internal::compiler::BasicBlock::id</a></div><div class="ttdeci">Id id() const</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8h_source.html#l00062">schedule.h:62</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1BasicBlock_html_ad7747f3d0300996ac24e2b3bdaf1d364"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#ad7747f3d0300996ac24e2b3bdaf1d364">v8::internal::compiler::BasicBlock::predecessors</a></div><div class="ttdeci">BasicBlockVector &amp; predecessors()</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8h_source.html#l00073">schedule.h:73</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1BasicBlock_html_aebd20273b715c4e966c748800c301804"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#aebd20273b715c4e966c748800c301804">v8::internal::compiler::BasicBlock::IsLoopHeader</a></div><div class="ttdeci">bool IsLoopHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8h_source.html#l00167">schedule.h:167</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1BasicBlock_html_afd9fcb33de7a485da4ccc0ef13755274"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1BasicBlock.html#afd9fcb33de7a485da4ccc0ef13755274">v8::internal::compiler::BasicBlock::dominator_depth</a></div><div class="ttdeci">int32_t dominator_depth() const</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8h_source.html#l00135">schedule.h:135</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1CodeRef_html"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1CodeRef.html">v8::internal::compiler::CodeRef</a></div><div class="ttdef"><b>Definition:</b> <a href="heap-refs_8h_source.html#l01295">heap-refs.h:1295</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1IrOpcode_html_a12e212665e666e61e7d32a0ae9a31e80"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1IrOpcode.html#a12e212665e666e61e7d32a0ae9a31e80">v8::internal::compiler::IrOpcode::Value</a></div><div class="ttdeci">Value</div><div class="ttdef"><b>Definition:</b> <a href="opcodes_8h_source.html#l01348">opcodes.h:1348</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1JSGraph_html"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1JSGraph.html">v8::internal::compiler::JSGraph</a></div><div class="ttdef"><b>Definition:</b> <a href="js-graph_8h_source.html#l00027">js-graph.h:27</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1JSHeapBroker_html"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1JSHeapBroker.html">v8::internal::compiler::JSHeapBroker</a></div><div class="ttdef"><b>Definition:</b> <a href="js-heap-broker_8h_source.html#l00095">js-heap-broker.h:95</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1JSHeapBroker_html_a5e0cdc4e2fb09a325e4da3afa2d59a3a"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1JSHeapBroker.html#a5e0cdc4e2fb09a325e4da3afa2d59a3a">v8::internal::compiler::JSHeapBroker::isolate</a></div><div class="ttdeci">Isolate * isolate() const</div><div class="ttdef"><b>Definition:</b> <a href="js-heap-broker_8h_source.html#l00118">js-heap-broker.h:118</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1NodeProperties_html_a7053cfe3857d7d48ad3d005d633c94cf"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1NodeProperties.html#a7053cfe3857d7d48ad3d005d633c94cf">v8::internal::compiler::NodeProperties::GetValueInput</a></div><div class="ttdeci">static Node * GetValueInput(Node *node, int index)</div><div class="ttdef"><b>Definition:</b> <a href="node-properties_8h_source.html#l00062">node-properties.h:62</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Node_html"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Node.html">v8::internal::compiler::Node</a></div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00041">node.h:41</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Node_html_a01f11c63a02469daba1e55c2bba16f05"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Node.html#a01f11c63a02469daba1e55c2bba16f05">v8::internal::compiler::Node::InputAt</a></div><div class="ttdeci">Node * InputAt(int index) const</div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00070">node.h:70</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Node_html_a3da04276e5cf4a3bceaa3c5aa84a7fb7"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Node.html#a3da04276e5cf4a3bceaa3c5aa84a7fb7">v8::internal::compiler::Node::op</a></div><div class="ttdeci">const Operator * op() const</div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00050">node.h:50</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Node_html_a4503620c5a9219c781579fa834c11d87"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Node.html#a4503620c5a9219c781579fa834c11d87">v8::internal::compiler::Node::opcode</a></div><div class="ttdeci">constexpr IrOpcode::Value opcode() const</div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00052">node.h:52</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Node_html_a5fd30f94dda21206092c9021e826e52a"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Node.html#a5fd30f94dda21206092c9021e826e52a">v8::internal::compiler::Node::inputs</a></div><div class="ttdeci">Inputs inputs() const</div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00478">node.h:478</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Node_html_a9ebd76ae3786acc626d9c4f3cc3f8557"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Node.html#a9ebd76ae3786acc626d9c4f3cc3f8557">v8::internal::compiler::Node::uses</a></div><div class="ttdeci">Uses uses()</div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00144">node.h:144</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Node_html_a9fddec0f808d54a0b5d97fda3a1043ea"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Node.html#a9fddec0f808d54a0b5d97fda3a1043ea">v8::internal::compiler::Node::InputCount</a></div><div class="ttdeci">int InputCount() const</div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00059">node.h:59</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Node_html_ab216b6b31f349566aa2d7dd26ee630b0"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Node.html#ab216b6b31f349566aa2d7dd26ee630b0">v8::internal::compiler::Node::UseCount</a></div><div class="ttdeci">int UseCount() const</div><div class="ttdef"><b>Definition:</b> <a href="node_8cc_source.html#l00286">node.cc:286</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Node_html_ab6aa5c0ce7d3ad1349cebfe168377ebe"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Node.html#ab6aa5c0ce7d3ad1349cebfe168377ebe">v8::internal::compiler::Node::ReplaceInput</a></div><div class="ttdeci">void ReplaceInput(int index, Node *new_to)</div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00076">node.h:76</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Node_html_ad92692ef35b67abdadbe3881fe9050ab"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Node.html#ad92692ef35b67abdadbe3881fe9050ab">v8::internal::compiler::Node::id</a></div><div class="ttdeci">NodeId id() const</div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00057">node.h:57</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis_html"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html">v8::internal::compiler::OneOrTwoByteAnalysis</a></div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00146">string-builder-optimizer.h:146</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis_html_a2e452ee78560b16697c49d89eff9d225"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a2e452ee78560b16697c49d89eff9d225">v8::internal::compiler::OneOrTwoByteAnalysis::states_</a></div><div class="ttdeci">ZoneVector&lt; State &gt; states_</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00210">string-builder-optimizer.h:210</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis_html_a6604e4259eeac2f76d92d867da5acf0c"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a6604e4259eeac2f76d92d867da5acf0c">v8::internal::compiler::OneOrTwoByteAnalysis::broker</a></div><div class="ttdeci">JSHeapBroker * broker()</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00208">string-builder-optimizer.h:208</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis_html_a91d8d12ae70310a081961516aa83ab45"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a91d8d12ae70310a081961516aa83ab45">v8::internal::compiler::OneOrTwoByteAnalysis::OneOrTwoByte</a></div><div class="ttdeci">State OneOrTwoByte(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00228">string-builder-optimizer.cc:228</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis_html_a97207e88f4f3e5fd39bc7182b8613ccf"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#a97207e88f4f3e5fd39bc7182b8613ccf">v8::internal::compiler::OneOrTwoByteAnalysis::ConcatResultIsOneOrTwoByte</a></div><div class="ttdeci">static State ConcatResultIsOneOrTwoByte(State a, State b)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00071">string-builder-optimizer.cc:71</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis_html_ad400dd46424f5c8aa6ba220caf9b943a"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#ad400dd46424f5c8aa6ba220caf9b943a">v8::internal::compiler::OneOrTwoByteAnalysis::TryGetRange</a></div><div class="ttdeci">std::optional&lt; std::pair&lt; int64_t, int64_t &gt; &gt; TryGetRange(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00083">string-builder-optimizer.cc:83</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis_html_adcca1015975b6661c18d2c55a797c6a3"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3">v8::internal::compiler::OneOrTwoByteAnalysis::State</a></div><div class="ttdeci">State</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00158">string-builder-optimizer.h:158</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis_html_adcca1015975b6661c18d2c55a797c6a3a25c2dc47991b3df171ed5192bcf70390"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a25c2dc47991b3df171ed5192bcf70390">v8::internal::compiler::OneOrTwoByteAnalysis::State::kUnknown</a></div><div class="ttdeci">@ kUnknown</div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis_html_adcca1015975b6661c18d2c55a797c6a3a57d2af567823567ab5671b3297f22932"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a57d2af567823567ab5671b3297f22932">v8::internal::compiler::OneOrTwoByteAnalysis::State::kOneByte</a></div><div class="ttdeci">@ kOneByte</div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis_html_adcca1015975b6661c18d2c55a797c6a3a7aae2709672066521147bc71cc3d59f6"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7aae2709672066521147bc71cc3d59f6">v8::internal::compiler::OneOrTwoByteAnalysis::State::kTwoByte</a></div><div class="ttdeci">@ kTwoByte</div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis_html_adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1OneOrTwoByteAnalysis.html#adcca1015975b6661c18d2c55a797c6a3a7d1cede54e8224ae0df25821ecb7c07b">v8::internal::compiler::OneOrTwoByteAnalysis::State::kCantKnow</a></div><div class="ttdeci">@ kCantKnow</div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Operator_html_a2ea0f97044ee07b76f525f48360a75ce"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Operator.html#a2ea0f97044ee07b76f525f48360a75ce">v8::internal::compiler::Operator::ValueInputCount</a></div><div class="ttdeci">int ValueInputCount() const</div><div class="ttdef"><b>Definition:</b> <a href="operator_8h_source.html#l00101">operator.h:101</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Operator_html_a6f9adac9859f8dc4d27961976d7560e8"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Operator.html#a6f9adac9859f8dc4d27961976d7560e8">v8::internal::compiler::Operator::EffectOutputCount</a></div><div class="ttdeci">int EffectOutputCount() const</div><div class="ttdef"><b>Definition:</b> <a href="operator_8h_source.html#l00106">operator.h:106</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Operator_html_ae2fc3b6586e790545e777fde3cec35c7"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Operator.html#ae2fc3b6586e790545e777fde3cec35c7">v8::internal::compiler::Operator::ControlOutputCount</a></div><div class="ttdeci">int ControlOutputCount() const</div><div class="ttdef"><b>Definition:</b> <a href="operator_8h_source.html#l00107">operator.h:107</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Schedule_html"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Schedule.html">v8::internal::compiler::Schedule</a></div><div class="ttdef"><b>Definition:</b> <a href="schedule_8h_source.html#l00210">schedule.h:210</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1Schedule_html_adba2b547f951366974d25caad19e575e"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1Schedule.html#adba2b547f951366974d25caad19e575e">v8::internal::compiler::Schedule::block</a></div><div class="ttdeci">BasicBlock * block(Node *node) const</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8cc_source.html#l00169">schedule.cc:169</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a005472dd868bea3495a4ef94577d1522"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a005472dd868bea3495a4ef94577d1522">v8::internal::compiler::StringBuilderOptimizer::broker</a></div><div class="ttdeci">JSHeapBroker * broker() const</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00265">string-builder-optimizer.h:265</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a0125d8ee2a195da90d7e72977b1ec9c1"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a0125d8ee2a195da90d7e72977b1ec9c1">v8::internal::compiler::StringBuilderOptimizer::FinalizeStringBuilders</a></div><div class="ttdeci">void FinalizeStringBuilders()</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l01016">string-builder-optimizer.cc:1016</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a01d7434ee6bb3a5a868650f1a6164e89"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a01d7434ee6bb3a5a868650f1a6164e89">v8::internal::compiler::StringBuilderOptimizer::temp_zone</a></div><div class="ttdeci">Zone * temp_zone() const</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00264">string-builder-optimizer.h:264</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a0c39c3079c84e53f1239b6221ff0d5a9"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a0c39c3079c84e53f1239b6221ff0d5a9">v8::internal::compiler::StringBuilderOptimizer::UpdateStatus</a></div><div class="ttdeci">void UpdateStatus(Node *node, State state)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00310">string-builder-optimizer.h:310</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a13ea9f1d6757798b8968ee9b7ae01b24"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a13ea9f1d6757798b8968ee9b7ae01b24">v8::internal::compiler::StringBuilderOptimizer::Run</a></div><div class="ttdeci">void Run()</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l01176">string-builder-optimizer.cc:1176</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a1dfe5315cf65deb7536b96f92e05140a"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a1dfe5315cf65deb7536b96f92e05140a">v8::internal::compiler::StringBuilderOptimizer::GetStringBuilderIdForConcat</a></div><div class="ttdeci">int GetStringBuilderIdForConcat(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00375">string-builder-optimizer.cc:375</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a27f13bdc20a0f6f78f14bd7b5526d5c5"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a27f13bdc20a0f6f78f14bd7b5526d5c5">v8::internal::compiler::StringBuilderOptimizer::graph</a></div><div class="ttdeci">TFGraph * graph() const</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00262">string-builder-optimizer.h:262</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a35efd05ad4de91827826311e8cf06758"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a35efd05ad4de91827826311e8cf06758">v8::internal::compiler::StringBuilderOptimizer::kInvalidStringBuilder</a></div><div class="ttdeci">const StringBuilder kInvalidStringBuilder</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00321">string-builder-optimizer.h:321</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a39003d4e1380f93f1147728c38038195"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a39003d4e1380f93f1147728c38038195">v8::internal::compiler::StringBuilderOptimizer::string_builders_</a></div><div class="ttdeci">ZoneVector&lt; StringBuilder &gt; string_builders_</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00368">string-builder-optimizer.h:368</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a3cf3a8f3f0ff2c0d9ab3f6e681a867fa"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a3cf3a8f3f0ff2c0d9ab3f6e681a867fa">v8::internal::compiler::StringBuilderOptimizer::ReplaceConcatInputIfNeeded</a></div><div class="ttdeci">void ReplaceConcatInputIfNeeded(Node *node, int input_idx)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00397">string-builder-optimizer.cc:397</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a42337579c6ed2c14db1bb857085931d6"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a42337579c6ed2c14db1bb857085931d6">v8::internal::compiler::StringBuilderOptimizer::SetStatus</a></div><div class="ttdeci">void SetStatus(Node *node, State state, int id=kInvalidId)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00297">string-builder-optimizer.h:297</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a472d50a648b015d88b0f5f339edd8bbe"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a472d50a648b015d88b0f5f339edd8bbe">v8::internal::compiler::StringBuilderOptimizer::VisitGraph</a></div><div class="ttdeci">void VisitGraph()</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l01152">string-builder-optimizer.cc:1152</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a4bc4b34398bd65e94024d18f227c0a1e"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a4bc4b34398bd65e94024d18f227c0a1e">v8::internal::compiler::StringBuilderOptimizer::CheckPreviousNodeUses</a></div><div class="ttdeci">bool CheckPreviousNodeUses(Node *child, Status status, int input_if_loop_phi=0)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00775">string-builder-optimizer.cc:775</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a659c5eadc8319cd54f78df984ca97916"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a659c5eadc8319cd54f78df984ca97916">v8::internal::compiler::StringBuilderOptimizer::IsLoopPhi</a></div><div class="ttdeci">bool IsLoopPhi(Node *node) const</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00331">string-builder-optimizer.h:331</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a7651fef55e0ee6bc716d3b69dcf37c1b"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7651fef55e0ee6bc716d3b69dcf37c1b">v8::internal::compiler::StringBuilderOptimizer::IsFirstConcatInStringBuilder</a></div><div class="ttdeci">bool IsFirstConcatInStringBuilder(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00385">string-builder-optimizer.cc:385</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a7670f2950fa8b9bd40854c2904f16f67"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7670f2950fa8b9bd40854c2904f16f67">v8::internal::compiler::StringBuilderOptimizer::loop_headers_</a></div><div class="ttdeci">ZoneVector&lt; BasicBlock * &gt; loop_headers_</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00371">string-builder-optimizer.h:371</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a79c7ac8e832d797235bd223f7f6ab76d"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a79c7ac8e832d797235bd223f7f6ab76d">v8::internal::compiler::StringBuilderOptimizer::BlockShouldFinalizeStringBuilders</a></div><div class="ttdeci">bool BlockShouldFinalizeStringBuilders(BasicBlock *block)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00317">string-builder-optimizer.cc:317</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a79ddf0a18c0476c96e329aa7110940a7"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a79ddf0a18c0476c96e329aa7110940a7">v8::internal::compiler::StringBuilderOptimizer::ConcatIsInStringBuilder</a></div><div class="ttdeci">bool ConcatIsInStringBuilder(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00362">string-builder-optimizer.cc:362</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a7a0494d886654ff17b43a6176845a204"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7a0494d886654ff17b43a6176845a204">v8::internal::compiler::StringBuilderOptimizer::CheckNodeUses</a></div><div class="ttdeci">bool CheckNodeUses(Node *node, Node *concat_child, Status status)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00638">string-builder-optimizer.cc:638</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a7bace7152c5fa75a7b342f3b64354cab"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a7bace7152c5fa75a7b342f3b64354cab">v8::internal::compiler::StringBuilderOptimizer::schedule</a></div><div class="ttdeci">Schedule * schedule() const</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00263">string-builder-optimizer.h:263</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a9370028d5cca630c223f43f7f613d4ca"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a9370028d5cca630c223f43f7f613d4ca">v8::internal::compiler::StringBuilderOptimizer::GetStringBuildersToFinalize</a></div><div class="ttdeci">ZoneVector&lt; Node * &gt; GetStringBuildersToFinalize(BasicBlock *block)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00323">string-builder-optimizer.cc:323</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_a9a9731ac16087c0d17e6d44c403aaf21"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#a9a9731ac16087c0d17e6d44c403aaf21">v8::internal::compiler::StringBuilderOptimizer::IsStringBuilderConcatInput</a></div><div class="ttdeci">bool IsStringBuilderConcatInput(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00354">string-builder-optimizer.cc:354</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_aad734b86fa06299e3d73795b1a45bc54"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#aad734b86fa06299e3d73795b1a45bc54">v8::internal::compiler::StringBuilderOptimizer::GetOneOrTwoByte</a></div><div class="ttdeci">OneOrTwoByteAnalysis::State GetOneOrTwoByte(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00329">string-builder-optimizer.cc:329</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ab0f33012df119a1c62c12ab471a239d4"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab0f33012df119a1c62c12ab471a239d4">v8::internal::compiler::StringBuilderOptimizer::blocks_to_trimmings_map_</a></div><div class="ttdeci">ZoneVector&lt; std::optional&lt; ZoneVector&lt; Node * &gt; &gt; &gt; blocks_to_trimmings_map_</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00366">string-builder-optimizer.h:366</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ab665a8a005ea4df2e7622565e9cad94c"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab665a8a005ea4df2e7622565e9cad94c">v8::internal::compiler::StringBuilderOptimizer::VisitNode</a></div><div class="ttdeci">void VisitNode(Node *node, BasicBlock *block)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00793">string-builder-optimizer.cc:793</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ab66e1432c44f25fdef1c0b6fac9b197a"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ab66e1432c44f25fdef1c0b6fac9b197a">v8::internal::compiler::StringBuilderOptimizer::LoopContains</a></div><div class="ttdeci">bool LoopContains(Node *loop_phi, Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00335">string-builder-optimizer.h:335</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_abf84e56931de331409ee197cc23eaa4c"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#abf84e56931de331409ee197cc23eaa4c">v8::internal::compiler::StringBuilderOptimizer::kInvalidId</a></div><div class="ttdeci">static constexpr int kInvalidId</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00288">string-builder-optimizer.h:288</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ad1128c006734c566bd941dbe2fe82380"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380">v8::internal::compiler::StringBuilderOptimizer::State</a></div><div class="ttdeci">State</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00268">string-builder-optimizer.h:268</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ad1128c006734c566bd941dbe2fe82380a5de143ed3332e093d8e2a0517de15f2a"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a5de143ed3332e093d8e2a0517de15f2a">v8::internal::compiler::StringBuilderOptimizer::State::kPendingPhi</a></div><div class="ttdeci">@ kPendingPhi</div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ad1128c006734c566bd941dbe2fe82380a663af9d6453261674d573c62f976737d"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a663af9d6453261674d573c62f976737d">v8::internal::compiler::StringBuilderOptimizer::State::kEndStringBuilderLoopPhi</a></div><div class="ttdeci">@ kEndStringBuilderLoopPhi</div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a6b639206f954cec69123f64a0555cfc8">v8::internal::compiler::StringBuilderOptimizer::State::kInStringBuilder</a></div><div class="ttdeci">@ kInStringBuilder</div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ad1128c006734c566bd941dbe2fe82380a7af3652974ec23df14261aa2864c2a78"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a7af3652974ec23df14261aa2864c2a78">v8::internal::compiler::StringBuilderOptimizer::State::kEndStringBuilder</a></div><div class="ttdeci">@ kEndStringBuilder</div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380a9ad2e8639c6f9d715018f277775a7b6d">v8::internal::compiler::StringBuilderOptimizer::State::kBeginStringBuilder</a></div><div class="ttdeci">@ kBeginStringBuilder</div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ab10913c938482a8aa4ba85b7a1116cb4">v8::internal::compiler::StringBuilderOptimizer::State::kInvalid</a></div><div class="ttdeci">@ kInvalid</div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ad1128c006734c566bd941dbe2fe82380ac20bd90d7c7da487270b7f0c9161bd09"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380ac20bd90d7c7da487270b7f0c9161bd09">v8::internal::compiler::StringBuilderOptimizer::State::kConfirmedInStringBuilder</a></div><div class="ttdeci">@ kConfirmedInStringBuilder</div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ad1128c006734c566bd941dbe2fe82380af4fa4b4b7a8441c10964d3d0c84b990f"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad1128c006734c566bd941dbe2fe82380af4fa4b4b7a8441c10964d3d0c84b990f">v8::internal::compiler::StringBuilderOptimizer::State::kUnvisited</a></div><div class="ttdeci">@ kUnvisited</div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ad2eb4d4b64ac6f7d6dae7abf01933b06"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad2eb4d4b64ac6f7d6dae7abf01933b06">v8::internal::compiler::StringBuilderOptimizer::IsNonLoopPhiStringBuilderEnd</a></div><div class="ttdeci">bool IsNonLoopPhiStringBuilderEnd(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00350">string-builder-optimizer.cc:350</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_ad938bcfd329e739f5a09eb7b88678081"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#ad938bcfd329e739f5a09eb7b88678081">v8::internal::compiler::StringBuilderOptimizer::StringBuilderOptimizer</a></div><div class="ttdeci">StringBuilderOptimizer(JSGraph *jsgraph, Schedule *schedule, Zone *temp_zone, JSHeapBroker *broker)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l01178">string-builder-optimizer.cc:1178</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_af912c31e7de4a332a04184af2af6380f"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#af912c31e7de4a332a04184af2af6380f">v8::internal::compiler::StringBuilderOptimizer::string_builder_count_</a></div><div class="ttdeci">unsigned int string_builder_count_</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00357">string-builder-optimizer.h:357</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_afa8213096c61872f3e7624c0e3050f29"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afa8213096c61872f3e7624c0e3050f29">v8::internal::compiler::StringBuilderOptimizer::IsStringBuilderEnd</a></div><div class="ttdeci">bool IsStringBuilderEnd(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00340">string-builder-optimizer.cc:340</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_afdae4f5bb5c0857441b0b584624e2372"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#afdae4f5bb5c0857441b0b584624e2372">v8::internal::compiler::StringBuilderOptimizer::GetStatus</a></div><div class="ttdeci">Status GetStatus(Node *node) const</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00290">string-builder-optimizer.h:290</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_html_aff19dd8c9326aec36198ff86799c0128"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer.html#aff19dd8c9326aec36198ff86799c0128">v8::internal::compiler::StringBuilderOptimizer::GetPhiPredecessorsCommonId</a></div><div class="ttdeci">int GetPhiPredecessorsCommonId(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00414">string-builder-optimizer.cc:414</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1StringRef_html"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1StringRef.html">v8::internal::compiler::StringRef</a></div><div class="ttdef"><b>Definition:</b> <a href="heap-refs_8h_source.html#l01183">heap-refs.h:1183</a></div></div>
<div class="ttc" id="aclassv8_1_1internal_1_1compiler_1_1TFGraph_html_a74ddea578fcea4c330478ad00b00006b"><div class="ttname"><a href="classv8_1_1internal_1_1compiler_1_1TFGraph.html#a74ddea578fcea4c330478ad00b00006b">v8::internal::compiler::TFGraph::CloneNode</a></div><div class="ttdeci">Node * CloneNode(const Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="turbofan-graph_8cc_source.html#l00058">turbofan-graph.cc:58</a></div></div>
<div class="ttc" id="acode_8h_html"><div class="ttname"><a href="code_8h.html">code.h</a></div></div>
<div class="ttc" id="acompiler_2turbofan-types_8h_html"><div class="ttname"><a href="compiler_2turbofan-types_8h.html">turbofan-types.h</a></div></div>
<div class="ttc" id="aflag-definitions_8h_html_a06b2b7e5d08192bb493bba69cb19a7a8"><div class="ttname"><a href="flag-definitions_8h.html#a06b2b7e5d08192bb493bba69cb19a7a8">graph</a></div><div class="ttdeci">refactor address components for immediate indexing make OptimizeMaglevOnNextCall optimize to turbofan instead of maglev filter for tracing turbofan compilation trace turbo cfg graph(for C1 visualizer) to a given file name&quot;)  DEFINE_SLOW_TRACING_BOOL(trace_turbo_trimming</div></div>
<div class="ttc" id="aflag-definitions_8h_html_a1e4d6c2aea5c663dda8b8fca8b9199a5"><div class="ttname"><a href="flag-definitions_8h.html#a1e4d6c2aea5c663dda8b8fca8b9199a5">broker</a></div><div class="ttdeci">other heap size generate builtins concurrently on separate threads in mksnapshot track concurrent recompilation artificial compilation delay in ms max number of threads that concurrent Turbofan can create additional concurrent optimization jobs but throw away result whether maglev resets the interrupt budget whether maglev resets the OSR interrupt budget create additional concurrent optimization jobs maximum levels for nesting child serializers trace the heap broker(reports on missing data only)&quot;)  DEFINE_INT(deopt_every_n_times</div></div>
<div class="ttc" id="aflag-definitions_8h_html_a2e89dcc15f540da766f7767b13e377e1"><div class="ttname"><a href="flag-definitions_8h.html#a2e89dcc15f540da766f7767b13e377e1">use</a></div><div class="ttdeci">other heap size generate builtins concurrently on separate threads in mksnapshot track concurrent recompilation artificial compilation delay in ms max number of threads that concurrent Turbofan can use(0 for unbounded)&quot;) DEFINE_BOOL( stress_concurrent_inlining</div></div>
<div class="ttc" id="aflag-definitions_8h_html_a3df0b28b666e942ffb9d7d04acdb9715"><div class="ttname"><a href="flag-definitions_8h.html#a3df0b28b666e942ffb9d7d04acdb9715">size</a></div><div class="ttdeci">too high values may cause the compiler to set high thresholds for inlining to as much as possible avoid inlined allocation of objects that cannot escape trace load stores from virtual maglev objects use TurboFan fast string builder analyze liveness of environment slots and zap dead values trace TurboFan load elimination emit data about basic block usage in builtins to this enable builtin reordering when run mksnapshot flag for emit warnings when applying builtin profile data verify register allocation in TurboFan randomly schedule instructions to stress dependency tracking enable store store elimination in TurboFan rewrite far to near simulate GC compiler thread race related to allow float parameters to be passed in simulator mode JS Wasm Run additional turbo_optimize_inlined_js_wasm_wrappers enables Turboshaft s StaticAssert and CheckTurboshaftTypeOf operations Wasm code into JS functions via the JS to Wasm wrappers are still inlined in TurboFan For controlling whether to at see turbo inline js wasm calls enable Turboshaft s loop unrolling enable an additional Turboshaft phase that performs optimizations based on type information enable Turbolev features that we want to ship in the not too far future trace individual Turboshaft reduction steps trace intermediate Turboshaft reduction steps trace Turboshaft s if else to switch reducer invocation count threshold for early optimization Enables optimizations which favor memory size over execution speed Enables sampling allocation profiler with X as a sample interval min size of a semi the new space consists of two semi spaces max size of the preconfigured old space size(in Mbytes)&quot;)     DEFINE_INT(random_gc_interval</div></div>
<div class="ttc" id="aflag-definitions_8h_html_ae0e79c88adf5166f9befeb542c2acd8f"><div class="ttname"><a href="flag-definitions_8h.html#ae0e79c88adf5166f9befeb542c2acd8f">code</a></div><div class="ttdeci">force emit tier up logic from all non turbofan code</div><div class="ttdef"><b>Definition:</b> <a href="flag-definitions_8h_source.html#l00546">flag-definitions.h:546</a></div></div>
<div class="ttc" id="agraph-assembler_8h_html"><div class="ttname"><a href="graph-assembler_8h.html">graph-assembler.h</a></div></div>
<div class="ttc" id="ajs-graph_8h_html"><div class="ttname"><a href="js-graph_8h.html">js-graph.h</a></div></div>
<div class="ttc" id="ajs-heap-broker_8h_html"><div class="ttname"><a href="js-heap-broker_8h.html">js-heap-broker.h</a></div></div>
<div class="ttc" id="ajs-operator_8h_html"><div class="ttname"><a href="js-operator_8h.html">js-operator.h</a></div></div>
<div class="ttc" id="amap-inl_8h_html"><div class="ttname"><a href="map-inl_8h.html">map-inl.h</a></div></div>
<div class="ttc" id="anamespaceunibrow_html_ab0275d47f9778d486eafe88b18c5851d"><div class="ttname"><a href="namespaceunibrow.html#ab0275d47f9778d486eafe88b18c5851d">unibrow::int32_t</a></div><div class="ttdeci">int int32_t</div><div class="ttdef"><b>Definition:</b> <a href="unicode_8cc_source.html#l00042">unicode.cc:42</a></div></div>
<div class="ttc" id="anamespacev8_1_1base_1_1bits_html_ac27d6b4ca0983d91ae080c5822aad3b5"><div class="ttname"><a href="namespacev8_1_1base_1_1bits.html#ac27d6b4ca0983d91ae080c5822aad3b5">v8::base::bits::SignedAddOverflow32</a></div><div class="ttdeci">bool SignedAddOverflow32(int32_t lhs, int32_t rhs, int32_t *val)</div><div class="ttdef"><b>Definition:</b> <a href="bits_8h_source.html#l00306">bits.h:306</a></div></div>
<div class="ttc" id="anamespacev8_1_1base_1_1bits_html_ae084bb91ce53c3748808f66bd49a8a51"><div class="ttname"><a href="namespacev8_1_1base_1_1bits.html#ae084bb91ce53c3748808f66bd49a8a51">v8::base::bits::SignedMulOverflow32</a></div><div class="ttdeci">bool SignedMulOverflow32(int32_t lhs, int32_t rhs, int32_t *val)</div><div class="ttdef"><b>Definition:</b> <a href="bits_8h_source.html#l00333">bits.h:333</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03_html_a0f6616ec658f329b8899c513f70ef30a"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a0f6616ec658f329b8899c513f70ef30a">v8::internal::compiler::anonymous_namespace{string-builder-optimizer.cc}::ValidControlFlowForStringBuilder</a></div><div class="ttdeci">bool ValidControlFlowForStringBuilder(BasicBlock *sb_child_block, BasicBlock *other_child_block, BasicBlock *previous_block, ZoneVector&lt; BasicBlock * &gt; loop_headers)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00533">string-builder-optimizer.cc:533</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03_html_a1b2deb5afd0e7ee81bbd36c4c7aa0328"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a1b2deb5afd0e7ee81bbd36c4c7aa0328">v8::internal::compiler::anonymous_namespace{string-builder-optimizer.cc}::ComputePredecessors</a></div><div class="ttdeci">bool ComputePredecessors(BasicBlock *start, BasicBlock *end, base::SmallVector&lt; BasicBlock *, kMaxPredecessors &gt; *dst)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00463">string-builder-optimizer.cc:463</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03_html_a254b932e6ccf797dc1d3c9917336600d"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a254b932e6ccf797dc1d3c9917336600d">v8::internal::compiler::anonymous_namespace{string-builder-optimizer.cc}::OpcodeIsAllowed</a></div><div class="ttdeci">bool OpcodeIsAllowed(IrOpcode::Value op)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00484">string-builder-optimizer.cc:484</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03_html_a28cca41977bd3a107541928d45cf58de"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a28cca41977bd3a107541928d45cf58de">v8::internal::compiler::anonymous_namespace{string-builder-optimizer.cc}::IsConcat</a></div><div class="ttdeci">bool IsConcat(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00036">string-builder-optimizer.cc:36</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03_html_a35812856566625589473e49f76e3b843"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a35812856566625589473e49f76e3b843">v8::internal::compiler::anonymous_namespace{string-builder-optimizer.cc}::kMaxPredecessors</a></div><div class="ttdeci">static constexpr int kMaxPredecessors</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00458">string-builder-optimizer.cc:458</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03_html_a65e21c951599d9d613063d6b5101729d"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a65e21c951599d9d613063d6b5101729d">v8::internal::compiler::anonymous_namespace{string-builder-optimizer.cc}::PhiInputsAreConcatsOrPhi</a></div><div class="ttdeci">bool PhiInputsAreConcatsOrPhi(Node *phi)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00613">string-builder-optimizer.cc:613</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03_html_a6c83f2f5945121347b6d5081b073784e"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a6c83f2f5945121347b6d5081b073784e">v8::internal::compiler::anonymous_namespace{string-builder-optimizer.cc}::HasConcatOrPhiUse</a></div><div class="ttdeci">bool HasConcatOrPhiUse(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00060">string-builder-optimizer.cc:60</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03_html_a898c935b8b8006e40d2953cf1f7820b5"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#a898c935b8b8006e40d2953cf1f7820b5">v8::internal::compiler::anonymous_namespace{string-builder-optimizer.cc}::IsClosebyDominator</a></div><div class="ttdeci">bool IsClosebyDominator(BasicBlock *maybe_dominator, BasicBlock *maybe_dominee)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00573">string-builder-optimizer.cc:573</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03_html_ac933348317640264b24e39e0aa65674d"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#ac933348317640264b24e39e0aa65674d">v8::internal::compiler::anonymous_namespace{string-builder-optimizer.cc}::IsPhiContainingGivenInputs</a></div><div class="ttdeci">bool IsPhiContainingGivenInputs(Node *node, Node *input1, Node *input2, Schedule *schedule)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00592">string-builder-optimizer.cc:592</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03_html_acad9c3baa7b040c6b7137be7e1dc556d"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#acad9c3baa7b040c6b7137be7e1dc556d">v8::internal::compiler::anonymous_namespace{string-builder-optimizer.cc}::ComesBeforeInBlock</a></div><div class="ttdeci">bool ComesBeforeInBlock(Node *first, Node *second, BasicBlock *block)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00446">string-builder-optimizer.cc:446</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03_html_ae6ef7bb53ae6b483ee9b5fca46a40eed"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1anonymous__namespace_02string-builder-optimizer_8cc_03.html#ae6ef7bb53ae6b483ee9b5fca46a40eed">v8::internal::compiler::anonymous_namespace{string-builder-optimizer.cc}::IsLiteralString</a></div><div class="ttdeci">bool IsLiteralString(Node *node, JSHeapBroker *broker)</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8cc_source.html#l00045">string-builder-optimizer.cc:45</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask_html_a0ada1f75f62be73dabab73507ca7bc14"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask.html#a0ada1f75f62be73dabab73507ca7bc14">v8::internal::compiler::turboshaft::Opmask::kHeapConstant</a></div><div class="ttdeci">ConstantMask::For&lt; ConstantOp::Kind::kHeapObject &gt; kHeapConstant</div><div class="ttdef"><b>Definition:</b> <a href="opmasks_8h_source.html#l00246">opmasks.h:246</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask_html_a88caf89879cb4c2e74a6847dcc0d2cf0"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask.html#a88caf89879cb4c2e74a6847dcc0d2cf0">v8::internal::compiler::turboshaft::Opmask::kFloat64Sub</a></div><div class="ttdeci">FloatBinopMask::For&lt; FloatBinopOp::Kind::kSub, FloatRepresentation::Float64()&gt; kFloat64Sub</div><div class="ttdef"><b>Definition:</b> <a href="opmasks_8h_source.html#l00205">opmasks.h:206</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask_html_a9fc841766cd28604a5aa910b1e05e3c4"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask.html#a9fc841766cd28604a5aa910b1e05e3c4">v8::internal::compiler::turboshaft::Opmask::kFloat32Sub</a></div><div class="ttdeci">FloatBinopMask::For&lt; FloatBinopOp::Kind::kSub, FloatRepresentation::Float32()&gt; kFloat32Sub</div><div class="ttdef"><b>Definition:</b> <a href="opmasks_8h_source.html#l00201">opmasks.h:202</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask_html_ab7d19f55ab5ae0815e96b07377977f33"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask.html#ab7d19f55ab5ae0815e96b07377977f33">v8::internal::compiler::turboshaft::Opmask::kFloat64Mul</a></div><div class="ttdeci">FloatBinopMask::For&lt; FloatBinopOp::Kind::kMul, FloatRepresentation::Float64()&gt; kFloat64Mul</div><div class="ttdef"><b>Definition:</b> <a href="opmasks_8h_source.html#l00207">opmasks.h:208</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask_html_affd391dfee47b71c7d8dfacbe50913b6"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler_1_1turboshaft_1_1Opmask.html#affd391dfee47b71c7d8dfacbe50913b6">v8::internal::compiler::turboshaft::Opmask::kFloat32Mul</a></div><div class="ttdeci">FloatBinopMask::For&lt; FloatBinopOp::Kind::kMul, FloatRepresentation::Float32()&gt; kFloat32Mul</div><div class="ttdef"><b>Definition:</b> <a href="opmasks_8h_source.html#l00203">opmasks.h:204</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_html_a3c392be439ddfcced9509a98e8aa385d"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler.html#a3c392be439ddfcced9509a98e8aa385d">v8::internal::compiler::NumberConstant</a></div><div class="ttdeci">NumberConstant(std::numeric_limits&lt; double &gt;::quiet_NaN())) DEFINE_GETTER(EmptyStateValues</div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_html_a4307712b5db9d879cc68bef07f992093"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler.html#a4307712b5db9d879cc68bef07f992093">v8::internal::compiler::kUnvisited</a></div><div class="ttdeci">const int kUnvisited</div><div class="ttdef"><b>Definition:</b> <a href="turbofan-graph-visualizer_8cc_source.html#l00917">turbofan-graph-visualizer.cc:917</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_1_1compiler_html_a51dcb90ae077172b12d63271c7e7ba0c"><div class="ttname"><a href="namespacev8_1_1internal_1_1compiler.html#a51dcb90ae077172b12d63271c7e7ba0c">v8::internal::compiler::end</a></div><div class="ttdeci">Node::Uses::const_iterator end(const Node::Uses &amp;uses)</div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00711">node.h:711</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html"><div class="ttname"><a href="namespacev8_1_1internal.html">v8::internal</a></div><div class="ttdef"><b>Definition:</b> <a href="api-arguments-inl_8h_source.html#l00020">api-arguments-inl.h:20</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_a5031451934208565c827c86d9eb86c5a"><div class="ttname"><a href="namespacev8_1_1internal.html#a5031451934208565c827c86d9eb86c5a">v8::internal::internal</a></div><div class="ttdeci">internal</div><div class="ttdef"><b>Definition:</b> <a href="wasm-objects-inl_8h_source.html#l00453">wasm-objects-inl.h:453</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_aa6b3743bd5d773c552654f2a6c3efa4a"><div class="ttname"><a href="namespacev8_1_1internal.html#aa6b3743bd5d773c552654f2a6c3efa4a">v8::internal::DCHECK</a></div><div class="ttdeci">DCHECK(IsNull(value)||IsNativeContext(value)||value==Smi::uninitialized_deserialization_value())</div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_acc2e164143496f18b5ec68f8ab70af52"><div class="ttname"><a href="namespacev8_1_1internal.html#acc2e164143496f18b5ec68f8ab70af52">v8::internal::Builtin</a></div><div class="ttdeci">Builtin</div><div class="ttdef"><b>Definition:</b> <a href="builtins_8h_source.html#l00050">builtins.h:50</a></div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_acdec713c25068019f935e35976f5b666"><div class="ttname"><a href="namespacev8_1_1internal.html#acdec713c25068019f935e35976f5b666">v8::internal::UNREACHABLE</a></div><div class="ttdeci">UNREACHABLE()</div></div>
<div class="ttc" id="anamespacev8_1_1internal_html_af04f4104c077ccbaef7596e23816a254"><div class="ttname"><a href="namespacev8_1_1internal.html#af04f4104c077ccbaef7596e23816a254">v8::internal::status</a></div><div class="ttdeci">status</div><div class="ttdef"><b>Definition:</b> <a href="js-disposable-stack-inl_8h_source.html#l00034">js-disposable-stack-inl.h:34</a></div></div>
<div class="ttc" id="anamespacev8_html"><div class="ttname"><a href="namespacev8.html">v8</a></div><div class="ttdoc">This file provides additional API on top of the default one for making API calls, which come from emb...</div><div class="ttdef"><b>Definition:</b> <a href="api-arguments-inl_8h_source.html#l00019">api-arguments-inl.h:19</a></div></div>
<div class="ttc" id="anode-matchers_8h_html"><div class="ttname"><a href="node-matchers_8h.html">node-matchers.h</a></div></div>
<div class="ttc" id="anode-properties_8h_html"><div class="ttname"><a href="node-properties_8h.html">node-properties.h</a></div></div>
<div class="ttc" id="anode_8h_html"><div class="ttname"><a href="node_8h.html">node.h</a></div></div>
<div class="ttc" id="aopcodes_8h_html"><div class="ttname"><a href="opcodes_8h.html">opcodes.h</a></div></div>
<div class="ttc" id="aoperator_8h_html"><div class="ttname"><a href="operator_8h.html">operator.h</a></div></div>
<div class="ttc" id="aschedule_8h_html"><div class="ttname"><a href="schedule_8h.html">schedule.h</a></div></div>
<div class="ttc" id="asmall-vector_8h_html"><div class="ttname"><a href="small-vector_8h.html">small-vector.h</a></div></div>
<div class="ttc" id="asrc_2base_2logging_8h_html"><div class="ttname"><a href="src_2base_2logging_8h.html">logging.h</a></div></div>
<div class="ttc" id="asrc_2base_2logging_8h_html_a96a75539aa82216cdde2250a11126ea0"><div class="ttname"><a href="src_2base_2logging_8h.html#a96a75539aa82216cdde2250a11126ea0">DCHECK_IMPLIES</a></div><div class="ttdeci">#define DCHECK_IMPLIES(v1, v2)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2logging_8h_source.html#l00492">logging.h:492</a></div></div>
<div class="ttc" id="asrc_2base_2logging_8h_html_a986dc8f4ec6dcd0644efe205c13f8eb7"><div class="ttname"><a href="src_2base_2logging_8h.html#a986dc8f4ec6dcd0644efe205c13f8eb7">DCHECK_NE</a></div><div class="ttdeci">#define DCHECK_NE(v1, v2)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2logging_8h_source.html#l00485">logging.h:485</a></div></div>
<div class="ttc" id="asrc_2base_2logging_8h_html_af1a711c8d5520dff78858ddefd2ad668"><div class="ttname"><a href="src_2base_2logging_8h.html#af1a711c8d5520dff78858ddefd2ad668">DCHECK_LT</a></div><div class="ttdeci">#define DCHECK_LT(v1, v2)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2logging_8h_source.html#l00488">logging.h:488</a></div></div>
<div class="ttc" id="asrc_2base_2logging_8h_html_af9c313d74155f7f201955a939e24c71f"><div class="ttname"><a href="src_2base_2logging_8h.html#af9c313d74155f7f201955a939e24c71f">DCHECK_EQ</a></div><div class="ttdeci">#define DCHECK_EQ(v1, v2)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2logging_8h_source.html#l00484">logging.h:484</a></div></div>
<div class="ttc" id="asrc_2base_2macros_8h_html_a280b0798f270f4b3f361c9ab64832956"><div class="ttname"><a href="src_2base_2macros_8h.html#a280b0798f270f4b3f361c9ab64832956">USE</a></div><div class="ttdeci">#define USE(...)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2macros_8h_source.html#l00293">macros.h:293</a></div></div>
<div class="ttc" id="astring-builder-optimizer_8cc_html_ab0daa3141dc1b3c77114b8246f9cf9a5"><div class="ttname"><a href="string-builder-optimizer_8cc.html#ab0daa3141dc1b3c77114b8246f9cf9a5">CONST_CASE</a></div><div class="ttdeci">#define CONST_CASE(op, matcher)</div></div>
<div class="ttc" id="astring-builder-optimizer_8h_html"><div class="ttname"><a href="string-builder-optimizer_8h.html">string-builder-optimizer.h</a></div></div>
<div class="ttc" id="astructv8_1_1internal_1_1compiler_1_1FloatMatcher_html"><div class="ttname"><a href="structv8_1_1internal_1_1compiler_1_1FloatMatcher.html">v8::internal::compiler::FloatMatcher</a></div><div class="ttdef"><b>Definition:</b> <a href="node-matchers_8h_source.html#l00183">node-matchers.h:183</a></div></div>
<div class="ttc" id="astructv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl_html"><div class="ttname"><a href="structv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl.html">v8::internal::compiler::HeapObjectMatcherImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="node-matchers_8h_source.html#l00227">node-matchers.h:228</a></div></div>
<div class="ttc" id="astructv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl_html_a81577df449591950f722a82e54537a8a"><div class="ttname"><a href="structv8_1_1internal_1_1compiler_1_1HeapObjectMatcherImpl.html#a81577df449591950f722a82e54537a8a">v8::internal::compiler::HeapObjectMatcherImpl::Ref</a></div><div class="ttdeci">HeapObjectRef Ref(JSHeapBroker *broker) const</div><div class="ttdef"><b>Definition:</b> <a href="node-matchers_8h_source.html#l00237">node-matchers.h:237</a></div></div>
<div class="ttc" id="astructv8_1_1internal_1_1compiler_1_1IntMatcher_html"><div class="ttname"><a href="structv8_1_1internal_1_1compiler_1_1IntMatcher.html">v8::internal::compiler::IntMatcher</a></div><div class="ttdef"><b>Definition:</b> <a href="node-matchers_8h_source.html#l00137">node-matchers.h:137</a></div></div>
<div class="ttc" id="astructv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status_html"><div class="ttname"><a href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html">v8::internal::compiler::StringBuilderOptimizer::Status</a></div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00283">string-builder-optimizer.h:283</a></div></div>
<div class="ttc" id="astructv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status_html_a9c0f2efbeebaa105fc289d7cfb7d2210"><div class="ttname"><a href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#a9c0f2efbeebaa105fc289d7cfb7d2210">v8::internal::compiler::StringBuilderOptimizer::Status::state</a></div><div class="ttdeci">State state</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00286">string-builder-optimizer.h:286</a></div></div>
<div class="ttc" id="astructv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status_html_ad0398d70f7057c73e6c4bf32620ca3c2"><div class="ttname"><a href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1Status.html#ad0398d70f7057c73e6c4bf32620ca3c2">v8::internal::compiler::StringBuilderOptimizer::Status::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00284">string-builder-optimizer.h:284</a></div></div>
<div class="ttc" id="astructv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder_html"><div class="ttname"><a href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder.html">v8::internal::compiler::StringBuilderOptimizer::StringBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00315">string-builder-optimizer.h:315</a></div></div>
<div class="ttc" id="astructv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder_html_a4c61c49d81c9ca974b191d8ac7fbd614"><div class="ttname"><a href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder.html#a4c61c49d81c9ca974b191d8ac7fbd614">v8::internal::compiler::StringBuilderOptimizer::StringBuilder::has_loop_phi</a></div><div class="ttdeci">bool has_loop_phi</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00318">string-builder-optimizer.h:318</a></div></div>
<div class="ttc" id="astructv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder_html_a7b9968eee9d203fc125fa372bd82e47e"><div class="ttname"><a href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder.html#a7b9968eee9d203fc125fa372bd82e47e">v8::internal::compiler::StringBuilderOptimizer::StringBuilder::start</a></div><div class="ttdeci">Node * start</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00316">string-builder-optimizer.h:316</a></div></div>
<div class="ttc" id="astructv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder_html_a7f3a4a3455946b28a0a0d7274dcf2473"><div class="ttname"><a href="structv8_1_1internal_1_1compiler_1_1StringBuilderOptimizer_1_1StringBuilder.html#a7f3a4a3455946b28a0a0d7274dcf2473">v8::internal::compiler::StringBuilderOptimizer::StringBuilder::one_or_two_bytes</a></div><div class="ttdeci">OneOrTwoByteAnalysis::State one_or_two_bytes</div><div class="ttdef"><b>Definition:</b> <a href="string-builder-optimizer_8h_source.html#l00319">string-builder-optimizer.h:319</a></div></div>
<div class="ttc" id="astructv8_1_1internal_1_1compiler_1_1ValueMatcher_html_a6665883b23b5b528f20e3cb52dfe5c5c"><div class="ttname"><a href="structv8_1_1internal_1_1compiler_1_1ValueMatcher.html#a6665883b23b5b528f20e3cb52dfe5c5c">v8::internal::compiler::ValueMatcher::HasResolvedValue</a></div><div class="ttdeci">bool HasResolvedValue() const</div><div class="ttdef"><b>Definition:</b> <a href="node-matchers_8h_source.html#l00086">node-matchers.h:86</a></div></div>
<div class="ttc" id="autils_2utils_8h_html"><div class="ttname"><a href="utils_2utils_8h.html">utils.h</a></div></div>
<div class="ttc" id="azone-containers_8h_html"><div class="ttname"><a href="zone-containers_8h.html">zone-containers.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_19225156eb7ba052e31d1a736469917a.html">mnt</a></li><li class="navelem"><a class="el" href="dir_3536f6d353061322e9ef91134b76e9ed.html">V8SourceCode</a></li><li class="navelem"><a class="el" href="dir_fbd53c45610d490c9fb8d0716db4e3a3.html">src</a></li><li class="navelem"><a class="el" href="dir_8397ff03797cda36c402b225885f9fa1.html">compiler</a></li><li class="navelem"><a class="el" href="string-builder-optimizer_8cc.html">string-builder-optimizer.cc</a></li>
    <li class="footer">Generated on Thu Jun 12 2025 15:55:41 for V8 Project by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
