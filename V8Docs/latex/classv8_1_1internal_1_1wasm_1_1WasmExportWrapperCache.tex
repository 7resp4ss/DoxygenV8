\hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache}{}\doxysection{v8\+::internal\+::wasm\+::Wasm\+Export\+Wrapper\+Cache Class Reference}
\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache}\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}


{\ttfamily \#include $<$wasm-\/export-\/wrapper-\/cache.\+h$>$}



Inheritance diagram for v8\+::internal\+::wasm\+::Wasm\+Export\+Wrapper\+Cache\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=240pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for v8\+::internal\+::wasm\+::Wasm\+Export\+Wrapper\+Cache\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac81d27d6edb00aeed62a3e4745b8cba0}{void}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a4f8beda6fb9cd7ac523dbbbcda3f9706}{Put}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1CanonicalTypeIndex}{Canonical\+Type\+Index}} sig\+\_\+index, \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} receiver\+\_\+is\+\_\+first\+\_\+param, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Code}{Code}} $>$ \mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}})
\item 
static \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1CodeWrapper}{Code\+Wrapper}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aa67c99c7e5e517261faf25a6a4c4a053}{Get}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1CanonicalTypeIndex}{Canonical\+Type\+Index}} sig\+\_\+index, \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} receiver\+\_\+is\+\_\+first\+\_\+param)
\item 
static \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a034da8dc95d095a339873690847d5364}{Count\+Wrappers\+For\+Testing}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate)
\end{DoxyCompactItemize}
\doxysubsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakFixedArray}{Weak\+Fixed\+Array}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aebc34a8ee5a1a1da95c274fd00d06cde}{New}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classint}{int}} capacity)
\item 
static uint32\+\_\+t \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aa8ad16033b5126c8e284d83fb35d8aa6}{Capacity}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakFixedArray}{Weak\+Fixed\+Array}} $>$ cache)
\item 
static uint32\+\_\+t \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac33957a1264934827f54836b9f2a16eb}{Hash}} (\mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1CanonicalTypeIndex}{Canonical\+Type\+Index}} sig\+\_\+index, \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} receiver\+\_\+is\+\_\+first\+\_\+param)
\item 
static \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a4d019594c196b0cad3173c4898d1c23b}{To\+Array\+Slot}} (\mbox{\hyperlink{classv8_1_1internal_1_1InternalIndex}{Internal\+Index}} entry)
\item 
static \mbox{\hyperlink{classv8_1_1internal_1_1InternalIndex}{Internal\+Index}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a149899eaa15a1cb1dc495b01888b0dce}{First\+Probe}} (uint32\+\_\+t hash, uint32\+\_\+t capacity)
\item 
static \mbox{\hyperlink{classv8_1_1internal_1_1InternalIndex}{Internal\+Index}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a78b37d35545c4dbd03627efdb9b352d2}{Next\+Probe}} (\mbox{\hyperlink{classv8_1_1internal_1_1InternalIndex}{Internal\+Index}} last, uint32\+\_\+t number, uint32\+\_\+t capacity)
\item 
static \mbox{\hyperlink{v8config_8h_a63258e4bf5dc9fb8c78f881c8405d83b}{V8\+\_\+\+WARN\+\_\+\+UNUSED\+\_\+\+RESULT}} \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakFixedArray}{Weak\+Fixed\+Array}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a1d2ad89f53842d447412e5086dd80143}{Ensure\+Capacity}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate)
\item 
{\footnotesize template$<$bool entry\+\_\+may\+\_\+exist$>$ }\\static \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac81d27d6edb00aeed62a3e4745b8cba0}{void}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a43dc3667a9dc531bd3261c00df78037e}{Put\+Internal}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakFixedArray}{Weak\+Fixed\+Array}} $>$ cache, uint32\+\_\+t hash, \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1MaybeWeak}{Maybe\+Weak}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$$>$ \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}})
\end{DoxyCompactItemize}
\doxysubsection*{Static Private Attributes}
\begin{DoxyCompactItemize}
\item 
static constexpr \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac5ba1c089975eb7e9f480507d0bba20d}{k\+Unused}} = -\/1
\item 
static constexpr \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a0023bbee91f2df1d200ae6a7666fa5d8}{k\+Num\+Used\+Elements\+Index}} = 0
\item 
static constexpr \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a181e36abff90c1255e51e5e2c2aa0fe4}{k\+Reserved\+Slots}} = 1
\item 
static constexpr \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_abb1b148a38cab141da5d208b3bcd5fe4}{k\+Slots\+Per\+Entry}} = 2
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 28 of file wasm-\/export-\/wrapper-\/cache.\+h.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aa8ad16033b5126c8e284d83fb35d8aa6}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aa8ad16033b5126c8e284d83fb35d8aa6}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!Capacity@{Capacity}}
\index{Capacity@{Capacity}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{Capacity()}{Capacity()}}
{\footnotesize\ttfamily uint32\+\_\+t v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::\+Capacity (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakFixedArray}{Weak\+Fixed\+Array}} $>$}]{cache }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 61 of file wasm-\/export-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{61                                                                       \{}
\DoxyCodeLine{62   \textcolor{comment}{// If we ever add more reserved slots, we'll have to subtract them properly}}
\DoxyCodeLine{63   \textcolor{comment}{// rather than just shifting them out implicitly.}}
\DoxyCodeLine{64   static\_assert((\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a181e36abff90c1255e51e5e2c2aa0fe4}{kReservedSlots}} >> 1) == 0);}
\DoxyCodeLine{65   \textcolor{keywordflow}{return} cache-\/>length() >> 1;}
\DoxyCodeLine{66 \}}

\end{DoxyCode}


References k\+Reserved\+Slots.



Referenced by Ensure\+Capacity(), Get(), and Put\+Internal().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aa8ad16033b5126c8e284d83fb35d8aa6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a034da8dc95d095a339873690847d5364}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a034da8dc95d095a339873690847d5364}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!CountWrappersForTesting@{CountWrappersForTesting}}
\index{CountWrappersForTesting@{CountWrappersForTesting}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{CountWrappersForTesting()}{CountWrappersForTesting()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{classint}{int}} v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::\+Count\+Wrappers\+For\+Testing (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a1d2ad89f53842d447412e5086dd80143}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a1d2ad89f53842d447412e5086dd80143}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!EnsureCapacity@{EnsureCapacity}}
\index{EnsureCapacity@{EnsureCapacity}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{EnsureCapacity()}{EnsureCapacity()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakFixedArray}{Weak\+Fixed\+Array}} $>$ v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::\+Ensure\+Capacity (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 69 of file wasm-\/export-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{70                       \{}
\DoxyCodeLine{71   Tagged<WeakFixedArray> cache = isolate-\/>heap()-\/>js\_to\_wasm\_wrappers();}
\DoxyCodeLine{72   \textcolor{keywordflow}{if} (cache-\/>length() == 0) \{}
\DoxyCodeLine{73     \textcolor{comment}{// Lazy initialization.}}
\DoxyCodeLine{74     \textcolor{keyword}{static} constexpr \textcolor{keywordtype}{int} kInitialCapacity = 16;}
\DoxyCodeLine{75     DirectHandle<WeakFixedArray> new\_cache = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aebc34a8ee5a1a1da95c274fd00d06cde}{New}}(isolate, kInitialCapacity);}
\DoxyCodeLine{76     isolate-\/>heap()-\/>SetJSToWasmWrappers(*new\_cache);}
\DoxyCodeLine{77     \textcolor{keywordflow}{return} *new\_cache;}
\DoxyCodeLine{78   \}}
\DoxyCodeLine{79   uint32\_t capacity = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aa8ad16033b5126c8e284d83fb35d8aa6}{Capacity}}(cache);}
\DoxyCodeLine{80   uint32\_t used = cache-\/>get(\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a0023bbee91f2df1d200ae6a7666fa5d8}{kNumUsedElementsIndex}}).ToSmi().value();}
\DoxyCodeLine{81   \textcolor{comment}{// We allow a maximum usage of 50\% plus one entry, otherwise grow.}}
\DoxyCodeLine{82   \textcolor{comment}{// It can happen that we find many cleared entries during growing, so the}}
\DoxyCodeLine{83   \textcolor{comment}{// returned grown cache may be nearly empty. That's unlikely to happen}}
\DoxyCodeLine{84   \textcolor{comment}{// often, and if it happens a few times that's not a problem.}}
\DoxyCodeLine{85   \textcolor{keywordflow}{if} (used < capacity / 2) \textcolor{keywordflow}{return} cache;}
\DoxyCodeLine{86   DirectHandle<WeakFixedArray> old\_cache(cache, isolate);}
\DoxyCodeLine{87   Tagged<WeakFixedArray> grown = *\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aebc34a8ee5a1a1da95c274fd00d06cde}{New}}(isolate, capacity * 2);}
\DoxyCodeLine{88   \mbox{\hyperlink{namespacev8_1_1internal_af2248a427f8ff8f81e68a2a87758e145}{DisallowGarbageCollection}} \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02json-stringifier_8cc_03_a63d8eefb47468aa3f816fbe26a59466a}{no\_gc}};}
\DoxyCodeLine{89   cache = *old\_cache;}
\DoxyCodeLine{90   \textcolor{keywordtype}{int} num\_used\_entries = 0;}
\DoxyCodeLine{91   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{namespacev8_1_1internal}{i}} = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a181e36abff90c1255e51e5e2c2aa0fe4}{kReservedSlots}}; \mbox{\hyperlink{namespacev8_1_1internal}{i}} < cache-\/>length(); \mbox{\hyperlink{namespacev8_1_1internal}{i}} += \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_abb1b148a38cab141da5d208b3bcd5fe4}{kSlotsPerEntry}}) \{}
\DoxyCodeLine{92     Tagged<MaybeWeak<Object>> raw\_key = cache-\/>get(\mbox{\hyperlink{namespacev8_1_1internal}{i}});}
\DoxyCodeLine{93     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(raw\_key.IsSmi());}
\DoxyCodeLine{94     \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}} = raw\_key.ToSmi().value();}
\DoxyCodeLine{95     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}} == \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac5ba1c089975eb7e9f480507d0bba20d}{kUnused}}) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{96     Tagged<MaybeWeak<Object>> \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}} = cache-\/>get(\mbox{\hyperlink{namespacev8_1_1internal}{i}} + 1);}
\DoxyCodeLine{97     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}.IsCleared()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{98     num\_used\_entries++;}
\DoxyCodeLine{99     PutInternal<false>(grown, \mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}}, \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}});}
\DoxyCodeLine{100   \}}
\DoxyCodeLine{101   grown-\/>set(\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a0023bbee91f2df1d200ae6a7666fa5d8}{kNumUsedElementsIndex}}, \mbox{\hyperlink{classv8_1_1internal_1_1Smi_afe7f07102d90ccce48cbe677c88a0645}{Smi::FromInt}}(num\_used\_entries));}
\DoxyCodeLine{102   isolate-\/>heap()-\/>SetJSToWasmWrappers(grown);}
\DoxyCodeLine{103   \textcolor{keywordflow}{return} grown;}
\DoxyCodeLine{104 \}}

\end{DoxyCode}


References Capacity(), v8\+::internal\+::\+DCHECK(), v8\+::internal\+::\+Smi\+::\+From\+Int(), v8\+::internal\+::\+Isolate\+::heap(), v8\+::internal\+::\+Tagged$<$ Heap\+Object $>$\+::\+Is\+Smi(), v8\+::internal\+::key, k\+Num\+Used\+Elements\+Index, k\+Reserved\+Slots, k\+Slots\+Per\+Entry, k\+Unused, New(), v8\+::internal\+::anonymous\+\_\+namespace\{json-\/stringifier.\+cc\}\+::no\+\_\+gc, v8\+::internal\+::\+Tagged\+Impl$<$ k\+Ref\+Type, Storage\+Type $>$\+::\+To\+Smi(), and v8\+::internal\+::value.



Referenced by Put().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a1d2ad89f53842d447412e5086dd80143_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a1d2ad89f53842d447412e5086dd80143_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a149899eaa15a1cb1dc495b01888b0dce}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a149899eaa15a1cb1dc495b01888b0dce}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!FirstProbe@{FirstProbe}}
\index{FirstProbe@{FirstProbe}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{FirstProbe()}{FirstProbe()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{classv8_1_1internal_1_1InternalIndex}{Internal\+Index}} v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::\+First\+Probe (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{hash,  }\item[{uint32\+\_\+t}]{capacity }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 72 of file wasm-\/export-\/wrapper-\/cache.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{72                                                                     \{}
\DoxyCodeLine{73     \textcolor{comment}{// \{New()\} ensures that \{capacity\} is always a power of two.}}
\DoxyCodeLine{74     \textcolor{keywordflow}{return} InternalIndex(hash \& (capacity -\/ 1));}
\DoxyCodeLine{75   \}}

\end{DoxyCode}


Referenced by Get(), and Put\+Internal().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a149899eaa15a1cb1dc495b01888b0dce_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aa67c99c7e5e517261faf25a6a4c4a053}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aa67c99c7e5e517261faf25a6a4c4a053}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!Get@{Get}}
\index{Get@{Get}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{Get()}{Get()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1CodeWrapper}{Code\+Wrapper}} $>$ v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::\+Get (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1CanonicalTypeIndex}{Canonical\+Type\+Index}}}]{sig\+\_\+index,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}}}]{receiver\+\_\+is\+\_\+first\+\_\+param }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 36 of file wasm-\/export-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{38                                                                               \{}
\DoxyCodeLine{39   Tagged<WeakFixedArray> cache = isolate-\/>heap()-\/>js\_to\_wasm\_wrappers();}
\DoxyCodeLine{40   uint32\_t hash = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac33957a1264934827f54836b9f2a16eb}{Hash}}(sig\_index, receiver\_is\_first\_param);}
\DoxyCodeLine{41   uint32\_t capacity = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aa8ad16033b5126c8e284d83fb35d8aa6}{Capacity}}(cache);}
\DoxyCodeLine{42   \textcolor{keywordflow}{if} (capacity == 0) \textcolor{keywordflow}{return} \{\};  \textcolor{comment}{// Not found (cache is uninitialized).}}
\DoxyCodeLine{43   uint32\_t count = 1;}
\DoxyCodeLine{44   \textcolor{keywordflow}{for} (InternalIndex entry = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a149899eaa15a1cb1dc495b01888b0dce}{FirstProbe}}(hash, capacity);;}
\DoxyCodeLine{45        entry = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a78b37d35545c4dbd03627efdb9b352d2}{NextProbe}}(entry, count++, capacity)) \{}
\DoxyCodeLine{46     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(count < capacity);}
\DoxyCodeLine{47     \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacev8_1_1internal_a0cfab207d565dcf62ebf50f3987e05de}{index}} = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a4d019594c196b0cad3173c4898d1c23b}{ToArraySlot}}(entry);}
\DoxyCodeLine{48     Tagged<MaybeWeak<Object>> raw\_key = cache-\/>get(\mbox{\hyperlink{namespacev8_1_1internal_a0cfab207d565dcf62ebf50f3987e05de}{index}});}
\DoxyCodeLine{49     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(raw\_key.IsSmi());}
\DoxyCodeLine{50     \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}} = raw\_key.ToSmi().value();}
\DoxyCodeLine{51     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}} == \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac5ba1c089975eb7e9f480507d0bba20d}{kUnused}}) \textcolor{keywordflow}{return} \{\};  \textcolor{comment}{// Not found.}}
\DoxyCodeLine{52     \mbox{\hyperlink{src_2base_2logging_8h_aabec5c3b7a8628298a25f044dcf89c25}{DCHECK\_GE}}(\mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}}, 0);}
\DoxyCodeLine{53     \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(\mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}}) != hash) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{54     Tagged<MaybeWeak<Object>> \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}} = cache-\/>get(\mbox{\hyperlink{namespacev8_1_1internal_a0cfab207d565dcf62ebf50f3987e05de}{index}} + 1);}
\DoxyCodeLine{55     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}.IsCleared()) \textcolor{keywordflow}{return} \{\};  \textcolor{comment}{// Not found.}}
\DoxyCodeLine{56     \textcolor{keywordflow}{return} Cast<CodeWrapper>(\mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}.GetHeapObjectAssumeWeak());}
\DoxyCodeLine{57   \}}
\DoxyCodeLine{58 \}}

\end{DoxyCode}


References Capacity(), v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+GE, First\+Probe(), Hash(), v8\+::internal\+::\+Isolate\+::heap(), v8\+::internal\+::index, v8\+::internal\+::\+Tagged$<$ Heap\+Object $>$\+::\+Is\+Smi(), v8\+::internal\+::key, k\+Unused, Next\+Probe(), To\+Array\+Slot(), v8\+::internal\+::\+Tagged\+Impl$<$ k\+Ref\+Type, Storage\+Type $>$\+::\+To\+Smi(), and v8\+::internal\+::value.



Referenced by v8\+::internal\+::\+Wasm\+Exported\+Function\+::\+Get\+Wrapper(), and v8\+::internal\+::\+RUNTIME\+\_\+\+FUNCTION().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aa67c99c7e5e517261faf25a6a4c4a053_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aa67c99c7e5e517261faf25a6a4c4a053_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac33957a1264934827f54836b9f2a16eb}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac33957a1264934827f54836b9f2a16eb}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!Hash@{Hash}}
\index{Hash@{Hash}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{Hash()}{Hash()}}
{\footnotesize\ttfamily static uint32\+\_\+t v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::\+Hash (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1CanonicalTypeIndex}{Canonical\+Type\+Index}}}]{sig\+\_\+index,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}}}]{receiver\+\_\+is\+\_\+first\+\_\+param }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 58 of file wasm-\/export-\/wrapper-\/cache.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{59                                                      \{}
\DoxyCodeLine{60     \textcolor{comment}{// We expect most signatures to get only one wrapper, so putting the}}
\DoxyCodeLine{61     \textcolor{comment}{// \{receiver\_is\_first\_param\} bit at the top should give good distribution}}
\DoxyCodeLine{62     \textcolor{comment}{// of hash values.}}
\DoxyCodeLine{63     static\_assert(\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_a2e079999502e577b181583a71bb096ef}{kMaxCanonicalTypes}} < (1u << 20));}
\DoxyCodeLine{64     \textcolor{keywordflow}{return} ((receiver\_is\_first\_param ? 1 : 0) << 20) | sig\_index.index;}
\DoxyCodeLine{65   \}}

\end{DoxyCode}


References v8\+::internal\+::wasm\+::\+Type\+Index\+::index, and v8\+::internal\+::wasm\+::k\+Max\+Canonical\+Types.



Referenced by Get(), and Put().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac33957a1264934827f54836b9f2a16eb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aebc34a8ee5a1a1da95c274fd00d06cde}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aebc34a8ee5a1a1da95c274fd00d06cde}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!New@{New}}
\index{New@{New}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{New()}{New()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakFixedArray}{Weak\+Fixed\+Array}} $>$ v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::\+New (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classint}{int}}}]{capacity }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 13 of file wasm-\/export-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{14                                                                        \{}
\DoxyCodeLine{15   \textcolor{comment}{// Probing depends on bit-\/masking the hashes, so the capacity needs to be}}
\DoxyCodeLine{16   \textcolor{comment}{// a power of two.}}
\DoxyCodeLine{17   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(\mbox{\hyperlink{namespacev8_1_1base_1_1bits_af9eb752b538fa8a66badab8f26e0e000}{base::bits::IsPowerOfTwo}}(capacity));}
\DoxyCodeLine{18   capacity = capacity * \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_abb1b148a38cab141da5d208b3bcd5fe4}{kSlotsPerEntry}} + \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a181e36abff90c1255e51e5e2c2aa0fe4}{kReservedSlots}};}
\DoxyCodeLine{19   DirectHandle<WeakFixedArray> cache =}
\DoxyCodeLine{20       \mbox{\hyperlink{classv8_1_1internal_1_1WeakFixedArray_a5c8137c6fa3f5b1f638de87a199606ae}{WeakFixedArray::New}}(isolate, capacity, \mbox{\hyperlink{namespacev8_1_1internal_a604d5beeb6fc8639670f737ed201e20aa0aa38c28f349d65a6819e03844b73dff}{AllocationType::kOld}},}
\DoxyCodeLine{21                           \mbox{\hyperlink{namespacev8_1_1internal_a73502f55102d18cb764881bc29f35c05}{direct\_handle}}(\mbox{\hyperlink{classv8_1_1internal_1_1Smi_afe7f07102d90ccce48cbe677c88a0645}{Smi::FromInt}}(\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac5ba1c089975eb7e9f480507d0bba20d}{kUnused}}), isolate));}
\DoxyCodeLine{22   cache-\/>set(\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a0023bbee91f2df1d200ae6a7666fa5d8}{kNumUsedElementsIndex}}, \mbox{\hyperlink{classv8_1_1internal_1_1Smi_a5386e0cc44bcfd6a13c8481b95f5652f}{Smi::zero}}());}
\DoxyCodeLine{23   \textcolor{keywordflow}{return} cache;}
\DoxyCodeLine{24 \}}

\end{DoxyCode}


References v8\+::internal\+::\+DCHECK(), v8\+::internal\+::direct\+\_\+handle(), v8\+::internal\+::\+Smi\+::\+From\+Int(), v8\+::base\+::bits\+::\+Is\+Power\+Of\+Two(), k\+Num\+Used\+Elements\+Index, v8\+::internal\+::k\+Old, k\+Reserved\+Slots, k\+Slots\+Per\+Entry, k\+Unused, v8\+::internal\+::\+Weak\+Fixed\+Array\+::\+New(), and v8\+::internal\+::\+Smi\+::zero().



Referenced by Ensure\+Capacity().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aebc34a8ee5a1a1da95c274fd00d06cde_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aebc34a8ee5a1a1da95c274fd00d06cde_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a78b37d35545c4dbd03627efdb9b352d2}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a78b37d35545c4dbd03627efdb9b352d2}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!NextProbe@{NextProbe}}
\index{NextProbe@{NextProbe}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{NextProbe()}{NextProbe()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{classv8_1_1internal_1_1InternalIndex}{Internal\+Index}} v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::\+Next\+Probe (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1InternalIndex}{Internal\+Index}}}]{last,  }\item[{uint32\+\_\+t}]{number,  }\item[{uint32\+\_\+t}]{capacity }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 77 of file wasm-\/export-\/wrapper-\/cache.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{78                                                     \{}
\DoxyCodeLine{79     \textcolor{comment}{// \{New()\} ensures that \{capacity\} is always a power of two.}}
\DoxyCodeLine{80     \textcolor{keywordflow}{return} InternalIndex((last.as\_uint32() + number) \& (capacity -\/ 1));}
\DoxyCodeLine{81   \}}

\end{DoxyCode}


References v8\+::internal\+::\+Internal\+Index\+::as\+\_\+uint32().



Referenced by Get(), and Put\+Internal().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a78b37d35545c4dbd03627efdb9b352d2_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a78b37d35545c4dbd03627efdb9b352d2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a4f8beda6fb9cd7ac523dbbbcda3f9706}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a4f8beda6fb9cd7ac523dbbbcda3f9706}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!Put@{Put}}
\index{Put@{Put}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{Put()}{Put()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac81d27d6edb00aeed62a3e4745b8cba0}{void}} v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::\+Put (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1CanonicalTypeIndex}{Canonical\+Type\+Index}}}]{sig\+\_\+index,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}}}]{receiver\+\_\+is\+\_\+first\+\_\+param,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Code}{Code}} $>$}]{code }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 27 of file wasm-\/export-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{29                                                           \{}
\DoxyCodeLine{30   uint32\_t hash = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac33957a1264934827f54836b9f2a16eb}{Hash}}(sig\_index, receiver\_is\_first\_param);}
\DoxyCodeLine{31   Tagged<WeakFixedArray> cache = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a1d2ad89f53842d447412e5086dd80143}{EnsureCapacity}}(isolate);}
\DoxyCodeLine{32   PutInternal<true>(cache, hash, \mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>wrapper());}
\DoxyCodeLine{33 \}}

\end{DoxyCode}


References code, Ensure\+Capacity(), and Hash().



Referenced by v8\+::internal\+::wasm\+::\+JSTo\+Wasm\+Wrapper\+Compilation\+Unit\+::\+Finalize().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a4f8beda6fb9cd7ac523dbbbcda3f9706_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a4f8beda6fb9cd7ac523dbbbcda3f9706_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a43dc3667a9dc531bd3261c00df78037e}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a43dc3667a9dc531bd3261c00df78037e}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!PutInternal@{PutInternal}}
\index{PutInternal@{PutInternal}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{PutInternal()}{PutInternal()}}
{\footnotesize\ttfamily template$<$bool entry\+\_\+may\+\_\+exist$>$ \\
\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac81d27d6edb00aeed62a3e4745b8cba0}{void}} v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::\+Put\+Internal (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakFixedArray}{Weak\+Fixed\+Array}} $>$}]{cache,  }\item[{uint32\+\_\+t}]{hash,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1MaybeWeak}{Maybe\+Weak}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$$>$}]{value }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 108 of file wasm-\/export-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{110                                                                           \{}
\DoxyCodeLine{111   uint32\_t capacity = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_aa8ad16033b5126c8e284d83fb35d8aa6}{Capacity}}(cache);}
\DoxyCodeLine{112   uint32\_t count = 1;}
\DoxyCodeLine{113   \textcolor{keywordflow}{for} (InternalIndex entry = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a149899eaa15a1cb1dc495b01888b0dce}{FirstProbe}}(hash, capacity);;}
\DoxyCodeLine{114        entry = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a78b37d35545c4dbd03627efdb9b352d2}{NextProbe}}(entry, count++, capacity)) \{}
\DoxyCodeLine{115     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(count < capacity);}
\DoxyCodeLine{116     \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacev8_1_1internal_a0cfab207d565dcf62ebf50f3987e05de}{index}} = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a4d019594c196b0cad3173c4898d1c23b}{ToArraySlot}}(entry);}
\DoxyCodeLine{117     Tagged<MaybeWeak<Object>> raw\_key = cache-\/>get(\mbox{\hyperlink{namespacev8_1_1internal_a0cfab207d565dcf62ebf50f3987e05de}{index}});}
\DoxyCodeLine{118     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(raw\_key.IsSmi());}
\DoxyCodeLine{119     \textcolor{keywordtype}{int} current\_key = raw\_key.ToSmi().value();}
\DoxyCodeLine{120     \textcolor{keywordflow}{if} (current\_key == \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac5ba1c089975eb7e9f480507d0bba20d}{kUnused}}) \{}
\DoxyCodeLine{121       cache-\/>set(\mbox{\hyperlink{namespacev8_1_1internal_a0cfab207d565dcf62ebf50f3987e05de}{index}}, \mbox{\hyperlink{classv8_1_1internal_1_1Smi_afe7f07102d90ccce48cbe677c88a0645}{Smi::FromInt}}(hash));}
\DoxyCodeLine{122       \textcolor{keywordtype}{int} used\_elements = cache-\/>get(\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a0023bbee91f2df1d200ae6a7666fa5d8}{kNumUsedElementsIndex}}).ToSmi().value();}
\DoxyCodeLine{123       cache-\/>set(\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a0023bbee91f2df1d200ae6a7666fa5d8}{kNumUsedElementsIndex}}, \mbox{\hyperlink{classv8_1_1internal_1_1Smi_afe7f07102d90ccce48cbe677c88a0645}{Smi::FromInt}}(used\_elements + 1));}
\DoxyCodeLine{124     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} constexpr (entry\_may\_exist) \{}
\DoxyCodeLine{125       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(current\_key) != hash) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{126       \textcolor{comment}{// Key exists; value must be cleared, otherwise we shouldn't be}}
\DoxyCodeLine{127       \textcolor{comment}{// trying to put a new value.}}
\DoxyCodeLine{128       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(cache-\/>get(\mbox{\hyperlink{namespacev8_1_1internal_a0cfab207d565dcf62ebf50f3987e05de}{index}} + 1).IsCleared());}
\DoxyCodeLine{129     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{130       \mbox{\hyperlink{src_2base_2logging_8h_a986dc8f4ec6dcd0644efe205c13f8eb7}{DCHECK\_NE}}(\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(current\_key), hash);}
\DoxyCodeLine{131       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{132     \}}
\DoxyCodeLine{133 }
\DoxyCodeLine{134     \textcolor{comment}{// We get here when we've found the right entry (unused or cleared).}}
\DoxyCodeLine{135     cache-\/>set(\mbox{\hyperlink{namespacev8_1_1internal_a0cfab207d565dcf62ebf50f3987e05de}{index}} + 1, \mbox{\hyperlink{namespacev8_1_1internal_a96a98d1219c08bac1c5c91ba9dacd1d4}{MakeWeak}}(\mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}));}
\DoxyCodeLine{136     \textcolor{keywordflow}{return};}
\DoxyCodeLine{137   \}}
\DoxyCodeLine{138 \}}

\end{DoxyCode}


References Capacity(), v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+NE, First\+Probe(), v8\+::internal\+::\+Smi\+::\+From\+Int(), v8\+::internal\+::index, v8\+::internal\+::\+Tagged\+Impl$<$ k\+Ref\+Type, Storage\+Type $>$\+::\+Is\+Cleared(), v8\+::internal\+::\+Tagged$<$ Heap\+Object $>$\+::\+Is\+Smi(), k\+Num\+Used\+Elements\+Index, k\+Unused, v8\+::internal\+::\+Make\+Weak(), Next\+Probe(), To\+Array\+Slot(), v8\+::internal\+::\+Tagged\+Impl$<$ k\+Ref\+Type, Storage\+Type $>$\+::\+To\+Smi(), and v8\+::internal\+::value.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a43dc3667a9dc531bd3261c00df78037e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a4d019594c196b0cad3173c4898d1c23b}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a4d019594c196b0cad3173c4898d1c23b}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!ToArraySlot@{ToArraySlot}}
\index{ToArraySlot@{ToArraySlot}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{ToArraySlot()}{ToArraySlot()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{classint}{int}} v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::\+To\+Array\+Slot (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1InternalIndex}{Internal\+Index}}}]{entry }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 68 of file wasm-\/export-\/wrapper-\/cache.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{68                                               \{}
\DoxyCodeLine{69     \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a181e36abff90c1255e51e5e2c2aa0fe4}{kReservedSlots}} + entry.as\_int() * \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_abb1b148a38cab141da5d208b3bcd5fe4}{kSlotsPerEntry}};}
\DoxyCodeLine{70   \}}

\end{DoxyCode}


References v8\+::internal\+::\+Internal\+Index\+::as\+\_\+int(), k\+Reserved\+Slots, and k\+Slots\+Per\+Entry.



Referenced by Get(), and Put\+Internal().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a4d019594c196b0cad3173c4898d1c23b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a4d019594c196b0cad3173c4898d1c23b_icgraph}
\end{center}
\end{figure}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a0023bbee91f2df1d200ae6a7666fa5d8}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a0023bbee91f2df1d200ae6a7666fa5d8}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!kNumUsedElementsIndex@{kNumUsedElementsIndex}}
\index{kNumUsedElementsIndex@{kNumUsedElementsIndex}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{kNumUsedElementsIndex}{kNumUsedElementsIndex}}
{\footnotesize\ttfamily constexpr \mbox{\hyperlink{classint}{int}} v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::k\+Num\+Used\+Elements\+Index = 0\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}, {\ttfamily [private]}}



Definition at line 48 of file wasm-\/export-\/wrapper-\/cache.\+h.



Referenced by Ensure\+Capacity(), New(), and Put\+Internal().

\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a181e36abff90c1255e51e5e2c2aa0fe4}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_a181e36abff90c1255e51e5e2c2aa0fe4}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!kReservedSlots@{kReservedSlots}}
\index{kReservedSlots@{kReservedSlots}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{kReservedSlots}{kReservedSlots}}
{\footnotesize\ttfamily constexpr \mbox{\hyperlink{classint}{int}} v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::k\+Reserved\+Slots = 1\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}, {\ttfamily [private]}}



Definition at line 49 of file wasm-\/export-\/wrapper-\/cache.\+h.



Referenced by Capacity(), Ensure\+Capacity(), New(), and To\+Array\+Slot().

\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_abb1b148a38cab141da5d208b3bcd5fe4}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_abb1b148a38cab141da5d208b3bcd5fe4}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!kSlotsPerEntry@{kSlotsPerEntry}}
\index{kSlotsPerEntry@{kSlotsPerEntry}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{kSlotsPerEntry}{kSlotsPerEntry}}
{\footnotesize\ttfamily constexpr \mbox{\hyperlink{classint}{int}} v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::k\+Slots\+Per\+Entry = 2\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}, {\ttfamily [private]}}



Definition at line 52 of file wasm-\/export-\/wrapper-\/cache.\+h.



Referenced by Ensure\+Capacity(), New(), and To\+Array\+Slot().

\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac5ba1c089975eb7e9f480507d0bba20d}\label{classv8_1_1internal_1_1wasm_1_1WasmExportWrapperCache_ac5ba1c089975eb7e9f480507d0bba20d}} 
\index{v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}!kUnused@{kUnused}}
\index{kUnused@{kUnused}!v8::internal::wasm::WasmExportWrapperCache@{v8::internal::wasm::WasmExportWrapperCache}}
\doxysubsubsection{\texorpdfstring{kUnused}{kUnused}}
{\footnotesize\ttfamily constexpr \mbox{\hyperlink{classint}{int}} v8\+::internal\+::wasm\+::\+Wasm\+Export\+Wrapper\+Cache\+::k\+Unused = -\/1\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}, {\ttfamily [private]}}



Definition at line 46 of file wasm-\/export-\/wrapper-\/cache.\+h.



Referenced by Ensure\+Capacity(), Get(), New(), and Put\+Internal().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/mnt/\+V8\+Source\+Code/src/wasm/\mbox{\hyperlink{wasm-export-wrapper-cache_8h}{wasm-\/export-\/wrapper-\/cache.\+h}}\item 
/mnt/\+V8\+Source\+Code/src/wasm/\mbox{\hyperlink{wasm-export-wrapper-cache_8cc}{wasm-\/export-\/wrapper-\/cache.\+cc}}\end{DoxyCompactItemize}
