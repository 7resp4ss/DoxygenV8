\hypertarget{classv8_1_1internal_1_1Coverage}{}\doxysection{v8\+::internal\+::Coverage Class Reference}
\label{classv8_1_1internal_1_1Coverage}\index{v8::internal::Coverage@{v8::internal::Coverage}}


{\ttfamily \#include $<$debug-\/coverage.\+h$>$}



Inheritance diagram for v8\+::internal\+::Coverage\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=205pt]{classv8_1_1internal_1_1Coverage__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for v8\+::internal\+::Coverage\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=205pt]{classv8_1_1internal_1_1Coverage__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Coverage}{Coverage}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1Coverage_a11bcbe58ca9413cbb7572b86882649fd}{Collect\+Precise}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate)
\item 
static std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Coverage}{Coverage}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1Coverage_af5201ef7727bf3071a6b3420a232565a}{Collect\+Best\+Effort}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate)
\item 
static \mbox{\hyperlink{src_2base_2macros_8h_ab08e353943a53678ac6baafc678f2d81}{V8\+\_\+\+EXPORT\+\_\+\+PRIVATE}} void \mbox{\hyperlink{classv8_1_1internal_1_1Coverage_a41fb833ad5c0b30b86acf85e6a13d9a9}{Select\+Mode}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0}{debug\+::\+Coverage\+Mode}} \mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}})
\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1Coverage_a0953ce3e62adac9b68d28a3cc0668b6f}{Coverage}} ()=default
\end{DoxyCompactItemize}
\doxysubsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
static std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Coverage}{Coverage}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1Coverage_a66664438229985b6aa3817220fcf0147}{Collect}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0}{v8\+::debug\+::\+Coverage\+Mode}} collection\+Mode)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 53 of file debug-\/coverage.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1Coverage_a0953ce3e62adac9b68d28a3cc0668b6f}\label{classv8_1_1internal_1_1Coverage_a0953ce3e62adac9b68d28a3cc0668b6f}} 
\index{v8::internal::Coverage@{v8::internal::Coverage}!Coverage@{Coverage}}
\index{Coverage@{Coverage}!v8::internal::Coverage@{v8::internal::Coverage}}
\doxysubsubsection{\texorpdfstring{Coverage()}{Coverage()}}
{\footnotesize\ttfamily v8\+::internal\+::\+Coverage\+::\+Coverage (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [default]}}



Referenced by Collect().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1Coverage_a0953ce3e62adac9b68d28a3cc0668b6f_icgraph}
\end{center}
\end{figure}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1Coverage_a66664438229985b6aa3817220fcf0147}\label{classv8_1_1internal_1_1Coverage_a66664438229985b6aa3817220fcf0147}} 
\index{v8::internal::Coverage@{v8::internal::Coverage}!Collect@{Collect}}
\index{Collect@{Collect}!v8::internal::Coverage@{v8::internal::Coverage}}
\doxysubsubsection{\texorpdfstring{Collect()}{Collect()}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Coverage}{Coverage}} $>$ v8\+::internal\+::\+Coverage\+::\+Collect (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0}{v8\+::debug\+::\+Coverage\+Mode}}}]{collection\+Mode }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 703 of file debug-\/coverage.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{704                                                            \{}
\DoxyCodeLine{705   \textcolor{comment}{// Unsupported if jitless mode is enabled at build-\/time since related}}
\DoxyCodeLine{706   \textcolor{comment}{// optimizations deactivate invocation count updates.}}
\DoxyCodeLine{707   \mbox{\hyperlink{src_2base_2logging_8h_a3e1cfef60e774a81f30eaddf26a3a274}{CHECK}}(!\mbox{\hyperlink{flag-definitions_8h_abce3584fddb7b6220f130e88432a59f6}{V8\_JITLESS\_BOOL}});}
\DoxyCodeLine{708 }
\DoxyCodeLine{709   \textcolor{comment}{// Collect call counts for all functions.}}
\DoxyCodeLine{710   SharedToCounterMap counter\_map;}
\DoxyCodeLine{711   \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02debug-coverage_8cc_03_a6bd71c4bf8cf278244d4f0e036ec0ce4}{CollectAndMaybeResetCounts}}(isolate, \&counter\_map, collection\_mode);}
\DoxyCodeLine{712 }
\DoxyCodeLine{713   \textcolor{comment}{// Iterate shared function infos of every script and build a mapping}}
\DoxyCodeLine{714   \textcolor{comment}{// between source ranges and invocation counts.}}
\DoxyCodeLine{715   std::unique\_ptr<Coverage> \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}}(\textcolor{keyword}{new} \mbox{\hyperlink{classv8_1_1internal_1_1Coverage_a0953ce3e62adac9b68d28a3cc0668b6f}{Coverage}}());}
\DoxyCodeLine{716 }
\DoxyCodeLine{717   std::vector<Handle<Script>> scripts;}
\DoxyCodeLine{718   Script::Iterator script\_it(isolate);}
\DoxyCodeLine{719   \textcolor{keywordflow}{for} (Tagged<Script> \mbox{\hyperlink{namespacev8_1_1internal_afb7e5cd394b9632dddc2e7807b11b2ab}{script}} = script\_it.Next(); !\mbox{\hyperlink{namespacev8_1_1internal_afb7e5cd394b9632dddc2e7807b11b2ab}{script}}.is\_null();}
\DoxyCodeLine{720        \mbox{\hyperlink{namespacev8_1_1internal_afb7e5cd394b9632dddc2e7807b11b2ab}{script}} = script\_it.Next()) \{}
\DoxyCodeLine{721     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_afb7e5cd394b9632dddc2e7807b11b2ab}{script}}-\/>IsUserJavaScript()) scripts.push\_back(\mbox{\hyperlink{namespacev8_1_1internal_a8c89f00da07e125218128b9fbf0a321c}{handle}}(\mbox{\hyperlink{namespacev8_1_1internal_afb7e5cd394b9632dddc2e7807b11b2ab}{script}}, isolate));}
\DoxyCodeLine{722   \}}
\DoxyCodeLine{723 }
\DoxyCodeLine{724   \textcolor{keywordflow}{for} (Handle<Script> \mbox{\hyperlink{namespacev8_1_1internal_afb7e5cd394b9632dddc2e7807b11b2ab}{script}} : scripts) \{}
\DoxyCodeLine{725     \textcolor{comment}{// Create and add new script data.}}
\DoxyCodeLine{726     \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}}-\/>emplace\_back(\mbox{\hyperlink{namespacev8_1_1internal_afb7e5cd394b9632dddc2e7807b11b2ab}{script}});}
\DoxyCodeLine{727     std::vector<CoverageFunction>* functions = \&\mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}}-\/>back().functions;}
\DoxyCodeLine{728 }
\DoxyCodeLine{729     std::vector<SharedFunctionInfoAndCount> sorted;}
\DoxyCodeLine{730 }
\DoxyCodeLine{731     \{}
\DoxyCodeLine{732       \textcolor{comment}{// Sort functions by start position, from outer to inner functions.}}
\DoxyCodeLine{733       SharedFunctionInfo::ScriptIterator infos(isolate, *\mbox{\hyperlink{namespacev8_1_1internal_afb7e5cd394b9632dddc2e7807b11b2ab}{script}});}
\DoxyCodeLine{734       \textcolor{keywordflow}{for} (Tagged<SharedFunctionInfo> info = infos.Next(); !info.is\_null();}
\DoxyCodeLine{735            info = infos.Next()) \{}
\DoxyCodeLine{736         sorted.emplace\_back(\mbox{\hyperlink{namespacev8_1_1internal_a8c89f00da07e125218128b9fbf0a321c}{handle}}(info, isolate), counter\_map.Get(info));}
\DoxyCodeLine{737       \}}
\DoxyCodeLine{738       \mbox{\hyperlink{namespacev8_1_1base_ae8575343c68d7ad91cf7aaf24cd6643f}{std::sort}}(sorted.begin(), sorted.end());}
\DoxyCodeLine{739     \}}
\DoxyCodeLine{740 }
\DoxyCodeLine{741     \textcolor{comment}{// Stack to track nested functions, referring function by index.}}
\DoxyCodeLine{742     std::vector<size\_t> nesting;}
\DoxyCodeLine{743 }
\DoxyCodeLine{744     \textcolor{comment}{// Use sorted list to reconstruct function nesting.}}
\DoxyCodeLine{745     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} SharedFunctionInfoAndCount\& v : sorted) \{}
\DoxyCodeLine{746       DirectHandle<SharedFunctionInfo> info = v.info;}
\DoxyCodeLine{747       \textcolor{keywordtype}{int} start = v.start;}
\DoxyCodeLine{748       \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacev8_1_1internal_1_1compiler_a51dcb90ae077172b12d63271c7e7ba0c}{end}} = v.end;}
\DoxyCodeLine{749       uint32\_t count = v.count;}
\DoxyCodeLine{750 }
\DoxyCodeLine{751       \textcolor{comment}{// Find the correct outer function based on start position.}}
\DoxyCodeLine{752       \textcolor{comment}{//}}
\DoxyCodeLine{753       \textcolor{comment}{// This is, in general, not robust when considering two functions with}}
\DoxyCodeLine{754       \textcolor{comment}{// identical source ranges; then the notion of inner and outer is unclear.}}
\DoxyCodeLine{755       \textcolor{comment}{// Identical source ranges arise when the source range of top-\/most entity}}
\DoxyCodeLine{756       \textcolor{comment}{// (e.g. function) in the script is identical to the whole script, e.g.}}
\DoxyCodeLine{757       \textcolor{comment}{// <script>function foo() \{\}<script>. The script has its own shared}}
\DoxyCodeLine{758       \textcolor{comment}{// function info, which has the same source range as the SFI for `foo`.}}
\DoxyCodeLine{759       \textcolor{comment}{// Node.js creates an additional wrapper for scripts (again with identical}}
\DoxyCodeLine{760       \textcolor{comment}{// source range) and those wrappers will have a call count of zero even if}}
\DoxyCodeLine{761       \textcolor{comment}{// the wrapped script was executed (see v8:9212). We mitigate this issue}}
\DoxyCodeLine{762       \textcolor{comment}{// by sorting top-\/level SFIs first among SFIs with the same source range:}}
\DoxyCodeLine{763       \textcolor{comment}{// This ensures top-\/level SFIs are processed first. If a top-\/level SFI has}}
\DoxyCodeLine{764       \textcolor{comment}{// a non-\/zero call count, it gets recorded due to `function\_is\_relevant`}}
\DoxyCodeLine{765       \textcolor{comment}{// below (e.g. script wrappers), while top-\/level SFIs with zero call count}}
\DoxyCodeLine{766       \textcolor{comment}{// do not get reported (this ensures node's extra wrappers do not get}}
\DoxyCodeLine{767       \textcolor{comment}{// reported). If two SFIs with identical source ranges get reported, we}}
\DoxyCodeLine{768       \textcolor{comment}{// report them in decreasing order of call count, as in all known cases}}
\DoxyCodeLine{769       \textcolor{comment}{// this corresponds to the nesting order. In the case of the script tag}}
\DoxyCodeLine{770       \textcolor{comment}{// example above, we report the zero call count of `foo` last. As it turns}}
\DoxyCodeLine{771       \textcolor{comment}{// out, embedders started to rely on functions being reported in nesting}}
\DoxyCodeLine{772       \textcolor{comment}{// order.}}
\DoxyCodeLine{773       \textcolor{comment}{// TODO(jgruber):  Investigate whether it is possible to remove node's}}
\DoxyCodeLine{774       \textcolor{comment}{// extra  top-\/level wrapper script, or change its source range, or ensure}}
\DoxyCodeLine{775       \textcolor{comment}{// that it follows the invariant that nesting order is descending count}}
\DoxyCodeLine{776       \textcolor{comment}{// order for SFIs with identical source ranges.}}
\DoxyCodeLine{777       \textcolor{keywordflow}{while} (!nesting.empty() \&\& functions-\/>at(nesting.back()).end <= start) \{}
\DoxyCodeLine{778         nesting.pop\_back();}
\DoxyCodeLine{779       \}}
\DoxyCodeLine{780 }
\DoxyCodeLine{781       \textcolor{keywordflow}{if} (count != 0) \{}
\DoxyCodeLine{782         \textcolor{keywordflow}{switch} (collection\_mode) \{}
\DoxyCodeLine{783           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0abe82278339b4872cc00b9daa8f1559ca}{v8::debug::CoverageMode::kBlockCount}}:}
\DoxyCodeLine{784           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0a170186bfcbad604d2e0c2c2a8e4368f9}{v8::debug::CoverageMode::kPreciseCount}}:}
\DoxyCodeLine{785             \textcolor{keywordflow}{break};}
\DoxyCodeLine{786           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0af5eae2fe9f938a0bf87e00f21a0430a9}{v8::debug::CoverageMode::kBlockBinary}}:}
\DoxyCodeLine{787           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0a2b28446539d3e379fd317ac848b7d4fc}{v8::debug::CoverageMode::kPreciseBinary}}:}
\DoxyCodeLine{788             count = info-\/>has\_reported\_binary\_coverage() ? 0 : 1;}
\DoxyCodeLine{789             info-\/>set\_has\_reported\_binary\_coverage(\textcolor{keyword}{true});}
\DoxyCodeLine{790             \textcolor{keywordflow}{break};}
\DoxyCodeLine{791           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0a8ca6416b1934c765a6967e9ea78e1f5c}{v8::debug::CoverageMode::kBestEffort}}:}
\DoxyCodeLine{792             count = 1;}
\DoxyCodeLine{793             \textcolor{keywordflow}{break};}
\DoxyCodeLine{794         \}}
\DoxyCodeLine{795       \}}
\DoxyCodeLine{796 }
\DoxyCodeLine{797       Handle<String> \mbox{\hyperlink{namespacev8_1_1internal_a611f0528d5415d4591ad6e8fe9513ac4}{name}} = \mbox{\hyperlink{classv8_1_1internal_1_1SharedFunctionInfo_aa026400e2b25d0876a0ee5b1fcf57c8a}{SharedFunctionInfo::DebugName}}(isolate, info);}
\DoxyCodeLine{798       CoverageFunction \textcolor{keyword}{function}(start, \mbox{\hyperlink{namespacev8_1_1internal_1_1compiler_a51dcb90ae077172b12d63271c7e7ba0c}{end}}, count, \mbox{\hyperlink{namespacev8_1_1internal_a611f0528d5415d4591ad6e8fe9513ac4}{name}});}
\DoxyCodeLine{799 }
\DoxyCodeLine{800       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02debug-coverage_8cc_03_a8c223b8ebd12f35065d7bf08e4e35708}{IsBlockMode}}(collection\_mode) \&\& info-\/>HasCoverageInfo(isolate)) \{}
\DoxyCodeLine{801         \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02debug-coverage_8cc_03_a56a3d0fed9afcb859bfcfa348777355d}{CollectBlockCoverage}}(isolate, \&\textcolor{keyword}{function}, *info, collection\_mode);}
\DoxyCodeLine{802       \}}
\DoxyCodeLine{803 }
\DoxyCodeLine{804       \textcolor{comment}{// Only include a function range if itself or its parent function is}}
\DoxyCodeLine{805       \textcolor{comment}{// covered, or if it contains non-\/trivial block coverage.}}
\DoxyCodeLine{806       \textcolor{keywordtype}{bool} is\_covered = (count != 0);}
\DoxyCodeLine{807       \textcolor{keywordtype}{bool} parent\_is\_covered =}
\DoxyCodeLine{808           (!nesting.empty() \&\& functions-\/>at(nesting.back()).count != 0);}
\DoxyCodeLine{809       \textcolor{keywordtype}{bool} has\_block\_coverage = !\textcolor{keyword}{function}.blocks.empty();}
\DoxyCodeLine{810       \textcolor{keywordtype}{bool} function\_is\_relevant =}
\DoxyCodeLine{811           (is\_covered || parent\_is\_covered || has\_block\_coverage);}
\DoxyCodeLine{812 }
\DoxyCodeLine{813       \textcolor{comment}{// It must also have a non-\/empty source range (otherwise it is not}}
\DoxyCodeLine{814       \textcolor{comment}{// interesting to report).}}
\DoxyCodeLine{815       \textcolor{keywordtype}{bool} has\_nonempty\_source\_range = \textcolor{keyword}{function}.HasNonEmptySourceRange();}
\DoxyCodeLine{816 }
\DoxyCodeLine{817       \textcolor{keywordflow}{if} (has\_nonempty\_source\_range \&\& function\_is\_relevant) \{}
\DoxyCodeLine{818         nesting.push\_back(functions-\/>size());}
\DoxyCodeLine{819         functions-\/>emplace\_back(\textcolor{keyword}{function});}
\DoxyCodeLine{820       \}}
\DoxyCodeLine{821 }
\DoxyCodeLine{822       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.trace\_block\_coverage) \{}
\DoxyCodeLine{823         \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02debug-coverage_8cc_03_aaf5f817109bd96f04047f1369ec4e973}{PrintBlockCoverage}}(\&\textcolor{keyword}{function}, *info, has\_nonempty\_source\_range,}
\DoxyCodeLine{824                            function\_is\_relevant);}
\DoxyCodeLine{825       \}}
\DoxyCodeLine{826     \}}
\DoxyCodeLine{827 }
\DoxyCodeLine{828     \textcolor{comment}{// Remove entries for scripts that have no coverage.}}
\DoxyCodeLine{829     \textcolor{keywordflow}{if} (functions-\/>empty()) \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}}-\/>pop\_back();}
\DoxyCodeLine{830   \}}
\DoxyCodeLine{831   \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}};}
\DoxyCodeLine{832 \}}

\end{DoxyCode}


References CHECK, v8\+::internal\+::anonymous\+\_\+namespace\{debug-\/coverage.\+cc\}\+::\+Collect\+And\+Maybe\+Reset\+Counts(), v8\+::internal\+::anonymous\+\_\+namespace\{debug-\/coverage.\+cc\}\+::\+Collect\+Block\+Coverage(), Coverage(), v8\+::internal\+::\+Shared\+Function\+Info\+::\+Debug\+Name(), v8\+::internal\+::compiler\+::end(), v8\+::internal\+::\+Shared\+To\+Counter\+Map\+::\+Get(), v8\+::internal\+::handle(), v8\+::internal\+::anonymous\+\_\+namespace\{debug-\/coverage.\+cc\}\+::\+Is\+Block\+Mode(), v8\+::debug\+::k\+Best\+Effort, v8\+::debug\+::k\+Block\+Binary, v8\+::debug\+::k\+Block\+Count, v8\+::debug\+::k\+Precise\+Binary, v8\+::debug\+::k\+Precise\+Count, v8\+::internal\+::name, v8\+::internal\+::\+Script\+::\+Iterator\+::\+Next(), v8\+::internal\+::\+Shared\+Function\+Info\+::\+Script\+Iterator\+::\+Next(), v8\+::internal\+::anonymous\+\_\+namespace\{debug-\/coverage.\+cc\}\+::\+Print\+Block\+Coverage(), v8\+::base\+::internal\+::result, v8\+::internal\+::script, v8\+::base\+::sort(), v8\+::internal\+::v8\+\_\+flags, and V8\+\_\+\+JITLESS\+\_\+\+BOOL.



Referenced by Collect\+Best\+Effort(), and Collect\+Precise().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1Coverage_a66664438229985b6aa3817220fcf0147_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1Coverage_a66664438229985b6aa3817220fcf0147_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1Coverage_af5201ef7727bf3071a6b3420a232565a}\label{classv8_1_1internal_1_1Coverage_af5201ef7727bf3071a6b3420a232565a}} 
\index{v8::internal::Coverage@{v8::internal::Coverage}!CollectBestEffort@{CollectBestEffort}}
\index{CollectBestEffort@{CollectBestEffort}!v8::internal::Coverage@{v8::internal::Coverage}}
\doxysubsubsection{\texorpdfstring{CollectBestEffort()}{CollectBestEffort()}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Coverage}{Coverage}} $>$ v8\+::internal\+::\+Coverage\+::\+Collect\+Best\+Effort (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 621 of file debug-\/coverage.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{621                                                                     \{}
\DoxyCodeLine{622   \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1Coverage_a66664438229985b6aa3817220fcf0147}{Collect}}(isolate, \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0a8ca6416b1934c765a6967e9ea78e1f5c}{v8::debug::CoverageMode::kBestEffort}});}
\DoxyCodeLine{623 \}}

\end{DoxyCode}


References Collect(), and v8\+::debug\+::k\+Best\+Effort.



Referenced by v8\+::debug\+::\+Coverage\+::\+Collect\+Best\+Effort(), and v8\+::internal\+::\+RUNTIME\+\_\+\+FUNCTION().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1Coverage_af5201ef7727bf3071a6b3420a232565a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1Coverage_af5201ef7727bf3071a6b3420a232565a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1Coverage_a11bcbe58ca9413cbb7572b86882649fd}\label{classv8_1_1internal_1_1Coverage_a11bcbe58ca9413cbb7572b86882649fd}} 
\index{v8::internal::Coverage@{v8::internal::Coverage}!CollectPrecise@{CollectPrecise}}
\index{CollectPrecise@{CollectPrecise}!v8::internal::Coverage@{v8::internal::Coverage}}
\doxysubsubsection{\texorpdfstring{CollectPrecise()}{CollectPrecise()}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Coverage}{Coverage}} $>$ v8\+::internal\+::\+Coverage\+::\+Collect\+Precise (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 607 of file debug-\/coverage.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{607                                                                  \{}
\DoxyCodeLine{608   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(!isolate-\/>is\_best\_effort\_code\_coverage());}
\DoxyCodeLine{609   std::unique\_ptr<Coverage> \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}} =}
\DoxyCodeLine{610       \mbox{\hyperlink{classv8_1_1internal_1_1Coverage_a66664438229985b6aa3817220fcf0147}{Collect}}(isolate, isolate-\/>code\_coverage\_mode());}
\DoxyCodeLine{611   \textcolor{keywordflow}{if} (isolate-\/>is\_precise\_binary\_code\_coverage() ||}
\DoxyCodeLine{612       isolate-\/>is\_block\_binary\_code\_coverage()) \{}
\DoxyCodeLine{613     \textcolor{comment}{// We do not have to hold onto feedback vectors for invocations we already}}
\DoxyCodeLine{614     \textcolor{comment}{// reported. So we can reset the list.}}
\DoxyCodeLine{615     isolate-\/>SetFeedbackVectorsForProfilingTools(}
\DoxyCodeLine{616         ReadOnlyRoots(isolate).empty\_array\_list());}
\DoxyCodeLine{617   \}}
\DoxyCodeLine{618   \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}};}
\DoxyCodeLine{619 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Isolate\+::code\+\_\+coverage\+\_\+mode(), Collect(), v8\+::internal\+::\+DCHECK(), v8\+::internal\+::\+Isolate\+::is\+\_\+best\+\_\+effort\+\_\+code\+\_\+coverage(), v8\+::internal\+::\+Isolate\+::is\+\_\+block\+\_\+binary\+\_\+code\+\_\+coverage(), v8\+::internal\+::\+Isolate\+::is\+\_\+precise\+\_\+binary\+\_\+code\+\_\+coverage(), v8\+::base\+::internal\+::result, and v8\+::internal\+::\+Isolate\+::\+Set\+Feedback\+Vectors\+For\+Profiling\+Tools().



Referenced by v8\+::debug\+::\+Coverage\+::\+Collect\+Precise(), and v8\+::internal\+::\+RUNTIME\+\_\+\+FUNCTION().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1Coverage_a11bcbe58ca9413cbb7572b86882649fd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1Coverage_a11bcbe58ca9413cbb7572b86882649fd_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1Coverage_a41fb833ad5c0b30b86acf85e6a13d9a9}\label{classv8_1_1internal_1_1Coverage_a41fb833ad5c0b30b86acf85e6a13d9a9}} 
\index{v8::internal::Coverage@{v8::internal::Coverage}!SelectMode@{SelectMode}}
\index{SelectMode@{SelectMode}!v8::internal::Coverage@{v8::internal::Coverage}}
\doxysubsubsection{\texorpdfstring{SelectMode()}{SelectMode()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Coverage\+::\+Select\+Mode (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0}{debug\+::\+Coverage\+Mode}}}]{mode }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 834 of file debug-\/coverage.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{834                                                                   \{}
\DoxyCodeLine{835   \textcolor{keywordflow}{if} (\mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}} != isolate-\/>code\_coverage\_mode()) \{}
\DoxyCodeLine{836     \textcolor{comment}{// Changing the coverage mode can change the bytecode that would be}}
\DoxyCodeLine{837     \textcolor{comment}{// generated for a function, which can interfere with lazy source positions,}}
\DoxyCodeLine{838     \textcolor{comment}{// so just force source position collection whenever there's such a change.}}
\DoxyCodeLine{839     isolate-\/>CollectSourcePositionsForAllBytecodeArrays();}
\DoxyCodeLine{840     \textcolor{comment}{// Changing the coverage mode changes the generated bytecode and hence it is}}
\DoxyCodeLine{841     \textcolor{comment}{// not safe to flush bytecode. Set a flag here, so we can disable bytecode}}
\DoxyCodeLine{842     \textcolor{comment}{// flushing.}}
\DoxyCodeLine{843     isolate-\/>set\_disable\_bytecode\_flushing(\textcolor{keyword}{true});}
\DoxyCodeLine{844   \}}
\DoxyCodeLine{845 }
\DoxyCodeLine{846   \textcolor{keywordflow}{switch} (\mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}}) \{}
\DoxyCodeLine{847     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0a8ca6416b1934c765a6967e9ea78e1f5c}{debug::CoverageMode::kBestEffort}}:}
\DoxyCodeLine{848       \textcolor{comment}{// Note that DevTools switches back to best-\/effort coverage once the}}
\DoxyCodeLine{849       \textcolor{comment}{// recording is stopped. Since we delete coverage infos at that point, any}}
\DoxyCodeLine{850       \textcolor{comment}{// following coverage recording (without reloads) will be at function}}
\DoxyCodeLine{851       \textcolor{comment}{// granularity.}}
\DoxyCodeLine{852       isolate-\/>debug()-\/>RemoveAllCoverageInfos();}
\DoxyCodeLine{853       isolate-\/>SetFeedbackVectorsForProfilingTools(}
\DoxyCodeLine{854           ReadOnlyRoots(isolate).undefined\_value());}
\DoxyCodeLine{855       \textcolor{keywordflow}{break};}
\DoxyCodeLine{856     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0af5eae2fe9f938a0bf87e00f21a0430a9}{debug::CoverageMode::kBlockBinary}}:}
\DoxyCodeLine{857     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0abe82278339b4872cc00b9daa8f1559ca}{debug::CoverageMode::kBlockCount}}:}
\DoxyCodeLine{858     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0a2b28446539d3e379fd317ac848b7d4fc}{debug::CoverageMode::kPreciseBinary}}:}
\DoxyCodeLine{859     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1debug_a6fe9cf9b9175111f411b64dc5460c5d0a170186bfcbad604d2e0c2c2a8e4368f9}{debug::CoverageMode::kPreciseCount}}: \{}
\DoxyCodeLine{860       HandleScope scope(isolate);}
\DoxyCodeLine{861 }
\DoxyCodeLine{862       \textcolor{comment}{// Remove all optimized function. Optimized and inlined functions do not}}
\DoxyCodeLine{863       \textcolor{comment}{// increment invocation count.}}
\DoxyCodeLine{864       \mbox{\hyperlink{classv8_1_1internal_1_1Deoptimizer_a6bb35276c37391b101bba2759894c2d0}{Deoptimizer::DeoptimizeAll}}(isolate);}
\DoxyCodeLine{865 }
\DoxyCodeLine{866       std::vector<Handle<JSFunction>> funcs\_needing\_feedback\_vector;}
\DoxyCodeLine{867       \{}
\DoxyCodeLine{868         HeapObjectIterator heap\_iterator(isolate-\/>heap());}
\DoxyCodeLine{869         \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacev8_1_1internal_a57f5ecf71b9a2757b0555b2be4c640b8}{Tagged<HeapObject>}} o = heap\_iterator.Next(); !o.is\_null();}
\DoxyCodeLine{870              o = heap\_iterator.Next()) \{}
\DoxyCodeLine{871           \textcolor{keywordflow}{if} (IsJSFunction(o)) \{}
\DoxyCodeLine{872             Tagged<JSFunction> func = Cast<JSFunction>(o);}
\DoxyCodeLine{873             \textcolor{keywordflow}{if} (func-\/>has\_closure\_feedback\_cell\_array()) \{}
\DoxyCodeLine{874               funcs\_needing\_feedback\_vector.push\_back(}
\DoxyCodeLine{875                   Handle<JSFunction>(func, isolate));}
\DoxyCodeLine{876             \}}
\DoxyCodeLine{877           \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02debug-coverage_8cc_03_a184d02efd817e9f0d12462674067db13}{IsBinaryMode}}(\mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}}) \&\& IsSharedFunctionInfo(o)) \{}
\DoxyCodeLine{878             \textcolor{comment}{// If collecting binary coverage, reset}}
\DoxyCodeLine{879             \textcolor{comment}{// SFI::has\_reported\_binary\_coverage to avoid optimizing / inlining}}
\DoxyCodeLine{880             \textcolor{comment}{// functions before they have reported coverage.}}
\DoxyCodeLine{881             Tagged<SharedFunctionInfo> shared = Cast<SharedFunctionInfo>(o);}
\DoxyCodeLine{882             shared-\/>set\_has\_reported\_binary\_coverage(\textcolor{keyword}{false});}
\DoxyCodeLine{883           \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (IsFeedbackVector(o)) \{}
\DoxyCodeLine{884             \textcolor{comment}{// In any case, clear any collected invocation counts.}}
\DoxyCodeLine{885             Cast<FeedbackVector>(o)-\/>clear\_invocation\_count(\mbox{\hyperlink{namespacev8_a6f4ac914af065ca471d59c67f789296f}{kRelaxedStore}});}
\DoxyCodeLine{886           \}}
\DoxyCodeLine{887         \}}
\DoxyCodeLine{888       \}}
\DoxyCodeLine{889 }
\DoxyCodeLine{890       \textcolor{keywordflow}{for} (DirectHandle<JSFunction> func : funcs\_needing\_feedback\_vector) \{}
\DoxyCodeLine{891         IsCompiledScope is\_compiled\_scope(}
\DoxyCodeLine{892             func-\/>shared()-\/>is\_compiled\_scope(isolate));}
\DoxyCodeLine{893         \mbox{\hyperlink{src_2base_2logging_8h_a3e1cfef60e774a81f30eaddf26a3a274}{CHECK}}(is\_compiled\_scope.is\_compiled());}
\DoxyCodeLine{894         \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction_a32102665604d5ad5d469aa3b44071499}{JSFunction::EnsureFeedbackVector}}(isolate, func, \&is\_compiled\_scope);}
\DoxyCodeLine{895       \}}
\DoxyCodeLine{896 }
\DoxyCodeLine{897       \textcolor{comment}{// Root all feedback vectors to avoid early collection.}}
\DoxyCodeLine{898       isolate-\/>MaybeInitializeVectorListFromHeap();}
\DoxyCodeLine{899 }
\DoxyCodeLine{900       \textcolor{keywordflow}{break};}
\DoxyCodeLine{901     \}}
\DoxyCodeLine{902   \}}
\DoxyCodeLine{903   isolate-\/>set\_code\_coverage\_mode(\mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}});}
\DoxyCodeLine{904 \}}

\end{DoxyCode}


References CHECK, v8\+::internal\+::\+Isolate\+::code\+\_\+coverage\+\_\+mode(), v8\+::internal\+::\+Isolate\+::\+Collect\+Source\+Positions\+For\+All\+Bytecode\+Arrays(), v8\+::internal\+::\+Isolate\+::debug(), v8\+::internal\+::\+Deoptimizer\+::\+Deoptimize\+All(), v8\+::internal\+::\+JSFunction\+::\+Ensure\+Feedback\+Vector(), v8\+::internal\+::\+Isolate\+::heap(), v8\+::internal\+::\+Is\+Compiled\+Scope\+::is\+\_\+compiled(), v8\+::internal\+::\+Tagged$<$ Heap\+Object $>$\+::is\+\_\+null(), v8\+::internal\+::anonymous\+\_\+namespace\{debug-\/coverage.\+cc\}\+::\+Is\+Binary\+Mode(), v8\+::debug\+::k\+Best\+Effort, v8\+::debug\+::k\+Block\+Binary, v8\+::debug\+::k\+Block\+Count, v8\+::debug\+::k\+Precise\+Binary, v8\+::debug\+::k\+Precise\+Count, v8\+::k\+Relaxed\+Store, v8\+::internal\+::\+Isolate\+::\+Maybe\+Initialize\+Vector\+List\+From\+Heap(), mode(), v8\+::internal\+::\+Heap\+Object\+Iterator\+::\+Next(), v8\+::internal\+::\+Debug\+::\+Remove\+All\+Coverage\+Infos(), v8\+::internal\+::\+Isolate\+::set\+\_\+code\+\_\+coverage\+\_\+mode(), and v8\+::internal\+::\+Isolate\+::\+Set\+Feedback\+Vectors\+For\+Profiling\+Tools().



Referenced by v8\+::internal\+::\+RUNTIME\+\_\+\+FUNCTION(), and v8\+::debug\+::\+Coverage\+::\+Select\+Mode().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1Coverage_a41fb833ad5c0b30b86acf85e6a13d9a9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1Coverage_a41fb833ad5c0b30b86acf85e6a13d9a9_icgraph}
\end{center}
\end{figure}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/mnt/\+V8\+Source\+Code/src/debug/\mbox{\hyperlink{debug-coverage_8h}{debug-\/coverage.\+h}}\item 
/mnt/\+V8\+Source\+Code/src/debug/\mbox{\hyperlink{debug-coverage_8cc}{debug-\/coverage.\+cc}}\end{DoxyCompactItemize}
