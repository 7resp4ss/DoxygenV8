\hypertarget{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03}{}\doxysection{cppgc\+::internal\+::anonymous\+\_\+namespace\{stats-\/collector.cc\} Namespace Reference}
\label{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03}\index{cppgc::internal::anonymous\_namespace\lcurly{}stats-\/collector.cc\rcurly{}@{cppgc::internal::anonymous\_namespace\lcurly{}stats-\/collector.cc\rcurly{}}}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int64\+\_\+t \mbox{\hyperlink{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03_a21fa701250e7de129858cd18b6c5841d}{Sum\+Phases}} (const \mbox{\hyperlink{structcppgc_1_1internal_1_1MetricRecorder_1_1GCCycle_1_1Phases}{Metric\+Recorder\+::\+GCCycle\+::\+Phases}} \&phases)
\item 
\mbox{\hyperlink{structcppgc_1_1internal_1_1MetricRecorder_1_1GCCycle}{Metric\+Recorder\+::\+GCCycle}} \mbox{\hyperlink{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03_a58a23ce837c6ae4495854b0071e24e40}{Get\+Cycle\+Event\+For\+Metric\+Recorder}} (\mbox{\hyperlink{namespacecppgc_1_1internal_a9a435919d5a4a3ecfdfe20fb93896a60}{Collection\+Type}} type, \mbox{\hyperlink{classcppgc_1_1Heap_a3094861cfe8c736974723e4ad9ca3e20}{Stats\+Collector\+::\+Marking\+Type}} marking\+\_\+type, \mbox{\hyperlink{classcppgc_1_1Heap_a9005da6b2685669d9b1419324e26b8a2}{Stats\+Collector\+::\+Sweeping\+Type}} sweeping\+\_\+type, int64\+\_\+t atomic\+\_\+mark\+\_\+us, int64\+\_\+t atomic\+\_\+weak\+\_\+us, int64\+\_\+t atomic\+\_\+compact\+\_\+us, int64\+\_\+t atomic\+\_\+sweep\+\_\+us, int64\+\_\+t incremental\+\_\+mark\+\_\+us, int64\+\_\+t incremental\+\_\+sweep\+\_\+us, int64\+\_\+t concurrent\+\_\+mark\+\_\+us, int64\+\_\+t concurrent\+\_\+sweep\+\_\+us, int64\+\_\+t objects\+\_\+before\+\_\+bytes, int64\+\_\+t objects\+\_\+after\+\_\+bytes, int64\+\_\+t objects\+\_\+freed\+\_\+bytes, int64\+\_\+t memory\+\_\+before\+\_\+bytes, int64\+\_\+t memory\+\_\+after\+\_\+bytes, int64\+\_\+t memory\+\_\+freed\+\_\+bytes)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03_a58a23ce837c6ae4495854b0071e24e40}\label{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03_a58a23ce837c6ae4495854b0071e24e40}} 
\index{cppgc::internal::anonymous\_namespace\lcurly{}stats-\/collector.cc\rcurly{}@{cppgc::internal::anonymous\_namespace\lcurly{}stats-\/collector.cc\rcurly{}}!GetCycleEventForMetricRecorder@{GetCycleEventForMetricRecorder}}
\index{GetCycleEventForMetricRecorder@{GetCycleEventForMetricRecorder}!cppgc::internal::anonymous\_namespace\lcurly{}stats-\/collector.cc\rcurly{}@{cppgc::internal::anonymous\_namespace\lcurly{}stats-\/collector.cc\rcurly{}}}
\doxysubsubsection{\texorpdfstring{GetCycleEventForMetricRecorder()}{GetCycleEventForMetricRecorder()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structcppgc_1_1internal_1_1MetricRecorder_1_1GCCycle}{Metric\+Recorder\+::\+GCCycle}} cppgc\+::internal\+::anonymous\+\_\+namespace\{stats-\/collector.\+cc\}\+::Get\+Cycle\+Event\+For\+Metric\+Recorder (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacecppgc_1_1internal_a9a435919d5a4a3ecfdfe20fb93896a60}{Collection\+Type}}}]{type,  }\item[{\mbox{\hyperlink{classcppgc_1_1Heap_a3094861cfe8c736974723e4ad9ca3e20}{Stats\+Collector\+::\+Marking\+Type}}}]{marking\+\_\+type,  }\item[{\mbox{\hyperlink{classcppgc_1_1Heap_a9005da6b2685669d9b1419324e26b8a2}{Stats\+Collector\+::\+Sweeping\+Type}}}]{sweeping\+\_\+type,  }\item[{int64\+\_\+t}]{atomic\+\_\+mark\+\_\+us,  }\item[{int64\+\_\+t}]{atomic\+\_\+weak\+\_\+us,  }\item[{int64\+\_\+t}]{atomic\+\_\+compact\+\_\+us,  }\item[{int64\+\_\+t}]{atomic\+\_\+sweep\+\_\+us,  }\item[{int64\+\_\+t}]{incremental\+\_\+mark\+\_\+us,  }\item[{int64\+\_\+t}]{incremental\+\_\+sweep\+\_\+us,  }\item[{int64\+\_\+t}]{concurrent\+\_\+mark\+\_\+us,  }\item[{int64\+\_\+t}]{concurrent\+\_\+sweep\+\_\+us,  }\item[{int64\+\_\+t}]{objects\+\_\+before\+\_\+bytes,  }\item[{int64\+\_\+t}]{objects\+\_\+after\+\_\+bytes,  }\item[{int64\+\_\+t}]{objects\+\_\+freed\+\_\+bytes,  }\item[{int64\+\_\+t}]{memory\+\_\+before\+\_\+bytes,  }\item[{int64\+\_\+t}]{memory\+\_\+after\+\_\+bytes,  }\item[{int64\+\_\+t}]{memory\+\_\+freed\+\_\+bytes }\end{DoxyParamCaption})}



Definition at line 181 of file stats-\/collector.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{189                                                             \{}
\DoxyCodeLine{190   MetricRecorder::GCCycle event;}
\DoxyCodeLine{191   \textcolor{keyword}{event}.type = (\mbox{\hyperlink{namespacev8_1_1internal_1_1tracing_a96000282e12b2483531025283d63154d}{type}} == CollectionType::kMajor)}
\DoxyCodeLine{192                    ? MetricRecorder::GCCycle::Type::kMajor}
\DoxyCodeLine{193                    : MetricRecorder::GCCycle::Type::kMinor;}
\DoxyCodeLine{194   \textcolor{comment}{// MainThread.Incremental:}}
\DoxyCodeLine{195   \textcolor{keyword}{event}.main\_thread\_incremental.mark\_duration\_us =}
\DoxyCodeLine{196       marking\_type != StatsCollector::MarkingType::kAtomic ? incremental\_mark\_us}
\DoxyCodeLine{197                                                            : -\/1;}
\DoxyCodeLine{198   \textcolor{keyword}{event}.main\_thread\_incremental.sweep\_duration\_us =}
\DoxyCodeLine{199       sweeping\_type != StatsCollector::SweepingType::kAtomic}
\DoxyCodeLine{200           ? incremental\_sweep\_us}
\DoxyCodeLine{201           : -\/1;}
\DoxyCodeLine{202   \textcolor{comment}{// MainThread.Atomic:}}
\DoxyCodeLine{203   \textcolor{keyword}{event}.main\_thread\_atomic.mark\_duration\_us = atomic\_mark\_us;}
\DoxyCodeLine{204   \textcolor{keyword}{event}.main\_thread\_atomic.weak\_duration\_us = atomic\_weak\_us;}
\DoxyCodeLine{205   \textcolor{keyword}{event}.main\_thread\_atomic.compact\_duration\_us = atomic\_compact\_us;}
\DoxyCodeLine{206   \textcolor{keyword}{event}.main\_thread\_atomic.sweep\_duration\_us = atomic\_sweep\_us;}
\DoxyCodeLine{207   \textcolor{comment}{// MainThread:}}
\DoxyCodeLine{208   \textcolor{keyword}{event}.main\_thread.mark\_duration\_us =}
\DoxyCodeLine{209       \textcolor{keyword}{event}.main\_thread\_atomic.mark\_duration\_us + incremental\_mark\_us;}
\DoxyCodeLine{210   \textcolor{keyword}{event}.main\_thread.weak\_duration\_us =}
\DoxyCodeLine{211       \textcolor{keyword}{event}.main\_thread\_atomic.weak\_duration\_us;}
\DoxyCodeLine{212   \textcolor{keyword}{event}.main\_thread.compact\_duration\_us =}
\DoxyCodeLine{213       \textcolor{keyword}{event}.main\_thread\_atomic.compact\_duration\_us;}
\DoxyCodeLine{214   \textcolor{keyword}{event}.main\_thread.sweep\_duration\_us =}
\DoxyCodeLine{215       \textcolor{keyword}{event}.main\_thread\_atomic.sweep\_duration\_us + incremental\_sweep\_us;}
\DoxyCodeLine{216   \textcolor{comment}{// Total:}}
\DoxyCodeLine{217   \textcolor{keyword}{event}.total.mark\_duration\_us =}
\DoxyCodeLine{218       \textcolor{keyword}{event}.main\_thread.mark\_duration\_us + concurrent\_mark\_us;}
\DoxyCodeLine{219   \textcolor{keyword}{event}.total.weak\_duration\_us = \textcolor{keyword}{event}.main\_thread.weak\_duration\_us;}
\DoxyCodeLine{220   \textcolor{keyword}{event}.total.compact\_duration\_us = \textcolor{keyword}{event}.main\_thread.compact\_duration\_us;}
\DoxyCodeLine{221   \textcolor{keyword}{event}.total.sweep\_duration\_us =}
\DoxyCodeLine{222       \textcolor{keyword}{event}.main\_thread.sweep\_duration\_us + concurrent\_sweep\_us;}
\DoxyCodeLine{223   \textcolor{comment}{// Objects:}}
\DoxyCodeLine{224   \textcolor{keyword}{event}.objects.before\_bytes = objects\_before\_bytes;}
\DoxyCodeLine{225   \textcolor{keyword}{event}.objects.after\_bytes = objects\_after\_bytes;}
\DoxyCodeLine{226   \textcolor{keyword}{event}.objects.freed\_bytes = objects\_freed\_bytes;}
\DoxyCodeLine{227   \textcolor{comment}{// Memory:}}
\DoxyCodeLine{228   \textcolor{keyword}{event}.memory.before\_bytes = memory\_before\_bytes;}
\DoxyCodeLine{229   \textcolor{keyword}{event}.memory.after\_bytes = memory\_after\_bytes;}
\DoxyCodeLine{230   \textcolor{keyword}{event}.memory.freed\_bytes = memory\_freed\_bytes;}
\DoxyCodeLine{231   \textcolor{comment}{// Collection Rate:}}
\DoxyCodeLine{232   \textcolor{keywordflow}{if} (event.objects.before\_bytes == 0) \{}
\DoxyCodeLine{233     \textcolor{keyword}{event}.collection\_rate\_in\_percent = 0;}
\DoxyCodeLine{234   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{235     \textcolor{keyword}{event}.collection\_rate\_in\_percent =}
\DoxyCodeLine{236         \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\textcolor{keyword}{event}.objects.freed\_bytes) /}
\DoxyCodeLine{237         event.objects.before\_bytes;}
\DoxyCodeLine{238   \}}
\DoxyCodeLine{239   \textcolor{comment}{// Efficiency:}}
\DoxyCodeLine{240   \textcolor{keywordflow}{if} (event.objects.freed\_bytes == 0) \{}
\DoxyCodeLine{241     \textcolor{keyword}{event}.efficiency\_in\_bytes\_per\_us = 0;}
\DoxyCodeLine{242     \textcolor{keyword}{event}.main\_thread\_efficiency\_in\_bytes\_per\_us = 0;}
\DoxyCodeLine{243   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{244     \textcolor{comment}{// Here, SumPhases(event.main\_thread) or even SumPhases(event.total) can be}}
\DoxyCodeLine{245     \textcolor{comment}{// zero if the clock resolution is not small enough and the entire GC was}}
\DoxyCodeLine{246     \textcolor{comment}{// very short, so the timed value was zero. This appears to happen on}}
\DoxyCodeLine{247     \textcolor{comment}{// Windows, see crbug.com/1338256 and crbug.com/1339180. In this case, we}}
\DoxyCodeLine{248     \textcolor{comment}{// are only here if the number of freed bytes is nonzero and the division}}
\DoxyCodeLine{249     \textcolor{comment}{// below produces an infinite value.}}
\DoxyCodeLine{250     \textcolor{keyword}{event}.efficiency\_in\_bytes\_per\_us =}
\DoxyCodeLine{251         \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\textcolor{keyword}{event}.objects.freed\_bytes) / \mbox{\hyperlink{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03_a21fa701250e7de129858cd18b6c5841d}{SumPhases}}(event.total);}
\DoxyCodeLine{252     \textcolor{keyword}{event}.main\_thread\_efficiency\_in\_bytes\_per\_us =}
\DoxyCodeLine{253         \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\textcolor{keyword}{event}.objects.freed\_bytes) /}
\DoxyCodeLine{254         \mbox{\hyperlink{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03_a21fa701250e7de129858cd18b6c5841d}{SumPhases}}(event.main\_thread);}
\DoxyCodeLine{255   \}}
\DoxyCodeLine{256   \textcolor{keywordflow}{return} event;}
\DoxyCodeLine{257 \}}

\end{DoxyCode}


References cppgc\+::internal\+::\+Metric\+Recorder\+::\+GCCycle\+::\+Sizes\+::before\+\_\+bytes, cppgc\+::internal\+::\+Metric\+Recorder\+::\+GCCycle\+::\+Sizes\+::freed\+\_\+bytes, cppgc\+::\+Heap\+::k\+Atomic, cppgc\+::internal\+::k\+Major, cppgc\+::internal\+::\+Metric\+Recorder\+::\+GCCycle\+::k\+Major, cppgc\+::internal\+::\+Metric\+Recorder\+::\+GCCycle\+::k\+Minor, cppgc\+::internal\+::\+Metric\+Recorder\+::\+GCCycle\+::main\+\_\+thread, cppgc\+::internal\+::\+Metric\+Recorder\+::\+GCCycle\+::objects, Sum\+Phases(), cppgc\+::internal\+::\+Metric\+Recorder\+::\+GCCycle\+::total, cppgc\+::internal\+::\+Metric\+Recorder\+::\+GCCycle\+::type, and v8\+::internal\+::tracing\+::type.



Referenced by cppgc\+::internal\+::\+Stats\+Collector\+::\+Notify\+Sweeping\+Completed().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03_a58a23ce837c6ae4495854b0071e24e40_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03_a58a23ce837c6ae4495854b0071e24e40_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03_a21fa701250e7de129858cd18b6c5841d}\label{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03_a21fa701250e7de129858cd18b6c5841d}} 
\index{cppgc::internal::anonymous\_namespace\lcurly{}stats-\/collector.cc\rcurly{}@{cppgc::internal::anonymous\_namespace\lcurly{}stats-\/collector.cc\rcurly{}}!SumPhases@{SumPhases}}
\index{SumPhases@{SumPhases}!cppgc::internal::anonymous\_namespace\lcurly{}stats-\/collector.cc\rcurly{}@{cppgc::internal::anonymous\_namespace\lcurly{}stats-\/collector.cc\rcurly{}}}
\doxysubsubsection{\texorpdfstring{SumPhases()}{SumPhases()}}
{\footnotesize\ttfamily int64\+\_\+t cppgc\+::internal\+::anonymous\+\_\+namespace\{stats-\/collector.\+cc\}\+::Sum\+Phases (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structcppgc_1_1internal_1_1MetricRecorder_1_1GCCycle_1_1Phases}{Metric\+Recorder\+::\+GCCycle\+::\+Phases}} \&}]{phases }\end{DoxyParamCaption})}



Definition at line 172 of file stats-\/collector.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{172                                                              \{}
\DoxyCodeLine{173   \mbox{\hyperlink{src_2base_2logging_8h_a16b382527f19b805fc8f856668f2270b}{DCHECK\_LE}}(0, phases.mark\_duration\_us);}
\DoxyCodeLine{174   \mbox{\hyperlink{src_2base_2logging_8h_a16b382527f19b805fc8f856668f2270b}{DCHECK\_LE}}(0, phases.weak\_duration\_us);}
\DoxyCodeLine{175   \mbox{\hyperlink{src_2base_2logging_8h_a16b382527f19b805fc8f856668f2270b}{DCHECK\_LE}}(0, phases.compact\_duration\_us);}
\DoxyCodeLine{176   \mbox{\hyperlink{src_2base_2logging_8h_a16b382527f19b805fc8f856668f2270b}{DCHECK\_LE}}(0, phases.sweep\_duration\_us);}
\DoxyCodeLine{177   \textcolor{keywordflow}{return} phases.mark\_duration\_us + phases.weak\_duration\_us +}
\DoxyCodeLine{178          phases.compact\_duration\_us + phases.sweep\_duration\_us;}
\DoxyCodeLine{179 \}}

\end{DoxyCode}


References cppgc\+::internal\+::\+Metric\+Recorder\+::\+GCCycle\+::\+Phases\+::compact\+\_\+duration\+\_\+us, DCHECK\+\_\+\+LE, cppgc\+::internal\+::\+Metric\+Recorder\+::\+GCCycle\+::\+Incremental\+Phases\+::mark\+\_\+duration\+\_\+us, cppgc\+::internal\+::\+Metric\+Recorder\+::\+GCCycle\+::\+Incremental\+Phases\+::sweep\+\_\+duration\+\_\+us, and cppgc\+::internal\+::\+Metric\+Recorder\+::\+GCCycle\+::\+Phases\+::weak\+\_\+duration\+\_\+us.



Referenced by Get\+Cycle\+Event\+For\+Metric\+Recorder().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecppgc_1_1internal_1_1anonymous__namespace_02stats-collector_8cc_03_a21fa701250e7de129858cd18b6c5841d_icgraph}
\end{center}
\end{figure}
