\hypertarget{classcppgc_1_1DefaultPlatform}{}\doxysection{cppgc\+::Default\+Platform Class Reference}
\label{classcppgc_1_1DefaultPlatform}\index{cppgc::DefaultPlatform@{cppgc::DefaultPlatform}}


\mbox{\hyperlink{classcppgc_1_1Platform}{Platform}} provided by cppgc.  




{\ttfamily \#include $<$default-\/platform.\+h$>$}



Inheritance diagram for cppgc\+::Default\+Platform\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=259pt]{classcppgc_1_1DefaultPlatform__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for cppgc\+::Default\+Platform\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classcppgc_1_1DefaultPlatform__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
using \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_ade8c2e9d68c5663450565e597a45e196}{Idle\+Task\+Support}} = \mbox{\hyperlink{namespacev8_1_1platform_abfec9b5c3f79b64e8edbf023708be318}{v8\+::platform\+::\+Idle\+Task\+Support}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a551a76506a6e2e934c688bf857e6aa99}{Default\+Platform}} (\mbox{\hyperlink{classint}{int}} thread\+\_\+pool\+\_\+size=0, \mbox{\hyperlink{namespacev8_1_1platform_abfec9b5c3f79b64e8edbf023708be318}{Idle\+Task\+Support}} idle\+\_\+task\+\_\+support=\mbox{\hyperlink{namespacev8_1_1platform_abfec9b5c3f79b64e8edbf023708be318a7b04d8795f5fd03c761ce70dab985fee}{Idle\+Task\+Support\+::k\+Disabled}}, std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{namespacecppgc_a28c3d393aadf0a5ef0847ae1657a60bb}{Tracing\+Controller}} $>$ tracing\+\_\+controller=\{\})
\item 
\mbox{\hyperlink{namespacecppgc_ae7d41c486a869bec62aa1b8c9c55c142}{cppgc\+::\+Page\+Allocator}} $\ast$ \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a10b3454d1a07aaaaeeca2c939073abfa}{Get\+Page\+Allocator}} () override
\item 
double \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_af00442dae93371d546837360a6c2705f}{Monotonically\+Increasing\+Time}} () override
\begin{DoxyCompactList}\small\item\em Monotonically increasing time in seconds from an arbitrary fixed point in the past. \end{DoxyCompactList}\item 
std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{namespacecppgc_a3c2b2bee060b35e6507a2d25c5e5abc7}{cppgc\+::\+Task\+Runner}} $>$ \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_af26ce14586beb26a1be7dd237fe10635}{Get\+Foreground\+Task\+Runner}} (\mbox{\hyperlink{namespacev8_a680c1a715d1d5df94b21e8b1ee1bf051}{Task\+Priority}} priority) override
\begin{DoxyCompactList}\small\item\em Returns a Task\+Runner with a specific $\vert$priority$\vert$ which can be used to post a task on the foreground thread. \end{DoxyCompactList}\item 
std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{namespacecppgc_a4607b4a641e66d8d659a26e3de353799}{cppgc\+::\+Job\+Handle}} $>$ \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a3ffe0ec3434b231a0c48c37c8f945ee1}{Post\+Job}} (\mbox{\hyperlink{namespacev8_a680c1a715d1d5df94b21e8b1ee1bf051}{cppgc\+::\+Task\+Priority}} priority, std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{namespacecppgc_af642e7a654c11a50fc291a85840537c8}{cppgc\+::\+Job\+Task}} $>$ job\+\_\+task) override
\begin{DoxyCompactList}\small\item\em Posts {\ttfamily job\+\_\+task} to run in parallel. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacecppgc_a28c3d393aadf0a5ef0847ae1657a60bb}{Tracing\+Controller}} $\ast$ \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_ae90a60665a260ab7ca21f1b1ea8665d0}{Get\+Tracing\+Controller}} () override
\begin{DoxyCompactList}\small\item\em Returns an instance of a {\ttfamily Tracing\+Controller}. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classv8_1_1Platform}{v8\+::\+Platform}} $\ast$ \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a0996d28ac9d0a0861244f3ddef2a72d5}{Get\+V8\+Platform}} () const
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1Platform}{v8\+::\+Platform}} $>$ \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a9b5b32e44b196f62f07c26df216b01b4}{v8\+\_\+platform\+\_\+}}
\end{DoxyCompactItemize}
\doxysubsection*{Static Protected Attributes}
\begin{DoxyCompactItemize}
\item 
static constexpr \mbox{\hyperlink{classv8_1_1Isolate}{v8\+::\+Isolate}} $\ast$ \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a93cd56403f15bdb84cdfce39c28c3e4f}{k\+No\+Isolate}} = \mbox{\hyperlink{flag-definitions_8h_aca14fbede0905858c819226fce3678cc}{nullptr}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\mbox{\hyperlink{classcppgc_1_1Platform}{Platform}} provided by cppgc. 

Uses V8\textquotesingle{}s \mbox{\hyperlink{classcppgc_1_1DefaultPlatform}{Default\+Platform}} provided by libplatform internally. Exception\+: {\ttfamily \mbox{\hyperlink{classcppgc_1_1Platform_a0dbe1a8407043f1cf645266b62dbf7f5}{Get\+Foreground\+Task\+Runner()}}}, see below. 

Definition at line 20 of file default-\/platform.\+h.



\doxysubsection{Member Typedef Documentation}
\mbox{\Hypertarget{classcppgc_1_1DefaultPlatform_ade8c2e9d68c5663450565e597a45e196}\label{classcppgc_1_1DefaultPlatform_ade8c2e9d68c5663450565e597a45e196}} 
\index{cppgc::DefaultPlatform@{cppgc::DefaultPlatform}!IdleTaskSupport@{IdleTaskSupport}}
\index{IdleTaskSupport@{IdleTaskSupport}!cppgc::DefaultPlatform@{cppgc::DefaultPlatform}}
\doxysubsubsection{\texorpdfstring{IdleTaskSupport}{IdleTaskSupport}}
{\footnotesize\ttfamily using \mbox{\hyperlink{namespacev8_1_1platform_abfec9b5c3f79b64e8edbf023708be318}{cppgc\+::\+Default\+Platform\+::\+Idle\+Task\+Support}} =  \mbox{\hyperlink{namespacev8_1_1platform_abfec9b5c3f79b64e8edbf023708be318}{v8\+::platform\+::\+Idle\+Task\+Support}}}



Definition at line 22 of file default-\/platform.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classcppgc_1_1DefaultPlatform_a551a76506a6e2e934c688bf857e6aa99}\label{classcppgc_1_1DefaultPlatform_a551a76506a6e2e934c688bf857e6aa99}} 
\index{cppgc::DefaultPlatform@{cppgc::DefaultPlatform}!DefaultPlatform@{DefaultPlatform}}
\index{DefaultPlatform@{DefaultPlatform}!cppgc::DefaultPlatform@{cppgc::DefaultPlatform}}
\doxysubsubsection{\texorpdfstring{DefaultPlatform()}{DefaultPlatform()}}
{\footnotesize\ttfamily cppgc\+::\+Default\+Platform\+::\+Default\+Platform (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classint}{int}}}]{thread\+\_\+pool\+\_\+size = {\ttfamily 0},  }\item[{\mbox{\hyperlink{namespacev8_1_1platform_abfec9b5c3f79b64e8edbf023708be318}{Idle\+Task\+Support}}}]{idle\+\_\+task\+\_\+support = {\ttfamily \mbox{\hyperlink{namespacev8_1_1platform_abfec9b5c3f79b64e8edbf023708be318a7b04d8795f5fd03c761ce70dab985fee}{Idle\+Task\+Support\+::k\+Disabled}}},  }\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{namespacecppgc_a28c3d393aadf0a5ef0847ae1657a60bb}{Tracing\+Controller}} $>$}]{tracing\+\_\+controller = {\ttfamily \{\}} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}



Definition at line 23 of file default-\/platform.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{26                                                             \{\})}
\DoxyCodeLine{27       : \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a9b5b32e44b196f62f07c26df216b01b4}{v8\_platform\_}}(\mbox{\hyperlink{namespacev8_1_1platform_acfab14c1076e4c2cc8fa2f1d1c76f1ac}{v8::platform::NewDefaultPlatform}}(}
\DoxyCodeLine{28             thread\_pool\_size, idle\_task\_support,}
\DoxyCodeLine{29             \mbox{\hyperlink{namespacev8_1_1platform_ac9dba75667058fba3443e60ca0356591a7b04d8795f5fd03c761ce70dab985fee}{v8::platform::InProcessStackDumping::kDisabled}},}
\DoxyCodeLine{30             std::move(tracing\_controller))) \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classcppgc_1_1DefaultPlatform_af26ce14586beb26a1be7dd237fe10635}\label{classcppgc_1_1DefaultPlatform_af26ce14586beb26a1be7dd237fe10635}} 
\index{cppgc::DefaultPlatform@{cppgc::DefaultPlatform}!GetForegroundTaskRunner@{GetForegroundTaskRunner}}
\index{GetForegroundTaskRunner@{GetForegroundTaskRunner}!cppgc::DefaultPlatform@{cppgc::DefaultPlatform}}
\doxysubsubsection{\texorpdfstring{GetForegroundTaskRunner()}{GetForegroundTaskRunner()}}
{\footnotesize\ttfamily std\+::shared\+\_\+ptr$<$\mbox{\hyperlink{namespacecppgc_a3c2b2bee060b35e6507a2d25c5e5abc7}{cppgc\+::\+Task\+Runner}}$>$ cppgc\+::\+Default\+Platform\+::\+Get\+Foreground\+Task\+Runner (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacev8_a680c1a715d1d5df94b21e8b1ee1bf051}{Task\+Priority}}}]{priority }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Returns a Task\+Runner with a specific $\vert$priority$\vert$ which can be used to post a task on the foreground thread. 



Reimplemented from \mbox{\hyperlink{classcppgc_1_1Platform_ae48a2caa736eaad9cc827bcad1e2e8c1}{cppgc\+::\+Platform}}.



Definition at line 40 of file default-\/platform.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{41                                       \{}
\DoxyCodeLine{42     \textcolor{comment}{// V8's default platform creates a new task runner when passed the}}
\DoxyCodeLine{43     \textcolor{comment}{// `v8::Isolate` pointer the first time. For non-\/default platforms this will}}
\DoxyCodeLine{44     \textcolor{comment}{// require getting the appropriate task runner.}}
\DoxyCodeLine{45     \textcolor{keywordflow}{return} \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a9b5b32e44b196f62f07c26df216b01b4}{v8\_platform\_}}-\/>GetForegroundTaskRunner(\mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a93cd56403f15bdb84cdfce39c28c3e4f}{kNoIsolate}}, priority);}
\DoxyCodeLine{46   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcppgc_1_1DefaultPlatform_a10b3454d1a07aaaaeeca2c939073abfa}\label{classcppgc_1_1DefaultPlatform_a10b3454d1a07aaaaeeca2c939073abfa}} 
\index{cppgc::DefaultPlatform@{cppgc::DefaultPlatform}!GetPageAllocator@{GetPageAllocator}}
\index{GetPageAllocator@{GetPageAllocator}!cppgc::DefaultPlatform@{cppgc::DefaultPlatform}}
\doxysubsubsection{\texorpdfstring{GetPageAllocator()}{GetPageAllocator()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacecppgc_ae7d41c486a869bec62aa1b8c9c55c142}{cppgc\+::\+Page\+Allocator}}$\ast$ cppgc\+::\+Default\+Platform\+::\+Get\+Page\+Allocator (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

\begin{DoxyReturn}{Returns}
the allocator used by cppgc to allocate its heap and various support structures. Returning nullptr results in using the {\ttfamily Page\+Allocator} provided by {\ttfamily \mbox{\hyperlink{namespacecppgc_a7dc95658081246e6b9d4279d6a94bee6}{cppgc\+::\+Initialize\+Process()}}} instead. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classcppgc_1_1Platform_a495855d4b25ce29041eaa683b066623e}{cppgc\+::\+Platform}}.



Definition at line 32 of file default-\/platform.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{32                                                   \{}
\DoxyCodeLine{33     \textcolor{keywordflow}{return} \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a9b5b32e44b196f62f07c26df216b01b4}{v8\_platform\_}}-\/>GetPageAllocator();}
\DoxyCodeLine{34   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcppgc_1_1DefaultPlatform_ae90a60665a260ab7ca21f1b1ea8665d0}\label{classcppgc_1_1DefaultPlatform_ae90a60665a260ab7ca21f1b1ea8665d0}} 
\index{cppgc::DefaultPlatform@{cppgc::DefaultPlatform}!GetTracingController@{GetTracingController}}
\index{GetTracingController@{GetTracingController}!cppgc::DefaultPlatform@{cppgc::DefaultPlatform}}
\doxysubsubsection{\texorpdfstring{GetTracingController()}{GetTracingController()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacecppgc_a28c3d393aadf0a5ef0847ae1657a60bb}{Tracing\+Controller}}$\ast$ cppgc\+::\+Default\+Platform\+::\+Get\+Tracing\+Controller (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Returns an instance of a {\ttfamily Tracing\+Controller}. 

This must be non-\/nullptr. The default implementation returns an empty {\ttfamily Tracing\+Controller} that consumes trace data without effect. 

Reimplemented from \mbox{\hyperlink{classcppgc_1_1Platform_a449d2d2e535fa36e830d59fc43823226}{cppgc\+::\+Platform}}.



Definition at line 54 of file default-\/platform.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{54                                                      \{}
\DoxyCodeLine{55     \textcolor{keywordflow}{return} \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a9b5b32e44b196f62f07c26df216b01b4}{v8\_platform\_}}-\/>GetTracingController();}
\DoxyCodeLine{56   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcppgc_1_1DefaultPlatform_a0996d28ac9d0a0861244f3ddef2a72d5}\label{classcppgc_1_1DefaultPlatform_a0996d28ac9d0a0861244f3ddef2a72d5}} 
\index{cppgc::DefaultPlatform@{cppgc::DefaultPlatform}!GetV8Platform@{GetV8Platform}}
\index{GetV8Platform@{GetV8Platform}!cppgc::DefaultPlatform@{cppgc::DefaultPlatform}}
\doxysubsubsection{\texorpdfstring{GetV8Platform()}{GetV8Platform()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1Platform}{v8\+::\+Platform}}$\ast$ cppgc\+::\+Default\+Platform\+::\+Get\+V8\+Platform (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 58 of file default-\/platform.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{58 \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a9b5b32e44b196f62f07c26df216b01b4}{v8\_platform\_}}.get(); \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcppgc_1_1DefaultPlatform_af00442dae93371d546837360a6c2705f}\label{classcppgc_1_1DefaultPlatform_af00442dae93371d546837360a6c2705f}} 
\index{cppgc::DefaultPlatform@{cppgc::DefaultPlatform}!MonotonicallyIncreasingTime@{MonotonicallyIncreasingTime}}
\index{MonotonicallyIncreasingTime@{MonotonicallyIncreasingTime}!cppgc::DefaultPlatform@{cppgc::DefaultPlatform}}
\doxysubsubsection{\texorpdfstring{MonotonicallyIncreasingTime()}{MonotonicallyIncreasingTime()}}
{\footnotesize\ttfamily double cppgc\+::\+Default\+Platform\+::\+Monotonically\+Increasing\+Time (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Monotonically increasing time in seconds from an arbitrary fixed point in the past. 

This function is expected to return at least millisecond-\/precision values. For this reason, it is recommended that the fixed point be no further in the past than the epoch. 

Implements \mbox{\hyperlink{classcppgc_1_1Platform_a84e8ad12fbf3693eceffe3477166798a}{cppgc\+::\+Platform}}.



Definition at line 36 of file default-\/platform.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{36                                                 \{}
\DoxyCodeLine{37     \textcolor{keywordflow}{return} \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a9b5b32e44b196f62f07c26df216b01b4}{v8\_platform\_}}-\/>MonotonicallyIncreasingTime();}
\DoxyCodeLine{38   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcppgc_1_1DefaultPlatform_a3ffe0ec3434b231a0c48c37c8f945ee1}\label{classcppgc_1_1DefaultPlatform_a3ffe0ec3434b231a0c48c37c8f945ee1}} 
\index{cppgc::DefaultPlatform@{cppgc::DefaultPlatform}!PostJob@{PostJob}}
\index{PostJob@{PostJob}!cppgc::DefaultPlatform@{cppgc::DefaultPlatform}}
\doxysubsubsection{\texorpdfstring{PostJob()}{PostJob()}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$\mbox{\hyperlink{namespacecppgc_a4607b4a641e66d8d659a26e3de353799}{cppgc\+::\+Job\+Handle}}$>$ cppgc\+::\+Default\+Platform\+::\+Post\+Job (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacev8_a680c1a715d1d5df94b21e8b1ee1bf051}{cppgc\+::\+Task\+Priority}}}]{priority,  }\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{namespacecppgc_af642e7a654c11a50fc291a85840537c8}{cppgc\+::\+Job\+Task}} $>$}]{job\+\_\+task }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Posts {\ttfamily job\+\_\+task} to run in parallel. 

Returns a {\ttfamily Job\+Handle} associated with the {\ttfamily Job}, which can be joined or canceled. This avoids degenerate cases\+:
\begin{DoxyItemize}
\item Calling {\ttfamily Call\+On\+Worker\+Thread()} for each work item, causing significant overhead.
\item Fixed number of {\ttfamily Call\+On\+Worker\+Thread()} calls that split the work and might run for a long time. This is problematic when many components post \char`\"{}num cores\char`\"{} tasks and all expect to use all the cores. In these cases, the scheduler lacks context to be fair to multiple same-\/priority requests and/or ability to request lower priority work to yield when high priority work comes in. A canonical implementation of {\ttfamily job\+\_\+task} looks like\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{class }MyJobTask : \textcolor{keyword}{public} \mbox{\hyperlink{namespacecppgc_af642e7a654c11a50fc291a85840537c8}{JobTask}} \{}
\DoxyCodeLine{ \textcolor{keyword}{public}:}
\DoxyCodeLine{  MyJobTask(...) : worker\_queue\_(...) \{\}}
\DoxyCodeLine{  \textcolor{comment}{// JobTask implementation.}}
\DoxyCodeLine{  \textcolor{keywordtype}{void} Run(\mbox{\hyperlink{namespacecppgc_a74aa606ef974ec10b401c6538a239245}{JobDelegate}}* delegate)\textcolor{keyword}{ override }\{}
\DoxyCodeLine{    \textcolor{keywordflow}{while} (!delegate-\/>ShouldYield()) \{}
\DoxyCodeLine{      \textcolor{comment}{// Smallest unit of work.}}
\DoxyCodeLine{      \textcolor{keyword}{auto} work\_item = worker\_queue\_.TakeWorkItem(); \textcolor{comment}{// Thread safe.}}
\DoxyCodeLine{      \textcolor{keywordflow}{if} (!work\_item) \textcolor{keywordflow}{return};}
\DoxyCodeLine{      ProcessWork(work\_item);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} GetMaxConcurrency()\textcolor{keyword}{ const override }\{}
\DoxyCodeLine{    \textcolor{keywordflow}{return} worker\_queue\_.GetSize(); \textcolor{comment}{// Thread safe.}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// ...}}
\DoxyCodeLine{\textcolor{keyword}{auto} \mbox{\hyperlink{namespacev8_1_1internal_a8c89f00da07e125218128b9fbf0a321c}{handle}} = \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a3ffe0ec3434b231a0c48c37c8f945ee1}{PostJob}}(\mbox{\hyperlink{namespacev8_a680c1a715d1d5df94b21e8b1ee1bf051a602dfdb2b16ea7a1f4392dc3d5761f7d}{TaskPriority::kUserVisible}},}
\DoxyCodeLine{                      std::make\_unique<MyJobTask>(...));}
\DoxyCodeLine{\mbox{\hyperlink{namespacev8_1_1internal_a8c89f00da07e125218128b9fbf0a321c}{handle}}-\/>Join();}

\end{DoxyCode}

\end{DoxyItemize}

{\ttfamily \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a3ffe0ec3434b231a0c48c37c8f945ee1}{Post\+Job()}}} and methods of the returned Job\+Handle/\+Job\+Delegate, must never be called while holding a lock that could be acquired by {\ttfamily \mbox{\hyperlink{classv8_1_1JobTask_a9b6d0cee5615420f30b0db8a4c5e8c3b}{Job\+Task\+::\+Run()}}} or {\ttfamily \mbox{\hyperlink{classv8_1_1JobTask_a9f1505551639903b327baecbeb38f6f7}{Job\+Task\+::\+Get\+Max\+Concurrency()}}} -- that could result in a deadlock. This is because (1) {\ttfamily \mbox{\hyperlink{classv8_1_1JobTask_a9f1505551639903b327baecbeb38f6f7}{Job\+Task\+::\+Get\+Max\+Concurrency()}}} may be invoked while holding internal lock (A), hence {\ttfamily \mbox{\hyperlink{classv8_1_1JobTask_a9f1505551639903b327baecbeb38f6f7}{Job\+Task\+::\+Get\+Max\+Concurrency()}}} can only use a lock (B) if that lock is {\itshape never} held while calling back into {\ttfamily Job\+Handle} from any thread (A=$>$B/B=$>$A deadlock) and (2) {\ttfamily \mbox{\hyperlink{classv8_1_1JobTask_a9b6d0cee5615420f30b0db8a4c5e8c3b}{Job\+Task\+::\+Run()}}} or {\ttfamily \mbox{\hyperlink{classv8_1_1JobTask_a9f1505551639903b327baecbeb38f6f7}{Job\+Task\+::\+Get\+Max\+Concurrency()}}} may be invoked synchronously from {\ttfamily Job\+Handle} (B=$>$Job\+Handle\+::foo=$>$B deadlock).

A sufficient {\ttfamily \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a3ffe0ec3434b231a0c48c37c8f945ee1}{Post\+Job()}}} implementation that uses the default Job provided in libplatform looks like\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{std::unique\_ptr<JobHandle> \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a3ffe0ec3434b231a0c48c37c8f945ee1}{PostJob}}(}
\DoxyCodeLine{    \mbox{\hyperlink{namespacecppgc_a3285e0ac166437006ff97f42ce2fad4c}{TaskPriority}} priority, std::unique\_ptr<JobTask> job\_task)\textcolor{keyword}{ override }\{}
\DoxyCodeLine{  \textcolor{keywordflow}{return} std::make\_unique<DefaultJobHandle>(}
\DoxyCodeLine{      std::make\_shared<DefaultJobState>(}
\DoxyCodeLine{          \textcolor{keyword}{this}, std::move(job\_task), kNumThreads));}
\DoxyCodeLine{\}}

\end{DoxyCode}
 

Reimplemented from \mbox{\hyperlink{classcppgc_1_1Platform_a6cd9224a397cb79d4c56e3f0dc163c74}{cppgc\+::\+Platform}}.



Definition at line 48 of file default-\/platform.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{50                                                      \{}
\DoxyCodeLine{51     \textcolor{keywordflow}{return} \mbox{\hyperlink{classcppgc_1_1DefaultPlatform_a9b5b32e44b196f62f07c26df216b01b4}{v8\_platform\_}}-\/>PostJob(priority, std::move(job\_task));}
\DoxyCodeLine{52   \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classcppgc_1_1DefaultPlatform_a93cd56403f15bdb84cdfce39c28c3e4f}\label{classcppgc_1_1DefaultPlatform_a93cd56403f15bdb84cdfce39c28c3e4f}} 
\index{cppgc::DefaultPlatform@{cppgc::DefaultPlatform}!kNoIsolate@{kNoIsolate}}
\index{kNoIsolate@{kNoIsolate}!cppgc::DefaultPlatform@{cppgc::DefaultPlatform}}
\doxysubsubsection{\texorpdfstring{kNoIsolate}{kNoIsolate}}
{\footnotesize\ttfamily constexpr \mbox{\hyperlink{classv8_1_1Isolate}{v8\+::\+Isolate}}$\ast$ cppgc\+::\+Default\+Platform\+::k\+No\+Isolate = \mbox{\hyperlink{flag-definitions_8h_aca14fbede0905858c819226fce3678cc}{nullptr}}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}, {\ttfamily [protected]}}



Definition at line 61 of file default-\/platform.\+h.

\mbox{\Hypertarget{classcppgc_1_1DefaultPlatform_a9b5b32e44b196f62f07c26df216b01b4}\label{classcppgc_1_1DefaultPlatform_a9b5b32e44b196f62f07c26df216b01b4}} 
\index{cppgc::DefaultPlatform@{cppgc::DefaultPlatform}!v8\_platform\_@{v8\_platform\_}}
\index{v8\_platform\_@{v8\_platform\_}!cppgc::DefaultPlatform@{cppgc::DefaultPlatform}}
\doxysubsubsection{\texorpdfstring{v8\_platform\_}{v8\_platform\_}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$\mbox{\hyperlink{classv8_1_1Platform}{v8\+::\+Platform}}$>$ cppgc\+::\+Default\+Platform\+::v8\+\_\+platform\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 63 of file default-\/platform.\+h.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/mnt/\+V8\+Source\+Code/include/cppgc/\mbox{\hyperlink{include_2cppgc_2default-platform_8h}{default-\/platform.\+h}}\end{DoxyCompactItemize}
