\hypertarget{classv8_1_1internal_1_1JSFinalizationRegistry}{}\doxysection{v8\+::internal\+::JSFinalization\+Registry Class Reference}
\label{classv8_1_1internal_1_1JSFinalizationRegistry}\index{v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}}


{\ttfamily \#include $<$js-\/weak-\/refs.\+h$>$}



Inheritance diagram for v8\+::internal\+::JSFinalization\+Registry\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=268pt]{classv8_1_1internal_1_1JSFinalizationRegistry__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for v8\+::internal\+::JSFinalization\+Registry\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=268pt]{classv8_1_1internal_1_1JSFinalizationRegistry__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_1_1BodyDescriptor}{Body\+Descriptor}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7}{Remove\+Unregister\+Token\+Mode}} \{ \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7a9121e50975a8359ce49b1becb757575b}{k\+Remove\+Matched\+Cells\+From\+Registry}}
, \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7a8317217427808991ad5756a7e7528643}{k\+Keep\+Matched\+Cells\+In\+Registry}}
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename GCNotify\+Updated\+Slot\+Callback $>$ }\\\mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_aba194e90349a70afbc6612047ef8abdb}{Remove\+Unregister\+Token}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1HeapObject}{Heap\+Object}} $>$ unregister\+\_\+token, \mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7}{Remove\+Unregister\+Token\+Mode}} removal\+\_\+mode, GCNotify\+Updated\+Slot\+Callback gc\+\_\+notify\+\_\+updated\+\_\+slot)
\item 
\mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_a946328a9b43059f352b4934a3fe636dc}{Needs\+Cleanup}} () const
\item 
\mbox{\hyperlink{src_2base_2macros_8h_ab08e353943a53678ac6baafc678f2d81}{V8\+\_\+\+EXPORT\+\_\+\+PRIVATE}} \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakCell}{Weak\+Cell}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_ab306a5ca4c9e289f271f4cc2a2bd34d7}{Pop\+Cleared\+Cell}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} $\ast$key\+\_\+map\+\_\+may\+\_\+need\+\_\+shrink)
\item 
\mbox{\hyperlink{src_2base_2macros_8h_ab08e353943a53678ac6baafc678f2d81}{V8\+\_\+\+EXPORT\+\_\+\+PRIVATE}} void \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_a7066e6a07c444d9c75895d90abdb841e}{Remove\+Cell\+From\+Unregister\+Token\+Map}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakCell}{Weak\+Cell}} $>$ weak\+\_\+cell)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_a79a6818eb3ede3874b8b15298667ca92}{Register\+Weak\+Cell\+With\+Unregister\+Token}} (\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry}{JSFinalization\+Registry}} $>$ finalization\+\_\+registry, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakCell}{Weak\+Cell}} $>$ weak\+\_\+cell, \mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate)
\item 
static \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_a1965c86a848b56e274d63fc15534d72c}{Unregister}} (\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry}{JSFinalization\+Registry}} $>$ finalization\+\_\+registry, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1HeapObject}{Heap\+Object}} $>$ unregister\+\_\+token, \mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate)
\item 
static void \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_a313415e97ce5c1625b4096a125ff6ae0}{Shrink\+Key\+Map}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry}{JSFinalization\+Registry}} $>$ finalization\+\_\+registry)
\item 
static \mbox{\hyperlink{classv8_1_1Maybe}{Maybe}}$<$ \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_ac96f7509b33f8e246a299245e5e363f9}{Cleanup}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry}{JSFinalization\+Registry}} $>$ finalization\+\_\+registry)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 24 of file js-\/weak-\/refs.\+h.



\doxysubsection{Member Enumeration Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7}\label{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7}} 
\index{v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}!RemoveUnregisterTokenMode@{RemoveUnregisterTokenMode}}
\index{RemoveUnregisterTokenMode@{RemoveUnregisterTokenMode}!v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}}
\doxysubsubsection{\texorpdfstring{RemoveUnregisterTokenMode}{RemoveUnregisterTokenMode}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7}{v8\+::internal\+::\+JSFinalization\+Registry\+::\+Remove\+Unregister\+Token\+Mode}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{kRemoveMatchedCellsFromRegistry@{kRemoveMatchedCellsFromRegistry}!v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}}\index{v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}!kRemoveMatchedCellsFromRegistry@{kRemoveMatchedCellsFromRegistry}}}\mbox{\Hypertarget{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7a9121e50975a8359ce49b1becb757575b}\label{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7a9121e50975a8359ce49b1becb757575b}} 
k\+Remove\+Matched\+Cells\+From\+Registry&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{kKeepMatchedCellsInRegistry@{kKeepMatchedCellsInRegistry}!v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}}\index{v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}!kKeepMatchedCellsInRegistry@{kKeepMatchedCellsInRegistry}}}\mbox{\Hypertarget{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7a8317217427808991ad5756a7e7528643}\label{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7a8317217427808991ad5756a7e7528643}} 
k\+Keep\+Matched\+Cells\+In\+Registry&\\
\hline

\end{DoxyEnumFields}


Definition at line 46 of file js-\/weak-\/refs.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{46                                  \{}
\DoxyCodeLine{47     \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7a9121e50975a8359ce49b1becb757575b}{kRemoveMatchedCellsFromRegistry}},}
\DoxyCodeLine{48     \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7a8317217427808991ad5756a7e7528643}{kKeepMatchedCellsInRegistry}}}
\DoxyCodeLine{49   \};}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSFinalizationRegistry_ac96f7509b33f8e246a299245e5e363f9}\label{classv8_1_1internal_1_1JSFinalizationRegistry_ac96f7509b33f8e246a299245e5e363f9}} 
\index{v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}!Cleanup@{Cleanup}}
\index{Cleanup@{Cleanup}!v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}}
\doxysubsubsection{\texorpdfstring{Cleanup()}{Cleanup()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1Maybe}{Maybe}}$<$ \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} $>$ v8\+::internal\+::\+JSFinalization\+Registry\+::\+Cleanup (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry}{JSFinalization\+Registry}} $>$}]{finalization\+\_\+registry }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 50 of file js-\/weak-\/refs.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{52                                                                 \{}
\DoxyCodeLine{53   \textcolor{comment}{// 1. Assert: finalizationRegistry has [[Cells]] and [[CleanupCallback]]}}
\DoxyCodeLine{54   \textcolor{comment}{//    internal slots.}}
\DoxyCodeLine{55   \textcolor{comment}{// (By construction.)}}
\DoxyCodeLine{56 }
\DoxyCodeLine{57   \textcolor{comment}{// 2. Let callback be finalizationRegistry.[[CleanupCallback]].}}
\DoxyCodeLine{58   DirectHandle<Object> callback(finalization\_registry-\/>cleanup(), isolate);}
\DoxyCodeLine{59 }
\DoxyCodeLine{60   \textcolor{comment}{// 3. While finalizationRegistry.[[Cells]] contains a Record cell such that}}
\DoxyCodeLine{61   \textcolor{comment}{//    cell.[[WeakRefTarget]] is empty, an implementation may perform the}}
\DoxyCodeLine{62   \textcolor{comment}{//    following steps:}}
\DoxyCodeLine{63   \textcolor{keywordtype}{bool} key\_map\_may\_need\_shrink = \textcolor{keyword}{false};}
\DoxyCodeLine{64   \textcolor{keywordflow}{while} (finalization\_registry-\/>NeedsCleanup()) \{}
\DoxyCodeLine{65     HandleScope scope(isolate);}
\DoxyCodeLine{66 }
\DoxyCodeLine{67     \textcolor{comment}{// a. Choose any such cell.}}
\DoxyCodeLine{68     \textcolor{comment}{// b. Remove cell from finalizationRegistry.[[Cells]].}}
\DoxyCodeLine{69     DirectHandle<WeakCell> weak\_cell(finalization\_registry-\/>PopClearedCell(}
\DoxyCodeLine{70                                          isolate, \&key\_map\_may\_need\_shrink),}
\DoxyCodeLine{71                                      isolate);}
\DoxyCodeLine{72 }
\DoxyCodeLine{73     \textcolor{comment}{// c. Perform ? HostCallJobCallback(callback, undefined,}}
\DoxyCodeLine{74     \textcolor{comment}{//    « cell.[[HeldValue]] »).}}
\DoxyCodeLine{75     DirectHandle<Object> \mbox{\hyperlink{namespacev8_1_1base_ad03b241da4e98adde3145092fe54be8b}{args}}[] = \{}
\DoxyCodeLine{76         \mbox{\hyperlink{namespacev8_1_1internal_a73502f55102d18cb764881bc29f35c05}{direct\_handle}}(weak\_cell-\/>holdings(), isolate)\};}
\DoxyCodeLine{77     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classv8_1_1internal_1_1Execution_a529f28484ea4dc14ee8212d5417409c1}{Execution::Call}}(isolate, callback,}
\DoxyCodeLine{78                         isolate-\/>factory()-\/>undefined\_value(),}
\DoxyCodeLine{79                         \mbox{\hyperlink{namespacev8_1_1base_a5bfc65f27076e49eb7752a4fb4d45acb}{base::VectorOf}}(\mbox{\hyperlink{namespacev8_1_1base_ad03b241da4e98adde3145092fe54be8b}{args}}))}
\DoxyCodeLine{80             .is\_null()) \{}
\DoxyCodeLine{81       \textcolor{keywordflow}{if} (key\_map\_may\_need\_shrink) \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_a313415e97ce5c1625b4096a125ff6ae0}{ShrinkKeyMap}}(isolate, finalization\_registry);}
\DoxyCodeLine{82       \textcolor{keywordflow}{return} Nothing<bool>();}
\DoxyCodeLine{83     \}}
\DoxyCodeLine{84   \}}
\DoxyCodeLine{85 }
\DoxyCodeLine{86   \textcolor{keywordflow}{if} (key\_map\_may\_need\_shrink) \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_a313415e97ce5c1625b4096a125ff6ae0}{ShrinkKeyMap}}(isolate, finalization\_registry);}
\DoxyCodeLine{87   \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacev8_a41f0e280eadfba6ac9afd833fdd540cf}{Just}}(\textcolor{keyword}{true});}
\DoxyCodeLine{88 \}}

\end{DoxyCode}


References v8\+::base\+::args, v8\+::internal\+::\+Execution\+::\+Call(), v8\+::internal\+::direct\+\_\+handle(), v8\+::internal\+::\+Isolate\+::factory(), v8\+::\+Just(), Shrink\+Key\+Map(), and v8\+::base\+::\+Vector\+Of().



Referenced by v8\+::internal\+::\+Invoke\+Finalization\+Registry\+Cleanup\+From\+Task().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{classv8_1_1internal_1_1JSFinalizationRegistry_ac96f7509b33f8e246a299245e5e363f9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSFinalizationRegistry_ac96f7509b33f8e246a299245e5e363f9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSFinalizationRegistry_a946328a9b43059f352b4934a3fe636dc}\label{classv8_1_1internal_1_1JSFinalizationRegistry_a946328a9b43059f352b4934a3fe636dc}} 
\index{v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}!NeedsCleanup@{NeedsCleanup}}
\index{NeedsCleanup@{NeedsCleanup}!v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}}
\doxysubsubsection{\texorpdfstring{NeedsCleanup()}{NeedsCleanup()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} v8\+::internal\+::\+JSFinalization\+Registry\+::\+Needs\+Cleanup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 157 of file js-\/weak-\/refs-\/inl.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{157                                                 \{}
\DoxyCodeLine{158   \textcolor{keywordflow}{return} IsWeakCell(cleared\_cells());}
\DoxyCodeLine{159 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSFinalizationRegistry_ab306a5ca4c9e289f271f4cc2a2bd34d7}\label{classv8_1_1internal_1_1JSFinalizationRegistry_ab306a5ca4c9e289f271f4cc2a2bd34d7}} 
\index{v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}!PopClearedCell@{PopClearedCell}}
\index{PopClearedCell@{PopClearedCell}!v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}}
\doxysubsubsection{\texorpdfstring{PopClearedCell()}{PopClearedCell()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakCell}{Weak\+Cell}} $>$ v8\+::internal\+::\+JSFinalization\+Registry\+::\+Pop\+Cleared\+Cell (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} $\ast$}]{key\+\_\+map\+\_\+may\+\_\+need\+\_\+shrink }\end{DoxyParamCaption})}



Definition at line 13 of file js-\/weak-\/refs.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{14                                                      \{}
\DoxyCodeLine{15   \mbox{\hyperlink{namespacev8_1_1internal_af2248a427f8ff8f81e68a2a87758e145}{DisallowGarbageCollection}} \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02json-stringifier_8cc_03_a63d8eefb47468aa3f816fbe26a59466a}{no\_gc}};}
\DoxyCodeLine{16   Tagged<Undefined> \mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}} = ReadOnlyRoots(isolate).undefined\_value();}
\DoxyCodeLine{17 }
\DoxyCodeLine{18   Tagged<WeakCell> head = Cast<WeakCell>(cleared\_cells());}
\DoxyCodeLine{19   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(IsUndefined(head-\/>prev(), isolate));}
\DoxyCodeLine{20   Tagged<Union<Undefined, WeakCell>> tail = head-\/>next();}
\DoxyCodeLine{21   head-\/>set\_next(\mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}});}
\DoxyCodeLine{22   \textcolor{keywordflow}{if} (IsWeakCell(tail)) Cast<WeakCell>(tail)-\/>set\_prev(\mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}});}
\DoxyCodeLine{23   set\_cleared\_cells(tail);}
\DoxyCodeLine{24 }
\DoxyCodeLine{25   \textcolor{comment}{// If the WeakCell has an unregister token, remove the cell from the}}
\DoxyCodeLine{26   \textcolor{comment}{// unregister token linked lists and and the unregister token from key\_map.}}
\DoxyCodeLine{27   \textcolor{comment}{// This doesn't shrink key\_map, which is done manually after the cleanup loop.}}
\DoxyCodeLine{28   \textcolor{keywordflow}{if} (!IsUndefined(head-\/>unregister\_token(), isolate)) \{}
\DoxyCodeLine{29     \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_a7066e6a07c444d9c75895d90abdb841e}{RemoveCellFromUnregisterTokenMap}}(isolate, head);}
\DoxyCodeLine{30     *key\_map\_may\_need\_shrink = \textcolor{keyword}{true};}
\DoxyCodeLine{31   \}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33   \textcolor{keywordflow}{return} head;}
\DoxyCodeLine{34 \}}

\end{DoxyCode}


References v8\+::internal\+::\+DCHECK(), v8\+::internal\+::anonymous\+\_\+namespace\{json-\/stringifier.\+cc\}\+::no\+\_\+gc, Remove\+Cell\+From\+Unregister\+Token\+Map(), and v8\+::internal\+::undefined.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSFinalizationRegistry_ab306a5ca4c9e289f271f4cc2a2bd34d7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSFinalizationRegistry_a79a6818eb3ede3874b8b15298667ca92}\label{classv8_1_1internal_1_1JSFinalizationRegistry_a79a6818eb3ede3874b8b15298667ca92}} 
\index{v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}!RegisterWeakCellWithUnregisterToken@{RegisterWeakCellWithUnregisterToken}}
\index{RegisterWeakCellWithUnregisterToken@{RegisterWeakCellWithUnregisterToken}!v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}}
\doxysubsubsection{\texorpdfstring{RegisterWeakCellWithUnregisterToken()}{RegisterWeakCellWithUnregisterToken()}}
{\footnotesize\ttfamily static void v8\+::internal\+::\+JSFinalization\+Registry\+::\+Register\+Weak\+Cell\+With\+Unregister\+Token (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry}{JSFinalization\+Registry}} $>$}]{finalization\+\_\+registry,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakCell}{Weak\+Cell}} $>$}]{weak\+\_\+cell,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Referenced by v8\+::internal\+::\+RUNTIME\+\_\+\+FUNCTION().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSFinalizationRegistry_a79a6818eb3ede3874b8b15298667ca92_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSFinalizationRegistry_a7066e6a07c444d9c75895d90abdb841e}\label{classv8_1_1internal_1_1JSFinalizationRegistry_a7066e6a07c444d9c75895d90abdb841e}} 
\index{v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}!RemoveCellFromUnregisterTokenMap@{RemoveCellFromUnregisterTokenMap}}
\index{RemoveCellFromUnregisterTokenMap@{RemoveCellFromUnregisterTokenMap}!v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}}
\doxysubsubsection{\texorpdfstring{RemoveCellFromUnregisterTokenMap()}{RemoveCellFromUnregisterTokenMap()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+JSFinalization\+Registry\+::\+Remove\+Cell\+From\+Unregister\+Token\+Map (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1WeakCell}{Weak\+Cell}} $>$}]{weak\+\_\+cell }\end{DoxyParamCaption})}



Definition at line 90 of file js-\/weak-\/refs.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{91                                                   \{}
\DoxyCodeLine{92   \mbox{\hyperlink{namespacev8_1_1internal_af2248a427f8ff8f81e68a2a87758e145}{DisallowGarbageCollection}} \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02json-stringifier_8cc_03_a63d8eefb47468aa3f816fbe26a59466a}{no\_gc}};}
\DoxyCodeLine{93   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(!IsUndefined(weak\_cell-\/>unregister\_token(), isolate));}
\DoxyCodeLine{94   Tagged<Undefined> \mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}} = ReadOnlyRoots(isolate).undefined\_value();}
\DoxyCodeLine{95 }
\DoxyCodeLine{96   \textcolor{comment}{// Remove weak\_cell from the linked list of other WeakCells with the same}}
\DoxyCodeLine{97   \textcolor{comment}{// unregister token and remove its unregister token from key\_map if necessary}}
\DoxyCodeLine{98   \textcolor{comment}{// without shrinking it. Since shrinking may allocate, it is performed by the}}
\DoxyCodeLine{99   \textcolor{comment}{// caller after looping, or on exception.}}
\DoxyCodeLine{100   \textcolor{keywordflow}{if} (IsUndefined(weak\_cell-\/>key\_list\_prev(), isolate)) \{}
\DoxyCodeLine{101     Tagged<SimpleNumberDictionary> key\_map =}
\DoxyCodeLine{102         Cast<SimpleNumberDictionary>(this-\/>key\_map());}
\DoxyCodeLine{103     \mbox{\hyperlink{namespacev8_1_1internal_a57f5ecf71b9a2757b0555b2be4c640b8}{Tagged<HeapObject>}} unregister\_token = weak\_cell-\/>unregister\_token();}
\DoxyCodeLine{104     uint32\_t \mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}} = \mbox{\hyperlink{classv8_1_1internal_1_1Smi_a2e32de9e93a2cdfae189371f22782dad}{Smi::ToInt}}(\mbox{\hyperlink{classv8_1_1internal_1_1Object_aaaea701b4535f34d23f5fa54eb02e95a}{Object::GetHash}}(unregister\_token));}
\DoxyCodeLine{105     InternalIndex entry = key\_map-\/>FindEntry(isolate, \mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}});}
\DoxyCodeLine{106     \mbox{\hyperlink{src_2base_2logging_8h_a3e1cfef60e774a81f30eaddf26a3a274}{CHECK}}(entry.is\_found());}
\DoxyCodeLine{107 }
\DoxyCodeLine{108     \textcolor{keywordflow}{if} (IsUndefined(weak\_cell-\/>key\_list\_next(), isolate)) \{}
\DoxyCodeLine{109       \textcolor{comment}{// weak\_cell is the only one associated with its key; remove the key}}
\DoxyCodeLine{110       \textcolor{comment}{// from the hash table.}}
\DoxyCodeLine{111       key\_map-\/>ClearEntry(entry);}
\DoxyCodeLine{112       key\_map-\/>ElementRemoved();}
\DoxyCodeLine{113     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{114       \textcolor{comment}{// weak\_cell is the list head for its key; we need to change the value}}
\DoxyCodeLine{115       \textcolor{comment}{// of the key in the hash table.}}
\DoxyCodeLine{116       Tagged<WeakCell> next = Cast<WeakCell>(weak\_cell-\/>key\_list\_next());}
\DoxyCodeLine{117       \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(next-\/>key\_list\_prev(), weak\_cell);}
\DoxyCodeLine{118       next-\/>set\_key\_list\_prev(\mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}});}
\DoxyCodeLine{119       key\_map-\/>ValueAtPut(entry, next);}
\DoxyCodeLine{120     \}}
\DoxyCodeLine{121   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{122     \textcolor{comment}{// weak\_cell is somewhere in the middle of its key list.}}
\DoxyCodeLine{123     Tagged<WeakCell> prev = Cast<WeakCell>(weak\_cell-\/>key\_list\_prev());}
\DoxyCodeLine{124     prev-\/>set\_key\_list\_next(weak\_cell-\/>key\_list\_next());}
\DoxyCodeLine{125     \textcolor{keywordflow}{if} (!IsUndefined(weak\_cell-\/>key\_list\_next())) \{}
\DoxyCodeLine{126       Tagged<WeakCell> next = Cast<WeakCell>(weak\_cell-\/>key\_list\_next());}
\DoxyCodeLine{127       next-\/>set\_key\_list\_prev(weak\_cell-\/>key\_list\_prev());}
\DoxyCodeLine{128     \}}
\DoxyCodeLine{129   \}}
\DoxyCodeLine{130 }
\DoxyCodeLine{131   \textcolor{comment}{// weak\_cell is now removed from the unregister token map, so clear its}}
\DoxyCodeLine{132   \textcolor{comment}{// unregister token-\/related fields.}}
\DoxyCodeLine{133   weak\_cell-\/>set\_unregister\_token(\mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}});}
\DoxyCodeLine{134   weak\_cell-\/>set\_key\_list\_prev(\mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}});}
\DoxyCodeLine{135   weak\_cell-\/>set\_key\_list\_next(\mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}});}
\DoxyCodeLine{136 \}}

\end{DoxyCode}


References CHECK, v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+EQ, v8\+::internal\+::\+Object\+::\+Get\+Hash(), v8\+::internal\+::\+Internal\+Index\+::is\+\_\+found(), v8\+::internal\+::key, v8\+::internal\+::anonymous\+\_\+namespace\{json-\/stringifier.\+cc\}\+::no\+\_\+gc, v8\+::internal\+::\+Smi\+::\+To\+Int(), and v8\+::internal\+::undefined.



Referenced by Pop\+Cleared\+Cell().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSFinalizationRegistry_a7066e6a07c444d9c75895d90abdb841e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSFinalizationRegistry_a7066e6a07c444d9c75895d90abdb841e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSFinalizationRegistry_aba194e90349a70afbc6612047ef8abdb}\label{classv8_1_1internal_1_1JSFinalizationRegistry_aba194e90349a70afbc6612047ef8abdb}} 
\index{v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}!RemoveUnregisterToken@{RemoveUnregisterToken}}
\index{RemoveUnregisterToken@{RemoveUnregisterToken}!v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}}
\doxysubsubsection{\texorpdfstring{RemoveUnregisterToken()}{RemoveUnregisterToken()}}
{\footnotesize\ttfamily template$<$typename GCNotify\+Updated\+Slot\+Callback $>$ \\
\mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} v8\+::internal\+::\+JSFinalization\+Registry\+::\+Remove\+Unregister\+Token (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1HeapObject}{Heap\+Object}} $>$}]{unregister\+\_\+token,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7}{Remove\+Unregister\+Token\+Mode}}}]{removal\+\_\+mode,  }\item[{GCNotify\+Updated\+Slot\+Callback}]{gc\+\_\+notify\+\_\+updated\+\_\+slot }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 71 of file js-\/weak-\/refs-\/inl.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{74                                                         \{}
\DoxyCodeLine{75   \textcolor{comment}{// This method is called from both FinalizationRegistry\#unregister and for}}
\DoxyCodeLine{76   \textcolor{comment}{// removing weakly-\/held dead unregister tokens. The latter is during GC so}}
\DoxyCodeLine{77   \textcolor{comment}{// this function cannot GC.}}
\DoxyCodeLine{78   \mbox{\hyperlink{namespacev8_1_1internal_af2248a427f8ff8f81e68a2a87758e145}{DisallowGarbageCollection}} \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02json-stringifier_8cc_03_a63d8eefb47468aa3f816fbe26a59466a}{no\_gc}};}
\DoxyCodeLine{79   \textcolor{keywordflow}{if} (IsUndefined(key\_map(), isolate)) \{}
\DoxyCodeLine{80     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{81   \}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83   Tagged<SimpleNumberDictionary> key\_map =}
\DoxyCodeLine{84       Cast<SimpleNumberDictionary>(this-\/>key\_map());}
\DoxyCodeLine{85   \textcolor{comment}{// If the token doesn't have a hash, it was not used as a key inside any hash}}
\DoxyCodeLine{86   \textcolor{comment}{// tables.}}
\DoxyCodeLine{87   \mbox{\hyperlink{namespacev8_1_1internal_a5297fd2c72981b2220e6b9a831570fb3}{Tagged<Object>}} hash = \mbox{\hyperlink{classv8_1_1internal_1_1Object_aaaea701b4535f34d23f5fa54eb02e95a}{Object::GetHash}}(unregister\_token);}
\DoxyCodeLine{88   \textcolor{keywordflow}{if} (IsUndefined(hash, isolate)) \{}
\DoxyCodeLine{89     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{90   \}}
\DoxyCodeLine{91   uint32\_t \mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}} = \mbox{\hyperlink{classv8_1_1internal_1_1Smi_a2e32de9e93a2cdfae189371f22782dad}{Smi::ToInt}}(hash);}
\DoxyCodeLine{92   InternalIndex entry = key\_map-\/>FindEntry(isolate, \mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}});}
\DoxyCodeLine{93   \textcolor{keywordflow}{if} (entry.is\_not\_found()) \{}
\DoxyCodeLine{94     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{95   \}}
\DoxyCodeLine{96 }
\DoxyCodeLine{97   \mbox{\hyperlink{namespacev8_1_1internal_a5297fd2c72981b2220e6b9a831570fb3}{Tagged<Object>}} \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}} = key\_map-\/>ValueAt(entry);}
\DoxyCodeLine{98   \textcolor{keywordtype}{bool} was\_present = \textcolor{keyword}{false};}
\DoxyCodeLine{99   Tagged<Undefined> \mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}} = ReadOnlyRoots(isolate).undefined\_value();}
\DoxyCodeLine{100   Tagged<UnionOf<Undefined, WeakCell>> new\_key\_list\_head = \mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}};}
\DoxyCodeLine{101   Tagged<UnionOf<Undefined, WeakCell>> new\_key\_list\_prev = \mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}};}
\DoxyCodeLine{102   \textcolor{comment}{// Compute a new key list that doesn't have unregister\_token. Because}}
\DoxyCodeLine{103   \textcolor{comment}{// unregister tokens are held weakly, key\_map is keyed using the tokens'}}
\DoxyCodeLine{104   \textcolor{comment}{// identity hashes, and identity hashes may collide.}}
\DoxyCodeLine{105   \textcolor{keywordflow}{while} (!IsUndefined(\mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, isolate)) \{}
\DoxyCodeLine{106     Tagged<WeakCell> weak\_cell = Cast<WeakCell>(\mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}});}
\DoxyCodeLine{107     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(!\mbox{\hyperlink{classv8_1_1internal_1_1HeapLayout_a597d0e70459c694743e92d98a9292f92}{HeapLayout::InYoungGeneration}}(weak\_cell));}
\DoxyCodeLine{108     \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}} = weak\_cell-\/>key\_list\_next();}
\DoxyCodeLine{109     \textcolor{keywordflow}{if} (weak\_cell-\/>unregister\_token() == unregister\_token) \{}
\DoxyCodeLine{110       \textcolor{comment}{// weak\_cell has the same unregister token; remove it from the key list.}}
\DoxyCodeLine{111       \textcolor{keywordflow}{switch} (removal\_mode) \{}
\DoxyCodeLine{112         \textcolor{keywordflow}{case} \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7a9121e50975a8359ce49b1becb757575b}{kRemoveMatchedCellsFromRegistry}}:}
\DoxyCodeLine{113           weak\_cell-\/>RemoveFromFinalizationRegistryCells(isolate);}
\DoxyCodeLine{114           \textcolor{keywordflow}{break};}
\DoxyCodeLine{115         \textcolor{keywordflow}{case} \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7a8317217427808991ad5756a7e7528643}{kKeepMatchedCellsInRegistry}}:}
\DoxyCodeLine{116           \textcolor{comment}{// Do nothing.}}
\DoxyCodeLine{117           \textcolor{keywordflow}{break};}
\DoxyCodeLine{118       \}}
\DoxyCodeLine{119       \textcolor{comment}{// Clear unregister token-\/related fields.}}
\DoxyCodeLine{120       weak\_cell-\/>set\_unregister\_token(\mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}});}
\DoxyCodeLine{121       weak\_cell-\/>set\_key\_list\_prev(\mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}});}
\DoxyCodeLine{122       weak\_cell-\/>set\_key\_list\_next(\mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}});}
\DoxyCodeLine{123       was\_present = \textcolor{keyword}{true};}
\DoxyCodeLine{124     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{125       \textcolor{comment}{// weak\_cell has a different unregister token with the same key (hash}}
\DoxyCodeLine{126       \textcolor{comment}{// collision); fix up the list.}}
\DoxyCodeLine{127       weak\_cell-\/>set\_key\_list\_prev(new\_key\_list\_prev);}
\DoxyCodeLine{128       gc\_notify\_updated\_slot(weak\_cell,}
\DoxyCodeLine{129                              weak\_cell-\/>RawField(WeakCell::kKeyListPrevOffset),}
\DoxyCodeLine{130                              new\_key\_list\_prev);}
\DoxyCodeLine{131       weak\_cell-\/>set\_key\_list\_next(\mbox{\hyperlink{namespacev8_1_1internal_ab165da27eb70b7cac315ad3c2c991c06}{undefined}});}
\DoxyCodeLine{132       \textcolor{keywordflow}{if} (IsUndefined(new\_key\_list\_prev, isolate)) \{}
\DoxyCodeLine{133         new\_key\_list\_head = weak\_cell;}
\DoxyCodeLine{134       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{135         \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(IsWeakCell(new\_key\_list\_head));}
\DoxyCodeLine{136         Tagged<WeakCell> prev\_cell = Cast<WeakCell>(new\_key\_list\_prev);}
\DoxyCodeLine{137         prev\_cell-\/>set\_key\_list\_next(weak\_cell);}
\DoxyCodeLine{138         gc\_notify\_updated\_slot(}
\DoxyCodeLine{139             prev\_cell, prev\_cell-\/>RawField(WeakCell::kKeyListNextOffset),}
\DoxyCodeLine{140             weak\_cell);}
\DoxyCodeLine{141       \}}
\DoxyCodeLine{142       new\_key\_list\_prev = weak\_cell;}
\DoxyCodeLine{143     \}}
\DoxyCodeLine{144   \}}
\DoxyCodeLine{145   \textcolor{keywordflow}{if} (IsUndefined(new\_key\_list\_head, isolate)) \{}
\DoxyCodeLine{146     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(was\_present);}
\DoxyCodeLine{147     key\_map-\/>ClearEntry(entry);}
\DoxyCodeLine{148     key\_map-\/>ElementRemoved();}
\DoxyCodeLine{149   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{150     key\_map-\/>ValueAtPut(entry, new\_key\_list\_head);}
\DoxyCodeLine{151     gc\_notify\_updated\_slot(key\_map, key\_map-\/>RawFieldOfValueAt(entry),}
\DoxyCodeLine{152                            new\_key\_list\_head);}
\DoxyCodeLine{153   \}}
\DoxyCodeLine{154   \textcolor{keywordflow}{return} was\_present;}
\DoxyCodeLine{155 \}}

\end{DoxyCode}


References v8\+::internal\+::\+DCHECK(), v8\+::internal\+::\+Object\+::\+Get\+Hash(), v8\+::internal\+::\+Heap\+Layout\+::\+In\+Young\+Generation(), v8\+::internal\+::\+Internal\+Index\+::is\+\_\+not\+\_\+found(), v8\+::internal\+::key, k\+Keep\+Matched\+Cells\+In\+Registry, k\+Remove\+Matched\+Cells\+From\+Registry, v8\+::internal\+::anonymous\+\_\+namespace\{json-\/stringifier.\+cc\}\+::no\+\_\+gc, v8\+::internal\+::\+Smi\+::\+To\+Int(), v8\+::internal\+::undefined, and v8\+::internal\+::value.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSFinalizationRegistry_aba194e90349a70afbc6612047ef8abdb_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSFinalizationRegistry_a313415e97ce5c1625b4096a125ff6ae0}\label{classv8_1_1internal_1_1JSFinalizationRegistry_a313415e97ce5c1625b4096a125ff6ae0}} 
\index{v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}!ShrinkKeyMap@{ShrinkKeyMap}}
\index{ShrinkKeyMap@{ShrinkKeyMap}!v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}}
\doxysubsubsection{\texorpdfstring{ShrinkKeyMap()}{ShrinkKeyMap()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+JSFinalization\+Registry\+::\+Shrink\+Key\+Map (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry}{JSFinalization\+Registry}} $>$}]{finalization\+\_\+registry }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 36 of file js-\/weak-\/refs.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{38                                                                 \{}
\DoxyCodeLine{39   \textcolor{keywordflow}{if} (!IsUndefined(finalization\_registry-\/>key\_map(), isolate)) \{}
\DoxyCodeLine{40     Handle<SimpleNumberDictionary> key\_map =}
\DoxyCodeLine{41         \mbox{\hyperlink{namespacev8_1_1internal_a8c89f00da07e125218128b9fbf0a321c}{handle}}(Cast<SimpleNumberDictionary>(finalization\_registry-\/>key\_map()),}
\DoxyCodeLine{42                isolate);}
\DoxyCodeLine{43     key\_map = \mbox{\hyperlink{namespacecppgc_1_1internal_1_1anonymous__namespace_02explicit-management_8cc_03_ae386bd778f9a2f3f49df2f8a280ffdf9}{SimpleNumberDictionary::Shrink}}(isolate, key\_map);}
\DoxyCodeLine{44     finalization\_registry-\/>set\_key\_map(*key\_map);}
\DoxyCodeLine{45   \}}
\DoxyCodeLine{46 \}}

\end{DoxyCode}


References v8\+::internal\+::handle(), and cppgc\+::internal\+::anonymous\+\_\+namespace\{explicit-\/management.\+cc\}\+::\+Shrink().



Referenced by Cleanup().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSFinalizationRegistry_a313415e97ce5c1625b4096a125ff6ae0_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSFinalizationRegistry_a313415e97ce5c1625b4096a125ff6ae0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSFinalizationRegistry_a1965c86a848b56e274d63fc15534d72c}\label{classv8_1_1internal_1_1JSFinalizationRegistry_a1965c86a848b56e274d63fc15534d72c}} 
\index{v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}!Unregister@{Unregister}}
\index{Unregister@{Unregister}!v8::internal::JSFinalizationRegistry@{v8::internal::JSFinalizationRegistry}}
\doxysubsubsection{\texorpdfstring{Unregister()}{Unregister()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} v8\+::internal\+::\+JSFinalization\+Registry\+::\+Unregister (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry}{JSFinalization\+Registry}} $>$}]{finalization\+\_\+registry,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1HeapObject}{Heap\+Object}} $>$}]{unregister\+\_\+token,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Definition at line 59 of file js-\/weak-\/refs-\/inl.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{61                                                                  \{}
\DoxyCodeLine{62   \textcolor{comment}{// Iterate through the doubly linked list of WeakCells associated with the}}
\DoxyCodeLine{63   \textcolor{comment}{// key. Each WeakCell will be in the "{}active\_cells"{} or "{}cleared\_cells"{} list of}}
\DoxyCodeLine{64   \textcolor{comment}{// its FinalizationRegistry; remove it from there.}}
\DoxyCodeLine{65   \textcolor{keywordflow}{return} finalization\_registry-\/>RemoveUnregisterToken(}
\DoxyCodeLine{66       *unregister\_token, isolate, \mbox{\hyperlink{classv8_1_1internal_1_1JSFinalizationRegistry_adc9713e6adaaa4c89bf5e814c6c8d9f7a9121e50975a8359ce49b1becb757575b}{kRemoveMatchedCellsFromRegistry}},}
\DoxyCodeLine{67       [](\mbox{\hyperlink{namespacev8_1_1internal_a57f5ecf71b9a2757b0555b2be4c640b8}{Tagged<HeapObject>}}, \mbox{\hyperlink{namespacev8_1_1internal_a0bc0ebcec45817212856f7d5e021224c}{ObjectSlot}}, \mbox{\hyperlink{namespacev8_1_1internal_a5297fd2c72981b2220e6b9a831570fb3}{Tagged<Object>}}) \{\});}
\DoxyCodeLine{68 \}}

\end{DoxyCode}


References k\+Remove\+Matched\+Cells\+From\+Registry.



Referenced by v8\+::internal\+::\+BUILTIN().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSFinalizationRegistry_a1965c86a848b56e274d63fc15534d72c_icgraph}
\end{center}
\end{figure}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/mnt/\+V8\+Source\+Code/src/objects/\mbox{\hyperlink{js-weak-refs_8h}{js-\/weak-\/refs.\+h}}\item 
/mnt/\+V8\+Source\+Code/src/objects/\mbox{\hyperlink{js-weak-refs-inl_8h}{js-\/weak-\/refs-\/inl.\+h}}\item 
/mnt/\+V8\+Source\+Code/src/objects/\mbox{\hyperlink{js-weak-refs_8cc}{js-\/weak-\/refs.\+cc}}\end{DoxyCompactItemize}
