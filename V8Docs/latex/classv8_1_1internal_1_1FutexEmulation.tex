\hypertarget{classv8_1_1internal_1_1FutexEmulation}{}\doxysection{v8\+::internal\+::Futex\+Emulation Class Reference}
\label{classv8_1_1internal_1_1FutexEmulation}\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}


{\ttfamily \#include $<$futex-\/emulation.\+h$>$}



Inheritance diagram for v8\+::internal\+::Futex\+Emulation\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=261pt]{classv8_1_1internal_1_1FutexEmulation__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for v8\+::internal\+::Futex\+Emulation\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=283pt]{classv8_1_1internal_1_1FutexEmulation__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045}{Wait\+Mode}} \{ \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045a04ae3932237a589cdfbe9296c5e27315}{k\+Sync}} = 0
, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045abe392c81102047b2256ecba4460c0a94}{k\+Async}}
 \}
\item 
enum class \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334}{Call\+Type}} \{ \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334ad6500d695793eb1ce81b747b2baf90ca}{k\+Is\+Not\+Wasm}} = 0
, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334aa4680e94a71b753e6e52c8acd575b8f2}{k\+Is\+Wasm}}
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a6a412db5fdd2af66e5c33f8c3026dee8}{Wait\+Js32}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045}{Wait\+Mode}} \mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}}, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$ array\+\_\+buffer, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} addr, int32\+\_\+t \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, double rel\+\_\+timeout\+\_\+ms)
\item 
static \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a5c745db4eaa564a11d52c835748f929d}{Wait\+Js64}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045}{Wait\+Mode}} \mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}}, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$ array\+\_\+buffer, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} addr, int64\+\_\+t \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, double rel\+\_\+timeout\+\_\+ms)
\item 
static \mbox{\hyperlink{src_2base_2macros_8h_ab08e353943a53678ac6baafc678f2d81}{V8\+\_\+\+EXPORT\+\_\+\+PRIVATE}} \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a83aebe720a9779dc17f167841298fefe}{Wait\+Wasm32}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$ array\+\_\+buffer, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} addr, int32\+\_\+t \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, int64\+\_\+t rel\+\_\+timeout\+\_\+ns)
\item 
static \mbox{\hyperlink{src_2base_2macros_8h_ab08e353943a53678ac6baafc678f2d81}{V8\+\_\+\+EXPORT\+\_\+\+PRIVATE}} \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a4370cbf76c1fc0aae5f0886e9df85c7f}{Wait\+Wasm64}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$ array\+\_\+buffer, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} addr, int64\+\_\+t \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, int64\+\_\+t rel\+\_\+timeout\+\_\+ns)
\item 
static \mbox{\hyperlink{src_2base_2macros_8h_ab08e353943a53678ac6baafc678f2d81}{V8\+\_\+\+EXPORT\+\_\+\+PRIVATE}} \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_ae1ce6ea182343b95d38dbf1c439d8fe4}{Wake}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$ array\+\_\+buffer, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} addr, uint32\+\_\+t num\+\_\+waiters\+\_\+to\+\_\+wake)
\item 
static \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a8b147798c1ea50ec5f5c11ef5e2083b6}{Wake}} (void $\ast$addr, uint32\+\_\+t num\+\_\+waiters\+\_\+to\+\_\+wake)
\item 
static void \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a963d39e6e3045aa065f91c9dc69ccca2}{Isolate\+Deinit}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate)
\item 
static \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a2be1c1ce169c3dd8374327205138d2f6}{Num\+Waiters\+For\+Testing}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$ array\+\_\+buffer, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} addr)
\item 
static \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a1e2bf4bfc44f2883976757ee751735fd}{Num\+Unresolved\+Async\+Promises\+For\+Testing}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$ array\+\_\+buffer, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} addr)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
static const uint32\+\_\+t \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a44e18f878cf35172c8b7e186aa6732cb}{k\+Wake\+All}} = UINT32\+\_\+\+MAX
\end{DoxyCompactItemize}
\doxysubsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename T $>$ }\\static \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0e1b77f6d08400b83d978e4c15185cf8}{Wait}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045}{Wait\+Mode}} \mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}}, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$ array\+\_\+buffer, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} addr, \mbox{\hyperlink{classT}{T}} \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, double rel\+\_\+timeout\+\_\+ms)
\item 
{\footnotesize template$<$typename T $>$ }\\static \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a689483cf6684d45d56daec4d465664c8}{Wait}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045}{Wait\+Mode}} \mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}}, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$ array\+\_\+buffer, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} addr, \mbox{\hyperlink{classT}{T}} \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} use\+\_\+timeout, int64\+\_\+t rel\+\_\+timeout\+\_\+ns, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334}{Call\+Type}} call\+\_\+type=\mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334ad6500d695793eb1ce81b747b2baf90ca}{Call\+Type\+::k\+Is\+Not\+Wasm}})
\item 
{\footnotesize template$<$typename T $>$ }\\static \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a07d062c5c0ffcf41500b433d7ce5f6a3}{Wait\+Sync}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$ array\+\_\+buffer, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} addr, \mbox{\hyperlink{classT}{T}} \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} use\+\_\+timeout, int64\+\_\+t rel\+\_\+timeout\+\_\+ns, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334}{Call\+Type}} call\+\_\+type)
\item 
{\footnotesize template$<$typename T $>$ }\\static \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a5b7d42b92773aeab3587c46d86d68d24}{Wait\+Async}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$ array\+\_\+buffer, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} addr, \mbox{\hyperlink{classT}{T}} \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} use\+\_\+timeout, int64\+\_\+t rel\+\_\+timeout\+\_\+ns, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334}{Call\+Type}} call\+\_\+type)
\item 
static void \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_afba63d0a6611d493d691927bb1e61605}{Resolve\+Async\+Waiter\+Promises}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate)
\item 
static void \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_aa1d04a031fc98cf02a916d60c8acc90f}{Resolve\+Async\+Waiter\+Promise}} (\mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitListNode}{Futex\+Wait\+List\+Node}} $\ast$node)
\item 
static void \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0614214316afd90448fe9b2597a035b4}{Handle\+Async\+Waiter\+Timeout}} (\mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitListNode}{Futex\+Wait\+List\+Node}} $\ast$node)
\item 
static void \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a5058561db3da3b8eee301914f24868cb}{Notify\+Async\+Waiter}} (\mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitListNode}{Futex\+Wait\+List\+Node}} $\ast$node)
\item 
static void \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_aaa0e4a01836397705dc2bdd174a0302e}{Cleanup\+Async\+Waiter\+Promise}} (\mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitListNode}{Futex\+Wait\+List\+Node}} $\ast$node)
\end{DoxyCompactItemize}
\doxysubsection*{Friends}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{Futex\+Wait\+List\+Node}}
\item 
class \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a9d159ab7a7dc5d26ed16d0d8e25de542}{Resolve\+Async\+Waiter\+Promises\+Task}}
\item 
class \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_ad097217dccf17302f39715f49205252b}{Async\+Waiter\+Timeout\+Task}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 138 of file futex-\/emulation.\+h.



\doxysubsection{Member Enumeration Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334}\label{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!CallType@{CallType}}
\index{CallType@{CallType}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{CallType}{CallType}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334}{v8\+::internal\+::\+Futex\+Emulation\+::\+Call\+Type}}\hspace{0.3cm}{\ttfamily [strong]}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{kIsNotWasm@{kIsNotWasm}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!kIsNotWasm@{kIsNotWasm}}}\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334ad6500d695793eb1ce81b747b2baf90ca}\label{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334ad6500d695793eb1ce81b747b2baf90ca}} 
k\+Is\+Not\+Wasm&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{kIsWasm@{kIsWasm}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!kIsWasm@{kIsWasm}}}\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334aa4680e94a71b753e6e52c8acd575b8f2}\label{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334aa4680e94a71b753e6e52c8acd575b8f2}} 
k\+Is\+Wasm&\\
\hline

\end{DoxyEnumFields}


Definition at line 141 of file futex-\/emulation.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{141 \{ kIsNotWasm = 0, kIsWasm \};}

\end{DoxyCode}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045}\label{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!WaitMode@{WaitMode}}
\index{WaitMode@{WaitMode}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{WaitMode}{WaitMode}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045}{v8\+::internal\+::\+Futex\+Emulation\+::\+Wait\+Mode}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{kSync@{kSync}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!kSync@{kSync}}}\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045a04ae3932237a589cdfbe9296c5e27315}\label{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045a04ae3932237a589cdfbe9296c5e27315}} 
k\+Sync&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{kAsync@{kAsync}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!kAsync@{kAsync}}}\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045abe392c81102047b2256ecba4460c0a94}\label{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045abe392c81102047b2256ecba4460c0a94}} 
k\+Async&\\
\hline

\end{DoxyEnumFields}


Definition at line 140 of file futex-\/emulation.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{140 \{ \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045a04ae3932237a589cdfbe9296c5e27315}{kSync}} = 0, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045abe392c81102047b2256ecba4460c0a94}{kAsync}} \};}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_aaa0e4a01836397705dc2bdd174a0302e}\label{classv8_1_1internal_1_1FutexEmulation_aaa0e4a01836397705dc2bdd174a0302e}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!CleanupAsyncWaiterPromise@{CleanupAsyncWaiterPromise}}
\index{CleanupAsyncWaiterPromise@{CleanupAsyncWaiterPromise}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{CleanupAsyncWaiterPromise()}{CleanupAsyncWaiterPromise()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Futex\+Emulation\+::\+Cleanup\+Async\+Waiter\+Promise (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitListNode}{Futex\+Wait\+List\+Node}} $\ast$}]{node }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 727 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{727                                                                       \{}
\DoxyCodeLine{728   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(node-\/>IsAsync());}
\DoxyCodeLine{729   \textcolor{comment}{// This function must run in the main thread of node's Isolate. This function}}
\DoxyCodeLine{730   \textcolor{comment}{// may allocate memory. To avoid deadlocks, we shouldn't be holding the}}
\DoxyCodeLine{731   \textcolor{comment}{// FutexEmulationGlobalState::mutex.}}
\DoxyCodeLine{732 }
\DoxyCodeLine{733   Isolate* isolate = node-\/>async\_state\_-\/>isolate\_for\_async\_waiters;}
\DoxyCodeLine{734   \textcolor{keyword}{auto} v8\_isolate = \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{classv8_1_1Isolate}{v8::Isolate}}*\textcolor{keyword}{>}(isolate);}
\DoxyCodeLine{735 }
\DoxyCodeLine{736   \textcolor{keywordflow}{if} (!node-\/>async\_state\_-\/>promise.IsEmpty()) \{}
\DoxyCodeLine{737     \textcolor{keyword}{auto} promise = Cast<JSPromise>(}
\DoxyCodeLine{738         \mbox{\hyperlink{classv8_1_1Utils_a9d3ed89b4ca4e995ba472f8091ea424f}{Utils::OpenDirectHandle}}(*node-\/>async\_state\_-\/>promise.Get(v8\_isolate)));}
\DoxyCodeLine{739     \textcolor{comment}{// Promise keeps the NativeContext alive.}}
\DoxyCodeLine{740     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(!node-\/>async\_state\_-\/>native\_context.IsEmpty());}
\DoxyCodeLine{741     \textcolor{keyword}{auto} \mbox{\hyperlink{namespacev8_1_1internal_afe601ad9b4b4c61d8a6a700e7db12c2a}{native\_context}} = Cast<NativeContext>(\mbox{\hyperlink{classv8_1_1Utils_a9d3ed89b4ca4e995ba472f8091ea424f}{Utils::OpenDirectHandle}}(}
\DoxyCodeLine{742         *node-\/>async\_state\_-\/>native\_context.Get(v8\_isolate)));}
\DoxyCodeLine{743 }
\DoxyCodeLine{744     \textcolor{comment}{// Remove the Promise from the NativeContext's set.}}
\DoxyCodeLine{745     DirectHandle<OrderedHashSet> promises(}
\DoxyCodeLine{746         \mbox{\hyperlink{namespacev8_1_1internal_afe601ad9b4b4c61d8a6a700e7db12c2a}{native\_context}}-\/>atomics\_waitasync\_promises(), isolate);}
\DoxyCodeLine{747     \textcolor{keywordtype}{bool} was\_deleted = \mbox{\hyperlink{classv8_1_1internal_1_1OrderedHashTable_ade5a4b2baa2adf5c4cb257f1ccb4e601}{OrderedHashSet::Delete}}(isolate, *promises, *promise);}
\DoxyCodeLine{748     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(was\_deleted);}
\DoxyCodeLine{749     \mbox{\hyperlink{src_2base_2macros_8h_a280b0798f270f4b3f361c9ab64832956}{USE}}(was\_deleted);}
\DoxyCodeLine{750     promises = \mbox{\hyperlink{namespacecppgc_1_1internal_1_1anonymous__namespace_02explicit-management_8cc_03_ae386bd778f9a2f3f49df2f8a280ffdf9}{OrderedHashSet::Shrink}}(isolate, promises);}
\DoxyCodeLine{751     \mbox{\hyperlink{namespacev8_1_1internal_afe601ad9b4b4c61d8a6a700e7db12c2a}{native\_context}}-\/>set\_atomics\_waitasync\_promises(*promises);}
\DoxyCodeLine{752   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{753     \textcolor{comment}{// NativeContext keeps the Promise alive; if the Promise is dead then}}
\DoxyCodeLine{754     \textcolor{comment}{// surely NativeContext is too.}}
\DoxyCodeLine{755     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(node-\/>async\_state\_-\/>native\_context.IsEmpty());}
\DoxyCodeLine{756   \}}
\DoxyCodeLine{757 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::async\+\_\+state\+\_\+, v8\+::internal\+::\+DCHECK(), v8\+::internal\+::\+Ordered\+Hash\+Table$<$ Ordered\+Hash\+Set, 1 $>$\+::\+Delete(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::\+Is\+Async(), v8\+::internal\+::native\+\_\+context, v8\+::\+Utils\+::\+Open\+Direct\+Handle(), cppgc\+::internal\+::anonymous\+\_\+namespace\{explicit-\/management.\+cc\}\+::\+Shrink(), and USE.



Referenced by Handle\+Async\+Waiter\+Timeout(), and Resolve\+Async\+Waiter\+Promises().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_aaa0e4a01836397705dc2bdd174a0302e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_aaa0e4a01836397705dc2bdd174a0302e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a0614214316afd90448fe9b2597a035b4}\label{classv8_1_1internal_1_1FutexEmulation_a0614214316afd90448fe9b2597a035b4}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!HandleAsyncWaiterTimeout@{HandleAsyncWaiterTimeout}}
\index{HandleAsyncWaiterTimeout@{HandleAsyncWaiterTimeout}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{HandleAsyncWaiterTimeout()}{HandleAsyncWaiterTimeout()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Futex\+Emulation\+::\+Handle\+Async\+Waiter\+Timeout (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitListNode}{Futex\+Wait\+List\+Node}} $\ast$}]{node }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 837 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{837                                                                      \{}
\DoxyCodeLine{838   \textcolor{comment}{// This function must run in the main thread of node's Isolate.}}
\DoxyCodeLine{839   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(node-\/>IsAsync());}
\DoxyCodeLine{840 }
\DoxyCodeLine{841   FutexWaitList* wait\_list = GetWaitList();}
\DoxyCodeLine{842 }
\DoxyCodeLine{843   \{}
\DoxyCodeLine{844     NoGarbageCollectionMutexGuard lock\_guard(wait\_list-\/>mutex());}
\DoxyCodeLine{845 }
\DoxyCodeLine{846     node-\/>async\_state\_-\/>timeout\_task\_id = \mbox{\hyperlink{classv8_1_1internal_1_1CancelableTaskManager_aeced01d51e2e17fe43f5286404519146}{CancelableTaskManager::kInvalidTaskId}};}
\DoxyCodeLine{847     \textcolor{keywordflow}{if} (!node-\/>waiting\_) \{}
\DoxyCodeLine{848       \textcolor{comment}{// If the Node is not waiting, it's already scheduled to have its Promise}}
\DoxyCodeLine{849       \textcolor{comment}{// resolved. Ignore the timeout.}}
\DoxyCodeLine{850       \textcolor{keywordflow}{return};}
\DoxyCodeLine{851     \}}
\DoxyCodeLine{852     wait\_list-\/>RemoveNode(node);}
\DoxyCodeLine{853   \}}
\DoxyCodeLine{854 }
\DoxyCodeLine{855   \textcolor{comment}{// "{}node"{} has been taken out of the lists, so it's ok to access it without}}
\DoxyCodeLine{856   \textcolor{comment}{// holding the mutex. We also need to not hold the mutex while calling}}
\DoxyCodeLine{857   \textcolor{comment}{// CleanupAsyncWaiterPromise, since it may allocate memory.}}
\DoxyCodeLine{858   HandleScope handle\_scope(node-\/>async\_state\_-\/>isolate\_for\_async\_waiters);}
\DoxyCodeLine{859   \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_aa1d04a031fc98cf02a916d60c8acc90f}{ResolveAsyncWaiterPromise}}(node);}
\DoxyCodeLine{860   \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_aaa0e4a01836397705dc2bdd174a0302e}{CleanupAsyncWaiterPromise}}(node);}
\DoxyCodeLine{861   \textcolor{keyword}{delete} node;}
\DoxyCodeLine{862 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::async\+\_\+state\+\_\+, Cleanup\+Async\+Waiter\+Promise(), v8\+::internal\+::\+DCHECK(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::\+Is\+Async(), v8\+::internal\+::\+Cancelable\+Task\+Manager\+::k\+Invalid\+Task\+Id, v8\+::internal\+::\+Futex\+Wait\+List\+::mutex(), v8\+::internal\+::\+Futex\+Wait\+List\+::\+Remove\+Node(), Resolve\+Async\+Waiter\+Promise(), and v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::waiting\+\_\+.



Referenced by v8\+::internal\+::\+Async\+Waiter\+Timeout\+Task\+::\+Run\+Internal().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{classv8_1_1internal_1_1FutexEmulation_a0614214316afd90448fe9b2597a035b4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a0614214316afd90448fe9b2597a035b4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a963d39e6e3045aa065f91c9dc69ccca2}\label{classv8_1_1internal_1_1FutexEmulation_a963d39e6e3045aa065f91c9dc69ccca2}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!IsolateDeinit@{IsolateDeinit}}
\index{IsolateDeinit@{IsolateDeinit}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{IsolateDeinit()}{IsolateDeinit()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Futex\+Emulation\+::\+Isolate\+Deinit (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 864 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{864                                                    \{}
\DoxyCodeLine{865   FutexWaitList* wait\_list = GetWaitList();}
\DoxyCodeLine{866   NoGarbageCollectionMutexGuard lock\_guard(wait\_list-\/>mutex());}
\DoxyCodeLine{867 }
\DoxyCodeLine{868   \textcolor{comment}{// Iterate all locations to find nodes belonging to "{}isolate"{} and delete them.}}
\DoxyCodeLine{869   \textcolor{comment}{// The Isolate is going away; don't bother cleaning up the Promises in the}}
\DoxyCodeLine{870   \textcolor{comment}{// NativeContext. Also we don't need to cancel the timeout tasks, since they}}
\DoxyCodeLine{871   \textcolor{comment}{// will be cancelled by Isolate::Deinit.}}
\DoxyCodeLine{872   \{}
\DoxyCodeLine{873     \textcolor{keyword}{auto}\& location\_lists = wait\_list-\/>location\_lists\_;}
\DoxyCodeLine{874     \textcolor{keyword}{auto} it = location\_lists.begin();}
\DoxyCodeLine{875     \textcolor{keywordflow}{while} (it != location\_lists.end()) \{}
\DoxyCodeLine{876       \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{FutexWaitListNode}}*\& head = it-\/>second.head;}
\DoxyCodeLine{877       \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{FutexWaitListNode}}*\& tail = it-\/>second.tail;}
\DoxyCodeLine{878       \mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitList_a8afeb038e45ac283b5ec5a661144c3f7}{FutexWaitList::DeleteNodesForIsolate}}(isolate, \&head, \&tail);}
\DoxyCodeLine{879       \textcolor{comment}{// head and tail are either both nullptr or both non-\/nullptr.}}
\DoxyCodeLine{880       \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(head == \textcolor{keyword}{nullptr}, tail == \textcolor{keyword}{nullptr});}
\DoxyCodeLine{881       \textcolor{keywordflow}{if} (head == \textcolor{keyword}{nullptr}) \{}
\DoxyCodeLine{882         it = location\_lists.erase(it);}
\DoxyCodeLine{883       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{884         ++it;}
\DoxyCodeLine{885       \}}
\DoxyCodeLine{886     \}}
\DoxyCodeLine{887   \}}
\DoxyCodeLine{888 }
\DoxyCodeLine{889   \{}
\DoxyCodeLine{890     \textcolor{keyword}{auto}\& \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}} = wait\_list-\/>isolate\_promises\_to\_resolve\_;}
\DoxyCodeLine{891     \textcolor{keyword}{auto} it = \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}}.find(isolate);}
\DoxyCodeLine{892     \textcolor{keywordflow}{if} (it != \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}}.end()) \{}
\DoxyCodeLine{893       \textcolor{keywordflow}{for} (\mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{FutexWaitListNode}}* node = it-\/>second.head; node;) \{}
\DoxyCodeLine{894         \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(node-\/>IsAsync());}
\DoxyCodeLine{895         \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(isolate, node-\/>async\_state\_-\/>isolate\_for\_async\_waiters);}
\DoxyCodeLine{896         node-\/>async\_state\_-\/>timeout\_task\_id =}
\DoxyCodeLine{897             \mbox{\hyperlink{classv8_1_1internal_1_1CancelableTaskManager_aeced01d51e2e17fe43f5286404519146}{CancelableTaskManager::kInvalidTaskId}};}
\DoxyCodeLine{898         node = \mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitList_a30fe0e6197159166d5152bab701d86db}{FutexWaitList::DeleteAsyncWaiterNode}}(node);}
\DoxyCodeLine{899       \}}
\DoxyCodeLine{900       \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}}.erase(it);}
\DoxyCodeLine{901     \}}
\DoxyCodeLine{902   \}}
\DoxyCodeLine{903 }
\DoxyCodeLine{904   wait\_list-\/>Verify();}
\DoxyCodeLine{905 \}}

\end{DoxyCode}


References v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+EQ, v8\+::internal\+::\+Futex\+Wait\+List\+::\+Delete\+Async\+Waiter\+Node(), v8\+::internal\+::\+Futex\+Wait\+List\+::\+Delete\+Nodes\+For\+Isolate(), v8\+::internal\+::\+ETWJITInterface\+::isolate\+\_\+map, v8\+::internal\+::\+Futex\+Wait\+List\+::isolate\+\_\+promises\+\_\+to\+\_\+resolve\+\_\+, v8\+::internal\+::\+Cancelable\+Task\+Manager\+::k\+Invalid\+Task\+Id, v8\+::internal\+::\+Futex\+Wait\+List\+::location\+\_\+lists\+\_\+, v8\+::internal\+::\+Futex\+Wait\+List\+::mutex(), and v8\+::internal\+::\+Futex\+Wait\+List\+::\+Verify().



Referenced by v8\+::internal\+::\+Isolate\+::\+Deinit().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a963d39e6e3045aa065f91c9dc69ccca2_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a963d39e6e3045aa065f91c9dc69ccca2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a5058561db3da3b8eee301914f24868cb}\label{classv8_1_1internal_1_1FutexEmulation_a5058561db3da3b8eee301914f24868cb}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!NotifyAsyncWaiter@{NotifyAsyncWaiter}}
\index{NotifyAsyncWaiter@{NotifyAsyncWaiter}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{NotifyAsyncWaiter()}{NotifyAsyncWaiter()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Futex\+Emulation\+::\+Notify\+Async\+Waiter (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitListNode}{Futex\+Wait\+List\+Node}} $\ast$}]{node }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 179 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{179                                                               \{}
\DoxyCodeLine{180   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(node-\/>IsAsync());}
\DoxyCodeLine{181   \textcolor{comment}{// This function can run in any thread.}}
\DoxyCodeLine{182 }
\DoxyCodeLine{183   FutexWaitList* wait\_list = GetWaitList();}
\DoxyCodeLine{184   wait\_list-\/>mutex()-\/>AssertHeld();}
\DoxyCodeLine{185 }
\DoxyCodeLine{186   \textcolor{comment}{// Nullify the timeout time; this distinguishes timed out waiters from}}
\DoxyCodeLine{187   \textcolor{comment}{// woken up ones.}}
\DoxyCodeLine{188   node-\/>async\_state\_-\/>timeout\_time = base::TimeTicks();}
\DoxyCodeLine{189 }
\DoxyCodeLine{190   wait\_list-\/>RemoveNode(node);}
\DoxyCodeLine{191 }
\DoxyCodeLine{192   \textcolor{comment}{// Schedule a task for resolving the Promise. It's still possible that the}}
\DoxyCodeLine{193   \textcolor{comment}{// timeout task runs before the promise resolving task. In that case, the}}
\DoxyCodeLine{194   \textcolor{comment}{// timeout task will just ignore the node.}}
\DoxyCodeLine{195   \textcolor{keyword}{auto}\& \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}} = wait\_list-\/>isolate\_promises\_to\_resolve\_;}
\DoxyCodeLine{196   \textcolor{keyword}{auto} it = \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}}.find(node-\/>async\_state\_-\/>isolate\_for\_async\_waiters);}
\DoxyCodeLine{197   \textcolor{keywordflow}{if} (it == \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}}.end()) \{}
\DoxyCodeLine{198     \textcolor{comment}{// This Isolate doesn't have other Promises to resolve at the moment.}}
\DoxyCodeLine{199     \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}}.insert(}
\DoxyCodeLine{200         std::make\_pair(node-\/>async\_state\_-\/>isolate\_for\_async\_waiters,}
\DoxyCodeLine{201                        FutexWaitList::HeadAndTail\{node, node\}));}
\DoxyCodeLine{202     \textcolor{keyword}{auto} task = std::make\_unique<ResolveAsyncWaiterPromisesTask>(}
\DoxyCodeLine{203         node-\/>async\_state\_-\/>isolate\_for\_async\_waiters);}
\DoxyCodeLine{204     node-\/>async\_state\_-\/>task\_runner-\/>PostNonNestableTask(std::move(task));}
\DoxyCodeLine{205   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{206     \textcolor{comment}{// Add this Node into the existing list.}}
\DoxyCodeLine{207     node-\/>prev\_ = it-\/>second.tail;}
\DoxyCodeLine{208     it-\/>second.tail-\/>next\_ = node;}
\DoxyCodeLine{209     it-\/>second.tail = node;}
\DoxyCodeLine{210   \}}
\DoxyCodeLine{211 \}}

\end{DoxyCode}


References v8\+::base\+::\+Mutex\+::\+Assert\+Held(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::async\+\_\+state\+\_\+, v8\+::internal\+::\+DCHECK(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::\+Is\+Async(), v8\+::internal\+::\+ETWJITInterface\+::isolate\+\_\+map, v8\+::internal\+::\+Futex\+Wait\+List\+::isolate\+\_\+promises\+\_\+to\+\_\+resolve\+\_\+, v8\+::internal\+::\+Futex\+Wait\+List\+::mutex(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::next\+\_\+, v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::prev\+\_\+, and v8\+::internal\+::\+Futex\+Wait\+List\+::\+Remove\+Node().



Referenced by Wake().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a5058561db3da3b8eee301914f24868cb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a5058561db3da3b8eee301914f24868cb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a1e2bf4bfc44f2883976757ee751735fd}\label{classv8_1_1internal_1_1FutexEmulation_a1e2bf4bfc44f2883976757ee751735fd}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!NumUnresolvedAsyncPromisesForTesting@{NumUnresolvedAsyncPromisesForTesting}}
\index{NumUnresolvedAsyncPromisesForTesting@{NumUnresolvedAsyncPromisesForTesting}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{NumUnresolvedAsyncPromisesForTesting()}{NumUnresolvedAsyncPromisesForTesting()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classint}{int}} v8\+::internal\+::\+Futex\+Emulation\+::\+Num\+Unresolved\+Async\+Promises\+For\+Testing (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$}]{array\+\_\+buffer,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}}]{addr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 931 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{932                                                      \{}
\DoxyCodeLine{933   \textcolor{keywordtype}{void}* wait\_location = \mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitList_a47163132578216a1527660cfa5b68064}{FutexWaitList::ToWaitLocation}}(array\_buffer, addr);}
\DoxyCodeLine{934   FutexWaitList* wait\_list = GetWaitList();}
\DoxyCodeLine{935   NoGarbageCollectionMutexGuard lock\_guard(wait\_list-\/>mutex());}
\DoxyCodeLine{936 }
\DoxyCodeLine{937   \textcolor{keywordtype}{int} num\_waiters = 0;}
\DoxyCodeLine{938   \textcolor{keyword}{auto}\& \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}} = wait\_list-\/>isolate\_promises\_to\_resolve\_;}
\DoxyCodeLine{939   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& it : \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}}) \{}
\DoxyCodeLine{940     \textcolor{keywordflow}{for} (\mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{FutexWaitListNode}}* node = it.second.head; node; node = node-\/>next\_) \{}
\DoxyCodeLine{941       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(node-\/>IsAsync());}
\DoxyCodeLine{942       \textcolor{keywordflow}{if} (node-\/>waiting\_) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{943       \textcolor{keywordflow}{if} (wait\_location != node-\/>wait\_location\_) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{944       \textcolor{keywordflow}{if} (node-\/>async\_state\_-\/>backing\_store.expired()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{945       \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(array\_buffer-\/>GetBackingStore(),}
\DoxyCodeLine{946                 node-\/>async\_state\_-\/>backing\_store.lock());}
\DoxyCodeLine{947       num\_waiters++;}
\DoxyCodeLine{948     \}}
\DoxyCodeLine{949   \}}
\DoxyCodeLine{950 }
\DoxyCodeLine{951   \textcolor{keywordflow}{return} num\_waiters;}
\DoxyCodeLine{952 \}}

\end{DoxyCode}


References v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+EQ, v8\+::internal\+::\+ETWJITInterface\+::isolate\+\_\+map, v8\+::internal\+::\+Futex\+Wait\+List\+::isolate\+\_\+promises\+\_\+to\+\_\+resolve\+\_\+, v8\+::internal\+::\+Futex\+Wait\+List\+::mutex(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::next\+\_\+, and v8\+::internal\+::\+Futex\+Wait\+List\+::\+To\+Wait\+Location().



Referenced by v8\+::internal\+::\+RUNTIME\+\_\+\+FUNCTION().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a1e2bf4bfc44f2883976757ee751735fd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a1e2bf4bfc44f2883976757ee751735fd_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a2be1c1ce169c3dd8374327205138d2f6}\label{classv8_1_1internal_1_1FutexEmulation_a2be1c1ce169c3dd8374327205138d2f6}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!NumWaitersForTesting@{NumWaitersForTesting}}
\index{NumWaitersForTesting@{NumWaitersForTesting}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{NumWaitersForTesting()}{NumWaitersForTesting()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classint}{int}} v8\+::internal\+::\+Futex\+Emulation\+::\+Num\+Waiters\+For\+Testing (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$}]{array\+\_\+buffer,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}}]{addr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 907 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{908                                                       \{}
\DoxyCodeLine{909   \textcolor{keywordtype}{void}* wait\_location = \mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitList_a47163132578216a1527660cfa5b68064}{FutexWaitList::ToWaitLocation}}(*array\_buffer, addr);}
\DoxyCodeLine{910   FutexWaitList* wait\_list = GetWaitList();}
\DoxyCodeLine{911   NoGarbageCollectionMutexGuard lock\_guard(wait\_list-\/>mutex());}
\DoxyCodeLine{912 }
\DoxyCodeLine{913   \textcolor{keywordtype}{int} num\_waiters = 0;}
\DoxyCodeLine{914   \textcolor{keyword}{auto}\& location\_lists = wait\_list-\/>location\_lists\_;}
\DoxyCodeLine{915   \textcolor{keyword}{auto} it = location\_lists.find(wait\_location);}
\DoxyCodeLine{916   \textcolor{keywordflow}{if} (it == location\_lists.end()) \textcolor{keywordflow}{return} num\_waiters;}
\DoxyCodeLine{917 }
\DoxyCodeLine{918   \textcolor{keywordflow}{for} (\mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{FutexWaitListNode}}* node = it-\/>second.head; node; node = node-\/>next\_) \{}
\DoxyCodeLine{919     \textcolor{keywordflow}{if} (!node-\/>waiting\_) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{920     \textcolor{keywordflow}{if} (node-\/>IsAsync()) \{}
\DoxyCodeLine{921       \textcolor{keywordflow}{if} (node-\/>async\_state\_-\/>backing\_store.expired()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{922       \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(array\_buffer-\/>GetBackingStore(),}
\DoxyCodeLine{923                 node-\/>async\_state\_-\/>backing\_store.lock());}
\DoxyCodeLine{924     \}}
\DoxyCodeLine{925     num\_waiters++;}
\DoxyCodeLine{926   \}}
\DoxyCodeLine{927 }
\DoxyCodeLine{928   \textcolor{keywordflow}{return} num\_waiters;}
\DoxyCodeLine{929 \}}

\end{DoxyCode}


References DCHECK\+\_\+\+EQ, v8\+::internal\+::\+Futex\+Wait\+List\+::location\+\_\+lists\+\_\+, v8\+::internal\+::\+Futex\+Wait\+List\+::mutex(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::next\+\_\+, and v8\+::internal\+::\+Futex\+Wait\+List\+::\+To\+Wait\+Location().



Referenced by v8\+::internal\+::\+RUNTIME\+\_\+\+FUNCTION().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a2be1c1ce169c3dd8374327205138d2f6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a2be1c1ce169c3dd8374327205138d2f6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_aa1d04a031fc98cf02a916d60c8acc90f}\label{classv8_1_1internal_1_1FutexEmulation_aa1d04a031fc98cf02a916d60c8acc90f}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!ResolveAsyncWaiterPromise@{ResolveAsyncWaiterPromise}}
\index{ResolveAsyncWaiterPromise@{ResolveAsyncWaiterPromise}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{ResolveAsyncWaiterPromise()}{ResolveAsyncWaiterPromise()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Futex\+Emulation\+::\+Resolve\+Async\+Waiter\+Promise (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitListNode}{Futex\+Wait\+List\+Node}} $\ast$}]{node }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 759 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{759                                                                       \{}
\DoxyCodeLine{760   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(node-\/>IsAsync());}
\DoxyCodeLine{761   \textcolor{comment}{// This function must run in the main thread of node's Isolate.}}
\DoxyCodeLine{762 }
\DoxyCodeLine{763   Isolate* isolate = node-\/>async\_state\_-\/>isolate\_for\_async\_waiters;}
\DoxyCodeLine{764   \mbox{\hyperlink{classv8_1_1Isolate}{v8::Isolate}}* v8\_isolate = \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{classv8_1_1Isolate}{v8::Isolate}}*\textcolor{keyword}{>}(isolate);}
\DoxyCodeLine{765 }
\DoxyCodeLine{766   \textcolor{comment}{// Try to cancel the timeout task (if one exists). If the timeout task exists,}}
\DoxyCodeLine{767   \textcolor{comment}{// cancelling it will always succeed. It's not possible for the timeout task}}
\DoxyCodeLine{768   \textcolor{comment}{// to be running, since it's scheduled to run in the same thread as this task.}}
\DoxyCodeLine{769 }
\DoxyCodeLine{770   \textcolor{comment}{// Using the CancelableTaskManager here is OK since the Isolate is guaranteed}}
\DoxyCodeLine{771   \textcolor{comment}{// to be alive -\/ FutexEmulation::IsolateDeinit removes all FutexWaitListNodes}}
\DoxyCodeLine{772   \textcolor{comment}{// owned by an Isolate which is going to die.}}
\DoxyCodeLine{773   \textcolor{keywordtype}{bool} success = node-\/>CancelTimeoutTask();}
\DoxyCodeLine{774   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(success);}
\DoxyCodeLine{775   \mbox{\hyperlink{src_2base_2macros_8h_a280b0798f270f4b3f361c9ab64832956}{USE}}(success);}
\DoxyCodeLine{776 }
\DoxyCodeLine{777   \textcolor{keywordflow}{if} (!node-\/>async\_state\_-\/>promise.IsEmpty()) \{}
\DoxyCodeLine{778     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(!node-\/>async\_state\_-\/>native\_context.IsEmpty());}
\DoxyCodeLine{779     Local<v8::Context> \mbox{\hyperlink{namespacev8_1_1internal_afe601ad9b4b4c61d8a6a700e7db12c2a}{native\_context}} =}
\DoxyCodeLine{780         node-\/>async\_state\_-\/>native\_context.Get(v8\_isolate);}
\DoxyCodeLine{781     \mbox{\hyperlink{classv8_1_1Context_1_1Scope}{v8::Context::Scope}} contextScope(\mbox{\hyperlink{namespacev8_1_1internal_afe601ad9b4b4c61d8a6a700e7db12c2a}{native\_context}});}
\DoxyCodeLine{782     DirectHandle<JSPromise> promise = Cast<JSPromise>(}
\DoxyCodeLine{783         \mbox{\hyperlink{classv8_1_1Utils_aea3e5682d909c5f546b8d0342e3cc1a4}{Utils::OpenHandle}}(*node-\/>async\_state\_-\/>promise.Get(v8\_isolate)));}
\DoxyCodeLine{784     DirectHandle<String> result\_string;}
\DoxyCodeLine{785     \textcolor{comment}{// When waiters are notified, their timeout\_time is reset. Having a}}
\DoxyCodeLine{786     \textcolor{comment}{// non-\/zero timeout\_time here means the waiter timed out.}}
\DoxyCodeLine{787     \textcolor{keywordflow}{if} (node-\/>async\_state\_-\/>timeout\_time != base::TimeTicks()) \{}
\DoxyCodeLine{788       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(node-\/>waiting\_);}
\DoxyCodeLine{789       result\_string = isolate-\/>factory()-\/>timed\_out\_string();}
\DoxyCodeLine{790     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{791       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(!node-\/>waiting\_);}
\DoxyCodeLine{792       result\_string = isolate-\/>factory()-\/>ok\_string();}
\DoxyCodeLine{793     \}}
\DoxyCodeLine{794     MaybeDirectHandle<Object> resolve\_result =}
\DoxyCodeLine{795         \mbox{\hyperlink{classv8_1_1internal_1_1JSPromise_ab5498a7e4026703f904ad2ab3018c250}{JSPromise::Resolve}}(promise, result\_string);}
\DoxyCodeLine{796     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(!resolve\_result.is\_null());}
\DoxyCodeLine{797     \mbox{\hyperlink{src_2base_2macros_8h_a280b0798f270f4b3f361c9ab64832956}{USE}}(resolve\_result);}
\DoxyCodeLine{798   \}}
\DoxyCodeLine{799 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::async\+\_\+state\+\_\+, v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::\+Cancel\+Timeout\+Task(), v8\+::internal\+::\+DCHECK(), v8\+::internal\+::\+Isolate\+::factory(), v8\+::internal\+::\+Maybe\+Direct\+Handle$<$ T $>$\+::is\+\_\+null(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::\+Is\+Async(), v8\+::internal\+::native\+\_\+context, v8\+::\+Utils\+::\+Open\+Handle(), v8\+::internal\+::\+JSPromise\+::\+Resolve(), USE, and v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::waiting\+\_\+.



Referenced by Handle\+Async\+Waiter\+Timeout(), and Resolve\+Async\+Waiter\+Promises().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_aa1d04a031fc98cf02a916d60c8acc90f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_aa1d04a031fc98cf02a916d60c8acc90f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_afba63d0a6611d493d691927bb1e61605}\label{classv8_1_1internal_1_1FutexEmulation_afba63d0a6611d493d691927bb1e61605}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!ResolveAsyncWaiterPromises@{ResolveAsyncWaiterPromises}}
\index{ResolveAsyncWaiterPromises@{ResolveAsyncWaiterPromises}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{ResolveAsyncWaiterPromises()}{ResolveAsyncWaiterPromises()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Futex\+Emulation\+::\+Resolve\+Async\+Waiter\+Promises (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 801 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{801                                                                 \{}
\DoxyCodeLine{802   \textcolor{comment}{// This function must run in the main thread of isolate.}}
\DoxyCodeLine{803 }
\DoxyCodeLine{804   FutexWaitList* wait\_list = GetWaitList();}
\DoxyCodeLine{805   \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{FutexWaitListNode}}* node;}
\DoxyCodeLine{806   \{}
\DoxyCodeLine{807     NoGarbageCollectionMutexGuard lock\_guard(wait\_list-\/>mutex());}
\DoxyCodeLine{808 }
\DoxyCodeLine{809     \textcolor{keyword}{auto}\& \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}} = wait\_list-\/>isolate\_promises\_to\_resolve\_;}
\DoxyCodeLine{810     \textcolor{keyword}{auto} it = \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}}.find(isolate);}
\DoxyCodeLine{811     \mbox{\hyperlink{src_2base_2logging_8h_a986dc8f4ec6dcd0644efe205c13f8eb7}{DCHECK\_NE}}(\mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}}.end(), it);}
\DoxyCodeLine{812 }
\DoxyCodeLine{813     node = it-\/>second.head;}
\DoxyCodeLine{814     \mbox{\hyperlink{namespacev8_1_1internal_1_1ETWJITInterface_a29563aedcfbc615dd5c8db594c39d1fb}{isolate\_map}}.erase(it);}
\DoxyCodeLine{815   \}}
\DoxyCodeLine{816 }
\DoxyCodeLine{817   \textcolor{comment}{// The list of nodes starting from "{}node"{} are no longer on any list, so it's}}
\DoxyCodeLine{818   \textcolor{comment}{// ok to iterate them without holding the mutex. We also need to not hold the}}
\DoxyCodeLine{819   \textcolor{comment}{// mutex while calling CleanupAsyncWaiterPromise, since it may allocate}}
\DoxyCodeLine{820   \textcolor{comment}{// memory.}}
\DoxyCodeLine{821   HandleScope handle\_scope(isolate);}
\DoxyCodeLine{822   \textcolor{keywordflow}{while} (node) \{}
\DoxyCodeLine{823     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(node-\/>IsAsync());}
\DoxyCodeLine{824     \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(isolate, node-\/>async\_state\_-\/>isolate\_for\_async\_waiters);}
\DoxyCodeLine{825     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(!node-\/>waiting\_);}
\DoxyCodeLine{826     \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_aa1d04a031fc98cf02a916d60c8acc90f}{ResolveAsyncWaiterPromise}}(node);}
\DoxyCodeLine{827     \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_aaa0e4a01836397705dc2bdd174a0302e}{CleanupAsyncWaiterPromise}}(node);}
\DoxyCodeLine{828     \textcolor{comment}{// We've already tried to cancel the timeout task for the node; since we're}}
\DoxyCodeLine{829     \textcolor{comment}{// now in the same thread the timeout task is supposed to run, we know the}}
\DoxyCodeLine{830     \textcolor{comment}{// timeout task will never happen, and it's safe to delete the node here.}}
\DoxyCodeLine{831     \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(\mbox{\hyperlink{classv8_1_1internal_1_1CancelableTaskManager_aeced01d51e2e17fe43f5286404519146}{CancelableTaskManager::kInvalidTaskId}},}
\DoxyCodeLine{832               node-\/>async\_state\_-\/>timeout\_task\_id);}
\DoxyCodeLine{833     node = \mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitList_a30fe0e6197159166d5152bab701d86db}{FutexWaitList::DeleteAsyncWaiterNode}}(node);}
\DoxyCodeLine{834   \}}
\DoxyCodeLine{835 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::async\+\_\+state\+\_\+, Cleanup\+Async\+Waiter\+Promise(), v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+EQ, DCHECK\+\_\+\+NE, v8\+::internal\+::\+Futex\+Wait\+List\+::\+Delete\+Async\+Waiter\+Node(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::\+Is\+Async(), v8\+::internal\+::\+ETWJITInterface\+::isolate\+\_\+map, v8\+::internal\+::\+Futex\+Wait\+List\+::isolate\+\_\+promises\+\_\+to\+\_\+resolve\+\_\+, v8\+::internal\+::\+Cancelable\+Task\+Manager\+::k\+Invalid\+Task\+Id, v8\+::internal\+::\+Futex\+Wait\+List\+::mutex(), Resolve\+Async\+Waiter\+Promise(), and v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::waiting\+\_\+.



Referenced by v8\+::internal\+::\+Resolve\+Async\+Waiter\+Promises\+Task\+::\+Run\+Internal().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{classv8_1_1internal_1_1FutexEmulation_afba63d0a6611d493d691927bb1e61605_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_afba63d0a6611d493d691927bb1e61605_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a689483cf6684d45d56daec4d465664c8}\label{classv8_1_1internal_1_1FutexEmulation_a689483cf6684d45d56daec4d465664c8}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!Wait@{Wait}}
\index{Wait@{Wait}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{Wait()}{Wait()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ v8\+::internal\+::\+Futex\+Emulation\+::\+Wait (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045}{Wait\+Mode}}}]{mode,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$}]{array\+\_\+buffer,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}}]{addr,  }\item[{\mbox{\hyperlink{classT}{T}}}]{value,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}}}]{use\+\_\+timeout,  }\item[{int64\+\_\+t}]{rel\+\_\+timeout\+\_\+ns,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334}{Call\+Type}}}]{call\+\_\+type = {\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334ad6500d695793eb1ce81b747b2baf90ca}{Call\+Type\+::k\+Is\+Not\+Wasm}}} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 345 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{349                                                         \{}
\DoxyCodeLine{350   \textcolor{keywordflow}{if} (\mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}} == WaitMode::kSync) \{}
\DoxyCodeLine{351     \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a07d062c5c0ffcf41500b433d7ce5f6a3}{WaitSync}}(isolate, array\_buffer, addr, \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, use\_timeout,}
\DoxyCodeLine{352                     rel\_timeout\_ns, call\_type);}
\DoxyCodeLine{353   \}}
\DoxyCodeLine{354   \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(\mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}}, WaitMode::kAsync);}
\DoxyCodeLine{355   \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a5b7d42b92773aeab3587c46d86d68d24}{WaitAsync}}(isolate, array\_buffer, addr, \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, use\_timeout,}
\DoxyCodeLine{356                    rel\_timeout\_ns, call\_type);}
\DoxyCodeLine{357 \}}

\end{DoxyCode}


References DCHECK\+\_\+\+EQ, mode(), v8\+::internal\+::value, Wait\+Async(), and Wait\+Sync().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a689483cf6684d45d56daec4d465664c8_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a0e1b77f6d08400b83d978e4c15185cf8}\label{classv8_1_1internal_1_1FutexEmulation_a0e1b77f6d08400b83d978e4c15185cf8}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!Wait@{Wait}}
\index{Wait@{Wait}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{Wait()}{Wait()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ v8\+::internal\+::\+Futex\+Emulation\+::\+Wait (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045}{Wait\+Mode}}}]{mode,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$}]{array\+\_\+buffer,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}}]{addr,  }\item[{\mbox{\hyperlink{classT}{T}}}]{value,  }\item[{double}]{rel\+\_\+timeout\+\_\+ms }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 318 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{321                                                            \{}
\DoxyCodeLine{322   \mbox{\hyperlink{src_2base_2logging_8h_af1a711c8d5520dff78858ddefd2ad668}{DCHECK\_LT}}(addr, array\_buffer-\/>GetByteLength());}
\DoxyCodeLine{323 }
\DoxyCodeLine{324   \textcolor{keywordtype}{bool} use\_timeout = rel\_timeout\_ms != \mbox{\hyperlink{common_2globals_8h_a085553a5c34c736329b329bffb0a3de1}{V8\_INFINITY}};}
\DoxyCodeLine{325   int64\_t rel\_timeout\_ns = -\/1;}
\DoxyCodeLine{326 }
\DoxyCodeLine{327   \textcolor{keywordflow}{if} (use\_timeout) \{}
\DoxyCodeLine{328     \textcolor{comment}{// Convert to nanoseconds.}}
\DoxyCodeLine{329     \textcolor{keywordtype}{double} timeout\_ns = rel\_timeout\_ms *}
\DoxyCodeLine{330                         \mbox{\hyperlink{classv8_1_1base_1_1TimeConstants_a7b7def4d913fbbad5793662bbc929fd7}{base::Time::kNanosecondsPerMicrosecond}} *}
\DoxyCodeLine{331                         \mbox{\hyperlink{classv8_1_1base_1_1TimeConstants_ab4b6e441763075b96c53fd519bc1d31d}{base::Time::kMicrosecondsPerMillisecond}};}
\DoxyCodeLine{332     \textcolor{keywordflow}{if} (timeout\_ns > \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(std::numeric\_limits<int64\_t>::max())) \{}
\DoxyCodeLine{333       \textcolor{comment}{// 2**63 nanoseconds is 292 years. Let's just treat anything greater as}}
\DoxyCodeLine{334       \textcolor{comment}{// infinite.}}
\DoxyCodeLine{335       use\_timeout = \textcolor{keyword}{false};}
\DoxyCodeLine{336     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{337       rel\_timeout\_ns = \textcolor{keyword}{static\_cast<}int64\_t\textcolor{keyword}{>}(timeout\_ns);}
\DoxyCodeLine{338     \}}
\DoxyCodeLine{339   \}}
\DoxyCodeLine{340   \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0e1b77f6d08400b83d978e4c15185cf8}{Wait}}(isolate, \mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}}, array\_buffer, addr, \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, use\_timeout,}
\DoxyCodeLine{341               rel\_timeout\_ns);}
\DoxyCodeLine{342 \}}

\end{DoxyCode}


References DCHECK\+\_\+\+LT, v8\+::base\+::\+Time\+Constants\+::k\+Microseconds\+Per\+Millisecond, v8\+::base\+::\+Time\+Constants\+::k\+Nanoseconds\+Per\+Microsecond, mode(), V8\+\_\+\+INFINITY, and v8\+::internal\+::value.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{classv8_1_1internal_1_1FutexEmulation_a0e1b77f6d08400b83d978e4c15185cf8_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a5b7d42b92773aeab3587c46d86d68d24}\label{classv8_1_1internal_1_1FutexEmulation_a5b7d42b92773aeab3587c46d86d68d24}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!WaitAsync@{WaitAsync}}
\index{WaitAsync@{WaitAsync}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{WaitAsync()}{WaitAsync()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ v8\+::internal\+::\+Futex\+Emulation\+::\+Wait\+Async (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$}]{array\+\_\+buffer,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}}]{addr,  }\item[{\mbox{\hyperlink{classT}{T}}}]{value,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}}}]{use\+\_\+timeout,  }\item[{int64\+\_\+t}]{rel\+\_\+timeout\+\_\+ns,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334}{Call\+Type}}}]{call\+\_\+type }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 503 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{505                                                                            \{}
\DoxyCodeLine{506   base::TimeDelta rel\_timeout =}
\DoxyCodeLine{507       \mbox{\hyperlink{classv8_1_1base_1_1TimeDelta_a023a048044be14caae6555c3f1763b9e}{base::TimeDelta::FromNanoseconds}}(rel\_timeout\_ns);}
\DoxyCodeLine{508 }
\DoxyCodeLine{509   Factory* factory = isolate-\/>factory();}
\DoxyCodeLine{510   DirectHandle<JSObject> \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}} =}
\DoxyCodeLine{511       factory-\/>NewJSObject(isolate-\/>object\_function());}
\DoxyCodeLine{512   DirectHandle<JSObject> promise\_capability = factory-\/>NewJSPromise();}
\DoxyCodeLine{513 }
\DoxyCodeLine{514   \textcolor{keyword}{enum class} ResultKind \{ \mbox{\hyperlink{namespacev8_1_1internal_a271f8ea99b7c0bbd771df015d4e4cf21a26a5934e256740899f4fd130f028fc70}{kNotEqual}}, \mbox{\hyperlink{namespacev8_1_1internal_ab0bd7b471763696d390be70adeb48da7a42f405b6977fc9a5b6b2bc88a836a140}{kTimedOut}}, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045abe392c81102047b2256ecba4460c0a94}{kAsync}} \};}
\DoxyCodeLine{515   ResultKind result\_kind;}
\DoxyCodeLine{516   \textcolor{keywordtype}{void}* wait\_location = \mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitList_a47163132578216a1527660cfa5b68064}{FutexWaitList::ToWaitLocation}}(*array\_buffer, addr);}
\DoxyCodeLine{517   \textcolor{comment}{// Get a weak pointer to the backing store, to be stored in the async state of}}
\DoxyCodeLine{518   \textcolor{comment}{// the node.}}
\DoxyCodeLine{519   std::weak\_ptr<BackingStore> backing\_store\{array\_buffer-\/>GetBackingStore()\};}
\DoxyCodeLine{520   FutexWaitList* wait\_list = GetWaitList();}
\DoxyCodeLine{521   \{}
\DoxyCodeLine{522     \textcolor{comment}{// 16. Perform EnterCriticalSection(WL).}}
\DoxyCodeLine{523     NoGarbageCollectionMutexGuard lock\_guard(wait\_list-\/>mutex());}
\DoxyCodeLine{524 }
\DoxyCodeLine{525     \textcolor{comment}{// 17. Let w be ! AtomicLoad(typedArray, i).}}
\DoxyCodeLine{526     std::atomic<T>* p = \textcolor{keyword}{static\_cast<}std::atomic<T>*\textcolor{keyword}{>}(wait\_location);}
\DoxyCodeLine{527     \mbox{\hyperlink{classT}{T}} loaded\_value = p-\/>load();}
\DoxyCodeLine{528 \textcolor{preprocessor}{\#if defined(V8\_TARGET\_BIG\_ENDIAN)}}
\DoxyCodeLine{529     \textcolor{comment}{// If loading a Wasm value, it needs to be reversed on Big Endian platforms.}}
\DoxyCodeLine{530     \textcolor{keywordflow}{if} (call\_type == \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334aa4680e94a71b753e6e52c8acd575b8f2}{CallType::kIsWasm}}) \{}
\DoxyCodeLine{531       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classT}{T}}) == \mbox{\hyperlink{namespacev8_1_1internal_a914d19dea357ee280bea7580796a62b5}{kInt32Size}} || \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classT}{T}}) == \mbox{\hyperlink{namespacev8_1_1internal_a191fd08d000c1fc6a1c0d14655f1b711}{kInt64Size}});}
\DoxyCodeLine{532       loaded\_value = \mbox{\hyperlink{namespacev8_1_1internal_af53a839b8395922f49d2ec23783cca6f}{ByteReverse}}(loaded\_value);}
\DoxyCodeLine{533     \}}
\DoxyCodeLine{534 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{535     \textcolor{keywordflow}{if} (loaded\_value != \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}) \{}
\DoxyCodeLine{536       result\_kind = \mbox{\hyperlink{namespacev8_1_1internal_a271f8ea99b7c0bbd771df015d4e4cf21a26a5934e256740899f4fd130f028fc70}{ResultKind::kNotEqual}};}
\DoxyCodeLine{537     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (use\_timeout \&\& rel\_timeout\_ns == 0) \{}
\DoxyCodeLine{538       result\_kind = \mbox{\hyperlink{namespacev8_1_1internal_ab0bd7b471763696d390be70adeb48da7a42f405b6977fc9a5b6b2bc88a836a140}{ResultKind::kTimedOut}};}
\DoxyCodeLine{539     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{540       result\_kind = ResultKind::kAsync;}
\DoxyCodeLine{541 }
\DoxyCodeLine{542       \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{FutexWaitListNode}}* node = \textcolor{keyword}{new} \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{FutexWaitListNode}}(}
\DoxyCodeLine{543           std::move(backing\_store), wait\_location, promise\_capability, isolate);}
\DoxyCodeLine{544 }
\DoxyCodeLine{545       \textcolor{keywordflow}{if} (use\_timeout) \{}
\DoxyCodeLine{546         node-\/>async\_state\_-\/>timeout\_time = \mbox{\hyperlink{classv8_1_1base_1_1TimeTicks_ab0886bf0e84f1e1fcdc101021c2c0775}{base::TimeTicks::Now}}() + rel\_timeout;}
\DoxyCodeLine{547         \textcolor{keyword}{auto} task = std::make\_unique<AsyncWaiterTimeoutTask>(}
\DoxyCodeLine{548             node-\/>async\_state\_-\/>isolate\_for\_async\_waiters}
\DoxyCodeLine{549                 -\/>cancelable\_task\_manager(),}
\DoxyCodeLine{550             node);}
\DoxyCodeLine{551         node-\/>async\_state\_-\/>timeout\_task\_id = task-\/>id();}
\DoxyCodeLine{552         node-\/>async\_state\_-\/>task\_runner-\/>PostNonNestableDelayedTask(}
\DoxyCodeLine{553             std::move(task), rel\_timeout.InSecondsF());}
\DoxyCodeLine{554       \}}
\DoxyCodeLine{555 }
\DoxyCodeLine{556       wait\_list-\/>AddNode(node);}
\DoxyCodeLine{557     \}}
\DoxyCodeLine{558 }
\DoxyCodeLine{559     \textcolor{comment}{// Leaving the block collapses the following steps:}}
\DoxyCodeLine{560     \textcolor{comment}{// 18.a. Perform LeaveCriticalSection(WL).}}
\DoxyCodeLine{561     \textcolor{comment}{// 19.b. Perform LeaveCriticalSection(WL).}}
\DoxyCodeLine{562     \textcolor{comment}{// 24. Perform LeaveCriticalSection(WL).}}
\DoxyCodeLine{563   \}}
\DoxyCodeLine{564 }
\DoxyCodeLine{565   \textcolor{keywordflow}{switch} (result\_kind) \{}
\DoxyCodeLine{566     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1internal_a271f8ea99b7c0bbd771df015d4e4cf21a26a5934e256740899f4fd130f028fc70}{ResultKind::kNotEqual}}:}
\DoxyCodeLine{567       \textcolor{comment}{// 18. If v is not equal to w, then}}
\DoxyCodeLine{568       \textcolor{comment}{//   ...}}
\DoxyCodeLine{569       \textcolor{comment}{//   c. Perform ! CreateDataPropertyOrThrow(resultObject, "{}async"{}, false).}}
\DoxyCodeLine{570       \textcolor{comment}{//   d. Perform ! CreateDataPropertyOrThrow(resultObject, "{}value"{},}}
\DoxyCodeLine{571       \textcolor{comment}{//     "{}not-\/equal"{}).}}
\DoxyCodeLine{572       \textcolor{comment}{//   e. Return resultObject.}}
\DoxyCodeLine{573       \mbox{\hyperlink{src_2base_2logging_8h_a3e1cfef60e774a81f30eaddf26a3a274}{CHECK}}(\mbox{\hyperlink{classv8_1_1internal_1_1JSReceiver_ab0d496ab5c687ec63fed2abbc354df25}{JSReceiver::CreateDataProperty}}(}
\DoxyCodeLine{574                 isolate, \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}}, factory-\/>async\_string(),}
\DoxyCodeLine{575                 factory-\/>false\_value(), \mbox{\hyperlink{namespacev8_a41f0e280eadfba6ac9afd833fdd540cf}{Just}}(\mbox{\hyperlink{namespacev8_1_1internal_adbf2c933630f2f4bb419ce1ba04ce760a4b0c7b00af69f6f81914acaa3a9849ee}{kDontThrow}}))}
\DoxyCodeLine{576                 .FromJust());}
\DoxyCodeLine{577       \mbox{\hyperlink{src_2base_2logging_8h_a3e1cfef60e774a81f30eaddf26a3a274}{CHECK}}(\mbox{\hyperlink{classv8_1_1internal_1_1JSReceiver_ab0d496ab5c687ec63fed2abbc354df25}{JSReceiver::CreateDataProperty}}(}
\DoxyCodeLine{578                 isolate, \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}}, factory-\/>value\_string(),}
\DoxyCodeLine{579                 factory-\/>not\_equal\_string(), \mbox{\hyperlink{namespacev8_a41f0e280eadfba6ac9afd833fdd540cf}{Just}}(\mbox{\hyperlink{namespacev8_1_1internal_adbf2c933630f2f4bb419ce1ba04ce760a4b0c7b00af69f6f81914acaa3a9849ee}{kDontThrow}}))}
\DoxyCodeLine{580                 .FromJust());}
\DoxyCodeLine{581       \textcolor{keywordflow}{break};}
\DoxyCodeLine{582 }
\DoxyCodeLine{583     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1internal_ab0bd7b471763696d390be70adeb48da7a42f405b6977fc9a5b6b2bc88a836a140}{ResultKind::kTimedOut}}:}
\DoxyCodeLine{584       \textcolor{comment}{// 19. If t is 0 and mode is async, then}}
\DoxyCodeLine{585       \textcolor{comment}{//   ...}}
\DoxyCodeLine{586       \textcolor{comment}{//   c. Perform ! CreateDataPropertyOrThrow(resultObject, "{}async"{}, false).}}
\DoxyCodeLine{587       \textcolor{comment}{//   d. Perform ! CreateDataPropertyOrThrow(resultObject, "{}value"{},}}
\DoxyCodeLine{588       \textcolor{comment}{//     "{}timed-\/out"{}).}}
\DoxyCodeLine{589       \textcolor{comment}{//   e. Return resultObject.}}
\DoxyCodeLine{590       \mbox{\hyperlink{src_2base_2logging_8h_a3e1cfef60e774a81f30eaddf26a3a274}{CHECK}}(\mbox{\hyperlink{classv8_1_1internal_1_1JSReceiver_ab0d496ab5c687ec63fed2abbc354df25}{JSReceiver::CreateDataProperty}}(}
\DoxyCodeLine{591                 isolate, \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}}, factory-\/>async\_string(),}
\DoxyCodeLine{592                 factory-\/>false\_value(), \mbox{\hyperlink{namespacev8_a41f0e280eadfba6ac9afd833fdd540cf}{Just}}(\mbox{\hyperlink{namespacev8_1_1internal_adbf2c933630f2f4bb419ce1ba04ce760a4b0c7b00af69f6f81914acaa3a9849ee}{kDontThrow}}))}
\DoxyCodeLine{593                 .FromJust());}
\DoxyCodeLine{594       \mbox{\hyperlink{src_2base_2logging_8h_a3e1cfef60e774a81f30eaddf26a3a274}{CHECK}}(\mbox{\hyperlink{classv8_1_1internal_1_1JSReceiver_ab0d496ab5c687ec63fed2abbc354df25}{JSReceiver::CreateDataProperty}}(}
\DoxyCodeLine{595                 isolate, \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}}, factory-\/>value\_string(),}
\DoxyCodeLine{596                 factory-\/>timed\_out\_string(), \mbox{\hyperlink{namespacev8_a41f0e280eadfba6ac9afd833fdd540cf}{Just}}(\mbox{\hyperlink{namespacev8_1_1internal_adbf2c933630f2f4bb419ce1ba04ce760a4b0c7b00af69f6f81914acaa3a9849ee}{kDontThrow}}))}
\DoxyCodeLine{597                 .FromJust());}
\DoxyCodeLine{598       \textcolor{keywordflow}{break};}
\DoxyCodeLine{599 }
\DoxyCodeLine{600     \textcolor{keywordflow}{case} ResultKind::kAsync:}
\DoxyCodeLine{601       \textcolor{comment}{// Add the Promise into the NativeContext's atomics\_waitasync\_promises}}
\DoxyCodeLine{602       \textcolor{comment}{// set, so that the list keeps it alive.}}
\DoxyCodeLine{603       DirectHandle<NativeContext> \mbox{\hyperlink{namespacev8_1_1internal_afe601ad9b4b4c61d8a6a700e7db12c2a}{native\_context}}(isolate-\/>native\_context());}
\DoxyCodeLine{604       DirectHandle<OrderedHashSet> promises(}
\DoxyCodeLine{605           \mbox{\hyperlink{namespacev8_1_1internal_afe601ad9b4b4c61d8a6a700e7db12c2a}{native\_context}}-\/>atomics\_waitasync\_promises(), isolate);}
\DoxyCodeLine{606       promises = \mbox{\hyperlink{namespacev8_1_1bigint_a6d4d2ce18897aba0f90b3208eca29a5b}{OrderedHashSet::Add}}(isolate, promises, promise\_capability)}
\DoxyCodeLine{607                      .ToHandleChecked();}
\DoxyCodeLine{608       \mbox{\hyperlink{namespacev8_1_1internal_afe601ad9b4b4c61d8a6a700e7db12c2a}{native\_context}}-\/>set\_atomics\_waitasync\_promises(*promises);}
\DoxyCodeLine{609 }
\DoxyCodeLine{610       \textcolor{comment}{// 26. Perform ! CreateDataPropertyOrThrow(resultObject, "{}async"{}, true).}}
\DoxyCodeLine{611       \textcolor{comment}{// 27. Perform ! CreateDataPropertyOrThrow(resultObject, "{}value"{},}}
\DoxyCodeLine{612       \textcolor{comment}{// promiseCapability.[[Promise]]).}}
\DoxyCodeLine{613       \textcolor{comment}{// 28. Return resultObject.}}
\DoxyCodeLine{614       \mbox{\hyperlink{src_2base_2logging_8h_a3e1cfef60e774a81f30eaddf26a3a274}{CHECK}}(\mbox{\hyperlink{classv8_1_1internal_1_1JSReceiver_ab0d496ab5c687ec63fed2abbc354df25}{JSReceiver::CreateDataProperty}}(}
\DoxyCodeLine{615                 isolate, \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}}, factory-\/>async\_string(), factory-\/>true\_value(),}
\DoxyCodeLine{616                 \mbox{\hyperlink{namespacev8_a41f0e280eadfba6ac9afd833fdd540cf}{Just}}(\mbox{\hyperlink{namespacev8_1_1internal_adbf2c933630f2f4bb419ce1ba04ce760a4b0c7b00af69f6f81914acaa3a9849ee}{kDontThrow}}))}
\DoxyCodeLine{617                 .FromJust());}
\DoxyCodeLine{618       \mbox{\hyperlink{src_2base_2logging_8h_a3e1cfef60e774a81f30eaddf26a3a274}{CHECK}}(\mbox{\hyperlink{classv8_1_1internal_1_1JSReceiver_ab0d496ab5c687ec63fed2abbc354df25}{JSReceiver::CreateDataProperty}}(isolate, \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}},}
\DoxyCodeLine{619                                            factory-\/>value\_string(),}
\DoxyCodeLine{620                                            promise\_capability, \mbox{\hyperlink{namespacev8_a41f0e280eadfba6ac9afd833fdd540cf}{Just}}(\mbox{\hyperlink{namespacev8_1_1internal_adbf2c933630f2f4bb419ce1ba04ce760a4b0c7b00af69f6f81914acaa3a9849ee}{kDontThrow}}))}
\DoxyCodeLine{621                 .FromJust());}
\DoxyCodeLine{622       \textcolor{keywordflow}{break};}
\DoxyCodeLine{623   \}}
\DoxyCodeLine{624 }
\DoxyCodeLine{625   \textcolor{keywordflow}{return} *\mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}};}
\DoxyCodeLine{626 \}}

\end{DoxyCode}


References v8\+::bigint\+::\+Add(), v8\+::internal\+::\+Futex\+Wait\+List\+::\+Add\+Node(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::async\+\_\+state\+\_\+, v8\+::internal\+::\+Byte\+Reverse(), CHECK, v8\+::internal\+::\+JSReceiver\+::\+Create\+Data\+Property(), v8\+::internal\+::\+DCHECK(), v8\+::internal\+::\+Isolate\+::factory(), v8\+::base\+::\+Time\+Delta\+::\+From\+Nanoseconds(), Futex\+Wait\+List\+Node, v8\+::base\+::\+Time\+Delta\+::\+In\+Seconds\+F(), v8\+::\+Just(), k\+Async, v8\+::internal\+::k\+Dont\+Throw, v8\+::internal\+::k\+Int32\+Size, v8\+::internal\+::k\+Int64\+Size, k\+Is\+Wasm, v8\+::internal\+::k\+Not\+Equal, v8\+::internal\+::k\+Timed\+Out, v8\+::internal\+::\+Futex\+Wait\+List\+::mutex(), v8\+::internal\+::\+Isolate\+::native\+\_\+context(), v8\+::internal\+::native\+\_\+context, v8\+::internal\+::\+Factory\+::\+New\+JSObject(), v8\+::internal\+::\+Factory\+::\+New\+JSPromise(), v8\+::base\+::\+Time\+Ticks\+::\+Now(), v8\+::base\+::internal\+::result, v8\+::internal\+::\+Futex\+Wait\+List\+::\+To\+Wait\+Location(), and v8\+::internal\+::value.



Referenced by Wait().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a5b7d42b92773aeab3587c46d86d68d24_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a5b7d42b92773aeab3587c46d86d68d24_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a6a412db5fdd2af66e5c33f8c3026dee8}\label{classv8_1_1internal_1_1FutexEmulation_a6a412db5fdd2af66e5c33f8c3026dee8}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!WaitJs32@{WaitJs32}}
\index{WaitJs32@{WaitJs32}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{WaitJs32()}{WaitJs32()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ v8\+::internal\+::\+Futex\+Emulation\+::\+Wait\+Js32 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045}{Wait\+Mode}}}]{mode,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$}]{array\+\_\+buffer,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}}]{addr,  }\item[{int32\+\_\+t}]{value,  }\item[{double}]{rel\+\_\+timeout\+\_\+ms }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 287 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{289                                                        \{}
\DoxyCodeLine{290   \mbox{\hyperlink{namespacev8_1_1internal_a5297fd2c72981b2220e6b9a831570fb3}{Tagged<Object>}} res =}
\DoxyCodeLine{291       Wait<int32\_t>(isolate, \mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}}, array\_buffer, addr, \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, rel\_timeout\_ms);}
\DoxyCodeLine{292   \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02futex-emulation_8cc_03_ae8b9b8a1ed2f0cde5aafb40596310806}{WaitJsTranslateReturn}}(isolate, res);}
\DoxyCodeLine{293 \}}

\end{DoxyCode}


References mode(), v8\+::internal\+::value, and v8\+::internal\+::anonymous\+\_\+namespace\{futex-\/emulation.\+cc\}\+::\+Wait\+Js\+Translate\+Return().



Referenced by v8\+::internal\+::\+Do\+Wait().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a6a412db5fdd2af66e5c33f8c3026dee8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a6a412db5fdd2af66e5c33f8c3026dee8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a5c745db4eaa564a11d52c835748f929d}\label{classv8_1_1internal_1_1FutexEmulation_a5c745db4eaa564a11d52c835748f929d}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!WaitJs64@{WaitJs64}}
\index{WaitJs64@{WaitJs64}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{WaitJs64()}{WaitJs64()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ v8\+::internal\+::\+Futex\+Emulation\+::\+Wait\+Js64 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a0c49a3df8fe3fd2cb0fa8ec204c3a045}{Wait\+Mode}}}]{mode,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$}]{array\+\_\+buffer,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}}]{addr,  }\item[{int64\+\_\+t}]{value,  }\item[{double}]{rel\+\_\+timeout\+\_\+ms }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 295 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{297                                                        \{}
\DoxyCodeLine{298   \mbox{\hyperlink{namespacev8_1_1internal_a5297fd2c72981b2220e6b9a831570fb3}{Tagged<Object>}} res =}
\DoxyCodeLine{299       Wait<int64\_t>(isolate, \mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}}, array\_buffer, addr, \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}, rel\_timeout\_ms);}
\DoxyCodeLine{300   \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02futex-emulation_8cc_03_ae8b9b8a1ed2f0cde5aafb40596310806}{WaitJsTranslateReturn}}(isolate, res);}
\DoxyCodeLine{301 \}}

\end{DoxyCode}


References mode(), v8\+::internal\+::value, and v8\+::internal\+::anonymous\+\_\+namespace\{futex-\/emulation.\+cc\}\+::\+Wait\+Js\+Translate\+Return().



Referenced by v8\+::internal\+::\+Do\+Wait().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a5c745db4eaa564a11d52c835748f929d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a5c745db4eaa564a11d52c835748f929d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a07d062c5c0ffcf41500b433d7ce5f6a3}\label{classv8_1_1internal_1_1FutexEmulation_a07d062c5c0ffcf41500b433d7ce5f6a3}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!WaitSync@{WaitSync}}
\index{WaitSync@{WaitSync}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{WaitSync()}{WaitSync()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ v8\+::internal\+::\+Futex\+Emulation\+::\+Wait\+Sync (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$}]{array\+\_\+buffer,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}}]{addr,  }\item[{\mbox{\hyperlink{classT}{T}}}]{value,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}}}]{use\+\_\+timeout,  }\item[{int64\+\_\+t}]{rel\+\_\+timeout\+\_\+ns,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334}{Call\+Type}}}]{call\+\_\+type }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Definition at line 360 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{362                                                                            \{}
\DoxyCodeLine{363   VMState<ATOMICS\_WAIT> state(isolate);}
\DoxyCodeLine{364   base::TimeDelta rel\_timeout =}
\DoxyCodeLine{365       \mbox{\hyperlink{classv8_1_1base_1_1TimeDelta_a023a048044be14caae6555c3f1763b9e}{base::TimeDelta::FromNanoseconds}}(rel\_timeout\_ns);}
\DoxyCodeLine{366 }
\DoxyCodeLine{367   DirectHandle<Object> \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}};}
\DoxyCodeLine{368 }
\DoxyCodeLine{369   FutexWaitList* wait\_list = GetWaitList();}
\DoxyCodeLine{370   \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{FutexWaitListNode}}* node = isolate-\/>futex\_wait\_list\_node();}
\DoxyCodeLine{371   \textcolor{keywordtype}{void}* wait\_location = \mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitList_a47163132578216a1527660cfa5b68064}{FutexWaitList::ToWaitLocation}}(*array\_buffer, addr);}
\DoxyCodeLine{372 }
\DoxyCodeLine{373   base::TimeTicks timeout\_time;}
\DoxyCodeLine{374   \textcolor{keywordflow}{if} (use\_timeout) \{}
\DoxyCodeLine{375     base::TimeTicks current\_time = \mbox{\hyperlink{classv8_1_1base_1_1TimeTicks_ab0886bf0e84f1e1fcdc101021c2c0775}{base::TimeTicks::Now}}();}
\DoxyCodeLine{376     timeout\_time = current\_time + rel\_timeout;}
\DoxyCodeLine{377   \}}
\DoxyCodeLine{378 }
\DoxyCodeLine{379   \textcolor{comment}{// The following is not really a loop; the do-\/while construct makes it easier}}
\DoxyCodeLine{380   \textcolor{comment}{// to break out early.}}
\DoxyCodeLine{381   \textcolor{comment}{// Keep the code in the loop as minimal as possible, because this is all in}}
\DoxyCodeLine{382   \textcolor{comment}{// the critical section.}}
\DoxyCodeLine{383   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{384     NoGarbageCollectionMutexGuard lock\_guard(wait\_list-\/>mutex());}
\DoxyCodeLine{385 }
\DoxyCodeLine{386     std::atomic<T>* p = \textcolor{keyword}{reinterpret\_cast<}std::atomic<T>*\textcolor{keyword}{>}(wait\_location);}
\DoxyCodeLine{387     \mbox{\hyperlink{classT}{T}} loaded\_value = p-\/>load();}
\DoxyCodeLine{388 \textcolor{preprocessor}{\#if defined(V8\_TARGET\_BIG\_ENDIAN)}}
\DoxyCodeLine{389     \textcolor{comment}{// If loading a Wasm value, it needs to be reversed on Big Endian platforms.}}
\DoxyCodeLine{390     \textcolor{keywordflow}{if} (call\_type == \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334aa4680e94a71b753e6e52c8acd575b8f2}{CallType::kIsWasm}}) \{}
\DoxyCodeLine{391       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classT}{T}}) == \mbox{\hyperlink{namespacev8_1_1internal_a914d19dea357ee280bea7580796a62b5}{kInt32Size}} || \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classT}{T}}) == \mbox{\hyperlink{namespacev8_1_1internal_a191fd08d000c1fc6a1c0d14655f1b711}{kInt64Size}});}
\DoxyCodeLine{392       loaded\_value = \mbox{\hyperlink{namespacev8_1_1internal_af53a839b8395922f49d2ec23783cca6f}{ByteReverse}}(loaded\_value);}
\DoxyCodeLine{393     \}}
\DoxyCodeLine{394 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{395     \textcolor{keywordflow}{if} (loaded\_value != \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}) \{}
\DoxyCodeLine{396       \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}} =}
\DoxyCodeLine{397           \mbox{\hyperlink{namespacev8_1_1internal_a73502f55102d18cb764881bc29f35c05}{direct\_handle}}(\mbox{\hyperlink{classv8_1_1internal_1_1Smi_afe7f07102d90ccce48cbe677c88a0645}{Smi::FromInt}}(\mbox{\hyperlink{namespacev8_1_1internal_ab0bd7b471763696d390be70adeb48da7a1cbfc5b0b52f58667d7d05ec1eb9693e}{WaitReturnValue::kNotEqualValue}}), isolate);}
\DoxyCodeLine{398       \textcolor{keywordflow}{break};}
\DoxyCodeLine{399     \}}
\DoxyCodeLine{400 }
\DoxyCodeLine{401     node-\/>wait\_location\_ = wait\_location;}
\DoxyCodeLine{402     node-\/>waiting\_ = \textcolor{keyword}{true};}
\DoxyCodeLine{403     wait\_list-\/>AddNode(node);}
\DoxyCodeLine{404 }
\DoxyCodeLine{405     \textcolor{keywordflow}{while} (\textcolor{keyword}{true}) \{}
\DoxyCodeLine{406       \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(node-\/>interrupted\_)) \{}
\DoxyCodeLine{407         \textcolor{comment}{// Reset the interrupted flag while still holding the mutex.}}
\DoxyCodeLine{408         node-\/>interrupted\_ = \textcolor{keyword}{false};}
\DoxyCodeLine{409 }
\DoxyCodeLine{410         \textcolor{comment}{// Unlock the mutex here to prevent deadlock from lock ordering between}}
\DoxyCodeLine{411         \textcolor{comment}{// mutex and mutexes locked by HandleInterrupts.}}
\DoxyCodeLine{412         lock\_guard.Unlock();}
\DoxyCodeLine{413 }
\DoxyCodeLine{414         \textcolor{comment}{// Because the mutex is unlocked, we have to be careful about not}}
\DoxyCodeLine{415         \textcolor{comment}{// dropping an interrupt. The notification can happen in three different}}
\DoxyCodeLine{416         \textcolor{comment}{// places:}}
\DoxyCodeLine{417         \textcolor{comment}{// 1) Before Wait is called: the notification will be dropped, but}}
\DoxyCodeLine{418         \textcolor{comment}{//    interrupted\_ will be set to 1. This will be checked below.}}
\DoxyCodeLine{419         \textcolor{comment}{// 2) After interrupted has been checked here, but before mutex is}}
\DoxyCodeLine{420         \textcolor{comment}{//    acquired: interrupted is checked in a loop, with mutex locked.}}
\DoxyCodeLine{421         \textcolor{comment}{//    Because the wakeup signal also acquires mutex, we know it will not}}
\DoxyCodeLine{422         \textcolor{comment}{//    be able to notify until mutex is released below, when waiting on}}
\DoxyCodeLine{423         \textcolor{comment}{//    the condition variable.}}
\DoxyCodeLine{424         \textcolor{comment}{// 3) After the mutex is released in the call to WaitFor(): this}}
\DoxyCodeLine{425         \textcolor{comment}{//    notification will wake up the condition variable. node-\/>waiting()}}
\DoxyCodeLine{426         \textcolor{comment}{//    will be false, so we'll loop and then check interrupts.}}
\DoxyCodeLine{427         \mbox{\hyperlink{namespacev8_1_1internal_a5297fd2c72981b2220e6b9a831570fb3}{Tagged<Object>}} interrupt\_object =}
\DoxyCodeLine{428             isolate-\/>stack\_guard()-\/>HandleInterrupts();}
\DoxyCodeLine{429 }
\DoxyCodeLine{430         lock\_guard.Lock();}
\DoxyCodeLine{431 }
\DoxyCodeLine{432         \textcolor{keywordflow}{if} (IsException(interrupt\_object, isolate)) \{}
\DoxyCodeLine{433           \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}} = \mbox{\hyperlink{namespacev8_1_1internal_a73502f55102d18cb764881bc29f35c05}{direct\_handle}}(interrupt\_object, isolate);}
\DoxyCodeLine{434           \textcolor{keywordflow}{break};}
\DoxyCodeLine{435         \}}
\DoxyCodeLine{436       \}}
\DoxyCodeLine{437 }
\DoxyCodeLine{438       \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(node-\/>interrupted\_)) \{}
\DoxyCodeLine{439         \textcolor{comment}{// An interrupt occurred while the mutex was unlocked. Don't wait yet.}}
\DoxyCodeLine{440         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{441       \}}
\DoxyCodeLine{442 }
\DoxyCodeLine{443       \textcolor{keywordflow}{if} (!node-\/>waiting\_) \{}
\DoxyCodeLine{444         \textcolor{comment}{// We were woken via Wake.}}
\DoxyCodeLine{445         \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}} = \mbox{\hyperlink{namespacev8_1_1internal_a73502f55102d18cb764881bc29f35c05}{direct\_handle}}(\mbox{\hyperlink{classv8_1_1internal_1_1Smi_afe7f07102d90ccce48cbe677c88a0645}{Smi::FromInt}}(\mbox{\hyperlink{namespacev8_1_1internal_ab0bd7b471763696d390be70adeb48da7aab5c78ddfd45f3debd6538ea7ae893e4}{WaitReturnValue::kOk}}), isolate);}
\DoxyCodeLine{446         \textcolor{keywordflow}{break};}
\DoxyCodeLine{447       \}}
\DoxyCodeLine{448 }
\DoxyCodeLine{449       \textcolor{comment}{// No interrupts, now wait.}}
\DoxyCodeLine{450       \textcolor{keywordflow}{if} (use\_timeout) \{}
\DoxyCodeLine{451         base::TimeTicks current\_time = \mbox{\hyperlink{classv8_1_1base_1_1TimeTicks_ab0886bf0e84f1e1fcdc101021c2c0775}{base::TimeTicks::Now}}();}
\DoxyCodeLine{452         \textcolor{keywordflow}{if} (current\_time >= timeout\_time) \{}
\DoxyCodeLine{453           \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}} =}
\DoxyCodeLine{454               \mbox{\hyperlink{namespacev8_1_1internal_a73502f55102d18cb764881bc29f35c05}{direct\_handle}}(\mbox{\hyperlink{classv8_1_1internal_1_1Smi_afe7f07102d90ccce48cbe677c88a0645}{Smi::FromInt}}(\mbox{\hyperlink{namespacev8_1_1internal_ab0bd7b471763696d390be70adeb48da7a42f405b6977fc9a5b6b2bc88a836a140}{WaitReturnValue::kTimedOut}}), isolate);}
\DoxyCodeLine{455           \textcolor{keywordflow}{break};}
\DoxyCodeLine{456         \}}
\DoxyCodeLine{457 }
\DoxyCodeLine{458         base::TimeDelta time\_until\_timeout = timeout\_time -\/ current\_time;}
\DoxyCodeLine{459         \mbox{\hyperlink{src_2base_2logging_8h_aabec5c3b7a8628298a25f044dcf89c25}{DCHECK\_GE}}(time\_until\_timeout.InMicroseconds(), 0);}
\DoxyCodeLine{460         \textcolor{keywordtype}{bool} wait\_for\_result =}
\DoxyCodeLine{461             node-\/>cond\_.WaitFor(wait\_list-\/>mutex(), time\_until\_timeout);}
\DoxyCodeLine{462         \mbox{\hyperlink{src_2base_2macros_8h_a280b0798f270f4b3f361c9ab64832956}{USE}}(wait\_for\_result);}
\DoxyCodeLine{463       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{464         node-\/>cond\_.Wait(wait\_list-\/>mutex());}
\DoxyCodeLine{465       \}}
\DoxyCodeLine{466 }
\DoxyCodeLine{467       \textcolor{comment}{// Spurious wakeup, interrupt or timeout.}}
\DoxyCodeLine{468     \}}
\DoxyCodeLine{469 }
\DoxyCodeLine{470     node-\/>waiting\_ = \textcolor{keyword}{false};}
\DoxyCodeLine{471     wait\_list-\/>RemoveNode(node);}
\DoxyCodeLine{472   \} \textcolor{keywordflow}{while} (\textcolor{keyword}{false});}
\DoxyCodeLine{473   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(!node-\/>waiting\_);}
\DoxyCodeLine{474 }
\DoxyCodeLine{475   \textcolor{keywordflow}{return} *\mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}};}
\DoxyCodeLine{476 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Futex\+Wait\+List\+::\+Add\+Node(), v8\+::internal\+::\+Byte\+Reverse(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::cond\+\_\+, v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+GE, v8\+::internal\+::direct\+\_\+handle(), v8\+::internal\+::\+Smi\+::\+From\+Int(), v8\+::base\+::\+Time\+Delta\+::\+From\+Nanoseconds(), v8\+::internal\+::\+Isolate\+::futex\+\_\+wait\+\_\+list\+\_\+node(), v8\+::internal\+::\+Stack\+Guard\+::\+Handle\+Interrupts(), v8\+::base\+::\+Time\+Delta\+::\+In\+Microseconds(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::interrupted\+\_\+, v8\+::internal\+::k\+Int32\+Size, v8\+::internal\+::k\+Int64\+Size, k\+Is\+Wasm, v8\+::internal\+::k\+Not\+Equal\+Value, v8\+::internal\+::k\+Ok, v8\+::internal\+::k\+Timed\+Out, v8\+::internal\+::\+No\+Garbage\+Collection\+Mutex\+Guard\+::\+Lock(), v8\+::internal\+::\+Futex\+Wait\+List\+::mutex(), v8\+::base\+::\+Time\+Ticks\+::\+Now(), v8\+::internal\+::\+Futex\+Wait\+List\+::\+Remove\+Node(), v8\+::base\+::internal\+::result, v8\+::internal\+::\+Isolate\+::stack\+\_\+guard(), v8\+::internal\+::\+Futex\+Wait\+List\+::\+To\+Wait\+Location(), v8\+::internal\+::\+No\+Garbage\+Collection\+Mutex\+Guard\+::\+Unlock(), USE, V8\+\_\+\+UNLIKELY, v8\+::internal\+::value, v8\+::base\+::\+Condition\+Variable\+::\+Wait(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::wait\+\_\+location\+\_\+, v8\+::base\+::\+Condition\+Variable\+::\+Wait\+For(), and v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::waiting\+\_\+.



Referenced by Wait().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a07d062c5c0ffcf41500b433d7ce5f6a3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a07d062c5c0ffcf41500b433d7ce5f6a3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a83aebe720a9779dc17f167841298fefe}\label{classv8_1_1internal_1_1FutexEmulation_a83aebe720a9779dc17f167841298fefe}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!WaitWasm32@{WaitWasm32}}
\index{WaitWasm32@{WaitWasm32}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{WaitWasm32()}{WaitWasm32()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ v8\+::internal\+::\+Futex\+Emulation\+::\+Wait\+Wasm32 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$}]{array\+\_\+buffer,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}}]{addr,  }\item[{int32\+\_\+t}]{value,  }\item[{int64\+\_\+t}]{rel\+\_\+timeout\+\_\+ns }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 303 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{305                                            \{}
\DoxyCodeLine{306   \textcolor{keywordflow}{return} Wait<int32\_t>(isolate, WaitMode::kSync, array\_buffer, addr, \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}},}
\DoxyCodeLine{307                        rel\_timeout\_ns >= 0, rel\_timeout\_ns, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334aa4680e94a71b753e6e52c8acd575b8f2}{CallType::kIsWasm}});}
\DoxyCodeLine{308 \}}

\end{DoxyCode}


References k\+Is\+Wasm, and v8\+::internal\+::value.



Referenced by v8\+::internal\+::wasm\+::\+Wasm\+Interpreter\+Runtime\+::\+I32\+Atomic\+Wait(), and v8\+::internal\+::\+RUNTIME\+\_\+\+FUNCTION().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a83aebe720a9779dc17f167841298fefe_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a4370cbf76c1fc0aae5f0886e9df85c7f}\label{classv8_1_1internal_1_1FutexEmulation_a4370cbf76c1fc0aae5f0886e9df85c7f}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!WaitWasm64@{WaitWasm64}}
\index{WaitWasm64@{WaitWasm64}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{WaitWasm64()}{WaitWasm64()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Object}{Object}} $>$ v8\+::internal\+::\+Futex\+Emulation\+::\+Wait\+Wasm64 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$}]{array\+\_\+buffer,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}}]{addr,  }\item[{int64\+\_\+t}]{value,  }\item[{int64\+\_\+t}]{rel\+\_\+timeout\+\_\+ns }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 310 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{312                                            \{}
\DoxyCodeLine{313   \textcolor{keywordflow}{return} Wait<int64\_t>(isolate, WaitMode::kSync, array\_buffer, addr, \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}},}
\DoxyCodeLine{314                        rel\_timeout\_ns >= 0, rel\_timeout\_ns, \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a3f260698c592acda71b87bb581f30334aa4680e94a71b753e6e52c8acd575b8f2}{CallType::kIsWasm}});}
\DoxyCodeLine{315 \}}

\end{DoxyCode}


References k\+Is\+Wasm, and v8\+::internal\+::value.



Referenced by v8\+::internal\+::wasm\+::\+Wasm\+Interpreter\+Runtime\+::\+I64\+Atomic\+Wait(), and v8\+::internal\+::\+RUNTIME\+\_\+\+FUNCTION().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a4370cbf76c1fc0aae5f0886e9df85c7f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_ae1ce6ea182343b95d38dbf1c439d8fe4}\label{classv8_1_1internal_1_1FutexEmulation_ae1ce6ea182343b95d38dbf1c439d8fe4}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!Wake@{Wake}}
\index{Wake@{Wake}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{Wake()}{Wake()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{classint}{int}} v8\+::internal\+::\+Futex\+Emulation\+::\+Wake (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSArrayBuffer}{JSArray\+Buffer}} $>$}]{array\+\_\+buffer,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}}]{addr,  }\item[{uint32\+\_\+t}]{num\+\_\+waiters\+\_\+to\+\_\+wake }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 628 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{629                                                        \{}
\DoxyCodeLine{630   \textcolor{keywordtype}{void}* wait\_location = \mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitList_a47163132578216a1527660cfa5b68064}{FutexWaitList::ToWaitLocation}}(array\_buffer, addr);}
\DoxyCodeLine{631   \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_ae1ce6ea182343b95d38dbf1c439d8fe4}{Wake}}(wait\_location, num\_waiters\_to\_wake);}
\DoxyCodeLine{632 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Futex\+Wait\+List\+::\+To\+Wait\+Location().



Referenced by v8\+::internal\+::wasm\+::\+Wasm\+Interpreter\+Runtime\+::\+Atomic\+Notify(), and v8\+::internal\+::\+BUILTIN().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_ae1ce6ea182343b95d38dbf1c439d8fe4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_ae1ce6ea182343b95d38dbf1c439d8fe4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a8b147798c1ea50ec5f5c11ef5e2083b6}\label{classv8_1_1internal_1_1FutexEmulation_a8b147798c1ea50ec5f5c11ef5e2083b6}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!Wake@{Wake}}
\index{Wake@{Wake}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{Wake()}{Wake()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{classint}{int}} v8\+::internal\+::\+Futex\+Emulation\+::\+Wake (\begin{DoxyParamCaption}\item[{void $\ast$}]{addr,  }\item[{uint32\+\_\+t}]{num\+\_\+waiters\+\_\+to\+\_\+wake }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 634 of file futex-\/emulation.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{634                                                                           \{}
\DoxyCodeLine{635   \textcolor{keywordtype}{int} num\_waiters\_woken = 0;}
\DoxyCodeLine{636   FutexWaitList* wait\_list = GetWaitList();}
\DoxyCodeLine{637   NoGarbageCollectionMutexGuard lock\_guard(wait\_list-\/>mutex());}
\DoxyCodeLine{638 }
\DoxyCodeLine{639   \textcolor{keyword}{auto}\& location\_lists = wait\_list-\/>location\_lists\_;}
\DoxyCodeLine{640   \textcolor{keyword}{auto} it = location\_lists.find(wait\_location);}
\DoxyCodeLine{641   \textcolor{keywordflow}{if} (it == location\_lists.end()) \textcolor{keywordflow}{return} num\_waiters\_woken;}
\DoxyCodeLine{642 }
\DoxyCodeLine{643   \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{FutexWaitListNode}}* node = it-\/>second.head;}
\DoxyCodeLine{644   \textcolor{keywordflow}{while} (node \&\& num\_waiters\_to\_wake > 0) \{}
\DoxyCodeLine{645     \textcolor{keywordflow}{if} (!node-\/>waiting\_) \{}
\DoxyCodeLine{646       node = node-\/>next\_;}
\DoxyCodeLine{647       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{648     \}}
\DoxyCodeLine{649     \textcolor{comment}{// Relying on wait\_location\_ here is not enough, since we need to guard}}
\DoxyCodeLine{650     \textcolor{comment}{// against the case where the BackingStore of the node has been deleted}}
\DoxyCodeLine{651     \textcolor{comment}{// during an async wait and a new BackingStore recreated in the same memory}}
\DoxyCodeLine{652     \textcolor{comment}{// area. Note that sync wait always keeps the backing store alive.}}
\DoxyCodeLine{653     \textcolor{comment}{// It is sufficient to check whether the node's backing store is expired}}
\DoxyCodeLine{654     \textcolor{comment}{// (and consider this a non-\/match). If it is not expired, it must be}}
\DoxyCodeLine{655     \textcolor{comment}{// identical to the backing store from which wait\_location was computed by}}
\DoxyCodeLine{656     \textcolor{comment}{// the caller. In that case, the current context holds the arraybuffer and}}
\DoxyCodeLine{657     \textcolor{comment}{// backing store alive during this call, so it can not expire while we}}
\DoxyCodeLine{658     \textcolor{comment}{// execute this code.}}
\DoxyCodeLine{659     \textcolor{keywordtype}{bool} matching\_backing\_store =}
\DoxyCodeLine{660         !node-\/>IsAsync() || !node-\/>async\_state\_-\/>backing\_store.expired();}
\DoxyCodeLine{661     \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a4f489f1b838163ab33f251c9e470d938}{V8\_LIKELY}}(matching\_backing\_store)) \{}
\DoxyCodeLine{662       node-\/>waiting\_ = \textcolor{keyword}{false};}
\DoxyCodeLine{663 }
\DoxyCodeLine{664       \textcolor{comment}{// Retrieve the next node to iterate before calling NotifyAsyncWaiter,}}
\DoxyCodeLine{665       \textcolor{comment}{// since NotifyAsyncWaiter will take the node out of the linked list.}}
\DoxyCodeLine{666       \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{FutexWaitListNode}}* next\_node = node-\/>next\_;}
\DoxyCodeLine{667       \textcolor{keywordflow}{if} (node-\/>IsAsync()) \{}
\DoxyCodeLine{668         \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a5058561db3da3b8eee301914f24868cb}{NotifyAsyncWaiter}}(node);}
\DoxyCodeLine{669       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{670         \textcolor{comment}{// WaitSync will remove the node from the list.}}
\DoxyCodeLine{671         node-\/>cond\_.NotifyOne();}
\DoxyCodeLine{672       \}}
\DoxyCodeLine{673       node = next\_node;}
\DoxyCodeLine{674       \textcolor{keywordflow}{if} (num\_waiters\_to\_wake != \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a44e18f878cf35172c8b7e186aa6732cb}{kWakeAll}}) \{}
\DoxyCodeLine{675         -\/-\/num\_waiters\_to\_wake;}
\DoxyCodeLine{676       \}}
\DoxyCodeLine{677       num\_waiters\_woken++;}
\DoxyCodeLine{678       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{679     \}}
\DoxyCodeLine{680 }
\DoxyCodeLine{681     \textcolor{comment}{// -\/-\/-\/}}
\DoxyCodeLine{682     \textcolor{comment}{// Code below handles the unlikely case that this node's backing store was}}
\DoxyCodeLine{683     \textcolor{comment}{// deleted during an async wait and a new one was allocated in its place.}}
\DoxyCodeLine{684     \textcolor{comment}{// We delete the node if possible (no timeout, or context is gone).}}
\DoxyCodeLine{685     \textcolor{comment}{// -\/-\/-\/}}
\DoxyCodeLine{686     \textcolor{keywordtype}{bool} delete\_this\_node = \textcolor{keyword}{false};}
\DoxyCodeLine{687     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(node-\/>IsAsync());}
\DoxyCodeLine{688     \textcolor{keywordflow}{if} (node-\/>async\_state\_-\/>timeout\_time.IsNull()) \{}
\DoxyCodeLine{689       \textcolor{comment}{// Backing store has been deleted and the node is still waiting, and}}
\DoxyCodeLine{690       \textcolor{comment}{// there's no timeout. It's never going to be woken up, so we can clean it}}
\DoxyCodeLine{691       \textcolor{comment}{// up now. We don't need to cancel the timeout task, because there is}}
\DoxyCodeLine{692       \textcolor{comment}{// none.}}
\DoxyCodeLine{693 }
\DoxyCodeLine{694       \textcolor{comment}{// This cleanup code is not very efficient, since it only kicks in when}}
\DoxyCodeLine{695       \textcolor{comment}{// a new BackingStore has been created in the same memory area where the}}
\DoxyCodeLine{696       \textcolor{comment}{// deleted BackingStore was.}}
\DoxyCodeLine{697       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(node-\/>IsAsync());}
\DoxyCodeLine{698       \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(\mbox{\hyperlink{classv8_1_1internal_1_1CancelableTaskManager_aeced01d51e2e17fe43f5286404519146}{CancelableTaskManager::kInvalidTaskId}},}
\DoxyCodeLine{699                 node-\/>async\_state\_-\/>timeout\_task\_id);}
\DoxyCodeLine{700       delete\_this\_node = \textcolor{keyword}{true};}
\DoxyCodeLine{701     \}}
\DoxyCodeLine{702     \textcolor{keywordflow}{if} (node-\/>async\_state\_-\/>native\_context.IsEmpty()) \{}
\DoxyCodeLine{703       \textcolor{comment}{// The NativeContext related to the async waiter has been deleted.}}
\DoxyCodeLine{704       \textcolor{comment}{// Ditto, clean up now.}}
\DoxyCodeLine{705 }
\DoxyCodeLine{706       \textcolor{comment}{// Using the CancelableTaskManager here is OK since the Isolate is}}
\DoxyCodeLine{707       \textcolor{comment}{// guaranteed to be alive -\/ FutexEmulation::IsolateDeinit removes all}}
\DoxyCodeLine{708       \textcolor{comment}{// FutexWaitListNodes owned by an Isolate which is going to die.}}
\DoxyCodeLine{709       \textcolor{keywordflow}{if} (node-\/>CancelTimeoutTask()) \{}
\DoxyCodeLine{710         delete\_this\_node = \textcolor{keyword}{true};}
\DoxyCodeLine{711       \}}
\DoxyCodeLine{712       \textcolor{comment}{// If cancelling the timeout task failed, the timeout task is already}}
\DoxyCodeLine{713       \textcolor{comment}{// running and will clean up the node.}}
\DoxyCodeLine{714     \}}
\DoxyCodeLine{715 }
\DoxyCodeLine{716     \mbox{\hyperlink{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}{FutexWaitListNode}}* next\_node = node-\/>next\_;}
\DoxyCodeLine{717     \textcolor{keywordflow}{if} (delete\_this\_node) \{}
\DoxyCodeLine{718       wait\_list-\/>RemoveNode(node);}
\DoxyCodeLine{719       \textcolor{keyword}{delete} node;}
\DoxyCodeLine{720     \}}
\DoxyCodeLine{721     node = next\_node;}
\DoxyCodeLine{722   \}}
\DoxyCodeLine{723 }
\DoxyCodeLine{724   \textcolor{keywordflow}{return} num\_waiters\_woken;}
\DoxyCodeLine{725 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::async\+\_\+state\+\_\+, v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::\+Cancel\+Timeout\+Task(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::cond\+\_\+, v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+EQ, v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::\+Is\+Async(), v8\+::internal\+::\+Cancelable\+Task\+Manager\+::k\+Invalid\+Task\+Id, k\+Wake\+All, v8\+::internal\+::\+Futex\+Wait\+List\+::location\+\_\+lists\+\_\+, v8\+::internal\+::\+Futex\+Wait\+List\+::mutex(), v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::next\+\_\+, Notify\+Async\+Waiter(), v8\+::base\+::\+Condition\+Variable\+::\+Notify\+One(), v8\+::internal\+::\+Futex\+Wait\+List\+::\+Remove\+Node(), V8\+\_\+\+LIKELY, and v8\+::internal\+::\+Futex\+Wait\+List\+Node\+::waiting\+\_\+.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1FutexEmulation_a8b147798c1ea50ec5f5c11ef5e2083b6_cgraph}
\end{center}
\end{figure}


\doxysubsection{Friends And Related Function Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_ad097217dccf17302f39715f49205252b}\label{classv8_1_1internal_1_1FutexEmulation_ad097217dccf17302f39715f49205252b}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!AsyncWaiterTimeoutTask@{AsyncWaiterTimeoutTask}}
\index{AsyncWaiterTimeoutTask@{AsyncWaiterTimeoutTask}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{AsyncWaiterTimeoutTask}{AsyncWaiterTimeoutTask}}
{\footnotesize\ttfamily friend class \mbox{\hyperlink{classv8_1_1internal_1_1AsyncWaiterTimeoutTask}{Async\+Waiter\+Timeout\+Task}}\hspace{0.3cm}{\ttfamily [friend]}}



Definition at line 202 of file futex-\/emulation.\+h.

\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}\label{classv8_1_1internal_1_1FutexEmulation_a468b1954483b12644e4ac971b41740f2}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!FutexWaitListNode@{FutexWaitListNode}}
\index{FutexWaitListNode@{FutexWaitListNode}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{FutexWaitListNode}{FutexWaitListNode}}
{\footnotesize\ttfamily friend class \mbox{\hyperlink{classv8_1_1internal_1_1FutexWaitListNode}{Futex\+Wait\+List\+Node}}\hspace{0.3cm}{\ttfamily [friend]}}



Definition at line 200 of file futex-\/emulation.\+h.



Referenced by Wait\+Async().

\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a9d159ab7a7dc5d26ed16d0d8e25de542}\label{classv8_1_1internal_1_1FutexEmulation_a9d159ab7a7dc5d26ed16d0d8e25de542}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!ResolveAsyncWaiterPromisesTask@{ResolveAsyncWaiterPromisesTask}}
\index{ResolveAsyncWaiterPromisesTask@{ResolveAsyncWaiterPromisesTask}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{ResolveAsyncWaiterPromisesTask}{ResolveAsyncWaiterPromisesTask}}
{\footnotesize\ttfamily friend class \mbox{\hyperlink{classv8_1_1internal_1_1ResolveAsyncWaiterPromisesTask}{Resolve\+Async\+Waiter\+Promises\+Task}}\hspace{0.3cm}{\ttfamily [friend]}}



Definition at line 201 of file futex-\/emulation.\+h.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1FutexEmulation_a44e18f878cf35172c8b7e186aa6732cb}\label{classv8_1_1internal_1_1FutexEmulation_a44e18f878cf35172c8b7e186aa6732cb}} 
\index{v8::internal::FutexEmulation@{v8::internal::FutexEmulation}!kWakeAll@{kWakeAll}}
\index{kWakeAll@{kWakeAll}!v8::internal::FutexEmulation@{v8::internal::FutexEmulation}}
\doxysubsubsection{\texorpdfstring{kWakeAll}{kWakeAll}}
{\footnotesize\ttfamily const uint32\+\_\+t v8\+::internal\+::\+Futex\+Emulation\+::k\+Wake\+All = UINT32\+\_\+\+MAX\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 144 of file futex-\/emulation.\+h.



Referenced by Wake().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/mnt/\+V8\+Source\+Code/src/execution/\mbox{\hyperlink{futex-emulation_8h}{futex-\/emulation.\+h}}\item 
/mnt/\+V8\+Source\+Code/src/execution/\mbox{\hyperlink{futex-emulation_8cc}{futex-\/emulation.\+cc}}\end{DoxyCompactItemize}
