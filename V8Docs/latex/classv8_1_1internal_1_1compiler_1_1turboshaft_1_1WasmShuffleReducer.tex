\hypertarget{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer}{}\doxysection{v8\+::internal\+::compiler\+::turboshaft\+::Wasm\+Shuffle\+Reducer$<$ Next $>$ Class Template Reference}
\label{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer}\index{v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$@{v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$}}


{\ttfamily \#include $<$wasm-\/shuffle-\/reducer.\+h$>$}



Inheritance diagram for v8\+::internal\+::compiler\+::turboshaft\+::Wasm\+Shuffle\+Reducer$<$ Next $>$\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for v8\+::internal\+::compiler\+::turboshaft\+::Wasm\+Shuffle\+Reducer$<$ Next $>$\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=295pt]{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_ac97c63cd1d2dfd0abe2467c50cabbc58}{Analyze}} ()
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1OpIndex}{Op\+Index}} REDUCE\+\_\+\+INPUT\+\_\+\+GRAPH() \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_acb23944f928f594fc6084c737980c4d6}{Simd128\+Shuffle}} (\mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1OpIndex}{Op\+Index}} ig\+\_\+index, const Simd128\+Shuffle\+Op \&shuffle)
\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::optional$<$ \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleAnalyzer}{Wasm\+Shuffle\+Analyzer}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\+\_\+}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$class Next$>$\newline
class v8\+::internal\+::compiler\+::turboshaft\+::\+Wasm\+Shuffle\+Reducer$<$ Next $>$}



Definition at line 227 of file wasm-\/shuffle-\/reducer.\+h.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_ac97c63cd1d2dfd0abe2467c50cabbc58}\label{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_ac97c63cd1d2dfd0abe2467c50cabbc58}} 
\index{v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$@{v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$}!Analyze@{Analyze}}
\index{Analyze@{Analyze}!v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$@{v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$}}
\doxysubsubsection{\texorpdfstring{Analyze()}{Analyze()}}
{\footnotesize\ttfamily template$<$class Next $>$ \\
void \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer}{v8\+::internal\+::compiler\+::turboshaft\+::\+Wasm\+Shuffle\+Reducer}}$<$ Next $>$\+::Analyze (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 277 of file wasm-\/shuffle-\/reducer.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{277                  \{}
\DoxyCodeLine{278     \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}.emplace(\mbox{\hyperlink{baseline-assembler-arm-inl_8h_a0a87998f4e8cee4888f2a89df3d5639b}{\_\_}} phase\_zone(), \mbox{\hyperlink{baseline-assembler-arm-inl_8h_a0a87998f4e8cee4888f2a89df3d5639b}{\_\_}} input\_graph());}
\DoxyCodeLine{279     \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>Run();}
\DoxyCodeLine{280     Next::Analyze();}
\DoxyCodeLine{281   \}}

\end{DoxyCode}


References \+\_\+\+\_\+, and v8\+::internal\+::compiler\+::turboshaft\+::\+Wasm\+Shuffle\+Reducer$<$ Next $>$\+::analyzer\+\_\+.

\mbox{\Hypertarget{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_acb23944f928f594fc6084c737980c4d6}\label{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_acb23944f928f594fc6084c737980c4d6}} 
\index{v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$@{v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$}!Simd128Shuffle@{Simd128Shuffle}}
\index{Simd128Shuffle@{Simd128Shuffle}!v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$@{v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$}}
\doxysubsubsection{\texorpdfstring{Simd128Shuffle()}{Simd128Shuffle()}}
{\footnotesize\ttfamily template$<$class Next $>$ \\
\mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1OpIndex}{Op\+Index}} REDUCE\+\_\+\+INPUT\+\_\+\+GRAPH() \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer}{v8\+::internal\+::compiler\+::turboshaft\+::\+Wasm\+Shuffle\+Reducer}}$<$ Next $>$\+::Simd128\+Shuffle (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1OpIndex}{Op\+Index}}}]{ig\+\_\+index,  }\item[{const Simd128\+Shuffle\+Op \&}]{shuffle }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 334 of file wasm-\/shuffle-\/reducer.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{335                                                                               \{}
\DoxyCodeLine{336     \mbox{\hyperlink{compiler_2turboshaft_2assembler_8h_a7a449d0096649ec2e7ec91ea05833a5d}{LABEL\_BLOCK}}(no\_change) \{}
\DoxyCodeLine{337       \textcolor{keywordflow}{return} Next::ReduceInputGraphSimd128Shuffle(ig\_index, shuffle);}
\DoxyCodeLine{338     \}}
\DoxyCodeLine{339     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_1_1compiler_1_1turboshaft_ac4d098a2688a019f309cb6f242bb421a}{ShouldSkipOptimizationStep}}()) \textcolor{keywordflow}{goto} no\_change;}
\DoxyCodeLine{340 }
\DoxyCodeLine{341     \textcolor{keywordflow}{if} (shuffle.kind != Simd128ShuffleOp::Kind::kI8x16) \textcolor{keywordflow}{goto} no\_change;}
\DoxyCodeLine{342 }
\DoxyCodeLine{343     \textcolor{keyword}{auto} og\_left = \mbox{\hyperlink{baseline-assembler-arm-inl_8h_a0a87998f4e8cee4888f2a89df3d5639b}{\_\_}} MapToNewGraph(shuffle.left());}
\DoxyCodeLine{344     \textcolor{keyword}{auto} og\_right = \mbox{\hyperlink{baseline-assembler-arm-inl_8h_a0a87998f4e8cee4888f2a89df3d5639b}{\_\_}} MapToNewGraph(shuffle.right());}
\DoxyCodeLine{345     std::array<uint8\_t, kSimd128Size> shuffle\_bytes = \{0\};}
\DoxyCodeLine{346     std::copy(shuffle.shuffle, shuffle.shuffle + \mbox{\hyperlink{namespacev8_1_1internal_a1ac5aaec8d986abe45d958e665beb21a}{kSimd128Size}},}
\DoxyCodeLine{347               shuffle\_bytes.begin());}
\DoxyCodeLine{348 \textcolor{preprocessor}{\#if V8\_ENABLE\_WASM\_DEINTERLEAVED\_MEM\_OPS}}
\DoxyCodeLine{349     \textcolor{keywordflow}{if} (\textcolor{keyword}{auto} maybe\_deinterleaved\_load = IsDeinterleaveLoadShuffle(\&shuffle)) \{}
\DoxyCodeLine{350       \textcolor{keyword}{const} \textcolor{keyword}{auto}* deinterleaved\_load = maybe\_deinterleaved\_load.value();}
\DoxyCodeLine{351       \textcolor{keywordflow}{return} \mbox{\hyperlink{baseline-assembler-arm-inl_8h_a0a87998f4e8cee4888f2a89df3d5639b}{\_\_}} Projection(deinterleaved\_load-\/>og\_index,}
\DoxyCodeLine{352                            deinterleaved\_load-\/>result\_index,}
\DoxyCodeLine{353                            \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1RegisterRepresentation_a49ef31a09de67cdeb2a1babcafca9170}{RegisterRepresentation::Simd128}}());}
\DoxyCodeLine{354     \}}
\DoxyCodeLine{355 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// V8\_ENABLE\_WASM\_DEINTERLEAVED\_MEM\_OPS}}
\DoxyCodeLine{356 }
\DoxyCodeLine{357     constexpr \textcolor{keywordtype}{size\_t} half\_lanes = \mbox{\hyperlink{namespacev8_1_1internal_a1ac5aaec8d986abe45d958e665beb21a}{kSimd128Size}} / 2;}
\DoxyCodeLine{358 }
\DoxyCodeLine{359     \textcolor{keywordtype}{bool} does\_shuffle\_into\_low\_half =}
\DoxyCodeLine{360         \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>DoesShuffleIntoLowHalf(\&shuffle);}
\DoxyCodeLine{361     \textcolor{keywordtype}{bool} does\_shuffle\_into\_high\_half =}
\DoxyCodeLine{362         \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>DoesShuffleIntoHighHalf(\&shuffle);}
\DoxyCodeLine{363 }
\DoxyCodeLine{364     \textcolor{comment}{// Shuffles to adjust because one, or both, of their inputs have been}}
\DoxyCodeLine{365     \textcolor{comment}{// narrowed.}}
\DoxyCodeLine{366     \textcolor{keywordflow}{if} (does\_shuffle\_into\_low\_half \&\& does\_shuffle\_into\_high\_half) \{}
\DoxyCodeLine{367       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(\mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>ShouldRewriteShuffleToLow(shuffle.left()));}
\DoxyCodeLine{368       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(\mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>ShouldRewriteShuffleToLow(shuffle.right()));}
\DoxyCodeLine{369       \textcolor{comment}{// We have a shuffle where both inputs have been reduced and shifted, so}}
\DoxyCodeLine{370       \textcolor{comment}{// something like this:}}
\DoxyCodeLine{371       \textcolor{comment}{// |-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/a1-\/-\/-\/|-\/-\/-\/b3-\/-\/-\/|  shf0 = (a, b)}}
\DoxyCodeLine{372       \textcolor{comment}{//}}
\DoxyCodeLine{373       \textcolor{comment}{// |-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/c2-\/-\/-\/|-\/-\/-\/d4-\/-\/-\/|  shf1 = (c, d)}}
\DoxyCodeLine{374       \textcolor{comment}{//}}
\DoxyCodeLine{375       \textcolor{comment}{// |-\/-\/-\/a1-\/-\/-\/|-\/-\/-\/b3-\/-\/-\/|-\/-\/-\/c2-\/-\/-\/|-\/-\/-\/d4-\/-\/-\/|  shf2 = (shf0, shf1)}}
\DoxyCodeLine{376       \textcolor{comment}{//}}
\DoxyCodeLine{377       \textcolor{comment}{// Is being changed into this:}}
\DoxyCodeLine{378       \textcolor{comment}{// |-\/-\/-\/a1-\/-\/-\/|-\/-\/-\/b3-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|  shf0 = (a, b)}}
\DoxyCodeLine{379       \textcolor{comment}{//}}
\DoxyCodeLine{380       \textcolor{comment}{// |-\/-\/-\/c2-\/-\/-\/|-\/-\/-\/d4-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|  shf1 = (c, d)}}
\DoxyCodeLine{381       \textcolor{comment}{//}}
\DoxyCodeLine{382       \textcolor{comment}{// |-\/-\/-\/a1-\/-\/-\/|-\/-\/-\/b3-\/-\/-\/|-\/-\/-\/c2-\/-\/-\/|-\/-\/-\/d4-\/-\/-\/|  shf2 = (shf0, shf1)}}
\DoxyCodeLine{383       std::transform(shuffle\_bytes.begin(), shuffle\_bytes.end(),}
\DoxyCodeLine{384                      shuffle\_bytes.begin(),}
\DoxyCodeLine{385                      [](uint8\_t lane) \{ return lane -\/ half\_lanes; \});}
\DoxyCodeLine{386     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (does\_shuffle\_into\_low\_half) \{}
\DoxyCodeLine{387       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(\mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>ShouldRewriteShuffleToLow(shuffle.left()) ||}
\DoxyCodeLine{388              \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>ShouldRewriteShuffleToLow(shuffle.right()));}
\DoxyCodeLine{389       \mbox{\hyperlink{src_2base_2logging_8h_a986dc8f4ec6dcd0644efe205c13f8eb7}{DCHECK\_NE}}(\mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>ShouldRewriteShuffleToLow(shuffle.left()),}
\DoxyCodeLine{390                 \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>ShouldRewriteShuffleToLow(shuffle.right()));}
\DoxyCodeLine{391       \textcolor{comment}{// We have a shuffle where both inputs have been reduced and one has}}
\DoxyCodeLine{392       \textcolor{comment}{// been shifted, so something like this:}}
\DoxyCodeLine{393       \textcolor{comment}{// |-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/a1-\/-\/-\/|-\/-\/-\/b3-\/-\/-\/|  shf0 = (a, b)}}
\DoxyCodeLine{394       \textcolor{comment}{//}}
\DoxyCodeLine{395       \textcolor{comment}{// |-\/-\/-\/c2-\/-\/-\/|-\/-\/-\/d4-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|  shf1 = (c, d)}}
\DoxyCodeLine{396       \textcolor{comment}{//}}
\DoxyCodeLine{397       \textcolor{comment}{// |-\/-\/-\/a1-\/-\/-\/|-\/-\/-\/b3-\/-\/-\/|-\/-\/-\/c2-\/-\/-\/|-\/-\/-\/d4-\/-\/-\/|  shf2 = (shf0, shf1)}}
\DoxyCodeLine{398       \textcolor{comment}{//}}
\DoxyCodeLine{399       \textcolor{comment}{// Is being changed into this:}}
\DoxyCodeLine{400       \textcolor{comment}{// |-\/-\/-\/a1-\/-\/-\/|-\/-\/-\/b3-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|  shf0 = (a, b)}}
\DoxyCodeLine{401       \textcolor{comment}{//}}
\DoxyCodeLine{402       \textcolor{comment}{// |-\/-\/-\/c2-\/-\/-\/|-\/-\/-\/d4-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|  shf1 = (c, d)}}
\DoxyCodeLine{403       \textcolor{comment}{//}}
\DoxyCodeLine{404       \textcolor{comment}{// |-\/-\/-\/a1-\/-\/-\/|-\/-\/-\/b3-\/-\/-\/|-\/-\/-\/c2-\/-\/-\/|-\/-\/-\/d4-\/-\/-\/|  shf2 = (shf0, shf1)}}
\DoxyCodeLine{405       \textcolor{comment}{//}}
\DoxyCodeLine{406       \textcolor{comment}{// Original shf2 lane-\/wise shuffle: [2, 3, 4, 5]}}
\DoxyCodeLine{407       \textcolor{comment}{// Needs to be converted to: [0, 1, 4, 5]}}
\DoxyCodeLine{408       std::transform(shuffle\_bytes.begin(), shuffle\_bytes.begin() + half\_lanes,}
\DoxyCodeLine{409                      shuffle\_bytes.begin(),}
\DoxyCodeLine{410                      [](uint8\_t lane) \{ return lane -\/ half\_lanes; \});}
\DoxyCodeLine{411     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (does\_shuffle\_into\_high\_half) \{}
\DoxyCodeLine{412       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(\mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>ShouldRewriteShuffleToLow(shuffle.left()) ||}
\DoxyCodeLine{413              \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>ShouldRewriteShuffleToLow(shuffle.right()));}
\DoxyCodeLine{414       \mbox{\hyperlink{src_2base_2logging_8h_a986dc8f4ec6dcd0644efe205c13f8eb7}{DCHECK\_NE}}(\mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>ShouldRewriteShuffleToLow(shuffle.left()),}
\DoxyCodeLine{415                 \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>ShouldRewriteShuffleToLow(shuffle.right()));}
\DoxyCodeLine{416       \textcolor{comment}{// We have a shuffle where both inputs have been reduced and one has}}
\DoxyCodeLine{417       \textcolor{comment}{// been shifted, so something like this:}}
\DoxyCodeLine{418       \textcolor{comment}{// |-\/-\/-\/a1-\/-\/-\/|-\/-\/-\/b3-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|  shf0 = (a, b)}}
\DoxyCodeLine{419       \textcolor{comment}{//}}
\DoxyCodeLine{420       \textcolor{comment}{// |-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/c2-\/-\/-\/|-\/-\/-\/d4-\/-\/-\/|  shf1 = (c, d)}}
\DoxyCodeLine{421       \textcolor{comment}{//}}
\DoxyCodeLine{422       \textcolor{comment}{// |-\/-\/-\/a1-\/-\/-\/|-\/-\/-\/b3-\/-\/-\/|-\/-\/-\/c2-\/-\/-\/|-\/-\/-\/d4-\/-\/-\/|  shf2 = (shf0, shf1)}}
\DoxyCodeLine{423       \textcolor{comment}{//}}
\DoxyCodeLine{424       \textcolor{comment}{// Is being changed into this:}}
\DoxyCodeLine{425       \textcolor{comment}{// |-\/-\/-\/a1-\/-\/-\/|-\/-\/-\/b3-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|  shf0 = (a, b)}}
\DoxyCodeLine{426       \textcolor{comment}{//}}
\DoxyCodeLine{427       \textcolor{comment}{// |-\/-\/-\/c2-\/-\/-\/|-\/-\/-\/d4-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/|  shf1 = (c, d)}}
\DoxyCodeLine{428       \textcolor{comment}{//}}
\DoxyCodeLine{429       \textcolor{comment}{// |-\/-\/-\/a1-\/-\/-\/|-\/-\/-\/b3-\/-\/-\/|-\/-\/-\/c2-\/-\/-\/|-\/-\/-\/d4-\/-\/-\/|  shf2 = (shf0, shf1)}}
\DoxyCodeLine{430       std::transform(shuffle\_bytes.begin() + half\_lanes, shuffle\_bytes.end(),}
\DoxyCodeLine{431                      shuffle\_bytes.begin() + half\_lanes,}
\DoxyCodeLine{432                      [](uint8\_t lane) \{ return lane -\/ half\_lanes; \});}
\DoxyCodeLine{433     \}}
\DoxyCodeLine{434 }
\DoxyCodeLine{435     \textcolor{keywordflow}{if} (does\_shuffle\_into\_low\_half || does\_shuffle\_into\_high\_half) \{}
\DoxyCodeLine{436       \textcolor{keywordflow}{return} \mbox{\hyperlink{baseline-assembler-arm-inl_8h_a0a87998f4e8cee4888f2a89df3d5639b}{\_\_}} \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_acb23944f928f594fc6084c737980c4d6}{Simd128Shuffle}}(og\_left, og\_right,}
\DoxyCodeLine{437                                Simd128ShuffleOp::Kind::kI8x16,}
\DoxyCodeLine{438                                shuffle\_bytes.data());}
\DoxyCodeLine{439     \}}
\DoxyCodeLine{440 }
\DoxyCodeLine{441     \textcolor{comment}{// Shuffles to narrow.}}
\DoxyCodeLine{442     \textcolor{keywordflow}{if} (\textcolor{keyword}{auto} maybe\_lanes = \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>DemandedByteLanes(\&shuffle)) \{}
\DoxyCodeLine{443       \textcolor{keyword}{auto} lanes = maybe\_lanes.value();}
\DoxyCodeLine{444       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}{analyzer\_}}-\/>ShouldRewriteShuffleToLow(\&shuffle)) \{}
\DoxyCodeLine{445         \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(lanes, \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1DemandedElementAnalysis_a57cab155ec74a59d998fc127cb538615}{DemandedElementAnalysis::k8x8Low}});}
\DoxyCodeLine{446         \textcolor{comment}{// Take the top half of the shuffle bytes and these will now write}}
\DoxyCodeLine{447         \textcolor{comment}{// those values into the low half of the result instead.}}
\DoxyCodeLine{448         std::copy(shuffle.shuffle + half\_lanes, shuffle.shuffle + \mbox{\hyperlink{namespacev8_1_1internal_a1ac5aaec8d986abe45d958e665beb21a}{kSimd128Size}},}
\DoxyCodeLine{449                   shuffle\_bytes.begin());}
\DoxyCodeLine{450       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{451         \textcolor{comment}{// Just truncate the lower half.}}
\DoxyCodeLine{452         std::copy(shuffle.shuffle, shuffle.shuffle + half\_lanes,}
\DoxyCodeLine{453                   shuffle\_bytes.begin());}
\DoxyCodeLine{454       \}}
\DoxyCodeLine{455 }
\DoxyCodeLine{456       \textcolor{keywordflow}{if} (lanes == \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1DemandedElementAnalysis_ace3637bda4f87fe7d153c67f0348bb26}{DemandedElementAnalysis::k8x2Low}}) \{}
\DoxyCodeLine{457         \textcolor{keywordflow}{return} \mbox{\hyperlink{baseline-assembler-arm-inl_8h_a0a87998f4e8cee4888f2a89df3d5639b}{\_\_}} \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_acb23944f928f594fc6084c737980c4d6}{Simd128Shuffle}}(og\_left, og\_right,}
\DoxyCodeLine{458                                  Simd128ShuffleOp::Kind::kI8x2,}
\DoxyCodeLine{459                                  shuffle\_bytes.data());}
\DoxyCodeLine{460       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lanes == \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1DemandedElementAnalysis_af0dc3ca68dcc157ee8cf55cc7bca6d66}{DemandedElementAnalysis::k8x4Low}}) \{}
\DoxyCodeLine{461         \textcolor{keywordflow}{return} \mbox{\hyperlink{baseline-assembler-arm-inl_8h_a0a87998f4e8cee4888f2a89df3d5639b}{\_\_}} \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_acb23944f928f594fc6084c737980c4d6}{Simd128Shuffle}}(og\_left, og\_right,}
\DoxyCodeLine{462                                  Simd128ShuffleOp::Kind::kI8x4,}
\DoxyCodeLine{463                                  shuffle\_bytes.data());}
\DoxyCodeLine{464       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lanes == \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1DemandedElementAnalysis_a57cab155ec74a59d998fc127cb538615}{DemandedElementAnalysis::k8x8Low}}) \{}
\DoxyCodeLine{465         \textcolor{keywordflow}{return} \mbox{\hyperlink{baseline-assembler-arm-inl_8h_a0a87998f4e8cee4888f2a89df3d5639b}{\_\_}} \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_acb23944f928f594fc6084c737980c4d6}{Simd128Shuffle}}(og\_left, og\_right,}
\DoxyCodeLine{466                                  Simd128ShuffleOp::Kind::kI8x8,}
\DoxyCodeLine{467                                  shuffle\_bytes.data());}
\DoxyCodeLine{468       \}}
\DoxyCodeLine{469     \}}
\DoxyCodeLine{470     \textcolor{keywordflow}{goto} no\_change;}
\DoxyCodeLine{471   \}}

\end{DoxyCode}


References \+\_\+\+\_\+, v8\+::internal\+::compiler\+::turboshaft\+::\+Wasm\+Shuffle\+Reducer$<$ Next $>$\+::analyzer\+\_\+, v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+EQ, DCHECK\+\_\+\+NE, v8\+::internal\+::compiler\+::turboshaft\+::\+Demanded\+Element\+Analysis\+::k8x2\+Low, v8\+::internal\+::compiler\+::turboshaft\+::\+Demanded\+Element\+Analysis\+::k8x4\+Low, v8\+::internal\+::compiler\+::turboshaft\+::\+Demanded\+Element\+Analysis\+::k8x8\+Low, v8\+::internal\+::k\+Simd128\+Size, LABEL\+\_\+\+BLOCK, v8\+::internal\+::compiler\+::turboshaft\+::\+Should\+Skip\+Optimization\+Step(), and v8\+::internal\+::compiler\+::turboshaft\+::\+Register\+Representation\+::\+Simd128().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_acb23944f928f594fc6084c737980c4d6_cgraph}
\end{center}
\end{figure}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}\label{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer_a93eca44fda180772d8815ea4c8467277}} 
\index{v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$@{v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$}!analyzer\_@{analyzer\_}}
\index{analyzer\_@{analyzer\_}!v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$@{v8::internal::compiler::turboshaft::WasmShuffleReducer$<$ Next $>$}}
\doxysubsubsection{\texorpdfstring{analyzer\_}{analyzer\_}}
{\footnotesize\ttfamily template$<$class Next $>$ \\
std\+::optional$<$\mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleAnalyzer}{Wasm\+Shuffle\+Analyzer}}$>$ \mbox{\hyperlink{classv8_1_1internal_1_1compiler_1_1turboshaft_1_1WasmShuffleReducer}{v8\+::internal\+::compiler\+::turboshaft\+::\+Wasm\+Shuffle\+Reducer}}$<$ Next $>$\+::analyzer\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 229 of file wasm-\/shuffle-\/reducer.\+h.



Referenced by v8\+::internal\+::compiler\+::turboshaft\+::\+Wasm\+Shuffle\+Reducer$<$ Next $>$\+::\+Analyze(), and v8\+::internal\+::compiler\+::turboshaft\+::\+Wasm\+Shuffle\+Reducer$<$ Next $>$\+::\+Simd128\+Shuffle().



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/mnt/\+V8\+Source\+Code/src/compiler/turboshaft/\mbox{\hyperlink{wasm-shuffle-reducer_8h}{wasm-\/shuffle-\/reducer.\+h}}\end{DoxyCompactItemize}
