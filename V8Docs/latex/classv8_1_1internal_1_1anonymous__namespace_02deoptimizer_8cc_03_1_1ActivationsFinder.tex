\hypertarget{classv8_1_1internal_1_1anonymous__namespace_02deoptimizer_8cc_03_1_1ActivationsFinder}{}\doxysection{v8\+::internal\+::anonymous\+\_\+namespace\{deoptimizer.\+cc\}\+::Activations\+Finder Class Reference}
\label{classv8_1_1internal_1_1anonymous__namespace_02deoptimizer_8cc_03_1_1ActivationsFinder}\index{v8::internal::anonymous\_namespace\lcurly{}deoptimizer.cc\rcurly{}::ActivationsFinder@{v8::internal::anonymous\_namespace\lcurly{}deoptimizer.cc\rcurly{}::ActivationsFinder}}


Inheritance diagram for v8\+::internal\+::anonymous\+\_\+namespace\{deoptimizer.\+cc\}\+::Activations\+Finder\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=241pt]{classv8_1_1internal_1_1anonymous__namespace_02deoptimizer_8cc_03_1_1ActivationsFinder__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for v8\+::internal\+::anonymous\+\_\+namespace\{deoptimizer.\+cc\}\+::Activations\+Finder\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=241pt]{classv8_1_1internal_1_1anonymous__namespace_02deoptimizer_8cc_03_1_1ActivationsFinder__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1anonymous__namespace_02deoptimizer_8cc_03_1_1ActivationsFinder_a770ad726d6a59d413fc6477d061cbefa}{Activations\+Finder}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1GcSafeCode}{Gc\+Safe\+Code}} $>$ topmost\+\_\+optimized\+\_\+code, \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} safe\+\_\+to\+\_\+deopt\+\_\+topmost\+\_\+optimized\+\_\+code)
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1anonymous__namespace_02deoptimizer_8cc_03_1_1ActivationsFinder_ab2752742c68db082583b0d9ca4ae4b26}{Visit\+Thread}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1ThreadLocalTop}{Thread\+Local\+Top}} $\ast$top) override
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}


Definition at line 331 of file deoptimizer.\+cc.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1anonymous__namespace_02deoptimizer_8cc_03_1_1ActivationsFinder_a770ad726d6a59d413fc6477d061cbefa}\label{classv8_1_1internal_1_1anonymous__namespace_02deoptimizer_8cc_03_1_1ActivationsFinder_a770ad726d6a59d413fc6477d061cbefa}} 
\index{v8::internal::anonymous\_namespace\lcurly{}deoptimizer.cc\rcurly{}::ActivationsFinder@{v8::internal::anonymous\_namespace\lcurly{}deoptimizer.cc\rcurly{}::ActivationsFinder}!ActivationsFinder@{ActivationsFinder}}
\index{ActivationsFinder@{ActivationsFinder}!v8::internal::anonymous\_namespace\lcurly{}deoptimizer.cc\rcurly{}::ActivationsFinder@{v8::internal::anonymous\_namespace\lcurly{}deoptimizer.cc\rcurly{}::ActivationsFinder}}
\doxysubsubsection{\texorpdfstring{ActivationsFinder()}{ActivationsFinder()}}
{\footnotesize\ttfamily v8\+::internal\+::anonymous\+\_\+namespace\{deoptimizer.\+cc\}\+::Activations\+Finder\+::\+Activations\+Finder (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1GcSafeCode}{Gc\+Safe\+Code}} $>$}]{topmost\+\_\+optimized\+\_\+code,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}}}]{safe\+\_\+to\+\_\+deopt\+\_\+topmost\+\_\+optimized\+\_\+code }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 333 of file deoptimizer.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{334                                                                \{}
\DoxyCodeLine{335 \textcolor{preprocessor}{\#ifdef DEBUG}}
\DoxyCodeLine{336     topmost\_ = topmost\_optimized\_code;}
\DoxyCodeLine{337     safe\_to\_deopt\_ = safe\_to\_deopt\_topmost\_optimized\_code;}
\DoxyCodeLine{338 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{339   \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1anonymous__namespace_02deoptimizer_8cc_03_1_1ActivationsFinder_ab2752742c68db082583b0d9ca4ae4b26}\label{classv8_1_1internal_1_1anonymous__namespace_02deoptimizer_8cc_03_1_1ActivationsFinder_ab2752742c68db082583b0d9ca4ae4b26}} 
\index{v8::internal::anonymous\_namespace\lcurly{}deoptimizer.cc\rcurly{}::ActivationsFinder@{v8::internal::anonymous\_namespace\lcurly{}deoptimizer.cc\rcurly{}::ActivationsFinder}!VisitThread@{VisitThread}}
\index{VisitThread@{VisitThread}!v8::internal::anonymous\_namespace\lcurly{}deoptimizer.cc\rcurly{}::ActivationsFinder@{v8::internal::anonymous\_namespace\lcurly{}deoptimizer.cc\rcurly{}::ActivationsFinder}}
\doxysubsubsection{\texorpdfstring{VisitThread()}{VisitThread()}}
{\footnotesize\ttfamily void v8\+::internal\+::anonymous\+\_\+namespace\{deoptimizer.\+cc\}\+::Activations\+Finder\+::\+Visit\+Thread (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1ThreadLocalTop}{Thread\+Local\+Top}} $\ast$}]{top }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classv8_1_1internal_1_1ThreadVisitor_a1be34c6a86e87d00a507c5b7bf0652fe}{v8\+::internal\+::\+Thread\+Visitor}}.



Definition at line 344 of file deoptimizer.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{344                                                                    \{}
\DoxyCodeLine{345     \textcolor{keywordflow}{for} (StackFrameIterator it(isolate, top); !it.done(); it.Advance()) \{}
\DoxyCodeLine{346       \textcolor{keywordflow}{if} (it.frame()-\/>is\_optimized\_js()) \{}
\DoxyCodeLine{347         Tagged<GcSafeCode> \mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}} = it.frame()-\/>GcSafeLookupCode();}
\DoxyCodeLine{348         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_af99e82892963b7932b8865a9c6f400bc}{CodeKindCanDeoptimize}}(\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>kind()) \&\&}
\DoxyCodeLine{349             \mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>marked\_for\_deoptimization()) \{}
\DoxyCodeLine{350           \textcolor{comment}{// Obtain the trampoline to the deoptimizer call.}}
\DoxyCodeLine{351           \textcolor{keywordtype}{int} trampoline\_pc;}
\DoxyCodeLine{352           \textcolor{keywordflow}{if} (\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>is\_maglevved()) \{}
\DoxyCodeLine{353             MaglevSafepointEntry safepoint = \mbox{\hyperlink{classv8_1_1internal_1_1MaglevSafepointTable_a202e2949aac2213d8e6ed90ef4de6797}{MaglevSafepointTable::FindEntry}}(}
\DoxyCodeLine{354                 isolate, \mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}, it.frame()-\/>pc());}
\DoxyCodeLine{355             trampoline\_pc = safepoint.trampoline\_pc();}
\DoxyCodeLine{356           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{357             SafepointEntry safepoint = \mbox{\hyperlink{classv8_1_1internal_1_1SafepointTable_a894fd386f9558cdcc2f990e1046ef7e6}{SafepointTable::FindEntry}}(}
\DoxyCodeLine{358                 isolate, \mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}, it.frame()-\/>maybe\_unauthenticated\_pc());}
\DoxyCodeLine{359             trampoline\_pc = safepoint.trampoline\_pc();}
\DoxyCodeLine{360           \}}
\DoxyCodeLine{361           \textcolor{comment}{// TODO(saelo): currently we have to use full pointer comparison as}}
\DoxyCodeLine{362           \textcolor{comment}{// builtin Code is still inside the sandbox while runtime-\/generated}}
\DoxyCodeLine{363           \textcolor{comment}{// Code is in trusted space.}}
\DoxyCodeLine{364           static\_assert(!\mbox{\hyperlink{namespacev8_1_1internal_ac8661ea9688019bb467bec1d28cc977a}{kAllCodeObjectsLiveInTrustedSpace}});}
\DoxyCodeLine{365           \mbox{\hyperlink{src_2base_2logging_8h_a96a75539aa82216cdde2250a11126ea0}{DCHECK\_IMPLIES}}(\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}.SafeEquals(topmost\_), safe\_to\_deopt\_);}
\DoxyCodeLine{366           static\_assert(\mbox{\hyperlink{classv8_1_1internal_1_1SafepointEntryBase_ae9823bcc6eb7bcdc6be78ee7b60af4e8}{SafepointEntry::kNoTrampolinePC}} == -\/1);}
\DoxyCodeLine{367           \mbox{\hyperlink{src_2base_2logging_8h_a1c7c9b7f14b9a33ea69cbe4578016a19}{CHECK\_GE}}(trampoline\_pc, 0);}
\DoxyCodeLine{368           \mbox{\hyperlink{namespacev8_1_1internal_ab4955debfb9384e59e3d4e9fcab5b0a0}{Address}} new\_pc = \mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>instruction\_start() + trampoline\_pc;}
\DoxyCodeLine{369           \textcolor{keywordflow}{if} (it.frame()-\/>InFastCCall()) \{}
\DoxyCodeLine{370             \textcolor{comment}{// Fast C calls call directly to C++, so there may not be a return}}
\DoxyCodeLine{371             \textcolor{comment}{// address on the stack. Instead we patch the code after the call.}}
\DoxyCodeLine{372             \textcolor{comment}{// For C calls the caller has to pop parameters off the stack. This}}
\DoxyCodeLine{373             \textcolor{comment}{// has to happen before deoptimization. Therefore we add the offset}}
\DoxyCodeLine{374             \textcolor{comment}{// here that is needed for popping the arguments.}}
\DoxyCodeLine{375             \mbox{\hyperlink{namespacev8_1_1internal_ab4955debfb9384e59e3d4e9fcab5b0a0}{Address}} pc =}
\DoxyCodeLine{376                 *it.frame()-\/>pc\_address() + \mbox{\hyperlink{namespacev8_1_1internal_ab59d19e234279facfd4c30af7af39de4}{kMaxSizeOfMoveAfterFastCall}};}
\DoxyCodeLine{377             \mbox{\hyperlink{classv8_1_1internal_1_1Deoptimizer_a085a025e097b3a39e520362f923a259a}{Deoptimizer::PatchToJump}}(pc, new\_pc);}
\DoxyCodeLine{378           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{379             \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.cet\_compatible) \{}
\DoxyCodeLine{380               \mbox{\hyperlink{namespacev8_1_1internal_ab4955debfb9384e59e3d4e9fcab5b0a0}{Address}} pc = *it.frame()-\/>pc\_address();}
\DoxyCodeLine{381               \mbox{\hyperlink{classv8_1_1internal_1_1Deoptimizer_a085a025e097b3a39e520362f923a259a}{Deoptimizer::PatchToJump}}(pc, new\_pc);}
\DoxyCodeLine{382             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{383               \textcolor{comment}{// Replace the current pc on the stack with the trampoline.}}
\DoxyCodeLine{384               \textcolor{comment}{// TODO(v8:10026): avoid replacing a signed pointer.}}
\DoxyCodeLine{385               \mbox{\hyperlink{namespacev8_1_1internal_ab4955debfb9384e59e3d4e9fcab5b0a0}{Address}}* pc\_addr = it.frame()-\/>pc\_address();}
\DoxyCodeLine{386               \mbox{\hyperlink{classv8_1_1internal_1_1PointerAuthentication_a302300591f85b4b54ec7464708d74f88}{PointerAuthentication::ReplacePC}}(pc\_addr, new\_pc,}
\DoxyCodeLine{387                                                \mbox{\hyperlink{namespacev8_1_1internal_a72cbfdfeabb9a401f279f7b80bcff67a}{kSystemPointerSize}});}
\DoxyCodeLine{388             \}}
\DoxyCodeLine{389           \}}
\DoxyCodeLine{390         \}}
\DoxyCodeLine{391       \}}
\DoxyCodeLine{392     \}}
\DoxyCodeLine{393   \}}

\end{DoxyCode}


References CHECK\+\_\+\+GE, code, v8\+::internal\+::\+Code\+Kind\+Can\+Deoptimize(), DCHECK\+\_\+\+IMPLIES, v8\+::internal\+::\+Stack\+Frame\+Iterator\+Base\+::done(), v8\+::internal\+::\+Maglev\+Safepoint\+Table\+::\+Find\+Entry(), v8\+::internal\+::\+Safepoint\+Table\+::\+Find\+Entry(), v8\+::internal\+::k\+All\+Code\+Objects\+Live\+In\+Trusted\+Space, v8\+::internal\+::k\+Max\+Size\+Of\+Move\+After\+Fast\+Call, v8\+::internal\+::\+Safepoint\+Entry\+Base\+::k\+No\+Trampoline\+PC, v8\+::internal\+::k\+System\+Pointer\+Size, v8\+::internal\+::\+Deoptimizer\+::\+Patch\+To\+Jump(), v8\+::internal\+::\+Pointer\+Authentication\+::\+Replace\+PC(), v8\+::internal\+::\+Safepoint\+Entry\+Base\+::trampoline\+\_\+pc(), and v8\+::internal\+::v8\+\_\+flags.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1anonymous__namespace_02deoptimizer_8cc_03_1_1ActivationsFinder_ab2752742c68db082583b0d9ca4ae4b26_cgraph}
\end{center}
\end{figure}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/mnt/\+V8\+Source\+Code/src/deoptimizer/\mbox{\hyperlink{deoptimizer_8cc}{deoptimizer.\+cc}}\end{DoxyCompactItemize}
