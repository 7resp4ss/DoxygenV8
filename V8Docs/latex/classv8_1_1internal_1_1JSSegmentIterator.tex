\hypertarget{classv8_1_1internal_1_1JSSegmentIterator}{}\doxysection{v8\+::internal\+::JSSegment\+Iterator Class Reference}
\label{classv8_1_1internal_1_1JSSegmentIterator}\index{v8::internal::JSSegmentIterator@{v8::internal::JSSegmentIterator}}


{\ttfamily \#include $<$js-\/segment-\/iterator.\+h$>$}



Inheritance diagram for v8\+::internal\+::JSSegment\+Iterator\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{classv8_1_1internal_1_1JSSegmentIterator__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for v8\+::internal\+::JSSegment\+Iterator\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{classv8_1_1internal_1_1JSSegmentIterator__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1Handle}{Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1String}{String}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator_a53a1f2a1a7380d4764493ca09ce1091e}{Granularity\+As\+String}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate) const
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator_aadc73ed70f81940119979ef7d98b8ea2}{set\+\_\+granularity}} (\mbox{\hyperlink{classv8_1_1internal_1_1JSSegmenter_a290b44bfddfb5408f5eb63f3b9a1f271}{JSSegmenter\+::\+Granularity}} \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator_a7295183d10fa655073e97f7d776688bf}{granularity}})
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1JSSegmenter_a290b44bfddfb5408f5eb63f3b9a1f271}{JSSegmenter\+::\+Granularity}} \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator_a7295183d10fa655073e97f7d776688bf}{granularity}} () const
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{v8config_8h_a63258e4bf5dc9fb8c78f881c8405d83b}{V8\+\_\+\+WARN\+\_\+\+UNUSED\+\_\+\+RESULT}} \mbox{\hyperlink{classv8_1_1internal_1_1MaybeDirectHandle}{Maybe\+Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator}{JSSegment\+Iterator}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator_aff42e840abb862dbb98d22c627e533cb}{Create}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1String}{String}} $>$ input\+\_\+string, icu\+::\+Break\+Iterator $\ast$icu\+\_\+break\+\_\+iterator, \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmenter_a290b44bfddfb5408f5eb63f3b9a1f271}{JSSegmenter\+::\+Granularity}} \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator_a7295183d10fa655073e97f7d776688bf}{granularity}})
\item 
static \mbox{\hyperlink{v8config_8h_a63258e4bf5dc9fb8c78f881c8405d83b}{V8\+\_\+\+WARN\+\_\+\+UNUSED\+\_\+\+RESULT}} \mbox{\hyperlink{classv8_1_1internal_1_1MaybeDirectHandle}{Maybe\+Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSReceiver}{JSReceiver}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator_a643983a89ca7ecaf409969b19de246c8}{Next}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator}{JSSegment\+Iterator}} $>$ segment\+\_\+iterator\+\_\+holder)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 33 of file js-\/segment-\/iterator.\+h.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSSegmentIterator_aff42e840abb862dbb98d22c627e533cb}\label{classv8_1_1internal_1_1JSSegmentIterator_aff42e840abb862dbb98d22c627e533cb}} 
\index{v8::internal::JSSegmentIterator@{v8::internal::JSSegmentIterator}!Create@{Create}}
\index{Create@{Create}!v8::internal::JSSegmentIterator@{v8::internal::JSSegmentIterator}}
\doxysubsubsection{\texorpdfstring{Create()}{Create()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1MaybeDirectHandle}{Maybe\+Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator}{JSSegment\+Iterator}} $>$ v8\+::internal\+::\+JSSegment\+Iterator\+::\+Create (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1String}{String}} $>$}]{input\+\_\+string,  }\item[{icu\+::\+Break\+Iterator $\ast$}]{icu\+\_\+break\+\_\+iterator,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1JSSegmenter_a290b44bfddfb5408f5eb63f3b9a1f271}{JSSegmenter\+::\+Granularity}}}]{granularity }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 32 of file js-\/segment-\/iterator.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{35                                         \{}
\DoxyCodeLine{36   \textcolor{comment}{// Clone a copy for both the ownership and not sharing with containing and}}
\DoxyCodeLine{37   \textcolor{comment}{// other calls to the iterator because icu::BreakIterator keep the iteration}}
\DoxyCodeLine{38   \textcolor{comment}{// position internally and cannot be shared across multiple calls to}}
\DoxyCodeLine{39   \textcolor{comment}{// JSSegmentIterator::Create and JSSegments::Containing.}}
\DoxyCodeLine{40   std::shared\_ptr<icu::BreakIterator> break\_iterator\{}
\DoxyCodeLine{41       incoming\_break\_iterator-\/>clone()\};}
\DoxyCodeLine{42   \mbox{\hyperlink{src_2base_2logging_8h_a7b9f9517fedacc2a1a56c2bbb9d03688}{DCHECK\_NOT\_NULL}}(break\_iterator);}
\DoxyCodeLine{43   DirectHandle<Map> map(isolate-\/>native\_context()-\/>intl\_segment\_iterator\_map(),}
\DoxyCodeLine{44                         isolate);}
\DoxyCodeLine{45 }
\DoxyCodeLine{46   \textcolor{comment}{// 5. Set iterator.[[IteratedStringNextSegmentCodeUnitIndex]] to 0.}}
\DoxyCodeLine{47   break\_iterator-\/>first();}
\DoxyCodeLine{48   DirectHandle<Managed<icu::BreakIterator>> managed\_break\_iterator =}
\DoxyCodeLine{49       \mbox{\hyperlink{classv8_1_1internal_1_1Managed_a1c10cb948281b864db32d8af25a7b7d9}{Managed<icu::BreakIterator>::From}}(isolate, 0, break\_iterator);}
\DoxyCodeLine{50 }
\DoxyCodeLine{51   std::shared\_ptr<icu::UnicodeString> \textcolor{keywordtype}{string} =}
\DoxyCodeLine{52       std::make\_shared<icu::UnicodeString>();}
\DoxyCodeLine{53   break\_iterator-\/>getText().getText(*\textcolor{keywordtype}{string});}
\DoxyCodeLine{54   DirectHandle<Managed<icu::UnicodeString>> \mbox{\hyperlink{namespacev8_1_1internal_ae4f59157cb0561e327ce537c779462d4}{unicode\_string}} =}
\DoxyCodeLine{55       \mbox{\hyperlink{classv8_1_1internal_1_1Managed_a1c10cb948281b864db32d8af25a7b7d9}{Managed<icu::UnicodeString>::From}}(isolate, 0, \textcolor{keywordtype}{string});}
\DoxyCodeLine{56 }
\DoxyCodeLine{57   break\_iterator-\/>setText(*\textcolor{keywordtype}{string});}
\DoxyCodeLine{58 }
\DoxyCodeLine{59   \textcolor{comment}{// Now all properties are ready, so we can allocate the result object.}}
\DoxyCodeLine{60   DirectHandle<JSObject> \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}} = isolate-\/>factory()-\/>NewJSObjectFromMap(map);}
\DoxyCodeLine{61   \mbox{\hyperlink{namespacev8_1_1internal_af2248a427f8ff8f81e68a2a87758e145}{DisallowGarbageCollection}} \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02json-stringifier_8cc_03_a63d8eefb47468aa3f816fbe26a59466a}{no\_gc}};}
\DoxyCodeLine{62   DirectHandle<JSSegmentIterator> segment\_iterator =}
\DoxyCodeLine{63       Cast<JSSegmentIterator>(\mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}});}
\DoxyCodeLine{64 }
\DoxyCodeLine{65   segment\_iterator-\/>set\_flags(0);}
\DoxyCodeLine{66   segment\_iterator-\/>set\_granularity(\mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator_a7295183d10fa655073e97f7d776688bf}{granularity}});}
\DoxyCodeLine{67   segment\_iterator-\/>set\_icu\_break\_iterator(*managed\_break\_iterator);}
\DoxyCodeLine{68   segment\_iterator-\/>set\_raw\_string(*input\_string);}
\DoxyCodeLine{69   segment\_iterator-\/>set\_unicode\_string(*\mbox{\hyperlink{namespacev8_1_1internal_ae4f59157cb0561e327ce537c779462d4}{unicode\_string}});}
\DoxyCodeLine{70 }
\DoxyCodeLine{71   \textcolor{keywordflow}{return} segment\_iterator;}
\DoxyCodeLine{72 \}}

\end{DoxyCode}


References DCHECK\+\_\+\+NOT\+\_\+\+NULL, v8\+::internal\+::\+Isolate\+::factory(), v8\+::internal\+::\+Managed$<$ Cpp\+Type $>$\+::\+From(), granularity(), v8\+::internal\+::\+Isolate\+::native\+\_\+context(), v8\+::internal\+::\+Factory\+::\+New\+JSObject\+From\+Map(), v8\+::internal\+::anonymous\+\_\+namespace\{json-\/stringifier.\+cc\}\+::no\+\_\+gc, v8\+::base\+::internal\+::result, and v8\+::internal\+::unicode\+\_\+string.



Referenced by v8\+::internal\+::\+BUILTIN().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSSegmentIterator_aff42e840abb862dbb98d22c627e533cb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSSegmentIterator_aff42e840abb862dbb98d22c627e533cb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSSegmentIterator_a7295183d10fa655073e97f7d776688bf}\label{classv8_1_1internal_1_1JSSegmentIterator_a7295183d10fa655073e97f7d776688bf}} 
\index{v8::internal::JSSegmentIterator@{v8::internal::JSSegmentIterator}!granularity@{granularity}}
\index{granularity@{granularity}!v8::internal::JSSegmentIterator@{v8::internal::JSSegmentIterator}}
\doxysubsubsection{\texorpdfstring{granularity()}{granularity()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmenter_a290b44bfddfb5408f5eb63f3b9a1f271}{JSSegmenter\+::\+Granularity}} v8\+::internal\+::\+JSSegment\+Iterator\+::granularity (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 44 of file js-\/segment-\/iterator-\/inl.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{44                                                                    \{}
\DoxyCodeLine{45   \textcolor{keywordflow}{return} GranularityBits::decode(\mbox{\hyperlink{namespacev8_1_1internal_a83b0c194e63513f61999805edd71b125}{flags}}());}
\DoxyCodeLine{46 \}}

\end{DoxyCode}


References v8\+::internal\+::flags.



Referenced by Create(), and Granularity\+As\+String().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSSegmentIterator_a7295183d10fa655073e97f7d776688bf_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSSegmentIterator_a53a1f2a1a7380d4764493ca09ce1091e}\label{classv8_1_1internal_1_1JSSegmentIterator_a53a1f2a1a7380d4764493ca09ce1091e}} 
\index{v8::internal::JSSegmentIterator@{v8::internal::JSSegmentIterator}!GranularityAsString@{GranularityAsString}}
\index{GranularityAsString@{GranularityAsString}!v8::internal::JSSegmentIterator@{v8::internal::JSSegmentIterator}}
\doxysubsubsection{\texorpdfstring{GranularityAsString()}{GranularityAsString()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1Handle}{Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1String}{String}} $>$ v8\+::internal\+::\+JSSegment\+Iterator\+::\+Granularity\+As\+String (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate }\end{DoxyParamCaption}) const}



Definition at line 27 of file js-\/segment-\/iterator.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{27                                                                             \{}
\DoxyCodeLine{28   \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmenter_a0edfb100270722710a2ce9cff919a313}{JSSegmenter::GetGranularityString}}(isolate, \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator_a7295183d10fa655073e97f7d776688bf}{granularity}}());}
\DoxyCodeLine{29 \}}

\end{DoxyCode}


References v8\+::internal\+::\+JSSegmenter\+::\+Get\+Granularity\+String(), and granularity().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSSegmentIterator_a53a1f2a1a7380d4764493ca09ce1091e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSSegmentIterator_a643983a89ca7ecaf409969b19de246c8}\label{classv8_1_1internal_1_1JSSegmentIterator_a643983a89ca7ecaf409969b19de246c8}} 
\index{v8::internal::JSSegmentIterator@{v8::internal::JSSegmentIterator}!Next@{Next}}
\index{Next@{Next}!v8::internal::JSSegmentIterator@{v8::internal::JSSegmentIterator}}
\doxysubsubsection{\texorpdfstring{Next()}{Next()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1MaybeDirectHandle}{Maybe\+Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSReceiver}{JSReceiver}} $>$ v8\+::internal\+::\+JSSegment\+Iterator\+::\+Next (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator}{JSSegment\+Iterator}} $>$}]{segment\+\_\+iterator\+\_\+holder }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 75 of file js-\/segment-\/iterator.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{76                                                                         \{}
\DoxyCodeLine{77   \textcolor{comment}{// Sketches of ideas for future performance improvements, roughly in order}}
\DoxyCodeLine{78   \textcolor{comment}{// of difficulty:}}
\DoxyCodeLine{79   \textcolor{comment}{// -\/ Add a fast path for grapheme segmentation of one-\/byte strings that}}
\DoxyCodeLine{80   \textcolor{comment}{//   entirely skips calling into ICU.}}
\DoxyCodeLine{81   \textcolor{comment}{// -\/ When we enter this function, perform a batch of calls into ICU and}}
\DoxyCodeLine{82   \textcolor{comment}{//   stash away the results, so the next couple of invocations can access}}
\DoxyCodeLine{83   \textcolor{comment}{//   them from a (Torque?) builtin without calling into C++.}}
\DoxyCodeLine{84   \textcolor{comment}{// -\/ Implement compiler support for escape-\/analyzing the JSSegmentDataObject}}
\DoxyCodeLine{85   \textcolor{comment}{//   and avoid allocating it when possible.}}
\DoxyCodeLine{86 }
\DoxyCodeLine{87   \textcolor{comment}{// TODO(v8:14681): We StackCheck here to break execution in the event of an}}
\DoxyCodeLine{88   \textcolor{comment}{// interrupt. Ordinarily in JS loops, this stack check should already be}}
\DoxyCodeLine{89   \textcolor{comment}{// occurring, however some loops implemented within CodeStubAssembler and}}
\DoxyCodeLine{90   \textcolor{comment}{// Torque builtins do not currently implement these checks. A preferable}}
\DoxyCodeLine{91   \textcolor{comment}{// solution which would benefit other iterators implemented in C++ include:}}
\DoxyCodeLine{92   \textcolor{comment}{//   1) Performing the stack check in CEntry, which would provide a solution}}
\DoxyCodeLine{93   \textcolor{comment}{//   for all methods implemented in C++.}}
\DoxyCodeLine{94   \textcolor{comment}{//}}
\DoxyCodeLine{95   \textcolor{comment}{//   2) Rewriting the loop to include an outer loop, which performs periodic}}
\DoxyCodeLine{96   \textcolor{comment}{//   stack checks every N loop bodies (where N is some arbitrary heuristic}}
\DoxyCodeLine{97   \textcolor{comment}{//   selected to allow short loop counts to run with few interruptions).}}
\DoxyCodeLine{98   \mbox{\hyperlink{execution_2isolate_8h_ab09961e7d4dc8b20d070cd87d66202dc}{STACK\_CHECK}}(isolate, MaybeDirectHandle<JSReceiver>());}
\DoxyCodeLine{99 }
\DoxyCodeLine{100   Factory* factory = isolate-\/>factory();}
\DoxyCodeLine{101   icu::BreakIterator* icu\_break\_iterator =}
\DoxyCodeLine{102       segment\_iterator-\/>icu\_break\_iterator()-\/>raw();}
\DoxyCodeLine{103   \textcolor{comment}{// 5. Let startIndex be iterator.[[IteratedStringNextSegmentCodeUnitIndex]].}}
\DoxyCodeLine{104   \mbox{\hyperlink{namespaceunibrow_ab0275d47f9778d486eafe88b18c5851d}{int32\_t}} start\_index = icu\_break\_iterator-\/>current();}
\DoxyCodeLine{105   \textcolor{comment}{// 6. Let endIndex be ! FindBoundary(segmenter, string, startIndex, after).}}
\DoxyCodeLine{106   \mbox{\hyperlink{namespaceunibrow_ab0275d47f9778d486eafe88b18c5851d}{int32\_t}} end\_index = icu\_break\_iterator-\/>next();}
\DoxyCodeLine{107 }
\DoxyCodeLine{108   \textcolor{comment}{// 7. If endIndex is not finite, then}}
\DoxyCodeLine{109   \textcolor{keywordflow}{if} (end\_index == icu::BreakIterator::DONE) \{}
\DoxyCodeLine{110     \textcolor{comment}{// a. Return ! CreateIterResultObject(undefined, true).}}
\DoxyCodeLine{111     \textcolor{keywordflow}{return} factory-\/>NewJSIteratorResult(isolate-\/>factory()-\/>undefined\_value(),}
\DoxyCodeLine{112                                         \textcolor{keyword}{true});}
\DoxyCodeLine{113   \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115   \textcolor{comment}{// 8. Set iterator.[[IteratedStringNextSegmentCodeUnitIndex]] to endIndex.}}
\DoxyCodeLine{116 }
\DoxyCodeLine{117   \textcolor{comment}{// 9. Let segmentData be ! CreateSegmentDataObject(segmenter, string,}}
\DoxyCodeLine{118   \textcolor{comment}{// startIndex, endIndex).}}
\DoxyCodeLine{119 }
\DoxyCodeLine{120   DirectHandle<JSSegmentDataObject> segment\_data;}
\DoxyCodeLine{121   \textcolor{keywordflow}{if} (segment\_iterator-\/>granularity() == \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmenter_a290b44bfddfb5408f5eb63f3b9a1f271a4c5c7516a7c4eda0e608f0ae7b01a494}{JSSegmenter::Granularity::GRAPHEME}} \&\&}
\DoxyCodeLine{122       start\_index == end\_index -\/ 1) \{}
\DoxyCodeLine{123     \textcolor{comment}{// Fast path: use cached segment string and skip avoidable handle creations.}}
\DoxyCodeLine{124     DirectHandle<String> segment;}
\DoxyCodeLine{125     \mbox{\hyperlink{namespaceunibrow_a0869a94c1a582a2b47889b990444deb9}{uint16\_t}} \mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}} = segment\_iterator-\/>raw\_string()-\/>Get(start\_index);}
\DoxyCodeLine{126     \textcolor{keywordflow}{if} (\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}} > \mbox{\hyperlink{classunibrow_1_1Latin1_a545d3659738ac943bcf6697c677fb1b9}{unibrow::Latin1::kMaxChar}}) \{}
\DoxyCodeLine{127       segment = factory-\/>LookupSingleCharacterStringFromCode(\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}});}
\DoxyCodeLine{128     \}}
\DoxyCodeLine{129     DirectHandle<Number> \mbox{\hyperlink{namespacev8_1_1internal_a0cfab207d565dcf62ebf50f3987e05de}{index}};}
\DoxyCodeLine{130     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classv8_1_1internal_1_1Smi_a9ae5e57f47d054b5636f7519a8c31898}{Smi::IsValid}}(start\_index)) \mbox{\hyperlink{namespacev8_1_1internal_a0cfab207d565dcf62ebf50f3987e05de}{index}} = factory-\/>NewHeapNumber(start\_index);}
\DoxyCodeLine{131     DirectHandle<Map> map(}
\DoxyCodeLine{132         isolate-\/>native\_context()-\/>intl\_segment\_data\_object\_map(), isolate);}
\DoxyCodeLine{133     segment\_data = Cast<JSSegmentDataObject>(factory-\/>NewJSObjectFromMap(map));}
\DoxyCodeLine{134     Tagged<JSSegmentDataObject> raw = *segment\_data;}
\DoxyCodeLine{135     \mbox{\hyperlink{namespacev8_1_1internal_ae70d08ee31e0546f018d5ec0fcd3f457}{DisallowHeapAllocation}} \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02json-stringifier_8cc_03_a63d8eefb47468aa3f816fbe26a59466a}{no\_gc}};}
\DoxyCodeLine{136     \textcolor{comment}{// We can skip write barriers because \{segment\_data\} is the last object}}
\DoxyCodeLine{137     \textcolor{comment}{// that was allocated.}}
\DoxyCodeLine{138     raw-\/>set\_segment(\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}} <= \mbox{\hyperlink{classunibrow_1_1Latin1_a545d3659738ac943bcf6697c677fb1b9}{unibrow::Latin1::kMaxChar}}}
\DoxyCodeLine{139                          ? ReadOnlyRoots(isolate).single\_character\_string(\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}})}
\DoxyCodeLine{140                          : *segment,}
\DoxyCodeLine{141                      \mbox{\hyperlink{namespacev8_1_1internal_a20c66a96ddfae551866ceae989a8ba13a6719428bfb5874884bca62eb8fe3de75}{SKIP\_WRITE\_BARRIER}});}
\DoxyCodeLine{142     raw-\/>set\_index(}
\DoxyCodeLine{143         \mbox{\hyperlink{classv8_1_1internal_1_1Smi_a9ae5e57f47d054b5636f7519a8c31898}{Smi::IsValid}}(start\_index) ? \mbox{\hyperlink{classv8_1_1internal_1_1Smi_afe7f07102d90ccce48cbe677c88a0645}{Smi::FromInt}}(start\_index) : *\mbox{\hyperlink{namespacev8_1_1internal_a0cfab207d565dcf62ebf50f3987e05de}{index}},}
\DoxyCodeLine{144         \mbox{\hyperlink{namespacev8_1_1internal_a20c66a96ddfae551866ceae989a8ba13a6719428bfb5874884bca62eb8fe3de75}{SKIP\_WRITE\_BARRIER}});}
\DoxyCodeLine{145     raw-\/>set\_input(segment\_iterator-\/>raw\_string(), \mbox{\hyperlink{namespacev8_1_1internal_a20c66a96ddfae551866ceae989a8ba13a6719428bfb5874884bca62eb8fe3de75}{SKIP\_WRITE\_BARRIER}});}
\DoxyCodeLine{146   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{147     \mbox{\hyperlink{execution_2isolate_8h_a45bb81ab232e9f2663545ec92dc0b950}{ASSIGN\_RETURN\_ON\_EXCEPTION}}(}
\DoxyCodeLine{148         isolate, segment\_data,}
\DoxyCodeLine{149         \mbox{\hyperlink{classv8_1_1internal_1_1JSSegments_ace8176c21c1345368eaa0005ae87d4fa}{JSSegments::CreateSegmentDataObject}}(}
\DoxyCodeLine{150             isolate, segment\_iterator-\/>granularity(), icu\_break\_iterator,}
\DoxyCodeLine{151             \mbox{\hyperlink{namespacev8_1_1internal_a73502f55102d18cb764881bc29f35c05}{direct\_handle}}(segment\_iterator-\/>raw\_string(), isolate),}
\DoxyCodeLine{152             *segment\_iterator-\/>unicode\_string()-\/>raw(), start\_index,}
\DoxyCodeLine{153             end\_index));}
\DoxyCodeLine{154   \}}
\DoxyCodeLine{155 }
\DoxyCodeLine{156   \textcolor{comment}{// 10. Return ! CreateIterResultObject(segmentData, false).}}
\DoxyCodeLine{157   \textcolor{keywordflow}{return} factory-\/>NewJSIteratorResult(segment\_data, \textcolor{keyword}{false});}
\DoxyCodeLine{158 \}}

\end{DoxyCode}


References ASSIGN\+\_\+\+RETURN\+\_\+\+ON\+\_\+\+EXCEPTION, code, v8\+::internal\+::\+JSSegments\+::\+Create\+Segment\+Data\+Object(), v8\+::internal\+::direct\+\_\+handle(), v8\+::internal\+::\+Isolate\+::factory(), v8\+::internal\+::\+Smi\+::\+From\+Int(), v8\+::internal\+::\+JSSegmenter\+::\+GRAPHEME, v8\+::internal\+::index, v8\+::internal\+::\+Smi\+::\+Is\+Valid(), unibrow\+::\+Latin1\+::k\+Max\+Char, v8\+::internal\+::\+Factory\+Base$<$ Impl $>$\+::\+Lookup\+Single\+Character\+String\+From\+Code(), v8\+::internal\+::\+Isolate\+::native\+\_\+context(), v8\+::internal\+::\+Factory\+Base$<$ Impl $>$\+::\+New\+Heap\+Number(), v8\+::internal\+::\+Factory\+::\+New\+JSIterator\+Result(), v8\+::internal\+::\+Factory\+::\+New\+JSObject\+From\+Map(), v8\+::internal\+::anonymous\+\_\+namespace\{json-\/stringifier.\+cc\}\+::no\+\_\+gc, v8\+::internal\+::\+SKIP\+\_\+\+WRITE\+\_\+\+BARRIER, and STACK\+\_\+\+CHECK.



Referenced by v8\+::internal\+::\+BUILTIN().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSSegmentIterator_a643983a89ca7ecaf409969b19de246c8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSSegmentIterator_a643983a89ca7ecaf409969b19de246c8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1JSSegmentIterator_aadc73ed70f81940119979ef7d98b8ea2}\label{classv8_1_1internal_1_1JSSegmentIterator_aadc73ed70f81940119979ef7d98b8ea2}} 
\index{v8::internal::JSSegmentIterator@{v8::internal::JSSegmentIterator}!set\_granularity@{set\_granularity}}
\index{set\_granularity@{set\_granularity}!v8::internal::JSSegmentIterator@{v8::internal::JSSegmentIterator}}
\doxysubsubsection{\texorpdfstring{set\_granularity()}{set\_granularity()}}
{\footnotesize\ttfamily k\+Unicode\+String\+Offset void v8\+::internal\+::\+JSSegment\+Iterator\+::set\+\_\+granularity (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1JSSegmenter_a290b44bfddfb5408f5eb63f3b9a1f271}{JSSegmenter\+::\+Granularity}}}]{granularity }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 36 of file js-\/segment-\/iterator-\/inl.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{37                                         \{}
\DoxyCodeLine{38   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(GranularityBits::is\_valid(\mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator_a7295183d10fa655073e97f7d776688bf}{granularity}}));}
\DoxyCodeLine{39   \textcolor{keywordtype}{int} hints = \mbox{\hyperlink{namespacev8_1_1internal_a83b0c194e63513f61999805edd71b125}{flags}}();}
\DoxyCodeLine{40   hints = GranularityBits::update(hints, \mbox{\hyperlink{classv8_1_1internal_1_1JSSegmentIterator_a7295183d10fa655073e97f7d776688bf}{granularity}});}
\DoxyCodeLine{41   set\_flags(hints);}
\DoxyCodeLine{42 \}}

\end{DoxyCode}


References v8\+::internal\+::\+DCHECK(), and v8\+::internal\+::flags.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1JSSegmentIterator_aadc73ed70f81940119979ef7d98b8ea2_cgraph}
\end{center}
\end{figure}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/mnt/\+V8\+Source\+Code/src/objects/\mbox{\hyperlink{js-segment-iterator_8h}{js-\/segment-\/iterator.\+h}}\item 
/mnt/\+V8\+Source\+Code/src/objects/\mbox{\hyperlink{js-segment-iterator-inl_8h}{js-\/segment-\/iterator-\/inl.\+h}}\item 
/mnt/\+V8\+Source\+Code/src/objects/\mbox{\hyperlink{js-segment-iterator_8cc}{js-\/segment-\/iterator.\+cc}}\end{DoxyCompactItemize}
