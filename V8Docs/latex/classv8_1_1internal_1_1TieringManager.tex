\hypertarget{classv8_1_1internal_1_1TieringManager}{}\doxysection{v8\+::internal\+::Tiering\+Manager Class Reference}
\label{classv8_1_1internal_1_1TieringManager}\index{v8::internal::TieringManager@{v8::internal::TieringManager}}


{\ttfamily \#include $<$tiering-\/manager.\+h$>$}



Collaboration diagram for v8\+::internal\+::Tiering\+Manager\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_1_1OnInterruptTickScope}{On\+Interrupt\+Tick\+Scope}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a7e67c924fe7c37444d5dc53557241948}{Tiering\+Manager}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate)
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_aac2eb7406a1ccb620cdc0773bbc7f57f}{On\+Interrupt\+Tick}} (\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$ function, \mbox{\hyperlink{namespacev8_1_1internal_a9f3877ef6710a52328e07f2f6347b577}{Code\+Kind}} code\+\_\+kind)
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a55f345bb7fa25a8f1b09def63676f536}{Notify\+ICChanged}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1FeedbackVector}{Feedback\+Vector}} $>$ vector)
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a14976d22f76dad46de632638a3be1ada}{Request\+Osr\+At\+Next\+Opportunity}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$ function)
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_ae75d92833be18671294d49598a703b3d}{Mark\+For\+Turbo\+Fan\+Optimization}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$ function)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a80f5e9c142559d86f0704972513e7ee7}{Interrupt\+Budget\+For}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$ function, std\+::optional$<$ \mbox{\hyperlink{namespacev8_1_1internal_a9f3877ef6710a52328e07f2f6347b577}{Code\+Kind}} $>$ override\+\_\+active\+\_\+tier=\{\})
\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a3b10f96a8e90bef265529f93ef1c939d}{Maybe\+Optimize\+Frame}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$ function, \mbox{\hyperlink{namespacev8_1_1internal_a9f3877ef6710a52328e07f2f6347b577}{Code\+Kind}} code\+\_\+kind)
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1OptimizationDecision}{Optimization\+Decision}} \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a3bf332cc352e26ced668a0b16c0ca479}{Should\+Optimize}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1FeedbackVector}{Feedback\+Vector}} $>$ feedback\+\_\+vector, \mbox{\hyperlink{namespacev8_1_1internal_a9f3877ef6710a52328e07f2f6347b577}{Code\+Kind}} code\+\_\+kind)
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a93d0ae84b9f62b0af4a0ac27cd6cfcab}{Optimize}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$ function, \mbox{\hyperlink{classv8_1_1internal_1_1OptimizationDecision}{Optimization\+Decision}} decision)
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a181431f7d59e71e10f67fa5d6945baf7}{Baseline}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$ function, \mbox{\hyperlink{namespacev8_1_1internal_a6c8e35b48eef9d51250a2d7b86c82567}{Optimization\+Reason}} reason)
\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$const \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\+\_\+}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 27 of file tiering-\/manager.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1TieringManager_a7e67c924fe7c37444d5dc53557241948}\label{classv8_1_1internal_1_1TieringManager_a7e67c924fe7c37444d5dc53557241948}} 
\index{v8::internal::TieringManager@{v8::internal::TieringManager}!TieringManager@{TieringManager}}
\index{TieringManager@{TieringManager}!v8::internal::TieringManager@{v8::internal::TieringManager}}
\doxysubsubsection{\texorpdfstring{TieringManager()}{TieringManager()}}
{\footnotesize\ttfamily v8\+::internal\+::\+Tiering\+Manager\+::\+Tiering\+Manager (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}



Definition at line 29 of file tiering-\/manager.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{29 : \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}(isolate) \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1TieringManager_a181431f7d59e71e10f67fa5d6945baf7}\label{classv8_1_1internal_1_1TieringManager_a181431f7d59e71e10f67fa5d6945baf7}} 
\index{v8::internal::TieringManager@{v8::internal::TieringManager}!Baseline@{Baseline}}
\index{Baseline@{Baseline}!v8::internal::TieringManager@{v8::internal::TieringManager}}
\doxysubsubsection{\texorpdfstring{Baseline()}{Baseline()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Tiering\+Manager\+::\+Baseline (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$}]{function,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a6c8e35b48eef9d51250a2d7b86c82567}{Optimization\+Reason}}}]{reason }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{classv8_1_1internal_1_1TieringManager_a80f5e9c142559d86f0704972513e7ee7}\label{classv8_1_1internal_1_1TieringManager_a80f5e9c142559d86f0704972513e7ee7}} 
\index{v8::internal::TieringManager@{v8::internal::TieringManager}!InterruptBudgetFor@{InterruptBudgetFor}}
\index{InterruptBudgetFor@{InterruptBudgetFor}!v8::internal::TieringManager@{v8::internal::TieringManager}}
\doxysubsubsection{\texorpdfstring{InterruptBudgetFor()}{InterruptBudgetFor()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classint}{int}} v8\+::internal\+::\+Tiering\+Manager\+::\+Interrupt\+Budget\+For (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$}]{function,  }\item[{std\+::optional$<$ \mbox{\hyperlink{namespacev8_1_1internal_a9f3877ef6710a52328e07f2f6347b577}{Code\+Kind}} $>$}]{override\+\_\+active\+\_\+tier = {\ttfamily \{\}} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 228 of file tiering-\/manager.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{230                                                 \{}
\DoxyCodeLine{231   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(function-\/>shared()-\/>is\_compiled());}
\DoxyCodeLine{232   \textcolor{keyword}{const} \textcolor{keywordtype}{int} bytecode\_length =}
\DoxyCodeLine{233       \textcolor{keyword}{function}-\/>shared()-\/>GetBytecodeArray(isolate)-\/>length();}
\DoxyCodeLine{234 }
\DoxyCodeLine{235   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02tiering-manager_8cc_03_afd6c6ca3a5eb24b769b555f488832c97}{FirstTimeTierUpToSparkplug}}(isolate, \textcolor{keyword}{function})) \{}
\DoxyCodeLine{236     \textcolor{keywordflow}{return} bytecode\_length * \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.invocation\_count\_for\_feedback\_allocation;}
\DoxyCodeLine{237   \}}
\DoxyCodeLine{238 }
\DoxyCodeLine{239   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(function-\/>has\_feedback\_vector());}
\DoxyCodeLine{240   \textcolor{keywordflow}{if} (bytecode\_length > \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.max\_optimized\_bytecode\_size) \{}
\DoxyCodeLine{241     \textcolor{comment}{// Decrease times of interrupt budget underflow, the reason of not setting}}
\DoxyCodeLine{242     \textcolor{comment}{// to INT\_MAX is the interrupt budget may overflow when doing add}}
\DoxyCodeLine{243     \textcolor{comment}{// operation for forward jump.}}
\DoxyCodeLine{244     \textcolor{keywordflow}{return} INT\_MAX / 2;}
\DoxyCodeLine{245   \}}
\DoxyCodeLine{246   \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02tiering-manager_8cc_03_a93ee9403d113eb75c50186d4f4989ceb}{return ::i::InterruptBudgetFor}}(}
\DoxyCodeLine{247       isolate,}
\DoxyCodeLine{248       override\_active\_tier ? override\_active\_tier}
\DoxyCodeLine{249                            : function-\/>GetActiveTier(isolate),}
\DoxyCodeLine{250       \textcolor{keyword}{function}, function-\/>shared()-\/>cached\_tiering\_decision(), bytecode\_length);}
\DoxyCodeLine{251 \}}

\end{DoxyCode}


References v8\+::internal\+::\+DCHECK(), v8\+::internal\+::anonymous\+\_\+namespace\{tiering-\/manager.\+cc\}\+::\+First\+Time\+Tier\+Up\+To\+Sparkplug(), v8\+::internal\+::anonymous\+\_\+namespace\{tiering-\/manager.\+cc\}\+::\+Interrupt\+Budget\+For(), and v8\+::internal\+::v8\+\_\+flags.



Referenced by v8\+::internal\+::anonymous\+\_\+namespace\{debug-\/coverage.\+cc\}\+::\+Collect\+And\+Maybe\+Reset\+Counts(), and v8\+::internal\+::\+JSFunction\+::\+Set\+Interrupt\+Budget().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_a80f5e9c142559d86f0704972513e7ee7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_a80f5e9c142559d86f0704972513e7ee7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1TieringManager_ae75d92833be18671294d49598a703b3d}\label{classv8_1_1internal_1_1TieringManager_ae75d92833be18671294d49598a703b3d}} 
\index{v8::internal::TieringManager@{v8::internal::TieringManager}!MarkForTurboFanOptimization@{MarkForTurboFanOptimization}}
\index{MarkForTurboFanOptimization@{MarkForTurboFanOptimization}!v8::internal::TieringManager@{v8::internal::TieringManager}}
\doxysubsubsection{\texorpdfstring{MarkForTurboFanOptimization()}{MarkForTurboFanOptimization()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Tiering\+Manager\+::\+Mark\+For\+Turbo\+Fan\+Optimization (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$}]{function }\end{DoxyParamCaption})}



Definition at line 150 of file tiering-\/manager.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{150                                                                             \{}
\DoxyCodeLine{151   \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a93d0ae84b9f62b0af4a0ac27cd6cfcab}{Optimize}}(\textcolor{keyword}{function}, \mbox{\hyperlink{classv8_1_1internal_1_1OptimizationDecision_aa246b609143f7ddced378b49f42bfc47}{OptimizationDecision::TurbofanHotAndStable}}());}
\DoxyCodeLine{152 \}}

\end{DoxyCode}


References Optimize(), and v8\+::internal\+::\+Optimization\+Decision\+::\+Turbofan\+Hot\+And\+Stable().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_ae75d92833be18671294d49598a703b3d_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1TieringManager_a3b10f96a8e90bef265529f93ef1c939d}\label{classv8_1_1internal_1_1TieringManager_a3b10f96a8e90bef265529f93ef1c939d}} 
\index{v8::internal::TieringManager@{v8::internal::TieringManager}!MaybeOptimizeFrame@{MaybeOptimizeFrame}}
\index{MaybeOptimizeFrame@{MaybeOptimizeFrame}!v8::internal::TieringManager@{v8::internal::TieringManager}}
\doxysubsubsection{\texorpdfstring{MaybeOptimizeFrame()}{MaybeOptimizeFrame()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Tiering\+Manager\+::\+Maybe\+Optimize\+Frame (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$}]{function,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a9f3877ef6710a52328e07f2f6347b577}{Code\+Kind}}}]{code\+\_\+kind }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 300 of file tiering-\/manager.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{301                                                                     \{}
\DoxyCodeLine{302   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} tiering\_in\_progress = \textcolor{keyword}{function}-\/>tiering\_in\_progress();}
\DoxyCodeLine{303   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} osr\_in\_progress =}
\DoxyCodeLine{304       \textcolor{keyword}{function}-\/>feedback\_vector()-\/>osr\_tiering\_in\_progress();}
\DoxyCodeLine{305   \textcolor{comment}{// Attenzione! Update this constant in case the condition below changes.}}
\DoxyCodeLine{306   static\_assert(\mbox{\hyperlink{namespacev8_1_1internal_ab36b8c5564206719bdd619e4e760c144}{kTieringStateInProgressBlocksTierup}});}
\DoxyCodeLine{307   \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(tiering\_in\_progress) || \mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(osr\_in\_progress)) \{}
\DoxyCodeLine{308     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.concurrent\_recompilation\_front\_running \&\&}
\DoxyCodeLine{309         ((tiering\_in\_progress \&\& function-\/>ActiveTierIsMaglev(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}})) ||}
\DoxyCodeLine{310          (osr\_in\_progress \&\&}
\DoxyCodeLine{311           function-\/>feedback\_vector()-\/>maybe\_has\_optimized\_osr\_code()))) \{}
\DoxyCodeLine{312       \textcolor{comment}{// TODO(olivf): In the case of Maglev we tried a queue with two}}
\DoxyCodeLine{313       \textcolor{comment}{// priorities, but it seems not actually beneficial. More}}
\DoxyCodeLine{314       \textcolor{comment}{// investigation is needed.}}
\DoxyCodeLine{315       \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Isolate_a6ac6d7dcb9f6212068c663a285fbaeb4}{IncreaseConcurrentOptimizationPriority}}(CodeKind::TURBOFAN\_JS,}
\DoxyCodeLine{316                                                        function-\/>shared());}
\DoxyCodeLine{317     \}}
\DoxyCodeLine{318     \textcolor{comment}{// Note: This effectively disables further tiering actions (e.g. OSR, or}}
\DoxyCodeLine{319     \textcolor{comment}{// tiering up into Maglev) for the function while it is being compiled.}}
\DoxyCodeLine{320     \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02tiering-manager_8cc_03_abf8b098961ced3ebcbcc76e144160526}{TraceInOptimizationQueue}}(\textcolor{keyword}{function}, current\_code\_kind);}
\DoxyCodeLine{321     \textcolor{keywordflow}{return};}
\DoxyCodeLine{322   \}}
\DoxyCodeLine{323 }
\DoxyCodeLine{324   \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.testing\_d8\_test\_runner) \&\&}
\DoxyCodeLine{325       \mbox{\hyperlink{classv8_1_1internal_1_1ManualOptimizationTable_af6b54b998489872bed4c6fd0c24cd5c1}{ManualOptimizationTable::IsMarkedForManualOptimization}}(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}},}
\DoxyCodeLine{326                                                              \textcolor{keyword}{function})) \{}
\DoxyCodeLine{327     \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02tiering-manager_8cc_03_aa080a1fbf01beead5269f651d89b7c1e}{TraceHeuristicOptimizationDisallowed}}(\textcolor{keyword}{function});}
\DoxyCodeLine{328     \textcolor{keywordflow}{return};}
\DoxyCodeLine{329   \}}
\DoxyCodeLine{330 }
\DoxyCodeLine{331   \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(function-\/>shared()-\/>optimization\_disabled(}
\DoxyCodeLine{332           current\_code\_kind == CodeKind::MAGLEV ? CodeKind::TURBOFAN\_JS}
\DoxyCodeLine{333                                                 : CodeKind::MAGLEV))) \{}
\DoxyCodeLine{334     \textcolor{keywordflow}{return};}
\DoxyCodeLine{335   \}}
\DoxyCodeLine{336 }
\DoxyCodeLine{337   \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.always\_osr)) \{}
\DoxyCodeLine{338     \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02tiering-manager_8cc_03_a7346e39f86996618ee07209357a8febc}{TryRequestOsrAtNextOpportunity}}(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, \textcolor{keyword}{function});}
\DoxyCodeLine{339     \textcolor{comment}{// Continue below and do a normal optimized compile as well.}}
\DoxyCodeLine{340   \}}
\DoxyCodeLine{341 }
\DoxyCodeLine{342   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} maglev\_osr = \mbox{\hyperlink{namespacev8_1_1internal_1_1maglev_a6c437af0c4ce8c8ff4a81f80058cdfe8}{maglev::IsMaglevOsrEnabled}}();}
\DoxyCodeLine{343   \textcolor{keyword}{const} \mbox{\hyperlink{namespacev8_1_1internal_aea60fde246b69d56a62c36775c091c58}{CodeKinds}} available\_kinds = \textcolor{keyword}{function}-\/>GetAvailableCodeKinds(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}});}
\DoxyCodeLine{344   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} waiting\_for\_tierup =}
\DoxyCodeLine{345       (current\_code\_kind < CodeKind::TURBOFAN\_JS \&\&}
\DoxyCodeLine{346        (available\_kinds \& CodeKindFlag::TURBOFAN\_JS)) ||}
\DoxyCodeLine{347       (maglev\_osr \&\& current\_code\_kind < CodeKind::MAGLEV \&\&}
\DoxyCodeLine{348        (available\_kinds \& CodeKindFlag::MAGLEV));}
\DoxyCodeLine{349   \textcolor{comment}{// Baseline OSR uses a separate mechanism and must not be considered here,}}
\DoxyCodeLine{350   \textcolor{comment}{// therefore we limit to kOptimizedJSFunctionCodeKindsMask.}}
\DoxyCodeLine{351   \textcolor{keywordflow}{if} (function-\/>IsOptimizationRequested(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}) || waiting\_for\_tierup) \{}
\DoxyCodeLine{352     \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(maglev\_osr \&\& current\_code\_kind == CodeKind::MAGLEV \&\&}
\DoxyCodeLine{353                     (!\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.osr\_from\_maglev ||}
\DoxyCodeLine{354                      \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Isolate_a6aaaceedeed1b4d8390ec23038ca1d87}{EfficiencyModeEnabledForTiering}}() ||}
\DoxyCodeLine{355                      \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Isolate_ad8e6a0faa64c5dc168e31bc5c0b62252}{BatterySaverModeEnabled}}()))) \{}
\DoxyCodeLine{356       \textcolor{keywordflow}{return};}
\DoxyCodeLine{357     \}}
\DoxyCodeLine{358 }
\DoxyCodeLine{359     \textcolor{comment}{// OSR kicks in only once we've previously decided to tier up, but we are}}
\DoxyCodeLine{360     \textcolor{comment}{// still in a lower-\/tier frame (this implies a long-\/running loop).}}
\DoxyCodeLine{361     \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02tiering-manager_8cc_03_a71261c1e5644fff4e0bd778f354ef85a}{TryIncrementOsrUrgency}}(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, \textcolor{keyword}{function});}
\DoxyCodeLine{362 }
\DoxyCodeLine{363     \textcolor{comment}{// Return unconditionally and don't run through the optimization decision}}
\DoxyCodeLine{364     \textcolor{comment}{// again; we've already decided to tier up previously.}}
\DoxyCodeLine{365     \textcolor{keywordflow}{return};}
\DoxyCodeLine{366   \}}
\DoxyCodeLine{367 }
\DoxyCodeLine{368   \textcolor{keyword}{const} std::optional<CodeKind> existing\_request =}
\DoxyCodeLine{369       \textcolor{keyword}{function}-\/>GetRequestedOptimizationIfAny(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}});}
\DoxyCodeLine{370   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(existing\_request != CodeKind::TURBOFAN\_JS);}
\DoxyCodeLine{371   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(!function-\/>HasAvailableCodeKind(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, CodeKind::TURBOFAN\_JS));}
\DoxyCodeLine{372   OptimizationDecision d =}
\DoxyCodeLine{373       \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a3bf332cc352e26ced668a0b16c0ca479}{ShouldOptimize}}(function-\/>feedback\_vector(), current\_code\_kind);}
\DoxyCodeLine{374   \textcolor{comment}{// We might be stuck in a baseline frame that wants to tier up to Maglev, but}}
\DoxyCodeLine{375   \textcolor{comment}{// is in a loop, and can't OSR, because Maglev doesn't have OSR. Allow it to}}
\DoxyCodeLine{376   \textcolor{comment}{// skip over Maglev by re-\/checking ShouldOptimize as if we were in Maglev.}}
\DoxyCodeLine{377   \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(!\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Isolate_a6aaaceedeed1b4d8390ec23038ca1d87}{EfficiencyModeEnabledForTiering}}() \&\& !maglev\_osr \&\&}
\DoxyCodeLine{378                   d.should\_optimize() \&\& d.code\_kind == CodeKind::MAGLEV)) \{}
\DoxyCodeLine{379     \textcolor{keywordtype}{bool} is\_marked\_for\_maglev\_optimization =}
\DoxyCodeLine{380         existing\_request == CodeKind::MAGLEV ||}
\DoxyCodeLine{381         (available\_kinds \& CodeKindFlag::MAGLEV);}
\DoxyCodeLine{382     \textcolor{keywordflow}{if} (is\_marked\_for\_maglev\_optimization) \{}
\DoxyCodeLine{383       d = \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a3bf332cc352e26ced668a0b16c0ca479}{ShouldOptimize}}(function-\/>feedback\_vector(), CodeKind::MAGLEV);}
\DoxyCodeLine{384     \}}
\DoxyCodeLine{385   \}}
\DoxyCodeLine{386 }
\DoxyCodeLine{387   \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Isolate_a6aaaceedeed1b4d8390ec23038ca1d87}{EfficiencyModeEnabledForTiering}}() \&\&}
\DoxyCodeLine{388                   d.code\_kind != CodeKind::TURBOFAN\_JS)) \{}
\DoxyCodeLine{389     d.concurrency\_mode = \mbox{\hyperlink{namespacev8_1_1internal_a420e377bba6b25b38450dd44912cd5f6a21ed2c08d58afea3d6b70cec9fbc377b}{ConcurrencyMode::kSynchronous}};}
\DoxyCodeLine{390   \}}
\DoxyCodeLine{391 }
\DoxyCodeLine{392   \textcolor{keywordflow}{if} (d.should\_optimize()) \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a93d0ae84b9f62b0af4a0ac27cd6cfcab}{Optimize}}(\textcolor{keyword}{function}, d);}
\DoxyCodeLine{393 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Isolate\+::\+Battery\+Saver\+Mode\+Enabled(), v8\+::internal\+::\+Optimization\+Decision\+::code\+\_\+kind, v8\+::internal\+::\+Optimization\+Decision\+::concurrency\+\_\+mode, v8\+::internal\+::\+DCHECK(), v8\+::internal\+::\+Isolate\+::\+Efficiency\+Mode\+Enabled\+For\+Tiering(), v8\+::internal\+::\+Isolate\+::\+Increase\+Concurrent\+Optimization\+Priority(), v8\+::internal\+::maglev\+::\+Is\+Maglev\+Osr\+Enabled(), v8\+::internal\+::\+Manual\+Optimization\+Table\+::\+Is\+Marked\+For\+Manual\+Optimization(), isolate\+\_\+, v8\+::internal\+::k\+Synchronous, v8\+::internal\+::k\+Tiering\+State\+In\+Progress\+Blocks\+Tierup, Optimize(), v8\+::internal\+::\+Optimization\+Decision\+::should\+\_\+optimize(), Should\+Optimize(), v8\+::internal\+::anonymous\+\_\+namespace\{tiering-\/manager.\+cc\}\+::\+Trace\+Heuristic\+Optimization\+Disallowed(), v8\+::internal\+::anonymous\+\_\+namespace\{tiering-\/manager.\+cc\}\+::\+Trace\+In\+Optimization\+Queue(), v8\+::internal\+::anonymous\+\_\+namespace\{tiering-\/manager.\+cc\}\+::\+Try\+Increment\+Osr\+Urgency(), v8\+::internal\+::anonymous\+\_\+namespace\{tiering-\/manager.\+cc\}\+::\+Try\+Request\+Osr\+At\+Next\+Opportunity(), v8\+::internal\+::v8\+\_\+flags, and V8\+\_\+\+UNLIKELY.



Referenced by On\+Interrupt\+Tick().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_a3b10f96a8e90bef265529f93ef1c939d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_a3b10f96a8e90bef265529f93ef1c939d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1TieringManager_a55f345bb7fa25a8f1b09def63676f536}\label{classv8_1_1internal_1_1TieringManager_a55f345bb7fa25a8f1b09def63676f536}} 
\index{v8::internal::TieringManager@{v8::internal::TieringManager}!NotifyICChanged@{NotifyICChanged}}
\index{NotifyICChanged@{NotifyICChanged}!v8::internal::TieringManager@{v8::internal::TieringManager}}
\doxysubsubsection{\texorpdfstring{NotifyICChanged()}{NotifyICChanged()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Tiering\+Manager\+::\+Notify\+ICChanged (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1FeedbackVector}{Feedback\+Vector}} $>$}]{vector }\end{DoxyParamCaption})}



Definition at line 457 of file tiering-\/manager.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{457                                                                   \{}
\DoxyCodeLine{458   \mbox{\hyperlink{namespacev8_1_1internal_a9f3877ef6710a52328e07f2f6347b577}{CodeKind}} code\_kind = vector-\/>shared\_function\_info()-\/>HasBaselineCode()}
\DoxyCodeLine{459                            ? CodeKind::BASELINE}
\DoxyCodeLine{460                            : CodeKind::INTERPRETED\_FUNCTION;}
\DoxyCodeLine{461 }
\DoxyCodeLine{462 \textcolor{preprocessor}{\#ifndef V8\_ENABLE\_LEAPTIERING}}
\DoxyCodeLine{463   \textcolor{keywordflow}{if} (vector-\/>has\_optimized\_code()) \{}
\DoxyCodeLine{464     code\_kind = vector-\/>optimized\_code(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}})-\/>kind();}
\DoxyCodeLine{465   \}}
\DoxyCodeLine{466 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// !V8\_ENABLE\_LEAPTIERING}}
\DoxyCodeLine{467 }
\DoxyCodeLine{468   \textcolor{keywordflow}{if} (code\_kind == CodeKind::INTERPRETED\_FUNCTION \&\&}
\DoxyCodeLine{469       \mbox{\hyperlink{namespacev8_1_1internal_af9f00f5c79b81245b561cf3984e65d74}{CanCompileWithBaseline}}(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, vector-\/>shared\_function\_info()) \&\&}
\DoxyCodeLine{470       vector-\/>shared\_function\_info()-\/>cached\_tiering\_decision() ==}
\DoxyCodeLine{471           \mbox{\hyperlink{namespacev8_1_1internal_a178a24cf9d2b1c1517d2bb9ec32b8227aa09be96128822643f3487a1415eb861c}{CachedTieringDecision::kPending}}) \{}
\DoxyCodeLine{472     \textcolor{comment}{// Don't delay tier-\/up if we haven't tiered up to baseline yet, but will -\/-\/}}
\DoxyCodeLine{473     \textcolor{comment}{// baseline code is feedback independent.}}
\DoxyCodeLine{474     \textcolor{keywordflow}{return};}
\DoxyCodeLine{475   \}}
\DoxyCodeLine{476 }
\DoxyCodeLine{477   OptimizationDecision decision = \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a3bf332cc352e26ced668a0b16c0ca479}{ShouldOptimize}}(vector, code\_kind);}
\DoxyCodeLine{478   \textcolor{keywordflow}{if} (decision.should\_optimize()) \{}
\DoxyCodeLine{479     Tagged<SharedFunctionInfo> shared = vector-\/>shared\_function\_info();}
\DoxyCodeLine{480     \textcolor{keywordtype}{int} bytecode\_length = shared-\/>GetBytecodeArray(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}})-\/>length();}
\DoxyCodeLine{481     \mbox{\hyperlink{namespacev8_1_1internal_acd0a5240d29e40367316d2fbdaaafeca}{Tagged<FeedbackCell>}} cell = vector-\/>parent\_feedback\_cell();}
\DoxyCodeLine{482     \textcolor{keywordtype}{int} invocations = \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.minimum\_invocations\_after\_ic\_update;}
\DoxyCodeLine{483     \textcolor{keywordtype}{int} bytecodes = std::min(bytecode\_length, (\mbox{\hyperlink{namespacev8_1_1internal_ad03e50e4d15ee0da6a722254f350e7eb}{kMaxInt}} >> 1) / invocations);}
\DoxyCodeLine{484     \textcolor{keywordtype}{int} new\_budget = invocations * bytecodes;}
\DoxyCodeLine{485     \textcolor{keywordtype}{int} current\_budget = cell-\/>interrupt\_budget();}
\DoxyCodeLine{486     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.profile\_guided\_optimization \&\&}
\DoxyCodeLine{487         shared-\/>cached\_tiering\_decision() <=}
\DoxyCodeLine{488             \mbox{\hyperlink{namespacev8_1_1internal_a178a24cf9d2b1c1517d2bb9ec32b8227ac4453b9036f43caef169c9d043c6033f}{CachedTieringDecision::kEarlySparkplug}}) \{}
\DoxyCodeLine{489       \mbox{\hyperlink{src_2base_2logging_8h_af1a711c8d5520dff78858ddefd2ad668}{DCHECK\_LT}}(\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.invocation\_count\_for\_early\_optimization,}
\DoxyCodeLine{490                 \mbox{\hyperlink{classv8_1_1internal_1_1FeedbackVector_a5e266533199c93546def8d9678a97c19}{FeedbackVector::kInvocationCountBeforeStableDeoptSentinel}});}
\DoxyCodeLine{491       \textcolor{keywordflow}{if} (vector-\/>invocation\_count\_before\_stable() <}
\DoxyCodeLine{492           \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.invocation\_count\_for\_early\_optimization) \{}
\DoxyCodeLine{493         \textcolor{comment}{// Record how many invocation count were consumed before the last IC}}
\DoxyCodeLine{494         \textcolor{comment}{// change.}}
\DoxyCodeLine{495         \textcolor{keywordtype}{int} new\_invocation\_count\_before\_stable;}
\DoxyCodeLine{496         \textcolor{keywordflow}{if} (vector-\/>interrupt\_budget\_reset\_by\_ic\_change()) \{}
\DoxyCodeLine{497           \textcolor{comment}{// Initial interrupt budget is}}
\DoxyCodeLine{498           \textcolor{comment}{// v8\_flags.minimum\_invocations\_after\_ic\_update * bytecodes}}
\DoxyCodeLine{499           \textcolor{keywordtype}{int} new\_consumed\_budget = new\_budget -\/ current\_budget;}
\DoxyCodeLine{500           new\_invocation\_count\_before\_stable =}
\DoxyCodeLine{501               vector-\/>invocation\_count\_before\_stable(\mbox{\hyperlink{namespacev8_a65227471e4ee0ccd275854a995f12a62}{kRelaxedLoad}}) +}
\DoxyCodeLine{502               std::ceil(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(new\_consumed\_budget) / bytecodes);}
\DoxyCodeLine{503         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{504           \textcolor{comment}{// Initial interrupt budget is}}
\DoxyCodeLine{505           \textcolor{comment}{// v8\_flags.invocation\_count\_for\_\{maglev|turbofan\} * bytecodes}}
\DoxyCodeLine{506           \textcolor{keywordtype}{int} total\_consumed\_budget =}
\DoxyCodeLine{507               (\mbox{\hyperlink{namespacev8_1_1internal_1_1maglev_a7406a952d2c33446062616dd41e79809}{maglev::IsMaglevEnabled}}()}
\DoxyCodeLine{508                    ? \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.invocation\_count\_for\_maglev}
\DoxyCodeLine{509                    : \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.invocation\_count\_for\_turbofan) *}
\DoxyCodeLine{510                   bytecodes -\/}
\DoxyCodeLine{511               current\_budget;}
\DoxyCodeLine{512           new\_invocation\_count\_before\_stable =}
\DoxyCodeLine{513               std::ceil(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(total\_consumed\_budget) / bytecodes);}
\DoxyCodeLine{514         \}}
\DoxyCodeLine{515         \textcolor{keywordflow}{if} (new\_invocation\_count\_before\_stable >=}
\DoxyCodeLine{516             \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.invocation\_count\_for\_early\_optimization) \{}
\DoxyCodeLine{517           vector-\/>set\_invocation\_count\_before\_stable(}
\DoxyCodeLine{518               \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.invocation\_count\_for\_early\_optimization, \mbox{\hyperlink{namespacev8_a6f4ac914af065ca471d59c67f789296f}{kRelaxedStore}});}
\DoxyCodeLine{519           shared-\/>set\_cached\_tiering\_decision(\mbox{\hyperlink{namespacev8_1_1internal_a178a24cf9d2b1c1517d2bb9ec32b8227a07fa7a19aa722c635a15e94cb7f50416}{CachedTieringDecision::kNormal}});}
\DoxyCodeLine{520         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{521           vector-\/>set\_invocation\_count\_before\_stable(}
\DoxyCodeLine{522               new\_invocation\_count\_before\_stable, \mbox{\hyperlink{namespacev8_a6f4ac914af065ca471d59c67f789296f}{kRelaxedStore}});}
\DoxyCodeLine{523         \}}
\DoxyCodeLine{524       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{525         shared-\/>set\_cached\_tiering\_decision(\mbox{\hyperlink{namespacev8_1_1internal_a178a24cf9d2b1c1517d2bb9ec32b8227a07fa7a19aa722c635a15e94cb7f50416}{CachedTieringDecision::kNormal}});}
\DoxyCodeLine{526       \}}
\DoxyCodeLine{527     \}}
\DoxyCodeLine{528     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.profile\_guided\_optimization ||}
\DoxyCodeLine{529         \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02tiering-manager_8cc_03_a4c55ce412c0d4093aaae5f0391ead13a}{ShouldResetInterruptBudgetByICChange}}(}
\DoxyCodeLine{530             shared-\/>cached\_tiering\_decision())) \{}
\DoxyCodeLine{531       \textcolor{keywordflow}{if} (new\_budget > current\_budget) \{}
\DoxyCodeLine{532         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.trace\_opt\_verbose) \{}
\DoxyCodeLine{533           \mbox{\hyperlink{namespacev8_1_1internal_a3430752cde9f29d73e97ceed1bce0856}{PrintF}}(\textcolor{stringliteral}{"{}[delaying optimization of \%s, IC changed]\(\backslash\)n"{}},}
\DoxyCodeLine{534                  shared-\/>DebugNameCStr().get());}
\DoxyCodeLine{535         \}}
\DoxyCodeLine{536         vector-\/>set\_interrupt\_budget\_reset\_by\_ic\_change(\textcolor{keyword}{true});}
\DoxyCodeLine{537         cell-\/>set\_interrupt\_budget(new\_budget);}
\DoxyCodeLine{538       \}}
\DoxyCodeLine{539     \}}
\DoxyCodeLine{540   \}}
\DoxyCodeLine{541 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Can\+Compile\+With\+Baseline(), DCHECK\+\_\+\+LT, v8\+::internal\+::maglev\+::\+Is\+Maglev\+Enabled(), isolate\+\_\+, v8\+::internal\+::k\+Early\+Sparkplug, v8\+::internal\+::\+Feedback\+Vector\+::k\+Invocation\+Count\+Before\+Stable\+Deopt\+Sentinel, v8\+::internal\+::k\+Max\+Int, v8\+::internal\+::k\+Normal, v8\+::internal\+::k\+Pending, v8\+::k\+Relaxed\+Load, v8\+::k\+Relaxed\+Store, v8\+::internal\+::\+Print\+F(), v8\+::internal\+::\+Optimization\+Decision\+::should\+\_\+optimize(), Should\+Optimize(), v8\+::internal\+::anonymous\+\_\+namespace\{tiering-\/manager.\+cc\}\+::\+Should\+Reset\+Interrupt\+Budget\+By\+ICChange(), and v8\+::internal\+::v8\+\_\+flags.



Referenced by v8\+::internal\+::\+IC\+::\+On\+Feedback\+Changed().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_a55f345bb7fa25a8f1b09def63676f536_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_a55f345bb7fa25a8f1b09def63676f536_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1TieringManager_aac2eb7406a1ccb620cdc0773bbc7f57f}\label{classv8_1_1internal_1_1TieringManager_aac2eb7406a1ccb620cdc0773bbc7f57f}} 
\index{v8::internal::TieringManager@{v8::internal::TieringManager}!OnInterruptTick@{OnInterruptTick}}
\index{OnInterruptTick@{OnInterruptTick}!v8::internal::TieringManager@{v8::internal::TieringManager}}
\doxysubsubsection{\texorpdfstring{OnInterruptTick()}{OnInterruptTick()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Tiering\+Manager\+::\+On\+Interrupt\+Tick (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$}]{function,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a9f3877ef6710a52328e07f2f6347b577}{Code\+Kind}}}]{code\+\_\+kind }\end{DoxyParamCaption})}



Definition at line 548 of file tiering-\/manager.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{549                                                          \{}
\DoxyCodeLine{550   IsCompiledScope is\_compiled\_scope(}
\DoxyCodeLine{551       function-\/>shared()-\/>is\_compiled\_scope(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}));}
\DoxyCodeLine{552 }
\DoxyCodeLine{553   \textcolor{comment}{// Remember whether the function had a vector at this point. This is}}
\DoxyCodeLine{554   \textcolor{comment}{// relevant later since the configuration 'Ignition without a vector' can be}}
\DoxyCodeLine{555   \textcolor{comment}{// considered a tier on its own. We begin tiering up to tiers higher than}}
\DoxyCodeLine{556   \textcolor{comment}{// Sparkplug only when reaching this point *with* a feedback vector.}}
\DoxyCodeLine{557   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} had\_feedback\_vector = \textcolor{keyword}{function}-\/>has\_feedback\_vector();}
\DoxyCodeLine{558   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} first\_time\_tiered\_up\_to\_sparkplug =}
\DoxyCodeLine{559       \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02tiering-manager_8cc_03_afd6c6ca3a5eb24b769b555f488832c97}{FirstTimeTierUpToSparkplug}}(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, *\textcolor{keyword}{function});}
\DoxyCodeLine{560   \textcolor{comment}{// We don't want to trigger GC in the middle of OSR, so do not build a}}
\DoxyCodeLine{561   \textcolor{comment}{// baseline code for such case.}}
\DoxyCodeLine{562   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} maybe\_had\_optimized\_osr\_code =}
\DoxyCodeLine{563       had\_feedback\_vector \&\&}
\DoxyCodeLine{564       \textcolor{keyword}{function}-\/>feedback\_vector()-\/>maybe\_has\_optimized\_osr\_code();}
\DoxyCodeLine{565   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} compile\_sparkplug =}
\DoxyCodeLine{566       \mbox{\hyperlink{namespacev8_1_1internal_af9f00f5c79b81245b561cf3984e65d74}{CanCompileWithBaseline}}(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, function-\/>shared()) \&\&}
\DoxyCodeLine{567       \textcolor{keyword}{function}-\/>ActiveTierIsIgnition(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}) \&\& !maybe\_had\_optimized\_osr\_code;}
\DoxyCodeLine{568 }
\DoxyCodeLine{569   \textcolor{comment}{// Ensure that the feedback vector has been allocated.}}
\DoxyCodeLine{570   \textcolor{keywordflow}{if} (!had\_feedback\_vector) \{}
\DoxyCodeLine{571     \textcolor{keywordflow}{if} (compile\_sparkplug \&\& function-\/>shared()-\/>cached\_tiering\_decision() ==}
\DoxyCodeLine{572                                  \mbox{\hyperlink{namespacev8_1_1internal_a178a24cf9d2b1c1517d2bb9ec32b8227aa09be96128822643f3487a1415eb861c}{CachedTieringDecision::kPending}}) \{}
\DoxyCodeLine{573       \textcolor{comment}{// Mark the function as compiled with sparkplug before the feedback}}
\DoxyCodeLine{574       \textcolor{comment}{// vector is created to initialize the interrupt budget for the next}}
\DoxyCodeLine{575       \textcolor{comment}{// tier.}}
\DoxyCodeLine{576       \textcolor{keyword}{function}-\/>shared()-\/>set\_cached\_tiering\_decision(}
\DoxyCodeLine{577           \mbox{\hyperlink{namespacev8_1_1internal_a178a24cf9d2b1c1517d2bb9ec32b8227ac4453b9036f43caef169c9d043c6033f}{CachedTieringDecision::kEarlySparkplug}});}
\DoxyCodeLine{578     \}}
\DoxyCodeLine{579     \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction_ad8c58b374c7d37fc1ae665686ffd5aaf}{JSFunction::CreateAndAttachFeedbackVector}}(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, \textcolor{keyword}{function},}
\DoxyCodeLine{580                                               \&is\_compiled\_scope);}
\DoxyCodeLine{581     \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(is\_compiled\_scope.is\_compiled());}
\DoxyCodeLine{582     \textcolor{comment}{// Also initialize the invocation count here. This is only really needed}}
\DoxyCodeLine{583     \textcolor{comment}{// for OSR. When we OSR functions with lazy feedback allocation we want to}}
\DoxyCodeLine{584     \textcolor{comment}{// have a non zero invocation count so we can inline functions.}}
\DoxyCodeLine{585     \textcolor{keyword}{function}-\/>feedback\_vector()-\/>set\_invocation\_count(1, \mbox{\hyperlink{namespacev8_a6f4ac914af065ca471d59c67f789296f}{kRelaxedStore}});}
\DoxyCodeLine{586   \}}
\DoxyCodeLine{587 }
\DoxyCodeLine{588   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(function-\/>has\_feedback\_vector());}
\DoxyCodeLine{589   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(function-\/>shared()-\/>is\_compiled());}
\DoxyCodeLine{590   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(function-\/>shared()-\/>HasBytecodeArray());}
\DoxyCodeLine{591 }
\DoxyCodeLine{592   \textcolor{comment}{// TODO(jgruber): Consider integrating this into a linear tiering system}}
\DoxyCodeLine{593   \textcolor{comment}{// controlled by TieringState in which the order is always}}
\DoxyCodeLine{594   \textcolor{comment}{// Ignition-\/Sparkplug-\/Turbofan, and only a single tierup is requested at}}
\DoxyCodeLine{595   \textcolor{comment}{// once.}}
\DoxyCodeLine{596   \textcolor{comment}{// It's unclear whether this is possible and/or makes sense -\/ for example,}}
\DoxyCodeLine{597   \textcolor{comment}{// batching compilation can introduce arbitrary latency between the SP}}
\DoxyCodeLine{598   \textcolor{comment}{// compile request and fulfillment, which doesn't work with strictly linear}}
\DoxyCodeLine{599   \textcolor{comment}{// tiering.}}
\DoxyCodeLine{600   \textcolor{keywordflow}{if} (compile\_sparkplug) \{}
\DoxyCodeLine{601 \textcolor{preprocessor}{\#ifdef V8\_ENABLE\_SPARKPLUG}}
\DoxyCodeLine{602     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.baseline\_batch\_compilation) \{}
\DoxyCodeLine{603       \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}-\/>baseline\_batch\_compiler()-\/>EnqueueFunction(\textcolor{keyword}{function});}
\DoxyCodeLine{604     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{605       IsCompiledScope inner\_is\_compiled\_scope(}
\DoxyCodeLine{606           function-\/>shared()-\/>is\_compiled\_scope(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}));}
\DoxyCodeLine{607       \mbox{\hyperlink{classv8_1_1internal_1_1Compiler_a3d9cb7d9e97cc3fead5c1678deec6162}{Compiler::CompileBaseline}}(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, \textcolor{keyword}{function}, \mbox{\hyperlink{classv8_1_1internal_1_1Compiler_ab59ab49f4051abae5d94e22871913b96a36db99accfe9e9b85b7dfeb0a8862fb9}{Compiler::CLEAR\_EXCEPTION}},}
\DoxyCodeLine{608                                 \&inner\_is\_compiled\_scope);}
\DoxyCodeLine{609     \}}
\DoxyCodeLine{610 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{611     \mbox{\hyperlink{namespacev8_1_1internal_acdec713c25068019f935e35976f5b666}{UNREACHABLE}}();}
\DoxyCodeLine{612 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// V8\_ENABLE\_SPARKPLUG}}
\DoxyCodeLine{613   \}}
\DoxyCodeLine{614 }
\DoxyCodeLine{615   \textcolor{comment}{// We only tier up beyond sparkplug if we already had a feedback vector.}}
\DoxyCodeLine{616   \textcolor{keywordflow}{if} (first\_time\_tiered\_up\_to\_sparkplug) \{}
\DoxyCodeLine{617     \textcolor{comment}{// If we didn't have a feedback vector, the interrupt budget has already}}
\DoxyCodeLine{618     \textcolor{comment}{// been set by JSFunction::CreateAndAttachFeedbackVector, so no need to}}
\DoxyCodeLine{619     \textcolor{comment}{// set it again.}}
\DoxyCodeLine{620     \textcolor{keywordflow}{if} (had\_feedback\_vector) \{}
\DoxyCodeLine{621       \textcolor{keywordflow}{if} (function-\/>shared()-\/>cached\_tiering\_decision() ==}
\DoxyCodeLine{622           \mbox{\hyperlink{namespacev8_1_1internal_a178a24cf9d2b1c1517d2bb9ec32b8227aa09be96128822643f3487a1415eb861c}{CachedTieringDecision::kPending}}) \{}
\DoxyCodeLine{623         \textcolor{keyword}{function}-\/>shared()-\/>set\_cached\_tiering\_decision(}
\DoxyCodeLine{624             \mbox{\hyperlink{namespacev8_1_1internal_a178a24cf9d2b1c1517d2bb9ec32b8227ac4453b9036f43caef169c9d043c6033f}{CachedTieringDecision::kEarlySparkplug}});}
\DoxyCodeLine{625       \}}
\DoxyCodeLine{626       \textcolor{keyword}{function}-\/>SetInterruptBudget(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, \mbox{\hyperlink{namespacev8_1_1internal_ae1290056b3472a1bb475139c13e2efdba3538405b5d9916e92ac29b5f5458a88a}{BudgetModification::kRaise}});}
\DoxyCodeLine{627     \}}
\DoxyCodeLine{628     \textcolor{keywordflow}{return};}
\DoxyCodeLine{629   \}}
\DoxyCodeLine{630 }
\DoxyCodeLine{631   \textcolor{comment}{// Don't tier up if Turbofan is disabled.}}
\DoxyCodeLine{632   \textcolor{comment}{// TODO(jgruber): Update this for a multi-\/tier world.}}
\DoxyCodeLine{633   \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(!\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Isolate_af4f6612dba19ccb7a237f0ca07f272da}{use\_optimizer}}())) \{}
\DoxyCodeLine{634     \textcolor{keyword}{function}-\/>SetInterruptBudget(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, \mbox{\hyperlink{namespacev8_1_1internal_ae1290056b3472a1bb475139c13e2efdba3538405b5d9916e92ac29b5f5458a88a}{BudgetModification::kRaise}});}
\DoxyCodeLine{635     \textcolor{keywordflow}{return};}
\DoxyCodeLine{636   \}}
\DoxyCodeLine{637 }
\DoxyCodeLine{638   \textcolor{comment}{// -\/-\/-\/ We've decided to proceed for now. -\/-\/-\/}}
\DoxyCodeLine{639 }
\DoxyCodeLine{640   \mbox{\hyperlink{namespacev8_1_1internal_af2248a427f8ff8f81e68a2a87758e145}{DisallowGarbageCollection}} \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02json-stringifier_8cc_03_a63d8eefb47468aa3f816fbe26a59466a}{no\_gc}};}
\DoxyCodeLine{641   OnInterruptTickScope scope;}
\DoxyCodeLine{642   Tagged<JSFunction> function\_obj = *\textcolor{keyword}{function};}
\DoxyCodeLine{643 }
\DoxyCodeLine{644   \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a3b10f96a8e90bef265529f93ef1c939d}{MaybeOptimizeFrame}}(function\_obj, code\_kind);}
\DoxyCodeLine{645 }
\DoxyCodeLine{646   \textcolor{comment}{// Make sure to set the interrupt budget after maybe starting an optimization,}}
\DoxyCodeLine{647   \textcolor{comment}{// so that the interrupt budget size takes into account tiering state.}}
\DoxyCodeLine{648   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(had\_feedback\_vector);}
\DoxyCodeLine{649   \textcolor{keyword}{function}-\/>SetInterruptBudget(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, \mbox{\hyperlink{namespacev8_1_1internal_ae1290056b3472a1bb475139c13e2efdba3538405b5d9916e92ac29b5f5458a88a}{BudgetModification::kRaise}});}
\DoxyCodeLine{650 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Can\+Compile\+With\+Baseline(), v8\+::internal\+::\+Compiler\+::\+CLEAR\+\_\+\+EXCEPTION, v8\+::internal\+::\+Compiler\+::\+Compile\+Baseline(), v8\+::internal\+::\+JSFunction\+::\+Create\+And\+Attach\+Feedback\+Vector(), v8\+::internal\+::\+DCHECK(), v8\+::internal\+::anonymous\+\_\+namespace\{tiering-\/manager.\+cc\}\+::\+First\+Time\+Tier\+Up\+To\+Sparkplug(), v8\+::internal\+::\+Is\+Compiled\+Scope\+::is\+\_\+compiled(), isolate\+\_\+, v8\+::internal\+::k\+Early\+Sparkplug, v8\+::internal\+::k\+Pending, v8\+::internal\+::k\+Raise, v8\+::k\+Relaxed\+Store, Maybe\+Optimize\+Frame(), v8\+::internal\+::anonymous\+\_\+namespace\{json-\/stringifier.\+cc\}\+::no\+\_\+gc, v8\+::internal\+::\+UNREACHABLE(), v8\+::internal\+::\+Isolate\+::use\+\_\+optimizer(), v8\+::internal\+::v8\+\_\+flags, and V8\+\_\+\+UNLIKELY.



Referenced by v8\+::internal\+::anonymous\+\_\+namespace\{runtime-\/internal.\+cc\}\+::\+Bytecode\+Budget\+Interrupt(), and v8\+::internal\+::anonymous\+\_\+namespace\{runtime-\/internal.\+cc\}\+::\+Bytecode\+Budget\+Interrupt\+With\+Stack\+Check().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_aac2eb7406a1ccb620cdc0773bbc7f57f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_aac2eb7406a1ccb620cdc0773bbc7f57f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1TieringManager_a93d0ae84b9f62b0af4a0ac27cd6cfcab}\label{classv8_1_1internal_1_1TieringManager_a93d0ae84b9f62b0af4a0ac27cd6cfcab}} 
\index{v8::internal::TieringManager@{v8::internal::TieringManager}!Optimize@{Optimize}}
\index{Optimize@{Optimize}!v8::internal::TieringManager@{v8::internal::TieringManager}}
\doxysubsubsection{\texorpdfstring{Optimize()}{Optimize()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Tiering\+Manager\+::\+Optimize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$}]{function,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1OptimizationDecision}{Optimization\+Decision}}}]{decision }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 143 of file tiering-\/manager.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{144                                                       \{}
\DoxyCodeLine{145   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(d.should\_optimize());}
\DoxyCodeLine{146   \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02tiering-manager_8cc_03_a1b619897a93851d655180942f7d7b5e4}{TraceRecompile}}(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, \textcolor{keyword}{function}, d);}
\DoxyCodeLine{147   \textcolor{keyword}{function}-\/>RequestOptimization(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, d.code\_kind, d.concurrency\_mode);}
\DoxyCodeLine{148 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Optimization\+Decision\+::code\+\_\+kind, v8\+::internal\+::\+Optimization\+Decision\+::concurrency\+\_\+mode, v8\+::internal\+::\+DCHECK(), isolate\+\_\+, v8\+::internal\+::\+Optimization\+Decision\+::should\+\_\+optimize(), and v8\+::internal\+::anonymous\+\_\+namespace\{tiering-\/manager.\+cc\}\+::\+Trace\+Recompile().



Referenced by Mark\+For\+Turbo\+Fan\+Optimization(), and Maybe\+Optimize\+Frame().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_a93d0ae84b9f62b0af4a0ac27cd6cfcab_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_a93d0ae84b9f62b0af4a0ac27cd6cfcab_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1TieringManager_a14976d22f76dad46de632638a3be1ada}\label{classv8_1_1internal_1_1TieringManager_a14976d22f76dad46de632638a3be1ada}} 
\index{v8::internal::TieringManager@{v8::internal::TieringManager}!RequestOsrAtNextOpportunity@{RequestOsrAtNextOpportunity}}
\index{RequestOsrAtNextOpportunity@{RequestOsrAtNextOpportunity}!v8::internal::TieringManager@{v8::internal::TieringManager}}
\doxysubsubsection{\texorpdfstring{RequestOsrAtNextOpportunity()}{RequestOsrAtNextOpportunity()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Tiering\+Manager\+::\+Request\+Osr\+At\+Next\+Opportunity (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSFunction}{JSFunction}} $>$}]{function }\end{DoxyParamCaption})}



Definition at line 295 of file tiering-\/manager.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{295                                                                             \{}
\DoxyCodeLine{296   \mbox{\hyperlink{namespacev8_1_1internal_af2248a427f8ff8f81e68a2a87758e145}{DisallowGarbageCollection}} \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02json-stringifier_8cc_03_a63d8eefb47468aa3f816fbe26a59466a}{no\_gc}};}
\DoxyCodeLine{297   \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02tiering-manager_8cc_03_a7346e39f86996618ee07209357a8febc}{TryRequestOsrAtNextOpportunity}}(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}, \textcolor{keyword}{function});}
\DoxyCodeLine{298 \}}

\end{DoxyCode}


References isolate\+\_\+, v8\+::internal\+::anonymous\+\_\+namespace\{json-\/stringifier.\+cc\}\+::no\+\_\+gc, and v8\+::internal\+::anonymous\+\_\+namespace\{tiering-\/manager.\+cc\}\+::\+Try\+Request\+Osr\+At\+Next\+Opportunity().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_a14976d22f76dad46de632638a3be1ada_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1TieringManager_a3bf332cc352e26ced668a0b16c0ca479}\label{classv8_1_1internal_1_1TieringManager_a3bf332cc352e26ced668a0b16c0ca479}} 
\index{v8::internal::TieringManager@{v8::internal::TieringManager}!ShouldOptimize@{ShouldOptimize}}
\index{ShouldOptimize@{ShouldOptimize}!v8::internal::TieringManager@{v8::internal::TieringManager}}
\doxysubsubsection{\texorpdfstring{ShouldOptimize()}{ShouldOptimize()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1OptimizationDecision}{Optimization\+Decision}} v8\+::internal\+::\+Tiering\+Manager\+::\+Should\+Optimize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1FeedbackVector}{Feedback\+Vector}} $>$}]{feedback\+\_\+vector,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_a9f3877ef6710a52328e07f2f6347b577}{Code\+Kind}}}]{code\+\_\+kind }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 395 of file tiering-\/manager.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{396                                                                         \{}
\DoxyCodeLine{397   Tagged<SharedFunctionInfo> shared = feedback\_vector-\/>shared\_function\_info();}
\DoxyCodeLine{398   \textcolor{keywordflow}{if} (current\_code\_kind == CodeKind::TURBOFAN\_JS) \{}
\DoxyCodeLine{399     \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1OptimizationDecision_a6dbee95a7a7a55492d50be09f5dd0844}{OptimizationDecision::DoNotOptimize}}();}
\DoxyCodeLine{400   \}}
\DoxyCodeLine{401 }
\DoxyCodeLine{402   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02tiering-manager_8cc_03_acdc8c36bd81dd63c7f0fd3a2913cb50e}{TiersUpToMaglev}}(current\_code\_kind) \&\&}
\DoxyCodeLine{403       shared-\/>PassesFilter(\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.maglev\_filter) \&\&}
\DoxyCodeLine{404       !shared-\/>maglev\_compilation\_failed()) \{}
\DoxyCodeLine{405     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.profile\_guided\_optimization \&\&}
\DoxyCodeLine{406         shared-\/>cached\_tiering\_decision() ==}
\DoxyCodeLine{407             \mbox{\hyperlink{namespacev8_1_1internal_a178a24cf9d2b1c1517d2bb9ec32b8227ad64b2d42707f966cb8b34433fac0332e}{CachedTieringDecision::kEarlyTurbofan}}) \{}
\DoxyCodeLine{408       \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1OptimizationDecision_aa246b609143f7ddced378b49f42bfc47}{OptimizationDecision::TurbofanHotAndStable}}();}
\DoxyCodeLine{409     \}}
\DoxyCodeLine{410     \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1OptimizationDecision_a2bd6ab83cd022ba17bd9651b109f130f}{OptimizationDecision::Maglev}}();}
\DoxyCodeLine{411   \}}
\DoxyCodeLine{412 }
\DoxyCodeLine{413   \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(!\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.turbofan ||}
\DoxyCodeLine{414                   !shared-\/>PassesFilter(\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.turbo\_filter) ||}
\DoxyCodeLine{415                   (\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.efficiency\_mode\_disable\_turbofan \&\&}
\DoxyCodeLine{416                    \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Isolate_a6aaaceedeed1b4d8390ec23038ca1d87}{EfficiencyModeEnabledForTiering}}()) ||}
\DoxyCodeLine{417                   \mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Isolate_ad8e6a0faa64c5dc168e31bc5c0b62252}{BatterySaverModeEnabled}}())) \{}
\DoxyCodeLine{418     \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1OptimizationDecision_a6dbee95a7a7a55492d50be09f5dd0844}{OptimizationDecision::DoNotOptimize}}();}
\DoxyCodeLine{419   \}}
\DoxyCodeLine{420 }
\DoxyCodeLine{421   \textcolor{keywordflow}{if} (\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Isolate_a6aaaceedeed1b4d8390ec23038ca1d87}{EfficiencyModeEnabledForTiering}}() \&\&}
\DoxyCodeLine{422       \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.efficiency\_mode\_delay\_turbofan \&\&}
\DoxyCodeLine{423       feedback\_vector-\/>invocation\_count() <}
\DoxyCodeLine{424           \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.efficiency\_mode\_delay\_turbofan) \{}
\DoxyCodeLine{425     \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1OptimizationDecision_a6dbee95a7a7a55492d50be09f5dd0844}{OptimizationDecision::DoNotOptimize}}();}
\DoxyCodeLine{426   \}}
\DoxyCodeLine{427 }
\DoxyCodeLine{428   Tagged<BytecodeArray> bytecode = shared-\/>GetBytecodeArray(\mbox{\hyperlink{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}{isolate\_}});}
\DoxyCodeLine{429   \textcolor{keywordflow}{if} (bytecode-\/>length() > \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.max\_optimized\_bytecode\_size) \{}
\DoxyCodeLine{430     \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1OptimizationDecision_a6dbee95a7a7a55492d50be09f5dd0844}{OptimizationDecision::DoNotOptimize}}();}
\DoxyCodeLine{431   \}}
\DoxyCodeLine{432 }
\DoxyCodeLine{433   \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1OptimizationDecision_aa246b609143f7ddced378b49f42bfc47}{OptimizationDecision::TurbofanHotAndStable}}();}
\DoxyCodeLine{434 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Isolate\+::\+Battery\+Saver\+Mode\+Enabled(), v8\+::internal\+::\+Optimization\+Decision\+::\+Do\+Not\+Optimize(), v8\+::internal\+::\+Isolate\+::\+Efficiency\+Mode\+Enabled\+For\+Tiering(), isolate\+\_\+, v8\+::internal\+::k\+Early\+Turbofan, v8\+::internal\+::\+Optimization\+Decision\+::\+Maglev(), v8\+::internal\+::anonymous\+\_\+namespace\{tiering-\/manager.\+cc\}\+::\+Tiers\+Up\+To\+Maglev(), v8\+::internal\+::\+Optimization\+Decision\+::\+Turbofan\+Hot\+And\+Stable(), v8\+::internal\+::v8\+\_\+flags, and V8\+\_\+\+UNLIKELY.



Referenced by Maybe\+Optimize\+Frame(), and Notify\+ICChanged().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_a3bf332cc352e26ced668a0b16c0ca479_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1TieringManager_a3bf332cc352e26ced668a0b16c0ca479_icgraph}
\end{center}
\end{figure}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}\label{classv8_1_1internal_1_1TieringManager_a9e0eae3af05699e5229d168abb181995}} 
\index{v8::internal::TieringManager@{v8::internal::TieringManager}!isolate\_@{isolate\_}}
\index{isolate\_@{isolate\_}!v8::internal::TieringManager@{v8::internal::TieringManager}}
\doxysubsubsection{\texorpdfstring{isolate\_}{isolate\_}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}}$\ast$ const v8\+::internal\+::\+Tiering\+Manager\+::isolate\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 67 of file tiering-\/manager.\+h.



Referenced by Maybe\+Optimize\+Frame(), Notify\+ICChanged(), On\+Interrupt\+Tick(), Optimize(), Request\+Osr\+At\+Next\+Opportunity(), and Should\+Optimize().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/mnt/\+V8\+Source\+Code/src/execution/\mbox{\hyperlink{tiering-manager_8h}{tiering-\/manager.\+h}}\item 
/mnt/\+V8\+Source\+Code/src/execution/\mbox{\hyperlink{tiering-manager_8cc}{tiering-\/manager.\+cc}}\end{DoxyCompactItemize}
