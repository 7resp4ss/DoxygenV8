\hypertarget{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03}{}\doxysection{v8\+::internal\+::anonymous\+\_\+namespace\{perfetto-\/logger.cc\} Namespace Reference}
\label{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03}\index{v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}@{v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}}}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classv8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_1_1IsolateRegistry}{Isolate\+Registry}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
Code\+Data\+Source\+::\+Trace\+Context\+::\+Trace\+Packet\+Handle \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_a10b5b41653855de08f7b42c3555b8666}{New\+Trace\+Packet}} (Code\+Data\+Source\+::\+Trace\+Context \&context)
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1CodeTraceContext}{Code\+Trace\+Context}} \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_a176e17770fa15ffe72fdf51c6be45497}{New\+Code\+Trace\+Context}} (Code\+Data\+Source\+::\+Trace\+Context \&ctx)
\item 
void \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_ac2ddbabde3820220442dfcee898c6141}{Write\+Js\+Code}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, const \mbox{\hyperlink{classv8_1_1internal_1_1CodeTraceContext}{Code\+Trace\+Context}} \&ctx, \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1AbstractCode}{Abstract\+Code}} $>$ abstract\+\_\+code, V8\+Js\+Code \&code\+\_\+proto)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_a176e17770fa15ffe72fdf51c6be45497}\label{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_a176e17770fa15ffe72fdf51c6be45497}} 
\index{v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}@{v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}}!NewCodeTraceContext@{NewCodeTraceContext}}
\index{NewCodeTraceContext@{NewCodeTraceContext}!v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}@{v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}}}
\doxysubsubsection{\texorpdfstring{NewCodeTraceContext()}{NewCodeTraceContext()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1CodeTraceContext}{Code\+Trace\+Context}} v8\+::internal\+::anonymous\+\_\+namespace\{perfetto-\/logger.\+cc\}\+::New\+Code\+Trace\+Context (\begin{DoxyParamCaption}\item[{Code\+Data\+Source\+::\+Trace\+Context \&}]{ctx }\end{DoxyParamCaption})}



Definition at line 72 of file perfetto-\/logger.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{72                                                                       \{}
\DoxyCodeLine{73   \textcolor{keywordflow}{return} CodeTraceContext(\mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_a10b5b41653855de08f7b42c3555b8666}{NewTracePacket}}(ctx), ctx.GetIncrementalState());}
\DoxyCodeLine{74 \}}

\end{DoxyCode}


References New\+Trace\+Packet().



Referenced by v8\+::internal\+::\+Perfetto\+Logger\+::\+Bytecode\+Move\+Event(), v8\+::internal\+::\+Perfetto\+Logger\+::\+Code\+Create\+Event(), v8\+::internal\+::\+Perfetto\+Logger\+::\+Code\+Move\+Event(), and v8\+::internal\+::\+Perfetto\+Logger\+::\+Reg\+Exp\+Code\+Create\+Event().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_a176e17770fa15ffe72fdf51c6be45497_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_a176e17770fa15ffe72fdf51c6be45497_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_a10b5b41653855de08f7b42c3555b8666}\label{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_a10b5b41653855de08f7b42c3555b8666}} 
\index{v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}@{v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}}!NewTracePacket@{NewTracePacket}}
\index{NewTracePacket@{NewTracePacket}!v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}@{v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}}}
\doxysubsubsection{\texorpdfstring{NewTracePacket()}{NewTracePacket()}}
{\footnotesize\ttfamily Code\+Data\+Source\+::\+Trace\+Context\+::\+Trace\+Packet\+Handle v8\+::internal\+::anonymous\+\_\+namespace\{perfetto-\/logger.\+cc\}\+::New\+Trace\+Packet (\begin{DoxyParamCaption}\item[{Code\+Data\+Source\+::\+Trace\+Context \&}]{context }\end{DoxyParamCaption})}



Definition at line 48 of file perfetto-\/logger.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{49                                          \{}
\DoxyCodeLine{50   CodeDataSourceIncrementalState* inc\_state = context.GetIncrementalState();}
\DoxyCodeLine{51   \textcolor{keyword}{auto} packet = context.NewTracePacket();}
\DoxyCodeLine{52   packet-\/>set\_timestamp(base::TimeTicks::Now().since\_origin().InNanoseconds());}
\DoxyCodeLine{53 }
\DoxyCodeLine{54   \textcolor{keywordflow}{if} (inc\_state-\/>is\_initialized()) \{}
\DoxyCodeLine{55     packet-\/>set\_sequence\_flags(TracePacket::SEQ\_NEEDS\_INCREMENTAL\_STATE);}
\DoxyCodeLine{56     \textcolor{keywordflow}{return} packet;}
\DoxyCodeLine{57   \}}
\DoxyCodeLine{58 }
\DoxyCodeLine{59   inc\_state-\/>Init(context);}
\DoxyCodeLine{60 }
\DoxyCodeLine{61   packet-\/>set\_sequence\_flags(TracePacket::SEQ\_INCREMENTAL\_STATE\_CLEARED);}
\DoxyCodeLine{62 }
\DoxyCodeLine{63   \textcolor{keyword}{auto}* defaults = packet-\/>set\_trace\_packet\_defaults();}
\DoxyCodeLine{64   defaults-\/>set\_timestamp\_clock\_id(BuiltinClock::BUILTIN\_CLOCK\_MONOTONIC);}
\DoxyCodeLine{65 }
\DoxyCodeLine{66   \textcolor{keyword}{auto}* v8\_defaults = defaults-\/>set\_v8\_code\_defaults();}
\DoxyCodeLine{67   v8\_defaults-\/>set\_tid(base::OS::GetCurrentThreadId());}
\DoxyCodeLine{68 }
\DoxyCodeLine{69   \textcolor{keywordflow}{return} packet;}
\DoxyCodeLine{70 \}}

\end{DoxyCode}


References v8\+::base\+::\+OS\+::\+Get\+Current\+Thread\+Id(), v8\+::internal\+::\+Code\+Data\+Source\+Incremental\+State\+::\+Init(), v8\+::internal\+::\+Code\+Data\+Source\+Incremental\+State\+::is\+\_\+initialized(), and v8\+::base\+::\+Time\+Ticks\+::\+Now().



Referenced by New\+Code\+Trace\+Context().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_a10b5b41653855de08f7b42c3555b8666_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_a10b5b41653855de08f7b42c3555b8666_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_ac2ddbabde3820220442dfcee898c6141}\label{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_ac2ddbabde3820220442dfcee898c6141}} 
\index{v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}@{v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}}!WriteJsCode@{WriteJsCode}}
\index{WriteJsCode@{WriteJsCode}!v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}@{v8::internal::anonymous\_namespace\lcurly{}perfetto-\/logger.cc\rcurly{}}}
\doxysubsubsection{\texorpdfstring{WriteJsCode()}{WriteJsCode()}}
{\footnotesize\ttfamily void v8\+::internal\+::anonymous\+\_\+namespace\{perfetto-\/logger.\+cc\}\+::Write\+Js\+Code (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{const \mbox{\hyperlink{classv8_1_1internal_1_1CodeTraceContext}{Code\+Trace\+Context}} \&}]{ctx,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1AbstractCode}{Abstract\+Code}} $>$}]{abstract\+\_\+code,  }\item[{V8\+Js\+Code \&}]{code\+\_\+proto }\end{DoxyParamCaption})}



Definition at line 149 of file perfetto-\/logger.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{150                                                                            \{}
\DoxyCodeLine{151   \textcolor{keywordflow}{if} (IsBytecodeArray(abstract\_code)) \{}
\DoxyCodeLine{152     Tagged<BytecodeArray> bytecode = abstract\_code-\/>GetBytecodeArray();}
\DoxyCodeLine{153     code\_proto.set\_tier(V8JsCode::TIER\_IGNITION);}
\DoxyCodeLine{154     code\_proto.set\_instruction\_start(bytecode-\/>GetFirstBytecodeAddress());}
\DoxyCodeLine{155     code\_proto.set\_instruction\_size\_bytes(bytecode-\/>length());}
\DoxyCodeLine{156     \textcolor{keywordflow}{if} (ctx.log\_instructions()) \{}
\DoxyCodeLine{157       code\_proto.set\_bytecode(}
\DoxyCodeLine{158           \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }uint8\_t*\textcolor{keyword}{>}(bytecode-\/>GetFirstBytecodeAddress()),}
\DoxyCodeLine{159           bytecode-\/>length());}
\DoxyCodeLine{160     \}}
\DoxyCodeLine{161     \textcolor{keywordflow}{return};}
\DoxyCodeLine{162   \}}
\DoxyCodeLine{163 }
\DoxyCodeLine{164   \mbox{\hyperlink{src_2base_2logging_8h_ae17f8119c108cf3070bad3449c7e0006}{DCHECK}}(IsCode(abstract\_code));}
\DoxyCodeLine{165   Tagged<Code> \mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}} = abstract\_code-\/>GetCode();}
\DoxyCodeLine{166 }
\DoxyCodeLine{167   V8JsCode::Tier \mbox{\hyperlink{flag-definitions_8h_a878783ad616ead06040f7d4b080f6a02}{tier}} = V8JsCode::TIER\_UNKNOWN;}
\DoxyCodeLine{168   \textcolor{keywordflow}{switch} (\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>kind()) \{}
\DoxyCodeLine{169     \textcolor{keywordflow}{case} \mbox{\hyperlink{builtins-utils_8h_a8ddc47515f89d0e3691438a6244e6642}{CodeKind::BUILTIN}}:}
\DoxyCodeLine{170       \textcolor{keywordflow}{if} (\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>builtin\_id() == Builtin::kInterpreterEntryTrampoline) \{}
\DoxyCodeLine{171         \mbox{\hyperlink{src_2base_2logging_8h_ae17f8119c108cf3070bad3449c7e0006}{DCHECK}}(isolate-\/>interpreted\_frames\_native\_stack());}
\DoxyCodeLine{172         \mbox{\hyperlink{src_2base_2logging_8h_ae17f8119c108cf3070bad3449c7e0006}{DCHECK}}(\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>has\_instruction\_stream());}
\DoxyCodeLine{173         \mbox{\hyperlink{flag-definitions_8h_a878783ad616ead06040f7d4b080f6a02}{tier}} = V8JsCode::TIER\_IGNITION;}
\DoxyCodeLine{174         \textcolor{keywordflow}{break};}
\DoxyCodeLine{175       \}}
\DoxyCodeLine{176 }
\DoxyCodeLine{177       \textcolor{comment}{// kEmptyFunction is used as a placeholder sometimes.}}
\DoxyCodeLine{178       \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>builtin\_id(), Builtin::kEmptyFunction);}
\DoxyCodeLine{179       \mbox{\hyperlink{src_2base_2logging_8h_ae17f8119c108cf3070bad3449c7e0006}{DCHECK}}(!\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>has\_instruction\_stream());}
\DoxyCodeLine{180       \textcolor{keywordflow}{return};}
\DoxyCodeLine{181 }
\DoxyCodeLine{182     \textcolor{keywordflow}{case} CodeKind::INTERPRETED\_FUNCTION:}
\DoxyCodeLine{183       \textcolor{comment}{// Handled above.}}
\DoxyCodeLine{184       \mbox{\hyperlink{src_2base_2logging_8h_a0bc63b24b654ca433be7b97a3edde132}{UNREACHABLE}}();}
\DoxyCodeLine{185 }
\DoxyCodeLine{186     \textcolor{keywordflow}{case} CodeKind::BASELINE:}
\DoxyCodeLine{187       \mbox{\hyperlink{flag-definitions_8h_a878783ad616ead06040f7d4b080f6a02}{tier}} = V8JsCode::TIER\_SPARKPLUG;}
\DoxyCodeLine{188       \textcolor{keywordflow}{break};}
\DoxyCodeLine{189     \textcolor{keywordflow}{case} CodeKind::MAGLEV:}
\DoxyCodeLine{190       \mbox{\hyperlink{flag-definitions_8h_a878783ad616ead06040f7d4b080f6a02}{tier}} = V8JsCode::TIER\_MAGLEV;}
\DoxyCodeLine{191       \textcolor{keywordflow}{break};}
\DoxyCodeLine{192     \textcolor{keywordflow}{case} CodeKind::TURBOFAN\_JS:}
\DoxyCodeLine{193       \mbox{\hyperlink{flag-definitions_8h_a878783ad616ead06040f7d4b080f6a02}{tier}} = V8JsCode::TIER\_TURBOFAN;}
\DoxyCodeLine{194       \textcolor{keywordflow}{break};}
\DoxyCodeLine{195 }
\DoxyCodeLine{196     \textcolor{keywordflow}{case} CodeKind::BYTECODE\_HANDLER:}
\DoxyCodeLine{197     \textcolor{keywordflow}{case} CodeKind::FOR\_TESTING:}
\DoxyCodeLine{198     \textcolor{keywordflow}{case} CodeKind::REGEXP:}
\DoxyCodeLine{199     \textcolor{keywordflow}{case} CodeKind::WASM\_FUNCTION:}
\DoxyCodeLine{200     \textcolor{keywordflow}{case} CodeKind::WASM\_TO\_CAPI\_FUNCTION:}
\DoxyCodeLine{201     \textcolor{keywordflow}{case} CodeKind::WASM\_TO\_JS\_FUNCTION:}
\DoxyCodeLine{202     \textcolor{keywordflow}{case} CodeKind::JS\_TO\_WASM\_FUNCTION:}
\DoxyCodeLine{203     \textcolor{keywordflow}{case} CodeKind::C\_WASM\_ENTRY:}
\DoxyCodeLine{204       \mbox{\hyperlink{src_2base_2logging_8h_a0bc63b24b654ca433be7b97a3edde132}{UNREACHABLE}}();}
\DoxyCodeLine{205   \}}
\DoxyCodeLine{206 }
\DoxyCodeLine{207   code\_proto.set\_tier(\mbox{\hyperlink{flag-definitions_8h_a878783ad616ead06040f7d4b080f6a02}{tier}});}
\DoxyCodeLine{208   code\_proto.set\_instruction\_start(\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>instruction\_start());}
\DoxyCodeLine{209   code\_proto.set\_instruction\_size\_bytes(\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>instruction\_size());}
\DoxyCodeLine{210   \textcolor{keywordflow}{if} (ctx.log\_instructions()) \{}
\DoxyCodeLine{211     code\_proto.set\_machine\_code(}
\DoxyCodeLine{212         \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }uint8\_t*\textcolor{keyword}{>}(\mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>instruction\_start()),}
\DoxyCodeLine{213         \mbox{\hyperlink{flag-definitions_8h_ae0e79c88adf5166f9befeb542c2acd8f}{code}}-\/>instruction\_size());}
\DoxyCodeLine{214   \}}
\DoxyCodeLine{215 \}}

\end{DoxyCode}


References BUILTIN, code, v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+EQ, v8\+::internal\+::\+Isolate\+::interpreted\+\_\+frames\+\_\+native\+\_\+stack(), v8\+::internal\+::\+Code\+Trace\+Context\+::log\+\_\+instructions(), and v8\+::internal\+::\+UNREACHABLE().



Referenced by v8\+::internal\+::\+Perfetto\+Logger\+::\+Code\+Create\+Event().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_ac2ddbabde3820220442dfcee898c6141_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacev8_1_1internal_1_1anonymous__namespace_02perfetto-logger_8cc_03_ac2ddbabde3820220442dfcee898c6141_icgraph}
\end{center}
\end{figure}
