\hypertarget{classcppgc_1_1LivenessBroker}{}\doxysection{cppgc\+::Liveness\+Broker Class Reference}
\label{classcppgc_1_1LivenessBroker}\index{cppgc::LivenessBroker@{cppgc::LivenessBroker}}


The broker is passed to weak callbacks to allow (temporarily) querying the liveness state of an object.  




{\ttfamily \#include $<$liveness-\/broker.\+h$>$}



Collaboration diagram for cppgc\+::Liveness\+Broker\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=223pt]{classcppgc_1_1LivenessBroker__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename T $>$ }\\bool \mbox{\hyperlink{classcppgc_1_1LivenessBroker_a064ad71393837112d380a15b26d4b166}{Is\+Heap\+Object\+Alive}} (const \mbox{\hyperlink{classT}{T}} $\ast$object) const
\item 
{\footnotesize template$<$typename T $>$ }\\bool \mbox{\hyperlink{classcppgc_1_1LivenessBroker_a6d6b9f3609e18ef58d5caf93a3f3f95f}{Is\+Heap\+Object\+Alive}} (const \mbox{\hyperlink{namespacecppgc_a3ddd7a241f51479efe00f76be3125c81}{Weak\+Member}}$<$ \mbox{\hyperlink{classT}{T}} $>$ \&weak\+\_\+member) const
\item 
{\footnotesize template$<$typename T $>$ }\\bool \mbox{\hyperlink{classcppgc_1_1LivenessBroker_aee6371e43c399799c9ed0f3b84674cfa}{Is\+Heap\+Object\+Alive}} (const \mbox{\hyperlink{namespacecppgc_a6ee8e8453589f23ed3b8c84c45068d73}{Untraced\+Member}}$<$ \mbox{\hyperlink{classT}{T}} $>$ \&untraced\+\_\+member) const
\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classcppgc_1_1LivenessBroker_afe2156dfb811db65378ecbe0bd9dc238}{Liveness\+Broker}} ()=default
\item 
bool \mbox{\hyperlink{classcppgc_1_1LivenessBroker_aa687a19b6dbd7ddf2878384c94520bf0}{Is\+Heap\+Object\+Alive\+Impl}} (const void $\ast$) const
\end{DoxyCompactItemize}
\doxysubsection*{Friends}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classcppgc_1_1LivenessBroker_a38540d304bebe5adec503d8fff904453}{internal\+::\+Liveness\+Broker\+Factory}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The broker is passed to weak callbacks to allow (temporarily) querying the liveness state of an object. 

References to non-\/live objects must be cleared when {\ttfamily \mbox{\hyperlink{classcppgc_1_1LivenessBroker_a064ad71393837112d380a15b26d4b166}{Is\+Heap\+Object\+Alive()}}} returns false.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{class }GCedWithCustomWeakCallback final}
\DoxyCodeLine{  : \textcolor{keyword}{public} GarbageCollected<GCedWithCustomWeakCallback> \{}
\DoxyCodeLine{ \textcolor{keyword}{public}:}
\DoxyCodeLine{  UntracedMember<Bar> bar;}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} CustomWeakCallbackMethod(\textcolor{keyword}{const} \mbox{\hyperlink{classcppgc_1_1LivenessBroker_afe2156dfb811db65378ecbe0bd9dc238}{LivenessBroker}}\& \mbox{\hyperlink{flag-definitions_8h_a1e4d6c2aea5c663dda8b8fca8b9199a5}{broker}}) \{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (!\mbox{\hyperlink{flag-definitions_8h_a1e4d6c2aea5c663dda8b8fca8b9199a5}{broker}}.IsHeapObjectAlive(bar))}
\DoxyCodeLine{      bar = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} Trace(\mbox{\hyperlink{classcppgc_1_1Visitor}{cppgc::Visitor}}* visitor)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{    visitor-\/>\mbox{\hyperlink{classcppgc_1_1Visitor_ae2d6e396bdd0a53698c904b0278d0934}{RegisterWeakCallbackMethod}}<}
\DoxyCodeLine{        GCedWithCustomWeakCallback,}
\DoxyCodeLine{        \&GCedWithCustomWeakCallback::CustomWeakCallbackMethod>(\textcolor{keyword}{this});}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\};}

\end{DoxyCode}
 

Definition at line 44 of file liveness-\/broker.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classcppgc_1_1LivenessBroker_afe2156dfb811db65378ecbe0bd9dc238}\label{classcppgc_1_1LivenessBroker_afe2156dfb811db65378ecbe0bd9dc238}} 
\index{cppgc::LivenessBroker@{cppgc::LivenessBroker}!LivenessBroker@{LivenessBroker}}
\index{LivenessBroker@{LivenessBroker}!cppgc::LivenessBroker@{cppgc::LivenessBroker}}
\doxysubsubsection{\texorpdfstring{LivenessBroker()}{LivenessBroker()}}
{\footnotesize\ttfamily cppgc\+::\+Liveness\+Broker\+::\+Liveness\+Broker (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [default]}}



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classcppgc_1_1LivenessBroker_a064ad71393837112d380a15b26d4b166}\label{classcppgc_1_1LivenessBroker_a064ad71393837112d380a15b26d4b166}} 
\index{cppgc::LivenessBroker@{cppgc::LivenessBroker}!IsHeapObjectAlive@{IsHeapObjectAlive}}
\index{IsHeapObjectAlive@{IsHeapObjectAlive}!cppgc::LivenessBroker@{cppgc::LivenessBroker}}
\doxysubsubsection{\texorpdfstring{IsHeapObjectAlive()}{IsHeapObjectAlive()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
bool cppgc\+::\+Liveness\+Broker\+::\+Is\+Heap\+Object\+Alive (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classT}{T}} $\ast$}]{object }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 47 of file liveness-\/broker.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{47                                                 \{}
\DoxyCodeLine{48     \textcolor{comment}{// -\/ nullptr objects are considered alive to allow weakness to be used from}}
\DoxyCodeLine{49     \textcolor{comment}{// stack while running into a conservative GC. Treating nullptr as dead}}
\DoxyCodeLine{50     \textcolor{comment}{// would mean that e.g. custom collections could not be strongified on}}
\DoxyCodeLine{51     \textcolor{comment}{// stack.}}
\DoxyCodeLine{52     \textcolor{comment}{// -\/ Sentinel pointers are also preserved in weakness and not cleared.}}
\DoxyCodeLine{53     \textcolor{keywordflow}{return} !\textcolor{keywordtype}{object} || \textcolor{keywordtype}{object} == \mbox{\hyperlink{namespacecppgc_a6ed40538a8d2b6b06da04df5de1f8786}{kSentinelPointer}} ||}
\DoxyCodeLine{54            \mbox{\hyperlink{classcppgc_1_1LivenessBroker_aa687a19b6dbd7ddf2878384c94520bf0}{IsHeapObjectAliveImpl}}(}
\DoxyCodeLine{55                \mbox{\hyperlink{structcppgc_1_1internal_1_1TraceTraitBase_a4448accd321c29fed3b220237353c8c8}{TraceTrait<T>::GetTraceDescriptor}}(\textcolor{keywordtype}{object}).base\_object\_payload);}
\DoxyCodeLine{56   \}}

\end{DoxyCode}


References cppgc\+::k\+Sentinel\+Pointer.



Referenced by cppgc\+::\+Visitor\+::\+Handle\+Weak(), and cppgc\+::internal\+::\+Root\+Visitor\+::\+Handle\+Weak().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classcppgc_1_1LivenessBroker_a064ad71393837112d380a15b26d4b166_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classcppgc_1_1LivenessBroker_aee6371e43c399799c9ed0f3b84674cfa}\label{classcppgc_1_1LivenessBroker_aee6371e43c399799c9ed0f3b84674cfa}} 
\index{cppgc::LivenessBroker@{cppgc::LivenessBroker}!IsHeapObjectAlive@{IsHeapObjectAlive}}
\index{IsHeapObjectAlive@{IsHeapObjectAlive}!cppgc::LivenessBroker@{cppgc::LivenessBroker}}
\doxysubsubsection{\texorpdfstring{IsHeapObjectAlive()}{IsHeapObjectAlive()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
bool cppgc\+::\+Liveness\+Broker\+::\+Is\+Heap\+Object\+Alive (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{namespacecppgc_a6ee8e8453589f23ed3b8c84c45068d73}{Untraced\+Member}}$<$ \mbox{\hyperlink{classT}{T}} $>$ \&}]{untraced\+\_\+member }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 64 of file liveness-\/broker.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{64                                                                          \{}
\DoxyCodeLine{65     \textcolor{keywordflow}{return} IsHeapObjectAlive<T>(untraced\_member.Get());}
\DoxyCodeLine{66   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcppgc_1_1LivenessBroker_a6d6b9f3609e18ef58d5caf93a3f3f95f}\label{classcppgc_1_1LivenessBroker_a6d6b9f3609e18ef58d5caf93a3f3f95f}} 
\index{cppgc::LivenessBroker@{cppgc::LivenessBroker}!IsHeapObjectAlive@{IsHeapObjectAlive}}
\index{IsHeapObjectAlive@{IsHeapObjectAlive}!cppgc::LivenessBroker@{cppgc::LivenessBroker}}
\doxysubsubsection{\texorpdfstring{IsHeapObjectAlive()}{IsHeapObjectAlive()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
bool cppgc\+::\+Liveness\+Broker\+::\+Is\+Heap\+Object\+Alive (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{namespacecppgc_a3ddd7a241f51479efe00f76be3125c81}{Weak\+Member}}$<$ \mbox{\hyperlink{classT}{T}} $>$ \&}]{weak\+\_\+member }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 59 of file liveness-\/broker.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{59                                                                  \{}
\DoxyCodeLine{60     \textcolor{keywordflow}{return} IsHeapObjectAlive<T>(weak\_member.Get());}
\DoxyCodeLine{61   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcppgc_1_1LivenessBroker_aa687a19b6dbd7ddf2878384c94520bf0}\label{classcppgc_1_1LivenessBroker_aa687a19b6dbd7ddf2878384c94520bf0}} 
\index{cppgc::LivenessBroker@{cppgc::LivenessBroker}!IsHeapObjectAliveImpl@{IsHeapObjectAliveImpl}}
\index{IsHeapObjectAliveImpl@{IsHeapObjectAliveImpl}!cppgc::LivenessBroker@{cppgc::LivenessBroker}}
\doxysubsubsection{\texorpdfstring{IsHeapObjectAliveImpl()}{IsHeapObjectAliveImpl()}}
{\footnotesize\ttfamily bool cppgc\+::\+Liveness\+Broker\+::\+Is\+Heap\+Object\+Alive\+Impl (\begin{DoxyParamCaption}\item[{const void $\ast$}]{payload }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 11 of file liveness-\/broker.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{11                                                                     \{}
\DoxyCodeLine{12   \textcolor{keywordflow}{return} \mbox{\hyperlink{classcppgc_1_1internal_1_1HeapObjectHeader_a04b955c04b80d2a431dc2b96e4a85028}{internal::HeapObjectHeader::FromObject}}(payload).\mbox{\hyperlink{classcppgc_1_1internal_1_1HeapObjectHeader_a328d2dfc7af3a7a8bd7f7618a3a41699}{IsMarked}}();}
\DoxyCodeLine{13 \}}

\end{DoxyCode}


References cppgc\+::internal\+::\+Heap\+Object\+Header\+::\+From\+Object(), and cppgc\+::internal\+::\+Heap\+Object\+Header\+::\+Is\+Marked().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classcppgc_1_1LivenessBroker_aa687a19b6dbd7ddf2878384c94520bf0_cgraph}
\end{center}
\end{figure}


\doxysubsection{Friends And Related Function Documentation}
\mbox{\Hypertarget{classcppgc_1_1LivenessBroker_a38540d304bebe5adec503d8fff904453}\label{classcppgc_1_1LivenessBroker_a38540d304bebe5adec503d8fff904453}} 
\index{cppgc::LivenessBroker@{cppgc::LivenessBroker}!internal::LivenessBrokerFactory@{internal::LivenessBrokerFactory}}
\index{internal::LivenessBrokerFactory@{internal::LivenessBrokerFactory}!cppgc::LivenessBroker@{cppgc::LivenessBroker}}
\doxysubsubsection{\texorpdfstring{internal::LivenessBrokerFactory}{internal::LivenessBrokerFactory}}
{\footnotesize\ttfamily friend class \mbox{\hyperlink{classcppgc_1_1internal_1_1LivenessBrokerFactory}{internal\+::\+Liveness\+Broker\+Factory}}\hspace{0.3cm}{\ttfamily [friend]}}



Definition at line 73 of file liveness-\/broker.\+h.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/mnt/\+V8\+Source\+Code/include/cppgc/\mbox{\hyperlink{include_2cppgc_2liveness-broker_8h}{liveness-\/broker.\+h}}\item 
/mnt/\+V8\+Source\+Code/src/heap/cppgc/\mbox{\hyperlink{liveness-broker_8cc}{liveness-\/broker.\+cc}}\end{DoxyCompactItemize}
