\hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache}{}\doxysection{v8\+::internal\+::wasm\+::Wasm\+Import\+Wrapper\+Cache Class Reference}
\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache}\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}


{\ttfamily \#include $<$wasm-\/import-\/wrapper-\/cache.\+h$>$}



Collaboration diagram for v8\+::internal\+::wasm\+::Wasm\+Import\+Wrapper\+Cache\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_1_1CacheKey}{Cache\+Key}}
\item 
class \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_1_1CacheKeyHash}{Cache\+Key\+Hash}}
\item 
class \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_1_1ModificationScope}{Modification\+Scope}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a888141daf79b48cc7943c723b0096e34}{Wasm\+Import\+Wrapper\+Cache}} ()=default
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_acbfced2275cb35fe94a1b7c7d9abd971}{$\sim$\+Wasm\+Import\+Wrapper\+Cache}} ()=default
\item 
\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac81d27d6edb00aeed62a3e4745b8cba0}{void}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a62f4cb8fc02e1bbfe2ed0f09ce2aa050}{Lazy\+Initialize}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$triggering\+\_\+isolate)
\item 
\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac81d27d6edb00aeed62a3e4745b8cba0}{void}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a4cc5d346203b8feafcbb394bf3edb14f}{Free}} (std\+::vector$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmCode}{Wasm\+Code}} $\ast$ $>$ \&wrappers)
\item 
\mbox{\hyperlink{src_2base_2macros_8h_ab08e353943a53678ac6baafc678f2d81}{V8\+\_\+\+EXPORT\+\_\+\+PRIVATE}} std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_afdfee412fc036961cd7dd6c121d628da}{Get}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63a}{Import\+Call\+Kind}} kind, \mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1CanonicalTypeIndex}{Canonical\+Type\+Index}} type\+\_\+index, \mbox{\hyperlink{classint}{int}} expected\+\_\+arity, \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_a6eef6d24980961199f34fb770039843a}{Suspend}} suspend, const \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1CanonicalSig}{wasm\+::\+Canonical\+Sig}} $\ast$\mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}})
\item 
\mbox{\hyperlink{src_2base_2macros_8h_ab08e353943a53678ac6baafc678f2d81}{V8\+\_\+\+EXPORT\+\_\+\+PRIVATE}} std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a83ced6511f55c6c4dca7707e21eb1d2d}{Get\+Compiled}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63a}{Import\+Call\+Kind}} kind, \mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1CanonicalTypeIndex}{Canonical\+Type\+Index}} type\+\_\+index, \mbox{\hyperlink{classint}{int}} expected\+\_\+arity, \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_a6eef6d24980961199f34fb770039843a}{Suspend}} suspend, const \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1CanonicalSig}{wasm\+::\+Canonical\+Sig}} $\ast$\mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}})
\item 
\mbox{\hyperlink{src_2base_2macros_8h_ab08e353943a53678ac6baafc678f2d81}{V8\+\_\+\+EXPORT\+\_\+\+PRIVATE}} std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a1c4fb3cb86d2f62a94121b926f20cfe9}{Compile\+Wasm\+Js\+Fast\+Call\+Wrapper}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, \mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSReceiver}{JSReceiver}} $>$ callable, const \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1CanonicalSig}{wasm\+::\+Canonical\+Sig}} $\ast$\mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}})
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmCode}{Wasm\+Code}} $\ast$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a14ee1f266c89689eb799afe5f843dc41}{Lookup}} (\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_adcd4ca657f5fbce4e3e61f860761470a}{Address}} pc) const
\item 
\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac81d27d6edb00aeed62a3e4745b8cba0}{void}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ad49664eee6f5df0f367014a789b71d21}{Log\+For\+Isolate}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate)
\item 
\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a3141096c4c37338b458cf2f3d004ba92}{Estimate\+Current\+Memory\+Consumption}} () const
\item 
\mbox{\hyperlink{src_2base_2macros_8h_ab08e353943a53678ac6baafc678f2d81}{V8\+\_\+\+EXPORT\+\_\+\+PRIVATE}} \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a83866e08c78cd52f5bfdc828457890f8}{Has\+Code\+For\+Testing}} (\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63a}{Import\+Call\+Kind}} kind, \mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1CanonicalTypeIndex}{Canonical\+Type\+Index}} type\+\_\+index, \mbox{\hyperlink{classint}{int}} expected\+\_\+arity, \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_a6eef6d24980961199f34fb770039843a}{Suspend}} suspend)
\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
std\+::optional$<$ \mbox{\hyperlink{namespacev8_1_1internal_acc2e164143496f18b5ec68f8ab70af52}{Builtin}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aef83412230ba335109c09eaad9b33230}{Builtin\+For\+Wrapper}} (\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63a}{Import\+Call\+Kind}} kind, const \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1CanonicalSig}{wasm\+::\+Canonical\+Sig}} $\ast$\mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}, \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_a6eef6d24980961199f34fb770039843a}{Suspend}} suspend)
\item 
std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a2d532c4b19fe903434777c244bd86138}{Compile\+Wrapper}} (\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$isolate, const \mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_1_1CacheKey}{Cache\+Key}} \&cache\+\_\+key, const \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1CanonicalSig}{wasm\+::\+Canonical\+Sig}} $\ast$\mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}, std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}} $>$ optional\+\_\+handle)
\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmCodeAllocator}{Wasm\+Code\+Allocator}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ad0d98cb0e4b11bce8cbbe290a2a84dc8}{code\+\_\+allocator\+\_\+}}
\item 
\mbox{\hyperlink{classv8_1_1base_1_1Mutex}{base\+::\+Mutex}} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a18b73781fc514b028867439e891c34ba}{mutex\+\_\+}}
\item 
std\+::unordered\+\_\+map$<$ \mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_1_1CacheKey}{Cache\+Key}}, std\+::weak\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}} $>$, \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_1_1CacheKeyHash}{Cache\+Key\+Hash}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\+\_\+map\+\_\+}}
\item 
std\+::map$<$ \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_adcd4ca657f5fbce4e3e61f860761470a}{Address}}, \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmCode}{Wasm\+Code}} $\ast$ $>$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aa08216cffa361023d9d4380a69b1672f}{codes\+\_\+}}
\end{DoxyCompactItemize}
\doxysubsection*{Friends}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a82dee3c089e5c827e7f0fb3baf26291d}{Wasm\+Import\+Wrapper\+Handle}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 25 of file wasm-\/import-\/wrapper-\/cache.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a888141daf79b48cc7943c723b0096e34}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a888141daf79b48cc7943c723b0096e34}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!WasmImportWrapperCache@{WasmImportWrapperCache}}
\index{WasmImportWrapperCache@{WasmImportWrapperCache}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{WasmImportWrapperCache()}{WasmImportWrapperCache()}}
{\footnotesize\ttfamily v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Wasm\+Import\+Wrapper\+Cache (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



Referenced by Estimate\+Current\+Memory\+Consumption().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a888141daf79b48cc7943c723b0096e34_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_acbfced2275cb35fe94a1b7c7d9abd971}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_acbfced2275cb35fe94a1b7c7d9abd971}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!````~WasmImportWrapperCache@{$\sim$WasmImportWrapperCache}}
\index{````~WasmImportWrapperCache@{$\sim$WasmImportWrapperCache}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{$\sim$WasmImportWrapperCache()}{~WasmImportWrapperCache()}}
{\footnotesize\ttfamily v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::$\sim$\+Wasm\+Import\+Wrapper\+Cache (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aef83412230ba335109c09eaad9b33230}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aef83412230ba335109c09eaad9b33230}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!BuiltinForWrapper@{BuiltinForWrapper}}
\index{BuiltinForWrapper@{BuiltinForWrapper}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{BuiltinForWrapper()}{BuiltinForWrapper()}}
{\footnotesize\ttfamily std\+::optional$<$ \mbox{\hyperlink{namespacev8_1_1internal_acc2e164143496f18b5ec68f8ab70af52}{Builtin}} $>$ v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Builtin\+For\+Wrapper (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63a}{Import\+Call\+Kind}}}]{kind,  }\item[{const \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1CanonicalSig}{wasm\+::\+Canonical\+Sig}} $\ast$}]{sig,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_a6eef6d24980961199f34fb770039843a}{Suspend}}}]{suspend }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 205 of file wasm-\/import-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{206                                                                        \{}
\DoxyCodeLine{207   \textcolor{keywordflow}{if} (kind != \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63aa2c181723941144749e409c197a8d87d1}{ImportCallKind::kJSFunction}}) \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{208 }
\DoxyCodeLine{209   \textcolor{keywordflow}{if} (!\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_a769350a0bf794ab0ebf3c8fc1c8fc450}{IsJSCompatibleSignature}}(\mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}})) \{}
\DoxyCodeLine{210     \textcolor{keywordflow}{return} Builtin::kWasmToJsWrapperInvalidSig;}
\DoxyCodeLine{211   \}}
\DoxyCodeLine{212 }
\DoxyCodeLine{213   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_a667827abe3e3649a272fe634ee5b2612}{UseGenericWasmToJSWrapper}}(kind, \mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}, suspend)) \{}
\DoxyCodeLine{214     \textcolor{keywordflow}{return} Builtin::kWasmToJsWrapperAsm;}
\DoxyCodeLine{215   \}}
\DoxyCodeLine{216 }
\DoxyCodeLine{217   \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{218 \}}

\end{DoxyCode}


References v8\+::internal\+::wasm\+::\+Is\+JSCompatible\+Signature(), v8\+::internal\+::wasm\+::k\+JSFunction, v8\+::internal\+::sig, and v8\+::internal\+::\+Use\+Generic\+Wasm\+To\+JSWrapper().



Referenced by Get().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aef83412230ba335109c09eaad9b33230_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aef83412230ba335109c09eaad9b33230_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a1c4fb3cb86d2f62a94121b926f20cfe9}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a1c4fb3cb86d2f62a94121b926f20cfe9}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!CompileWasmJsFastCallWrapper@{CompileWasmJsFastCallWrapper}}
\index{CompileWasmJsFastCallWrapper@{CompileWasmJsFastCallWrapper}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{CompileWasmJsFastCallWrapper()}{CompileWasmJsFastCallWrapper()}}
{\footnotesize\ttfamily std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}} $>$ v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Compile\+Wasm\+Js\+Fast\+Call\+Wrapper (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1DirectHandle}{Direct\+Handle}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1JSReceiver}{JSReceiver}} $>$}]{callable,  }\item[{const \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1CanonicalSig}{wasm\+::\+Canonical\+Sig}} $\ast$}]{sig }\end{DoxyParamCaption})}



Definition at line 374 of file wasm-\/import-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{376                                  \{}
\DoxyCodeLine{377   \textcolor{comment}{// Note: the wrapper we're about to compile is specific to this}}
\DoxyCodeLine{378   \textcolor{comment}{// instantiation, so it cannot be shared.}}
\DoxyCodeLine{379   WasmCompilationResult \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}} =}
\DoxyCodeLine{380       \mbox{\hyperlink{namespacev8_1_1internal_1_1compiler_ac7487375c580f916b38504dc43380233}{compiler::CompileWasmJSFastCallWrapper}}(\mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}, callable);}
\DoxyCodeLine{381 }
\DoxyCodeLine{382   std::shared\_ptr<WasmImportWrapperHandle> wrapper\_handle =}
\DoxyCodeLine{383       std::make\_shared<WasmImportWrapperHandle>(\mbox{\hyperlink{namespacev8_1_1internal_acf6bafb5b8483a580f375393c413ee02}{kNullAddress}},}
\DoxyCodeLine{384                                                 \mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}-\/>signature\_hash());}
\DoxyCodeLine{385   WasmCode* wasm\_code;}
\DoxyCodeLine{386   \{}
\DoxyCodeLine{387     ModificationScope cache\_scope(\textcolor{keyword}{this});}
\DoxyCodeLine{388     wasm\_code = cache\_scope.AddWrapper(std::move(\mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}}),}
\DoxyCodeLine{389                                        WasmCode::Kind::kWasmToJsWrapper,}
\DoxyCodeLine{390                                        \mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}-\/>signature\_hash(), wrapper\_handle);}
\DoxyCodeLine{391   \}}
\DoxyCodeLine{392   \textcolor{comment}{// To avoid lock order inversion, code printing must happen after the}}
\DoxyCodeLine{393   \textcolor{comment}{// end of the \{cache\_scope\}.}}
\DoxyCodeLine{394   wasm\_code-\/>MaybePrint();}
\DoxyCodeLine{395   isolate-\/>counters()-\/>wasm\_generated\_code\_size()-\/>Increment(}
\DoxyCodeLine{396       wasm\_code-\/>instructions().length());}
\DoxyCodeLine{397   isolate-\/>counters()-\/>wasm\_reloc\_size()-\/>Increment(}
\DoxyCodeLine{398       wasm\_code-\/>reloc\_info().length());}
\DoxyCodeLine{399   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_abc12fc3b25ebfb54c20b8479642acb94}{GetWasmEngine}}()-\/>LogWrapperCode(wasm\_code)) \{}
\DoxyCodeLine{400     \textcolor{comment}{// Log the code immediately in the current isolate.}}
\DoxyCodeLine{401     \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_abc12fc3b25ebfb54c20b8479642acb94}{GetWasmEngine}}()-\/>\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmEngine_a80a2af861380fd22a236025164b81737}{LogOutstandingCodesForIsolate}}(isolate);}
\DoxyCodeLine{402   \}}
\DoxyCodeLine{403 }
\DoxyCodeLine{404   \textcolor{keywordflow}{return} wrapper\_handle;}
\DoxyCodeLine{405 \}}

\end{DoxyCode}


References v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Modification\+Scope\+::\+Add\+Wrapper(), v8\+::internal\+::compiler\+::\+Compile\+Wasm\+JSFast\+Call\+Wrapper(), v8\+::internal\+::\+Isolate\+::counters(), v8\+::internal\+::wasm\+::\+Get\+Wasm\+Engine(), v8\+::internal\+::wasm\+::\+Wasm\+Code\+::instructions(), v8\+::internal\+::k\+Null\+Address, v8\+::base\+::\+Vector$<$ T $>$\+::length(), v8\+::internal\+::wasm\+::\+Wasm\+Engine\+::\+Log\+Outstanding\+Codes\+For\+Isolate(), v8\+::internal\+::wasm\+::\+Wasm\+Code\+::\+Maybe\+Print(), v8\+::internal\+::wasm\+::\+Wasm\+Code\+::reloc\+\_\+info(), v8\+::base\+::internal\+::result, and v8\+::internal\+::sig.



Referenced by v8\+::internal\+::wasm\+::\+Instance\+Builder\+::\+Process\+Imported\+Function().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a1c4fb3cb86d2f62a94121b926f20cfe9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a1c4fb3cb86d2f62a94121b926f20cfe9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a2d532c4b19fe903434777c244bd86138}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a2d532c4b19fe903434777c244bd86138}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!CompileWrapper@{CompileWrapper}}
\index{CompileWrapper@{CompileWrapper}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{CompileWrapper()}{CompileWrapper()}}
{\footnotesize\ttfamily std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}} $>$ v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Compile\+Wrapper (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{const \mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_1_1CacheKey}{Cache\+Key}} \&}]{cache\+\_\+key,  }\item[{const \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1CanonicalSig}{wasm\+::\+Canonical\+Sig}} $\ast$}]{sig,  }\item[{std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}} $>$}]{optional\+\_\+handle }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 307 of file wasm-\/import-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{309                                                            \{}
\DoxyCodeLine{310   wasm::WasmCompilationResult \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}};}
\DoxyCodeLine{311   \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmCode_a236d413616e672cc2cda31bb7a4fc04d}{wasm::WasmCode::Kind}} code\_kind;}
\DoxyCodeLine{312   \textcolor{keywordflow}{switch} (cache\_key.kind) \{}
\DoxyCodeLine{313     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63aa5411029decc6201a8ac468e9bb7fadbb}{ImportCallKind::kLinkError}}:}
\DoxyCodeLine{314     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63aaab44f4e0361a9e4865baa6ac82b1df7d}{ImportCallKind::kWasmToWasm}}:}
\DoxyCodeLine{315     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63aa7467c277d2efacf697386cbed4f64dc0}{ImportCallKind::kWasmToJSFastApi}}:}
\DoxyCodeLine{316       \mbox{\hyperlink{namespacev8_1_1internal_acdec713c25068019f935e35976f5b666}{UNREACHABLE}}();}
\DoxyCodeLine{317     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63aa2c181723941144749e409c197a8d87d1}{ImportCallKind::kJSFunction}}:}
\DoxyCodeLine{318     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63aa5427d5490900477a371648688dfbb95b}{ImportCallKind::kUseCallBuiltin}}:}
\DoxyCodeLine{319     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63aab810d863342c9190448e06c0239b3376}{ImportCallKind::kRuntimeTypeError}}:}
\DoxyCodeLine{320       \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}} = \mbox{\hyperlink{namespacev8_1_1internal_1_1compiler_a150b8a9ff28bf34f132764224b9ea6ef}{compiler::CompileWasmImportCallWrapper}}(}
\DoxyCodeLine{321           cache\_key.kind, \mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}, cache\_key.expected\_arity, cache\_key.suspend);}
\DoxyCodeLine{322       code\_kind = WasmCode::Kind::kWasmToJsWrapper;}
\DoxyCodeLine{323       \textcolor{keywordflow}{break};}
\DoxyCodeLine{324     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63aa7f5686cf8a9e0b7053c4d28dde68020f}{ImportCallKind::kWasmToCapi}}:}
\DoxyCodeLine{325       \mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}} = \mbox{\hyperlink{namespacev8_1_1internal_1_1compiler_a50bcd95a7391f11ea798d7b747922901}{compiler::CompileWasmCapiCallWrapper}}(\mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}});}
\DoxyCodeLine{326       code\_kind = wasm::WasmCode::Kind::kWasmToCapiWrapper;}
\DoxyCodeLine{327       \textcolor{keywordflow}{break};}
\DoxyCodeLine{328   \}}
\DoxyCodeLine{329 }
\DoxyCodeLine{330   WasmCode* wasm\_code;}
\DoxyCodeLine{331   \{}
\DoxyCodeLine{332     wasm::WasmImportWrapperCache::ModificationScope cache\_scope(\textcolor{keyword}{this});}
\DoxyCodeLine{333 }
\DoxyCodeLine{334     \textcolor{keywordflow}{if} (!wrapper\_handle) \{}
\DoxyCodeLine{335       \textcolor{keyword}{auto} it = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}.find(cache\_key);}
\DoxyCodeLine{336       \textcolor{keywordflow}{if} (it != \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}.end()) \{}
\DoxyCodeLine{337         wrapper\_handle = it-\/>second.lock();}
\DoxyCodeLine{338       \}}
\DoxyCodeLine{339     \}}
\DoxyCodeLine{340 }
\DoxyCodeLine{341     \textcolor{keywordflow}{if} (wrapper\_handle \&\& wrapper\_handle-\/>has\_code()) \{}
\DoxyCodeLine{342       \textcolor{comment}{// There was a race and we have code now.}}
\DoxyCodeLine{343       \textcolor{keywordflow}{return} wrapper\_handle;}
\DoxyCodeLine{344     \}}
\DoxyCodeLine{345 }
\DoxyCodeLine{346     \textcolor{keywordflow}{if} (!wrapper\_handle) \{}
\DoxyCodeLine{347       wrapper\_handle = std::make\_shared<WasmImportWrapperHandle>(}
\DoxyCodeLine{348           \mbox{\hyperlink{namespacev8_1_1internal_acf6bafb5b8483a580f375393c413ee02}{kNullAddress}}, \mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}-\/>signature\_hash());}
\DoxyCodeLine{349       \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}[cache\_key] = wrapper\_handle;}
\DoxyCodeLine{350     \}}
\DoxyCodeLine{351 }
\DoxyCodeLine{352     wasm\_code = cache\_scope.AddWrapper(std::move(\mbox{\hyperlink{namespacev8_1_1base_1_1internal_a9840f2bf0b4780133662292486d0bc01}{result}}), code\_kind,}
\DoxyCodeLine{353                                        \mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}-\/>signature\_hash(), wrapper\_handle);}
\DoxyCodeLine{354   \}}
\DoxyCodeLine{355 }
\DoxyCodeLine{356   \textcolor{comment}{// To avoid lock order inversion, code printing must happen after the}}
\DoxyCodeLine{357   \textcolor{comment}{// end of the \{cache\_scope\}.}}
\DoxyCodeLine{358   wasm\_code-\/>MaybePrint();}
\DoxyCodeLine{359   \textcolor{keywordflow}{if} (isolate) \{}
\DoxyCodeLine{360     isolate-\/>counters()-\/>wasm\_generated\_code\_size()-\/>Increment(}
\DoxyCodeLine{361         wasm\_code-\/>instructions().length());}
\DoxyCodeLine{362     isolate-\/>counters()-\/>wasm\_reloc\_size()-\/>Increment(}
\DoxyCodeLine{363         wasm\_code-\/>reloc\_info().length());}
\DoxyCodeLine{364   \}}
\DoxyCodeLine{365   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_abc12fc3b25ebfb54c20b8479642acb94}{GetWasmEngine}}()-\/>LogWrapperCode(wasm\_code) \&\& isolate) \{}
\DoxyCodeLine{366     \textcolor{comment}{// Log the code immediately in the current isolate.}}
\DoxyCodeLine{367     \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_abc12fc3b25ebfb54c20b8479642acb94}{GetWasmEngine}}()-\/>\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmEngine_a80a2af861380fd22a236025164b81737}{LogOutstandingCodesForIsolate}}(isolate);}
\DoxyCodeLine{368   \}}
\DoxyCodeLine{369 }
\DoxyCodeLine{370   \textcolor{keywordflow}{return} wrapper\_handle;}
\DoxyCodeLine{371 \}}

\end{DoxyCode}


References v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Modification\+Scope\+::\+Add\+Wrapper(), v8\+::internal\+::compiler\+::\+Compile\+Wasm\+Capi\+Call\+Wrapper(), v8\+::internal\+::compiler\+::\+Compile\+Wasm\+Import\+Call\+Wrapper(), v8\+::internal\+::\+Isolate\+::counters(), entry\+\_\+map\+\_\+, v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Cache\+Key\+::expected\+\_\+arity, v8\+::internal\+::wasm\+::\+Get\+Wasm\+Engine(), v8\+::internal\+::wasm\+::\+Wasm\+Code\+::instructions(), v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Cache\+Key\+::kind, v8\+::internal\+::wasm\+::k\+JSFunction, v8\+::internal\+::wasm\+::k\+Link\+Error, v8\+::internal\+::k\+Null\+Address, v8\+::internal\+::wasm\+::k\+Runtime\+Type\+Error, v8\+::internal\+::wasm\+::k\+Use\+Call\+Builtin, v8\+::internal\+::wasm\+::k\+Wasm\+To\+Capi, v8\+::internal\+::wasm\+::k\+Wasm\+To\+JSFast\+Api, v8\+::internal\+::wasm\+::k\+Wasm\+To\+Wasm, v8\+::base\+::\+Vector$<$ T $>$\+::length(), v8\+::internal\+::wasm\+::\+Wasm\+Engine\+::\+Log\+Outstanding\+Codes\+For\+Isolate(), v8\+::internal\+::wasm\+::\+Wasm\+Code\+::\+Maybe\+Print(), v8\+::internal\+::wasm\+::\+Wasm\+Code\+::reloc\+\_\+info(), v8\+::base\+::internal\+::result, v8\+::internal\+::sig, v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Cache\+Key\+::suspend, and v8\+::internal\+::\+UNREACHABLE().



Referenced by Get(), and Get\+Compiled().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a2d532c4b19fe903434777c244bd86138_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a2d532c4b19fe903434777c244bd86138_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a3141096c4c37338b458cf2f3d004ba92}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a3141096c4c37338b458cf2f3d004ba92}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!EstimateCurrentMemoryConsumption@{EstimateCurrentMemoryConsumption}}
\index{EstimateCurrentMemoryConsumption@{EstimateCurrentMemoryConsumption}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{EstimateCurrentMemoryConsumption()}{EstimateCurrentMemoryConsumption()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Estimate\+Current\+Memory\+Consumption (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Definition at line 424 of file wasm-\/import-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{424                                                                       \{}
\DoxyCodeLine{425   \mbox{\hyperlink{std-object-sizes_8h_a56caa02a4280c4f0c82adab429400770}{UPDATE\_WHEN\_CLASS\_CHANGES}}(\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a888141daf79b48cc7943c723b0096e34}{WasmImportWrapperCache}}, 88);}
\DoxyCodeLine{426   \mbox{\hyperlink{namespacev8_1_1base_a40b71b3558e4b5297d51003612578a81}{base::MutexGuard}} lock(\&\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a18b73781fc514b028867439e891c34ba}{mutex\_}});}
\DoxyCodeLine{427   \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a888141daf79b48cc7943c723b0096e34}{WasmImportWrapperCache}}) + \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_aa122591443234c1d0b597dadc9d55c5e}{ContentSize}}(\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}) +}
\DoxyCodeLine{428          \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_aa122591443234c1d0b597dadc9d55c5e}{ContentSize}}(\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aa08216cffa361023d9d4380a69b1672f}{codes\_}});}
\DoxyCodeLine{429 \}}

\end{DoxyCode}


References codes\+\_\+, v8\+::internal\+::wasm\+::\+Content\+Size(), entry\+\_\+map\+\_\+, mutex\+\_\+, UPDATE\+\_\+\+WHEN\+\_\+\+CLASS\+\_\+\+CHANGES, and Wasm\+Import\+Wrapper\+Cache().



Referenced by v8\+::internal\+::\+Memory\+Measurement\+::\+Finish\+Processing().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a3141096c4c37338b458cf2f3d004ba92_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a3141096c4c37338b458cf2f3d004ba92_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a4cc5d346203b8feafcbb394bf3edb14f}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a4cc5d346203b8feafcbb394bf3edb14f}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!Free@{Free}}
\index{Free@{Free}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{Free()}{Free()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac81d27d6edb00aeed62a3e4745b8cba0}{void}} v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Free (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmCode}{Wasm\+Code}} $\ast$ $>$ \&}]{wrappers }\end{DoxyParamCaption})}



Definition at line 177 of file wasm-\/import-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{177                                                                 \{}
\DoxyCodeLine{178   \mbox{\hyperlink{namespacev8_1_1base_a40b71b3558e4b5297d51003612578a81}{base::MutexGuard}} lock(\&\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a18b73781fc514b028867439e891c34ba}{mutex\_}});}
\DoxyCodeLine{179   \textcolor{keywordflow}{if} (\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aa08216cffa361023d9d4380a69b1672f}{codes\_}}.empty() || wrappers.empty()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{180   \textcolor{comment}{// \{WasmCodeAllocator::FreeCode()\} wants code objects to be sorted.}}
\DoxyCodeLine{181   \mbox{\hyperlink{namespacev8_1_1base_ae8575343c68d7ad91cf7aaf24cd6643f}{std::sort}}(wrappers.begin(), wrappers.end(), [](WasmCode* a, WasmCode* b) \{}
\DoxyCodeLine{182     return a-\/>instruction\_start() < b-\/>instruction\_start();}
\DoxyCodeLine{183   \});}
\DoxyCodeLine{184   \textcolor{keywordflow}{for} (WasmCode* wrapper : wrappers) \{}
\DoxyCodeLine{185     \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aa08216cffa361023d9d4380a69b1672f}{codes\_}}.erase(wrapper-\/>instruction\_start());}
\DoxyCodeLine{186   \}}
\DoxyCodeLine{187   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} it = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}.begin(); it != \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}.end();) \{}
\DoxyCodeLine{188     \textcolor{keywordflow}{if} (it-\/>second.expired()) \{}
\DoxyCodeLine{189       it = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}.erase(it);}
\DoxyCodeLine{190     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{191       it++;}
\DoxyCodeLine{192     \}}
\DoxyCodeLine{193   \}}
\DoxyCodeLine{194   \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ad0d98cb0e4b11bce8cbbe290a2a84dc8}{code\_allocator\_}}-\/>FreeCode(\mbox{\hyperlink{namespacev8_1_1base_a5bfc65f27076e49eb7752a4fb4d45acb}{base::VectorOf}}(wrappers));}
\DoxyCodeLine{195   \textcolor{keywordflow}{for} (WasmCode* wrapper : wrappers) \{}
\DoxyCodeLine{196     \textcolor{comment}{// TODO(407003348): Drop this check if it doesn't trigger in the wild.}}
\DoxyCodeLine{197     \mbox{\hyperlink{src_2base_2logging_8h_aca32614b4d2aea7dd9abdeb222bf02f3}{CHECK\_EQ}}(wrapper-\/>ref\_count\_bitfield\_.load(std::memory\_order\_acquire),}
\DoxyCodeLine{198              \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmCode_a10b233187c7caaf9ecdeba735866428a}{WasmCode::kIsDyingMask}});}
\DoxyCodeLine{199     \textcolor{keyword}{delete} wrapper;}
\DoxyCodeLine{200   \}}
\DoxyCodeLine{201   \textcolor{comment}{// Make sure nobody tries to access stale pointers.}}
\DoxyCodeLine{202   wrappers.clear();}
\DoxyCodeLine{203 \}}

\end{DoxyCode}


References CHECK\+\_\+\+EQ, code\+\_\+allocator\+\_\+, codes\+\_\+, entry\+\_\+map\+\_\+, v8\+::internal\+::wasm\+::\+Wasm\+Code\+::k\+Is\+Dying\+Mask, mutex\+\_\+, v8\+::base\+::sort(), and v8\+::base\+::\+Vector\+Of().



Referenced by v8\+::internal\+::wasm\+::\+Wasm\+Engine\+::\+Free\+Dead\+Code\+Locked().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a4cc5d346203b8feafcbb394bf3edb14f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a4cc5d346203b8feafcbb394bf3edb14f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_afdfee412fc036961cd7dd6c121d628da}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_afdfee412fc036961cd7dd6c121d628da}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!Get@{Get}}
\index{Get@{Get}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{Get()}{Get()}}
{\footnotesize\ttfamily std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}} $>$ v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Get (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63a}{Import\+Call\+Kind}}}]{kind,  }\item[{\mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1CanonicalTypeIndex}{Canonical\+Type\+Index}}}]{type\+\_\+index,  }\item[{\mbox{\hyperlink{classint}{int}}}]{expected\+\_\+arity,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_a6eef6d24980961199f34fb770039843a}{Suspend}}}]{suspend,  }\item[{const \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1CanonicalSig}{wasm\+::\+Canonical\+Sig}} $\ast$}]{sig }\end{DoxyParamCaption})}



Definition at line 220 of file wasm-\/import-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{222                                                                       \{}
\DoxyCodeLine{223   CacheKey cache\_key(kind, type\_index, expected\_arity, suspend);}
\DoxyCodeLine{224 }
\DoxyCodeLine{225   \{}
\DoxyCodeLine{226     \mbox{\hyperlink{namespacev8_1_1base_a40b71b3558e4b5297d51003612578a81}{base::MutexGuard}} lock(\&\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a18b73781fc514b028867439e891c34ba}{mutex\_}});}
\DoxyCodeLine{227 }
\DoxyCodeLine{228     \textcolor{comment}{// If we have an entry already, just return that.}}
\DoxyCodeLine{229     \textcolor{keyword}{auto} it = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}.find(cache\_key);}
\DoxyCodeLine{230     \textcolor{keywordflow}{if} (it != \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}.end()) \{}
\DoxyCodeLine{231       std::shared\_ptr<WasmImportWrapperHandle> \mbox{\hyperlink{namespacev8_1_1internal_a8c89f00da07e125218128b9fbf0a321c}{handle}} = it-\/>second.lock();}
\DoxyCodeLine{232       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_a8c89f00da07e125218128b9fbf0a321c}{handle}}) \{}
\DoxyCodeLine{233         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacev8_1_1internal_a8c89f00da07e125218128b9fbf0a321c}{handle}};}
\DoxyCodeLine{234       \}}
\DoxyCodeLine{235     \}}
\DoxyCodeLine{236 }
\DoxyCodeLine{237     \textcolor{comment}{// Check if we should use a builtin.}}
\DoxyCodeLine{238     std::optional<Builtin> builtin = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aef83412230ba335109c09eaad9b33230}{BuiltinForWrapper}}(kind, \mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}, suspend);}
\DoxyCodeLine{239     \textcolor{keywordflow}{if} (builtin) \{}
\DoxyCodeLine{240       \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_adcd4ca657f5fbce4e3e61f860761470a}{Address}} call\_target = \mbox{\hyperlink{classv8_1_1internal_1_1Builtins_a47a260ae04bebdcad714c481a3cd3553}{Builtins::EmbeddedEntryOf}}(*builtin);}
\DoxyCodeLine{241       static\_assert(\mbox{\hyperlink{classv8_1_1internal_1_1Builtins_a9272a472ad4885ecd59c1f55dcb16028}{Builtins::kAllBuiltinsAreIsolateIndependent}});}
\DoxyCodeLine{242       std::shared\_ptr<WasmImportWrapperHandle> wrapper\_handle =}
\DoxyCodeLine{243           std::make\_shared<WasmImportWrapperHandle>(call\_target,}
\DoxyCodeLine{244                                                     \mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}-\/>signature\_hash());}
\DoxyCodeLine{245       \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}[cache\_key] = wrapper\_handle;}
\DoxyCodeLine{246       \textcolor{keywordflow}{return} wrapper\_handle;}
\DoxyCodeLine{247     \}}
\DoxyCodeLine{248   \}}
\DoxyCodeLine{249 }
\DoxyCodeLine{250   \textcolor{comment}{// Fall back to compile a new wrapper.}}
\DoxyCodeLine{251   \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a2d532c4b19fe903434777c244bd86138}{CompileWrapper}}(isolate, cache\_key, \mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{252 \}}

\end{DoxyCode}


References Builtin\+For\+Wrapper(), Compile\+Wrapper(), v8\+::internal\+::\+Builtins\+::\+Embedded\+Entry\+Of(), entry\+\_\+map\+\_\+, v8\+::internal\+::handle(), v8\+::internal\+::\+Builtins\+::k\+All\+Builtins\+Are\+Isolate\+Independent, mutex\+\_\+, and v8\+::internal\+::sig.



Referenced by v8\+::internal\+::\+Wasm\+JSFunction\+::\+New(), and v8\+::internal\+::wasm\+::\+Instance\+Builder\+::\+Process\+Imported\+Function().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_afdfee412fc036961cd7dd6c121d628da_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_afdfee412fc036961cd7dd6c121d628da_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a83ced6511f55c6c4dca7707e21eb1d2d}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a83ced6511f55c6c4dca7707e21eb1d2d}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!GetCompiled@{GetCompiled}}
\index{GetCompiled@{GetCompiled}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{GetCompiled()}{GetCompiled()}}
{\footnotesize\ttfamily std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}} $>$ v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Get\+Compiled (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63a}{Import\+Call\+Kind}}}]{kind,  }\item[{\mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1CanonicalTypeIndex}{Canonical\+Type\+Index}}}]{type\+\_\+index,  }\item[{\mbox{\hyperlink{classint}{int}}}]{expected\+\_\+arity,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_a6eef6d24980961199f34fb770039843a}{Suspend}}}]{suspend,  }\item[{const \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1CanonicalSig}{wasm\+::\+Canonical\+Sig}} $\ast$}]{sig }\end{DoxyParamCaption})}



Definition at line 283 of file wasm-\/import-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{285                                                                   \{}
\DoxyCodeLine{286   \mbox{\hyperlink{src_2base_2logging_8h_aa958a8a4e5dda3abaa031977268ae60e}{CHECK\_NE}}(kind, \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63aa7467c277d2efacf697386cbed4f64dc0}{ImportCallKind::kWasmToJSFastApi}});}
\DoxyCodeLine{287   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(!\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.wasm\_jitless);}
\DoxyCodeLine{288 }
\DoxyCodeLine{289   CacheKey cache\_key\{kind, type\_index, expected\_arity, suspend\};}
\DoxyCodeLine{290 }
\DoxyCodeLine{291   std::shared\_ptr<wasm::WasmImportWrapperHandle> wrapper\_handle;}
\DoxyCodeLine{292   \{}
\DoxyCodeLine{293     \mbox{\hyperlink{namespacev8_1_1base_a40b71b3558e4b5297d51003612578a81}{base::MutexGuard}} lock(\&\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a18b73781fc514b028867439e891c34ba}{mutex\_}});}
\DoxyCodeLine{294 }
\DoxyCodeLine{295     \textcolor{keyword}{auto} it = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}.find(cache\_key);}
\DoxyCodeLine{296     \textcolor{keywordflow}{if} (it != \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}.end()) \{}
\DoxyCodeLine{297       wrapper\_handle = it-\/>second.lock();}
\DoxyCodeLine{298       \textcolor{keywordflow}{if} (wrapper\_handle \&\& wrapper\_handle-\/>has\_code()) \{}
\DoxyCodeLine{299         \textcolor{keywordflow}{return} wrapper\_handle;}
\DoxyCodeLine{300       \}}
\DoxyCodeLine{301     \}}
\DoxyCodeLine{302   \}}
\DoxyCodeLine{303 }
\DoxyCodeLine{304   \textcolor{keywordflow}{return} \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a2d532c4b19fe903434777c244bd86138}{CompileWrapper}}(isolate, cache\_key, \mbox{\hyperlink{namespacev8_1_1internal_a6135f0ef57de8d381e3225f6659c617a}{sig}}, wrapper\_handle);}
\DoxyCodeLine{305 \}}

\end{DoxyCode}


References CHECK\+\_\+\+NE, Compile\+Wrapper(), v8\+::internal\+::\+DCHECK(), entry\+\_\+map\+\_\+, v8\+::internal\+::wasm\+::k\+Wasm\+To\+JSFast\+Api, mutex\+\_\+, v8\+::internal\+::sig, and v8\+::internal\+::v8\+\_\+flags.



Referenced by v8\+::internal\+::wasm\+::\+Compile\+Import\+Wrapper\+For\+Test(), v8\+::internal\+::\+RUNTIME\+\_\+\+FUNCTION(), and v8\+::internal\+::\+Wasm\+Table\+Object\+::\+Update\+Dispatch\+Table().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a83ced6511f55c6c4dca7707e21eb1d2d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a83ced6511f55c6c4dca7707e21eb1d2d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a83866e08c78cd52f5bfdc828457890f8}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a83866e08c78cd52f5bfdc828457890f8}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!HasCodeForTesting@{HasCodeForTesting}}
\index{HasCodeForTesting@{HasCodeForTesting}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{HasCodeForTesting()}{HasCodeForTesting()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Has\+Code\+For\+Testing (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac0c0d417be648d20ef96581e5d3bd63a}{Import\+Call\+Kind}}}]{kind,  }\item[{\mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1CanonicalTypeIndex}{Canonical\+Type\+Index}}}]{type\+\_\+index,  }\item[{\mbox{\hyperlink{classint}{int}}}]{expected\+\_\+arity,  }\item[{\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_a6eef6d24980961199f34fb770039843a}{Suspend}}}]{suspend }\end{DoxyParamCaption})}



Definition at line 269 of file wasm-\/import-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{272                                                                 \{}
\DoxyCodeLine{273   \mbox{\hyperlink{namespacev8_1_1base_a40b71b3558e4b5297d51003612578a81}{base::MutexGuard}} lock(\&\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a18b73781fc514b028867439e891c34ba}{mutex\_}});}
\DoxyCodeLine{274 }
\DoxyCodeLine{275   CacheKey cache\_key(kind, type\_index, expected\_arity, suspend);}
\DoxyCodeLine{276   \textcolor{keyword}{auto} it = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}.find(cache\_key);}
\DoxyCodeLine{277   \textcolor{keywordflow}{if} (it == \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}{entry\_map\_}}.end()) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{278   \textcolor{keyword}{auto} \mbox{\hyperlink{namespacev8_1_1internal_a8c89f00da07e125218128b9fbf0a321c}{handle}} = it-\/>second.lock();}
\DoxyCodeLine{279   \textcolor{keywordflow}{if} (!\mbox{\hyperlink{namespacev8_1_1internal_a8c89f00da07e125218128b9fbf0a321c}{handle}}) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{280   \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacev8_1_1internal_a8c89f00da07e125218128b9fbf0a321c}{handle}}-\/>has\_code();}
\DoxyCodeLine{281 \}}

\end{DoxyCode}


References entry\+\_\+map\+\_\+, v8\+::internal\+::handle(), and mutex\+\_\+.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a83866e08c78cd52f5bfdc828457890f8_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a62f4cb8fc02e1bbfe2ed0f09ce2aa050}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a62f4cb8fc02e1bbfe2ed0f09ce2aa050}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!LazyInitialize@{LazyInitialize}}
\index{LazyInitialize@{LazyInitialize}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{LazyInitialize()}{LazyInitialize()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac81d27d6edb00aeed62a3e4745b8cba0}{void}} v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Lazy\+Initialize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{triggering\+\_\+isolate }\end{DoxyParamCaption})}



Definition at line 59 of file wasm-\/import-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{59                                                                        \{}
\DoxyCodeLine{60   \mbox{\hyperlink{namespacev8_1_1base_a40b71b3558e4b5297d51003612578a81}{base::MutexGuard}} lock(\&\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a18b73781fc514b028867439e891c34ba}{mutex\_}});}
\DoxyCodeLine{61   \textcolor{keywordflow}{if} (\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ad0d98cb0e4b11bce8cbbe290a2a84dc8}{code\_allocator\_}}.get() != \textcolor{keyword}{nullptr}) \textcolor{keywordflow}{return};  \textcolor{comment}{// Already initialized.}}
\DoxyCodeLine{62   \textcolor{comment}{// Most wrappers are small (200-\/300 bytes), most modules don't need many.}}
\DoxyCodeLine{63   \textcolor{comment}{// 32K is enough for \string~100 wrappers.}}
\DoxyCodeLine{64   \textcolor{keyword}{static} constexpr \textcolor{keywordtype}{size\_t} kInitialReservationSize = 1 << 15;}
\DoxyCodeLine{65   \textcolor{comment}{// See \{NewNativeModule\} for reasoning.}}
\DoxyCodeLine{66   \textcolor{keyword}{static} constexpr \textcolor{keywordtype}{int} kAllocationRetries = 2;}
\DoxyCodeLine{67   VirtualMemory code\_space;}
\DoxyCodeLine{68   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} retries = 0;; ++retries) \{}
\DoxyCodeLine{69     code\_space = \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_a55a717894f5d005ae86062dd4647a3b2}{GetWasmCodeManager}}()-\/>\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmCodeManager_a7ed36ebeb931a4b5b5cd1097891d60c1}{TryAllocate}}(kInitialReservationSize);}
\DoxyCodeLine{70     \textcolor{keywordflow}{if} (code\_space.IsReserved()) \textcolor{keywordflow}{break};}
\DoxyCodeLine{71     \textcolor{keywordflow}{if} (retries == kAllocationRetries) \{}
\DoxyCodeLine{72       \mbox{\hyperlink{classv8_1_1internal_1_1V8_a977b087d4ee58955efe72b33136a4e94}{V8::FatalProcessOutOfMemory}}(}
\DoxyCodeLine{73           triggering\_isolate,}
\DoxyCodeLine{74           \textcolor{stringliteral}{"{}Failed to allocate code space for import wrappers"{}});}
\DoxyCodeLine{75       \mbox{\hyperlink{namespacev8_1_1internal_acdec713c25068019f935e35976f5b666}{UNREACHABLE}}();}
\DoxyCodeLine{76     \}}
\DoxyCodeLine{77     triggering\_isolate-\/>heap()-\/>MemoryPressureNotification(}
\DoxyCodeLine{78         \mbox{\hyperlink{namespacev8_ae0e9a25bf51e518585f555806e7dc7b9a5a20548c220f372fc701cae6de94040b}{MemoryPressureLevel::kCritical}}, \textcolor{keyword}{true});}
\DoxyCodeLine{79   \}}
\DoxyCodeLine{80   \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ad0d98cb0e4b11bce8cbbe290a2a84dc8}{code\_allocator\_}}.reset(}
\DoxyCodeLine{81       \textcolor{keyword}{new} WasmCodeAllocator(triggering\_isolate-\/>async\_counters()));}
\DoxyCodeLine{82   base::AddressRegion initial\_region = code\_space.region();}
\DoxyCodeLine{83   \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ad0d98cb0e4b11bce8cbbe290a2a84dc8}{code\_allocator\_}}-\/>Init(std::move(code\_space));}
\DoxyCodeLine{84   \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ad0d98cb0e4b11bce8cbbe290a2a84dc8}{code\_allocator\_}}-\/>InitializeCodeRange(\textcolor{keyword}{nullptr}, initial\_region);}
\DoxyCodeLine{85 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Isolate\+::async\+\_\+counters(), code\+\_\+allocator\+\_\+, v8\+::internal\+::\+V8\+::\+Fatal\+Process\+Out\+Of\+Memory(), v8\+::internal\+::wasm\+::\+Get\+Wasm\+Code\+Manager(), v8\+::internal\+::\+Isolate\+::heap(), v8\+::internal\+::\+Virtual\+Memory\+::\+Is\+Reserved(), v8\+::k\+Critical, v8\+::internal\+::\+Heap\+::\+Memory\+Pressure\+Notification(), mutex\+\_\+, v8\+::internal\+::\+Virtual\+Memory\+::region(), v8\+::internal\+::wasm\+::\+Wasm\+Code\+Manager\+::\+Try\+Allocate(), and v8\+::internal\+::\+UNREACHABLE().



Referenced by v8\+::internal\+::\+Wasm\+JSFunction\+::\+New(), and v8\+::internal\+::wasm\+::\+Wasm\+Engine\+::\+New\+Native\+Module().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a62f4cb8fc02e1bbfe2ed0f09ce2aa050_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a62f4cb8fc02e1bbfe2ed0f09ce2aa050_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ad49664eee6f5df0f367014a789b71d21}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ad49664eee6f5df0f367014a789b71d21}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!LogForIsolate@{LogForIsolate}}
\index{LogForIsolate@{LogForIsolate}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{LogForIsolate()}{LogForIsolate()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_ac81d27d6edb00aeed62a3e4745b8cba0}{void}} v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Log\+For\+Isolate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Isolate}{Isolate}} $\ast$}]{isolate }\end{DoxyParamCaption})}



Definition at line 170 of file wasm-\/import-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{170                                                            \{}
\DoxyCodeLine{171   \mbox{\hyperlink{namespacev8_1_1base_a40b71b3558e4b5297d51003612578a81}{base::MutexGuard}} lock(\&\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a18b73781fc514b028867439e891c34ba}{mutex\_}});}
\DoxyCodeLine{172   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& entry : \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aa08216cffa361023d9d4380a69b1672f}{codes\_}}) \{}
\DoxyCodeLine{173     entry.second-\/>LogCode(isolate, \textcolor{stringliteral}{"{}"{}}, -\/1);  \textcolor{comment}{// No source URL, no ScriptId.}}
\DoxyCodeLine{174   \}}
\DoxyCodeLine{175 \}}

\end{DoxyCode}


References codes\+\_\+, and mutex\+\_\+.



Referenced by v8\+::internal\+::wasm\+::\+Wasm\+Engine\+::\+Add\+Isolate(), and v8\+::internal\+::\+Existing\+Code\+Logger\+::\+Log\+Compiled\+Functions().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ad49664eee6f5df0f367014a789b71d21_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a14ee1f266c89689eb799afe5f843dc41}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a14ee1f266c89689eb799afe5f843dc41}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!Lookup@{Lookup}}
\index{Lookup@{Lookup}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{Lookup()}{Lookup()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmCode}{Wasm\+Code}} $\ast$ v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Lookup (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_adcd4ca657f5fbce4e3e61f860761470a}{Address}}}]{pc }\end{DoxyParamCaption}) const}



Definition at line 407 of file wasm-\/import-\/wrapper-\/cache.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{407                                                          \{}
\DoxyCodeLine{408   \textcolor{comment}{// This can be called from the disassembler via `code-\/>MaybePrint()` in}}
\DoxyCodeLine{409   \textcolor{comment}{// `AddWrapper()` above, so we need a recursive mutex.}}
\DoxyCodeLine{410   \mbox{\hyperlink{namespacev8_1_1base_a40b71b3558e4b5297d51003612578a81}{base::MutexGuard}} lock(\&\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a18b73781fc514b028867439e891c34ba}{mutex\_}});}
\DoxyCodeLine{411   \textcolor{keyword}{auto} iter = \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aa08216cffa361023d9d4380a69b1672f}{codes\_}}.upper\_bound(pc);}
\DoxyCodeLine{412   \textcolor{keywordflow}{if} (iter == \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aa08216cffa361023d9d4380a69b1672f}{codes\_}}.begin()) \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{413   -\/-\/iter;}
\DoxyCodeLine{414   WasmCode* candidate = iter-\/>second;}
\DoxyCodeLine{415   \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(candidate-\/>instruction\_start(), iter-\/>first);}
\DoxyCodeLine{416   \textcolor{keywordflow}{if} (!candidate-\/>contains(pc)) \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{417   \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmCodeRefScope_a9148e3cdeac9e7f3d97d518fa66f722c}{WasmCodeRefScope::AddRef}}(candidate);}
\DoxyCodeLine{418   \textcolor{comment}{// Note: this function is used for iterating the stack, where dying}}
\DoxyCodeLine{419   \textcolor{comment}{// code objects can still have their last few activations, so we}}
\DoxyCodeLine{420   \textcolor{comment}{// must return \{candidate\} even if \{candidate-\/>is\_dying()\}.}}
\DoxyCodeLine{421   \textcolor{keywordflow}{return} candidate;}
\DoxyCodeLine{422 \}}

\end{DoxyCode}


References v8\+::internal\+::wasm\+::\+Wasm\+Code\+Ref\+Scope\+::\+Add\+Ref(), codes\+\_\+, v8\+::internal\+::wasm\+::\+Wasm\+Code\+::contains(), DCHECK\+\_\+\+EQ, v8\+::internal\+::wasm\+::\+Wasm\+Code\+::instruction\+\_\+start(), and mutex\+\_\+.



Referenced by v8\+::internal\+::wasm\+::\+Wasm\+Code\+Manager\+::\+Lookup\+Code().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a14ee1f266c89689eb799afe5f843dc41_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a14ee1f266c89689eb799afe5f843dc41_icgraph}
\end{center}
\end{figure}


\doxysubsection{Friends And Related Function Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a82dee3c089e5c827e7f0fb3baf26291d}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a82dee3c089e5c827e7f0fb3baf26291d}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!WasmImportWrapperHandle@{WasmImportWrapperHandle}}
\index{WasmImportWrapperHandle@{WasmImportWrapperHandle}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{WasmImportWrapperHandle}{WasmImportWrapperHandle}}
{\footnotesize\ttfamily friend class \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}}\hspace{0.3cm}{\ttfamily [friend]}}



Definition at line 121 of file wasm-\/import-\/wrapper-\/cache.\+h.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ad0d98cb0e4b11bce8cbbe290a2a84dc8}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ad0d98cb0e4b11bce8cbbe290a2a84dc8}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!code\_allocator\_@{code\_allocator\_}}
\index{code\_allocator\_@{code\_allocator\_}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{code\_allocator\_}{code\_allocator\_}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmCodeAllocator}{Wasm\+Code\+Allocator}}$>$ v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::code\+\_\+allocator\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 112 of file wasm-\/import-\/wrapper-\/cache.\+h.



Referenced by v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Modification\+Scope\+::\+Add\+Wrapper(), Free(), and Lazy\+Initialize().

\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aa08216cffa361023d9d4380a69b1672f}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_aa08216cffa361023d9d4380a69b1672f}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!codes\_@{codes\_}}
\index{codes\_@{codes\_}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{codes\_}{codes\_}}
{\footnotesize\ttfamily std\+::map$<$\mbox{\hyperlink{namespacev8_1_1internal_1_1wasm_adcd4ca657f5fbce4e3e61f860761470a}{Address}}, \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmCode}{Wasm\+Code}}$\ast$$>$ v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::codes\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 119 of file wasm-\/import-\/wrapper-\/cache.\+h.



Referenced by v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Modification\+Scope\+::\+Add\+Wrapper(), Estimate\+Current\+Memory\+Consumption(), Free(), Log\+For\+Isolate(), and Lookup().

\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_ae9f936a4608c94af40e9d12a4880ed1a}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!entry\_map\_@{entry\_map\_}}
\index{entry\_map\_@{entry\_map\_}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{entry\_map\_}{entry\_map\_}}
{\footnotesize\ttfamily std\+::unordered\+\_\+map$<$\mbox{\hyperlink{structv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_1_1CacheKey}{Cache\+Key}}, std\+::weak\+\_\+ptr$<$\mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperHandle}{Wasm\+Import\+Wrapper\+Handle}}$>$, \mbox{\hyperlink{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_1_1CacheKeyHash}{Cache\+Key\+Hash}}$>$ v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::entry\+\_\+map\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 116 of file wasm-\/import-\/wrapper-\/cache.\+h.



Referenced by Compile\+Wrapper(), Estimate\+Current\+Memory\+Consumption(), Free(), Get(), Get\+Compiled(), and Has\+Code\+For\+Testing().

\mbox{\Hypertarget{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a18b73781fc514b028867439e891c34ba}\label{classv8_1_1internal_1_1wasm_1_1WasmImportWrapperCache_a18b73781fc514b028867439e891c34ba}} 
\index{v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}!mutex\_@{mutex\_}}
\index{mutex\_@{mutex\_}!v8::internal::wasm::WasmImportWrapperCache@{v8::internal::wasm::WasmImportWrapperCache}}
\doxysubsubsection{\texorpdfstring{mutex\_}{mutex\_}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1base_1_1Mutex}{base\+::\+Mutex}} v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::mutex\+\_\+\hspace{0.3cm}{\ttfamily [mutable]}, {\ttfamily [private]}}



Definition at line 113 of file wasm-\/import-\/wrapper-\/cache.\+h.



Referenced by v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Cache\+::\+Modification\+Scope\+::\+Add\+Wrapper(), Estimate\+Current\+Memory\+Consumption(), Free(), Get(), Get\+Compiled(), Has\+Code\+For\+Testing(), Lazy\+Initialize(), Log\+For\+Isolate(), Lookup(), and v8\+::internal\+::wasm\+::\+Wasm\+Import\+Wrapper\+Handle\+::set\+\_\+code().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/mnt/\+V8\+Source\+Code/src/wasm/\mbox{\hyperlink{wasm-import-wrapper-cache_8h}{wasm-\/import-\/wrapper-\/cache.\+h}}\item 
/mnt/\+V8\+Source\+Code/src/wasm/\mbox{\hyperlink{wasm-import-wrapper-cache_8cc}{wasm-\/import-\/wrapper-\/cache.\+cc}}\end{DoxyCompactItemize}
