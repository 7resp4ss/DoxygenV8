\hypertarget{classv8_1_1internal_1_1PretenuringHandler}{}\doxysection{v8\+::internal\+::Pretenuring\+Handler Class Reference}
\label{classv8_1_1internal_1_1PretenuringHandler}\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}


{\ttfamily \#include $<$pretenuring-\/handler.\+h$>$}



Collaboration diagram for v8\+::internal\+::Pretenuring\+Handler\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1PretenuringHandler__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbf}{Find\+Memento\+Mode}} \{ \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbfae10ae9e8514058b9e601d7d6779bedb1}{k\+For\+Runtime}}
, \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbfa825580f68d2341a2c206387cae6ec671}{k\+For\+GC}}
 \}
\item 
using \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_af4636a79d24b9944a5f2a8c4b5c7fdcb}{Pretenuring\+Feedback\+Map}} = std\+::unordered\+\_\+map$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1AllocationSite}{Allocation\+Site}} $>$, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}, \mbox{\hyperlink{structv8_1_1internal_1_1Object_1_1Hasher}{Object\+::\+Hasher}} $>$
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ab44e3286b1035d232b4d8570b815430e}{Pretenuring\+Handler}} (\mbox{\hyperlink{classv8_1_1internal_1_1Heap}{Heap}} $\ast$\mbox{\hyperlink{flag-definitions_8h_a761e4e5929b1553283fd6a532822bb17}{heap}})
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ab00c13c68ea499c94cdc34b88bb0d981}{$\sim$\+Pretenuring\+Handler}} ()
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ab9d9c25a2b1b39927039595c9fb76c4a}{reset}} ()
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_aca35e5784df91c84d77686aac732635f}{Merge\+Allocation\+Site\+Pretenuring\+Feedback}} (const \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_af4636a79d24b9944a5f2a8c4b5c7fdcb}{Pretenuring\+Feedback\+Map}} \&local\+\_\+pretenuring\+\_\+feedback)
\item 
\mbox{\hyperlink{src_2base_2macros_8h_ab08e353943a53678ac6baafc678f2d81}{V8\+\_\+\+EXPORT\+\_\+\+PRIVATE}} void \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ad2c621c0136aa48b7b222f6b317104c9}{Pretenure\+Allocation\+Site\+On\+Next\+Collection}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1AllocationSite}{Allocation\+Site}} $>$ site)
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a112c244eff162bdadfdbb014b84321e9}{Process\+Pretenuring\+Feedback}} (\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}} new\+\_\+space\+\_\+capacity\+\_\+before\+\_\+gc)
\item 
void \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ab38af427f3e4e918eedc75fad80bd8a4}{Remove\+Allocation\+Site\+Pretenuring\+Feedback}} (\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1AllocationSite}{Allocation\+Site}} $>$ site)
\item 
\mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_afb76f828951520e7d13610c0ff238c64}{Has\+Pretenuring\+Feedback}} () const
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$Find\+Memento\+Mode mode$>$ }\\static \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1AllocationMemento}{Allocation\+Memento}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a67aea6c902ecbf63fc80dfebf8783ff7}{Find\+Allocation\+Memento}} (\mbox{\hyperlink{classv8_1_1internal_1_1Heap}{Heap}} $\ast$\mbox{\hyperlink{flag-definitions_8h_a761e4e5929b1553283fd6a532822bb17}{heap}}, \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Map}{Map}} $>$ map, \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1HeapObject}{Heap\+Object}} $>$ object)
\item 
{\footnotesize template$<$Find\+Memento\+Mode mode$>$ }\\static \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1AllocationMemento}{Allocation\+Memento}} $>$ \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_aefedc0a489373bc91b85e8e057e8925e}{Find\+Allocation\+Memento}} (\mbox{\hyperlink{classv8_1_1internal_1_1Heap}{Heap}} $\ast$\mbox{\hyperlink{flag-definitions_8h_a761e4e5929b1553283fd6a532822bb17}{heap}}, \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Map}{Map}} $>$ map, \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1HeapObject}{Heap\+Object}} $>$ object, \mbox{\hyperlink{classint}{int}} object\+\_\+size)
\item 
static void \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_afe6ffac83eddf7cac23594de7d90da1f}{Update\+Allocation\+Site}} (\mbox{\hyperlink{classv8_1_1internal_1_1Heap}{Heap}} $\ast$\mbox{\hyperlink{flag-definitions_8h_a761e4e5929b1553283fd6a532822bb17}{heap}}, \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Map}{Map}} $>$ map, \mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1HeapObject}{Heap\+Object}} $>$ object, \mbox{\hyperlink{classint}{int}} object\+\_\+size, \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_af4636a79d24b9944a5f2a8c4b5c7fdcb}{Pretenuring\+Feedback\+Map}} $\ast$pretenuring\+\_\+feedback)
\item 
static \mbox{\hyperlink{src_2base_2macros_8h_ab08e353943a53678ac6baafc678f2d81}{V8\+\_\+\+EXPORT\+\_\+\+PRIVATE}} \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_adc9b6de73a166bf364a14787e9ac0414}{Get\+Min\+Memento\+Count\+For\+Testing}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
static constexpr \mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a39e978227fa4328858984891781819e0}{k\+Initial\+Feedback\+Capacity}} = 256
\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1Heap}{Heap}} $\ast$const \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\+\_\+}}
\item 
\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_af4636a79d24b9944a5f2a8c4b5c7fdcb}{Pretenuring\+Feedback\+Map}} \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ad610e3a13ab68e7a0859c53156aded4a}{global\+\_\+pretenuring\+\_\+feedback\+\_\+}}
\item 
std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classv8_1_1internal_1_1GlobalHandleVector}{Global\+Handle\+Vector}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1AllocationSite}{Allocation\+Site}} $>$ $>$ \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a9dc83c9451368bbb81ffeb35f6113843}{allocation\+\_\+sites\+\_\+to\+\_\+pretenure\+\_\+}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 21 of file pretenuring-\/handler.\+h.



\doxysubsection{Member Typedef Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_af4636a79d24b9944a5f2a8c4b5c7fdcb}\label{classv8_1_1internal_1_1PretenuringHandler_af4636a79d24b9944a5f2a8c4b5c7fdcb}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!PretenuringFeedbackMap@{PretenuringFeedbackMap}}
\index{PretenuringFeedbackMap@{PretenuringFeedbackMap}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{PretenuringFeedbackMap}{PretenuringFeedbackMap}}
{\footnotesize\ttfamily using \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_af4636a79d24b9944a5f2a8c4b5c7fdcb}{v8\+::internal\+::\+Pretenuring\+Handler\+::\+Pretenuring\+Feedback\+Map}} =  std\+::unordered\+\_\+map$<$\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$\mbox{\hyperlink{classv8_1_1internal_1_1AllocationSite}{Allocation\+Site}}$>$, \mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}, \mbox{\hyperlink{structv8_1_1internal_1_1Object_1_1Hasher}{Object\+::\+Hasher}}$>$}



Definition at line 25 of file pretenuring-\/handler.\+h.



\doxysubsection{Member Enumeration Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbf}\label{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbf}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!FindMementoMode@{FindMementoMode}}
\index{FindMementoMode@{FindMementoMode}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{FindMementoMode}{FindMementoMode}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbf}{v8\+::internal\+::\+Pretenuring\+Handler\+::\+Find\+Memento\+Mode}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{kForRuntime@{kForRuntime}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!kForRuntime@{kForRuntime}}}\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbfae10ae9e8514058b9e601d7d6779bedb1}\label{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbfae10ae9e8514058b9e601d7d6779bedb1}} 
k\+For\+Runtime&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{kForGC@{kForGC}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!kForGC@{kForGC}}}\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbfa825580f68d2341a2c206387cae6ec671}\label{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbfa825580f68d2341a2c206387cae6ec671}} 
k\+For\+GC&\\
\hline

\end{DoxyEnumFields}


Definition at line 27 of file pretenuring-\/handler.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{27 \{ \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbfae10ae9e8514058b9e601d7d6779bedb1}{kForRuntime}}, \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbfa825580f68d2341a2c206387cae6ec671}{kForGC}} \};}

\end{DoxyCode}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_ab44e3286b1035d232b4d8570b815430e}\label{classv8_1_1internal_1_1PretenuringHandler_ab44e3286b1035d232b4d8570b815430e}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!PretenuringHandler@{PretenuringHandler}}
\index{PretenuringHandler@{PretenuringHandler}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{PretenuringHandler()}{PretenuringHandler()}}
{\footnotesize\ttfamily v8\+::internal\+::\+Pretenuring\+Handler\+::\+Pretenuring\+Handler (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Heap}{Heap}} $\ast$}]{heap }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [explicit]}}



Definition at line 19 of file pretenuring-\/handler.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{20     : \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}(\mbox{\hyperlink{namespaceheap}{heap}}), \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ad610e3a13ab68e7a0859c53156aded4a}{global\_pretenuring\_feedback\_}}(\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a39e978227fa4328858984891781819e0}{kInitialFeedbackCapacity}}) \{\}}

\end{DoxyCode}
\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_ab00c13c68ea499c94cdc34b88bb0d981}\label{classv8_1_1internal_1_1PretenuringHandler_ab00c13c68ea499c94cdc34b88bb0d981}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!````~PretenuringHandler@{$\sim$PretenuringHandler}}
\index{````~PretenuringHandler@{$\sim$PretenuringHandler}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{$\sim$PretenuringHandler()}{~PretenuringHandler()}}
{\footnotesize\ttfamily v8\+::internal\+::\+Pretenuring\+Handler\+::$\sim$\+Pretenuring\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_a67aea6c902ecbf63fc80dfebf8783ff7}\label{classv8_1_1internal_1_1PretenuringHandler_a67aea6c902ecbf63fc80dfebf8783ff7}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!FindAllocationMemento@{FindAllocationMemento}}
\index{FindAllocationMemento@{FindAllocationMemento}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{FindAllocationMemento()}{FindAllocationMemento()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$Pretenuring\+Handler\+::\+Find\+Memento\+Mode mode$>$ \\
\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1AllocationMemento}{Allocation\+Memento}} $>$ v8\+::internal\+::\+Pretenuring\+Handler\+::\+Find\+Allocation\+Memento (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Heap}{Heap}} $\ast$}]{heap,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Map}{Map}} $>$}]{map,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1HeapObject}{Heap\+Object}} $>$}]{object }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Definition at line 55 of file pretenuring-\/handler-\/inl.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{56                                                             \{}
\DoxyCodeLine{57   \textcolor{keywordflow}{return} FindAllocationMemento<mode>(\mbox{\hyperlink{namespaceheap}{heap}}, map, \textcolor{keywordtype}{object},}
\DoxyCodeLine{58                                      object-\/>SizeFromMap(map));}
\DoxyCodeLine{59 \}}

\end{DoxyCode}


Referenced by v8\+::internal\+::\+RUNTIME\+\_\+\+FUNCTION(), and v8\+::internal\+::\+JSObject\+::\+Update\+Allocation\+Site().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1PretenuringHandler_a67aea6c902ecbf63fc80dfebf8783ff7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_aefedc0a489373bc91b85e8e057e8925e}\label{classv8_1_1internal_1_1PretenuringHandler_aefedc0a489373bc91b85e8e057e8925e}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!FindAllocationMemento@{FindAllocationMemento}}
\index{FindAllocationMemento@{FindAllocationMemento}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{FindAllocationMemento()}{FindAllocationMemento()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$Pretenuring\+Handler\+::\+Find\+Memento\+Mode mode$>$ \\
\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1AllocationMemento}{Allocation\+Memento}} $>$ v8\+::internal\+::\+Pretenuring\+Handler\+::\+Find\+Allocation\+Memento (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Heap}{Heap}} $\ast$}]{heap,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Map}{Map}} $>$}]{map,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1HeapObject}{Heap\+Object}} $>$}]{object,  }\item[{\mbox{\hyperlink{classint}{int}}}]{object\+\_\+size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Definition at line 63 of file pretenuring-\/handler-\/inl.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{64                                                                              \{}
\DoxyCodeLine{65   \textcolor{comment}{// For uses from within the GC, the size here may actually change when e.g.}}
\DoxyCodeLine{66   \textcolor{comment}{// updating mementos during marking in the young generation collector. This is}}
\DoxyCodeLine{67   \textcolor{comment}{// not an issue with Scavenger that stops the mutator.}}
\DoxyCodeLine{68   \mbox{\hyperlink{src_2base_2logging_8h_a96a75539aa82216cdde2250a11126ea0}{DCHECK\_IMPLIES}}(\mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}} != FindMementoMode::kForGC || !\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.minor\_ms,}
\DoxyCodeLine{69                  object\_size == object-\/>SizeFromMap(map));}
\DoxyCodeLine{70   \textcolor{comment}{// For configurations where object size changes, we can check that it only}}
\DoxyCodeLine{71   \textcolor{comment}{// shinks in case the sizes are not matching.}}
\DoxyCodeLine{72   \mbox{\hyperlink{src_2base_2logging_8h_a96a75539aa82216cdde2250a11126ea0}{DCHECK\_IMPLIES}}(\mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}} == FindMementoMode::kForGC \&\& \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.minor\_ms,}
\DoxyCodeLine{73                  object\_size >= object-\/>SizeFromMap(map));}
\DoxyCodeLine{74   \mbox{\hyperlink{namespacev8_1_1internal_ab4955debfb9384e59e3d4e9fcab5b0a0}{Address}} object\_address = \textcolor{keywordtype}{object}.address();}
\DoxyCodeLine{75   \mbox{\hyperlink{namespacev8_1_1internal_ab4955debfb9384e59e3d4e9fcab5b0a0}{Address}} memento\_address =}
\DoxyCodeLine{76       object\_address + \mbox{\hyperlink{common_2globals_8h_a76f936b13cc7401de647c23963eda5c1}{ALIGN\_TO\_ALLOCATION\_ALIGNMENT}}(object\_size);}
\DoxyCodeLine{77   \mbox{\hyperlink{namespacev8_1_1internal_ab4955debfb9384e59e3d4e9fcab5b0a0}{Address}} last\_memento\_word\_address = memento\_address + \mbox{\hyperlink{namespacev8_1_1internal_a12d50d7bb2c9d8a916ff0785e6eff241}{kTaggedSize}};}
\DoxyCodeLine{78   \textcolor{comment}{// If the memento would be on another page, bail out immediately.}}
\DoxyCodeLine{79   \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classv8_1_1internal_1_1PageMetadata_ac76942f2ebb9dcc60b35d0510f0b46c9}{PageMetadata::OnSamePage}}(object\_address, last\_memento\_word\_address)) \{}
\DoxyCodeLine{80     \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{81   \}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83   \textcolor{comment}{// If the page is being swept, treat it as if the memento was already swept}}
\DoxyCodeLine{84   \textcolor{comment}{// and bail out.}}
\DoxyCodeLine{85   \textcolor{keywordflow}{if} constexpr (\mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}} != FindMementoMode::kForGC) \{}
\DoxyCodeLine{86     MemoryChunk* object\_chunk = \mbox{\hyperlink{classv8_1_1internal_1_1MemoryChunk_a1c9e126ddfcab88ef54ab6a899ece138}{MemoryChunk::FromAddress}}(object\_address);}
\DoxyCodeLine{87     PageMetadata* object\_page = \mbox{\hyperlink{classv8_1_1internal_1_1PageMetadata_a08ed4b4b38b8a49836598d6a447e30f5}{PageMetadata::cast}}(object\_chunk-\/>Metadata());}
\DoxyCodeLine{88     \textcolor{keywordflow}{if} (!object\_page-\/>SweepingDone()) \{}
\DoxyCodeLine{89       \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{90     \}}
\DoxyCodeLine{91   \}}
\DoxyCodeLine{92 }
\DoxyCodeLine{93   \mbox{\hyperlink{namespacev8_1_1internal_a57f5ecf71b9a2757b0555b2be4c640b8}{Tagged<HeapObject>}} candidate = \mbox{\hyperlink{classv8_1_1internal_1_1HeapObject_aa18961d55321b920bd98b2fbcf729775}{HeapObject::FromAddress}}(memento\_address);}
\DoxyCodeLine{94   \mbox{\hyperlink{namespacev8_1_1internal_a0bc0ebcec45817212856f7d5e021224c}{ObjectSlot}} candidate\_map\_slot = candidate-\/>map\_slot();}
\DoxyCodeLine{95   \textcolor{comment}{// This fast check may peek at an uninitialized word. However, the slow check}}
\DoxyCodeLine{96   \textcolor{comment}{// below (memento\_address == top) ensures that this is safe. Mark the word as}}
\DoxyCodeLine{97   \textcolor{comment}{// initialized to silence MemorySanitizer warnings.}}
\DoxyCodeLine{98   \mbox{\hyperlink{msan_8h_a3247bf8fa2f4372cc59ac92e7432cc9c}{MSAN\_MEMORY\_IS\_INITIALIZED}}(candidate\_map\_slot.address(), \mbox{\hyperlink{namespacev8_1_1internal_a12d50d7bb2c9d8a916ff0785e6eff241}{kTaggedSize}});}
\DoxyCodeLine{99   \textcolor{keywordflow}{if} (!candidate\_map\_slot.Relaxed\_ContainsMapValue(}
\DoxyCodeLine{100           ReadOnlyRoots(\mbox{\hyperlink{namespaceheap}{heap}}).allocation\_memento\_map().ptr())) \{}
\DoxyCodeLine{101     \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{102   \}}
\DoxyCodeLine{103 }
\DoxyCodeLine{104   \textcolor{comment}{// Bailout if memento is below the age mark. This is only possible for pinned}}
\DoxyCodeLine{105   \textcolor{comment}{// pages in the scavenger. Full GC has page promotion but clears the}}
\DoxyCodeLine{106   \textcolor{comment}{// NEW\_SPACE\_BELOW\_AGE\_MARK page flags before checking mementos.}}
\DoxyCodeLine{107   \textcolor{keywordflow}{if} (!\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.minor\_ms \&\&}
\DoxyCodeLine{108       \mbox{\hyperlink{namespaceheap}{heap}}-\/>semi\_space\_new\_space()-\/>IsAddressBelowAgeMark(object\_address)) \{}
\DoxyCodeLine{109     \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{110   \}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112   Tagged<AllocationMemento> memento\_candidate =}
\DoxyCodeLine{113       Cast<AllocationMemento>(candidate);}
\DoxyCodeLine{114 }
\DoxyCodeLine{115   \textcolor{comment}{// Depending on what the memento is used for, we might need to perform}}
\DoxyCodeLine{116   \textcolor{comment}{// additional checks.}}
\DoxyCodeLine{117   \mbox{\hyperlink{namespacev8_1_1internal_ab4955debfb9384e59e3d4e9fcab5b0a0}{Address}} top;}
\DoxyCodeLine{118   \textcolor{keywordflow}{switch} (\mbox{\hyperlink{flag-definitions_8h_adaf90f045d5cd2710edd625b8685472a}{mode}}) \{}
\DoxyCodeLine{119     \textcolor{keywordflow}{case} \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbfa825580f68d2341a2c206387cae6ec671}{kForGC}}:}
\DoxyCodeLine{120       \textcolor{keywordflow}{return} memento\_candidate;}
\DoxyCodeLine{121     \textcolor{keywordflow}{case} \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a5680675b7266054743eac8e320900cbfae10ae9e8514058b9e601d7d6779bedb1}{kForRuntime}}:}
\DoxyCodeLine{122       \textcolor{keywordflow}{if} (memento\_candidate.is\_null()) \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{123       \textcolor{comment}{// Either the object is the last object in the new space, or there is}}
\DoxyCodeLine{124       \textcolor{comment}{// another object of at least word size (the header map word) following}}
\DoxyCodeLine{125       \textcolor{comment}{// it, so suffices to compare ptr and top here.}}
\DoxyCodeLine{126       top = \mbox{\hyperlink{namespaceheap}{heap}}-\/>NewSpaceTop();}
\DoxyCodeLine{127       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(memento\_address >= \mbox{\hyperlink{namespaceheap}{heap}}-\/>NewSpaceLimit() ||}
\DoxyCodeLine{128              memento\_address +}
\DoxyCodeLine{129                      \mbox{\hyperlink{common_2globals_8h_a76f936b13cc7401de647c23963eda5c1}{ALIGN\_TO\_ALLOCATION\_ALIGNMENT}}(\textcolor{keyword}{sizeof}(AllocationMemento)) <=}
\DoxyCodeLine{130                  top);}
\DoxyCodeLine{131       \textcolor{keywordflow}{if} ((memento\_address != top) \&\& memento\_candidate-\/>IsValid()) \{}
\DoxyCodeLine{132         \textcolor{keywordflow}{return} memento\_candidate;}
\DoxyCodeLine{133       \}}
\DoxyCodeLine{134       \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{135     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{136       \mbox{\hyperlink{namespacev8_1_1internal_acdec713c25068019f935e35976f5b666}{UNREACHABLE}}();}
\DoxyCodeLine{137   \}}
\DoxyCodeLine{138   \mbox{\hyperlink{namespacev8_1_1internal_acdec713c25068019f935e35976f5b666}{UNREACHABLE}}();}
\DoxyCodeLine{139 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Slot\+Base$<$ Subclass, Data, Slot\+Data\+Alignment $>$\+::address(), ALIGN\+\_\+\+TO\+\_\+\+ALLOCATION\+\_\+\+ALIGNMENT, v8\+::internal\+::\+Page\+Metadata\+::cast(), v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+IMPLIES, v8\+::internal\+::\+Memory\+Chunk\+::\+From\+Address(), v8\+::internal\+::\+Heap\+Object\+::\+From\+Address(), v8\+::internal\+::\+Tagged$<$ Heap\+Object $>$\+::is\+\_\+null(), k\+For\+GC, k\+For\+Runtime, v8\+::internal\+::k\+Tagged\+Size, v8\+::internal\+::\+Memory\+Chunk\+::\+Metadata(), mode(), MSAN\+\_\+\+MEMORY\+\_\+\+IS\+\_\+\+INITIALIZED, v8\+::internal\+::\+Page\+Metadata\+::\+On\+Same\+Page(), v8\+::internal\+::\+Full\+Object\+Slot\+::\+Relaxed\+\_\+\+Contains\+Map\+Value(), v8\+::internal\+::\+Mutable\+Page\+Metadata\+::\+Sweeping\+Done(), v8\+::internal\+::\+UNREACHABLE(), and v8\+::internal\+::v8\+\_\+flags.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1PretenuringHandler_aefedc0a489373bc91b85e8e057e8925e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_adc9b6de73a166bf364a14787e9ac0414}\label{classv8_1_1internal_1_1PretenuringHandler_adc9b6de73a166bf364a14787e9ac0414}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!GetMinMementoCountForTesting@{GetMinMementoCountForTesting}}
\index{GetMinMementoCountForTesting@{GetMinMementoCountForTesting}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{GetMinMementoCountForTesting()}{GetMinMementoCountForTesting()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classint}{int}} v8\+::internal\+::\+Pretenuring\+Handler\+::\+Get\+Min\+Memento\+Count\+For\+Testing (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 136 of file pretenuring-\/handler.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{136                                                      \{}
\DoxyCodeLine{137   \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02pretenuring-handler_8cc_03_a1cbb4e9cc878fbfc4511ee6e92146009}{kMinMementoCount}};}
\DoxyCodeLine{138 \}}

\end{DoxyCode}


References v8\+::internal\+::anonymous\+\_\+namespace\{pretenuring-\/handler.\+cc\}\+::k\+Min\+Memento\+Count.

\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_afb76f828951520e7d13610c0ff238c64}\label{classv8_1_1internal_1_1PretenuringHandler_afb76f828951520e7d13610c0ff238c64}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!HasPretenuringFeedback@{HasPretenuringFeedback}}
\index{HasPretenuringFeedback@{HasPretenuringFeedback}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{HasPretenuringFeedback()}{HasPretenuringFeedback()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacev8_1_1internal_a4e2118a7c0d730210e0cb87b511cba70}{bool}} v8\+::internal\+::\+Pretenuring\+Handler\+::\+Has\+Pretenuring\+Feedback (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 77 of file pretenuring-\/handler.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{77                                       \{}
\DoxyCodeLine{78     \textcolor{keywordflow}{return} !\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ad610e3a13ab68e7a0859c53156aded4a}{global\_pretenuring\_feedback\_}}.empty();}
\DoxyCodeLine{79   \}}

\end{DoxyCode}


References global\+\_\+pretenuring\+\_\+feedback\+\_\+.

\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_aca35e5784df91c84d77686aac732635f}\label{classv8_1_1internal_1_1PretenuringHandler_aca35e5784df91c84d77686aac732635f}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!MergeAllocationSitePretenuringFeedback@{MergeAllocationSitePretenuringFeedback}}
\index{MergeAllocationSitePretenuringFeedback@{MergeAllocationSitePretenuringFeedback}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{MergeAllocationSitePretenuringFeedback()}{MergeAllocationSitePretenuringFeedback()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Pretenuring\+Handler\+::\+Merge\+Allocation\+Site\+Pretenuring\+Feedback (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_af4636a79d24b9944a5f2a8c4b5c7fdcb}{Pretenuring\+Feedback\+Map}} \&}]{local\+\_\+pretenuring\+\_\+feedback }\end{DoxyParamCaption})}



Definition at line 140 of file pretenuring-\/handler.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{141                                                               \{}
\DoxyCodeLine{142   PtrComprCageBase cage\_base(\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Heap_ae5160ad63bc51ff7b36e8f247be48f63}{isolate}}());}
\DoxyCodeLine{143   Tagged<AllocationSite> site;}
\DoxyCodeLine{144   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& site\_and\_count : local\_pretenuring\_feedback) \{}
\DoxyCodeLine{145     site = site\_and\_count.first;}
\DoxyCodeLine{146     MapWord map\_word = site-\/>map\_word(\mbox{\hyperlink{namespacev8_a65227471e4ee0ccd275854a995f12a62}{kRelaxedLoad}});}
\DoxyCodeLine{147     \textcolor{keywordflow}{if} (map\_word.IsForwardingAddress()) \{}
\DoxyCodeLine{148       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(!\mbox{\hyperlink{classv8_1_1internal_1_1HeapLayout_a9265f7227418460bf7248ff206fdf5d4}{HeapLayout::IsSelfForwarded}}(site, map\_word));}
\DoxyCodeLine{149       site = Cast<AllocationSite>(map\_word.ToForwardingAddress(site));}
\DoxyCodeLine{150     \}}
\DoxyCodeLine{151 }
\DoxyCodeLine{152     \textcolor{comment}{// We have not validated the allocation site yet, since we have not}}
\DoxyCodeLine{153     \textcolor{comment}{// dereferenced the site during collecting information.}}
\DoxyCodeLine{154     \textcolor{comment}{// This is an inlined check of AllocationMemento::IsValid.}}
\DoxyCodeLine{155     \textcolor{keywordflow}{if} (!IsAllocationSite(site) || site-\/>IsZombie()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{156 }
\DoxyCodeLine{157     \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}} = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(site\_and\_count.second);}
\DoxyCodeLine{158     \mbox{\hyperlink{src_2base_2logging_8h_af1a711c8d5520dff78858ddefd2ad668}{DCHECK\_LT}}(0, \mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}});}
\DoxyCodeLine{159     \textcolor{keywordflow}{if} (site-\/>IncrementMementoFoundCount(\mbox{\hyperlink{namespacev8_1_1internal_ac1a33b5fd9af1653d346746cdb5c1ac0}{value}}) >= \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02pretenuring-handler_8cc_03_a1cbb4e9cc878fbfc4511ee6e92146009}{kMinMementoCount}}) \{}
\DoxyCodeLine{160       \textcolor{comment}{// For sites in the global map the count is accessed through the site.}}
\DoxyCodeLine{161       \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ad610e3a13ab68e7a0859c53156aded4a}{global\_pretenuring\_feedback\_}}.insert(std::make\_pair(site, 0));}
\DoxyCodeLine{162     \}}
\DoxyCodeLine{163   \}}
\DoxyCodeLine{164 \}}

\end{DoxyCode}


References v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+LT, global\+\_\+pretenuring\+\_\+feedback\+\_\+, heap\+\_\+, v8\+::internal\+::\+Map\+Word\+::\+Is\+Forwarding\+Address(), v8\+::internal\+::\+Heap\+::isolate(), v8\+::internal\+::\+Heap\+Layout\+::\+Is\+Self\+Forwarded(), v8\+::internal\+::anonymous\+\_\+namespace\{pretenuring-\/handler.\+cc\}\+::k\+Min\+Memento\+Count, v8\+::k\+Relaxed\+Load, v8\+::internal\+::\+Map\+Word\+::\+To\+Forwarding\+Address(), and v8\+::internal\+::value.



Referenced by v8\+::internal\+::\+Concurrent\+Marking\+::\+Flush\+Pretenuring\+Feedback(), and v8\+::internal\+::\+Minor\+Mark\+Sweep\+Collector\+::\+Mark\+Live\+Objects().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1PretenuringHandler_aca35e5784df91c84d77686aac732635f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1PretenuringHandler_aca35e5784df91c84d77686aac732635f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_ad2c621c0136aa48b7b222f6b317104c9}\label{classv8_1_1internal_1_1PretenuringHandler_ad2c621c0136aa48b7b222f6b317104c9}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!PretenureAllocationSiteOnNextCollection@{PretenureAllocationSiteOnNextCollection}}
\index{PretenureAllocationSiteOnNextCollection@{PretenureAllocationSiteOnNextCollection}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{PretenureAllocationSiteOnNextCollection()}{PretenureAllocationSiteOnNextCollection()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Pretenuring\+Handler\+::\+Pretenure\+Allocation\+Site\+On\+Next\+Collection (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1AllocationSite}{Allocation\+Site}} $>$}]{site }\end{DoxyParamCaption})}



Definition at line 286 of file pretenuring-\/handler.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{287                                  \{}
\DoxyCodeLine{288   \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a9dc83c9451368bbb81ffeb35f6113843}{allocation\_sites\_to\_pretenure\_}}) \{}
\DoxyCodeLine{289     \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a9dc83c9451368bbb81ffeb35f6113843}{allocation\_sites\_to\_pretenure\_}}.reset(}
\DoxyCodeLine{290         \textcolor{keyword}{new} GlobalHandleVector<AllocationSite>(\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}));}
\DoxyCodeLine{291   \}}
\DoxyCodeLine{292   \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a9dc83c9451368bbb81ffeb35f6113843}{allocation\_sites\_to\_pretenure\_}}-\/>Push(site);}
\DoxyCodeLine{293 \}}

\end{DoxyCode}


References allocation\+\_\+sites\+\_\+to\+\_\+pretenure\+\_\+, and heap\+\_\+.



Referenced by v8\+::internal\+::\+RUNTIME\+\_\+\+FUNCTION().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1PretenuringHandler_ad2c621c0136aa48b7b222f6b317104c9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_a112c244eff162bdadfdbb014b84321e9}\label{classv8_1_1internal_1_1PretenuringHandler_a112c244eff162bdadfdbb014b84321e9}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!ProcessPretenuringFeedback@{ProcessPretenuringFeedback}}
\index{ProcessPretenuringFeedback@{ProcessPretenuringFeedback}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{ProcessPretenuringFeedback()}{ProcessPretenuringFeedback()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Pretenuring\+Handler\+::\+Process\+Pretenuring\+Feedback (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacev8_1_1internal_a4725962ca3c127eb5871cb47293aee95}{size\+\_\+t}}}]{new\+\_\+space\+\_\+capacity\+\_\+before\+\_\+gc }\end{DoxyParamCaption})}



Definition at line 171 of file pretenuring-\/handler.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{172                                                \{}
\DoxyCodeLine{173   \textcolor{comment}{// The minimum new space capacity from which allocation sites can be}}
\DoxyCodeLine{174   \textcolor{comment}{// pretenured. A too small capacity means frequent GCs. Objects thus don't get}}
\DoxyCodeLine{175   \textcolor{comment}{// a chance to die before being promoted, which may lead to wrong pretenuring}}
\DoxyCodeLine{176   \textcolor{comment}{// decisions.}}
\DoxyCodeLine{177   \textcolor{keyword}{static} constexpr \textcolor{keywordtype}{size\_t} kDefaultMinNewSpaceCapacityForPretenuring =}
\DoxyCodeLine{178       8192 * \mbox{\hyperlink{namespacev8_1_1internal_a93b2e7c72fa0878021b495b6f3cec820}{KB}} * \mbox{\hyperlink{classv8_1_1internal_1_1Heap_ad066a03f343d821140af2c59eb65dd0c}{Heap::kPointerMultiplier}};}
\DoxyCodeLine{179 }
\DoxyCodeLine{180   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Heap_abdd7e3821604a14452281640366cc9bb}{tracer}}()-\/>IsInAtomicPause());}
\DoxyCodeLine{181 }
\DoxyCodeLine{182   \textcolor{keywordflow}{if} (!\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.allocation\_site\_pretenuring) \textcolor{keywordflow}{return};}
\DoxyCodeLine{183 }
\DoxyCodeLine{184   \textcolor{comment}{// TODO(333906585): Adjust capacity for sticky bits.}}
\DoxyCodeLine{185   \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} max\_capacity = \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.sticky\_mark\_bits}
\DoxyCodeLine{186                                   ? \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Heap_a7a11a699cd963225c196e93b8e6d4bd2}{sticky\_space}}()-\/>\mbox{\hyperlink{classv8_1_1internal_1_1PagedSpaceBase_aaa82a6e7714e013601a7b5a21dbc5458}{Capacity}}()}
\DoxyCodeLine{187                                   : \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Heap_a8abe18f92f4794f8ba70937917325140}{new\_space}}()-\/>\mbox{\hyperlink{classv8_1_1internal_1_1NewSpace_abe262f655679fbeca083466b9bf351f1}{MaximumCapacity}}();}
\DoxyCodeLine{188   \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} min\_new\_space\_capacity\_for\_pretenuring =}
\DoxyCodeLine{189       std::min(max\_capacity, kDefaultMinNewSpaceCapacityForPretenuring);}
\DoxyCodeLine{190 }
\DoxyCodeLine{191   \textcolor{keywordtype}{bool} trigger\_deoptimization = \textcolor{keyword}{false};}
\DoxyCodeLine{192   \textcolor{keywordtype}{int} tenure\_decisions = 0;}
\DoxyCodeLine{193   \textcolor{keywordtype}{int} dont\_tenure\_decisions = 0;}
\DoxyCodeLine{194   \textcolor{keywordtype}{int} allocation\_mementos\_found = 0;}
\DoxyCodeLine{195   \textcolor{keywordtype}{int} allocation\_sites = 0;}
\DoxyCodeLine{196   \textcolor{keywordtype}{int} active\_allocation\_sites = 0;}
\DoxyCodeLine{197 }
\DoxyCodeLine{198   Tagged<AllocationSite> site;}
\DoxyCodeLine{199 }
\DoxyCodeLine{200   \textcolor{comment}{// Step 1: Digest feedback for recorded allocation sites.}}
\DoxyCodeLine{201   \textcolor{comment}{// This is the pretenuring trigger for allocation sites that are in maybe}}
\DoxyCodeLine{202   \textcolor{comment}{// tenure state. When we switched to a large enough new space size we}}
\DoxyCodeLine{203   \textcolor{comment}{// deoptimize the code that belongs to the allocation site and derive the}}
\DoxyCodeLine{204   \textcolor{comment}{// lifetime of the allocation site.}}
\DoxyCodeLine{205   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} new\_space\_was\_above\_pretenuring\_threshold =}
\DoxyCodeLine{206       new\_space\_capacity\_target\_capacity >=}
\DoxyCodeLine{207       min\_new\_space\_capacity\_for\_pretenuring;}
\DoxyCodeLine{208 }
\DoxyCodeLine{209   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& site\_and\_count : \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ad610e3a13ab68e7a0859c53156aded4a}{global\_pretenuring\_feedback\_}}) \{}
\DoxyCodeLine{210     allocation\_sites++;}
\DoxyCodeLine{211     site = site\_and\_count.first;}
\DoxyCodeLine{212     \textcolor{comment}{// Count is always access through the site.}}
\DoxyCodeLine{213     \mbox{\hyperlink{src_2base_2logging_8h_af9c313d74155f7f201955a939e24c71f}{DCHECK\_EQ}}(0, site\_and\_count.second);}
\DoxyCodeLine{214     \textcolor{keywordtype}{int} found\_count = site-\/>memento\_found\_count();}
\DoxyCodeLine{215     \textcolor{comment}{// An entry in the storage does not imply that the count is > 0 because}}
\DoxyCodeLine{216     \textcolor{comment}{// allocation sites might have been reset due to too many objects dying}}
\DoxyCodeLine{217     \textcolor{comment}{// in old space.}}
\DoxyCodeLine{218     \textcolor{keywordflow}{if} (found\_count > 0) \{}
\DoxyCodeLine{219       \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(IsAllocationSite(site));}
\DoxyCodeLine{220       active\_allocation\_sites++;}
\DoxyCodeLine{221       allocation\_mementos\_found += found\_count;}
\DoxyCodeLine{222       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02pretenuring-handler_8cc_03_af3c2fcc875e84c3b1998ac896eec4ca8}{DigestPretenuringFeedback}}(\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Heap_ae5160ad63bc51ff7b36e8f247be48f63}{isolate}}(), site,}
\DoxyCodeLine{223                                     new\_space\_was\_above\_pretenuring\_threshold,}
\DoxyCodeLine{224                                     new\_space\_capacity\_target\_capacity)) \{}
\DoxyCodeLine{225         trigger\_deoptimization = \textcolor{keyword}{true};}
\DoxyCodeLine{226       \}}
\DoxyCodeLine{227       \textcolor{keywordflow}{if} (site-\/>GetAllocationType() == \mbox{\hyperlink{namespacev8_1_1internal_a604d5beeb6fc8639670f737ed201e20aa0aa38c28f349d65a6819e03844b73dff}{AllocationType::kOld}}) \{}
\DoxyCodeLine{228         tenure\_decisions++;}
\DoxyCodeLine{229       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{230         dont\_tenure\_decisions++;}
\DoxyCodeLine{231       \}}
\DoxyCodeLine{232     \}}
\DoxyCodeLine{233   \}}
\DoxyCodeLine{234 }
\DoxyCodeLine{235   \textcolor{comment}{// Step 2: Pretenure allocation sites for manual requests.}}
\DoxyCodeLine{236   \textcolor{keywordflow}{if} (\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a9dc83c9451368bbb81ffeb35f6113843}{allocation\_sites\_to\_pretenure\_}}) \{}
\DoxyCodeLine{237     \textcolor{keywordflow}{while} (!\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a9dc83c9451368bbb81ffeb35f6113843}{allocation\_sites\_to\_pretenure\_}}-\/>empty()) \{}
\DoxyCodeLine{238       \textcolor{keyword}{auto} pretenure\_site = \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a9dc83c9451368bbb81ffeb35f6113843}{allocation\_sites\_to\_pretenure\_}}-\/>Pop();}
\DoxyCodeLine{239       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02pretenuring-handler_8cc_03_a9750d30db138bca0b35729e132746103}{PretenureAllocationSiteManually}}(\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Heap_ae5160ad63bc51ff7b36e8f247be48f63}{isolate}}(), pretenure\_site)) \{}
\DoxyCodeLine{240         trigger\_deoptimization = \textcolor{keyword}{true};}
\DoxyCodeLine{241       \}}
\DoxyCodeLine{242     \}}
\DoxyCodeLine{243     \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a9dc83c9451368bbb81ffeb35f6113843}{allocation\_sites\_to\_pretenure\_}}.reset();}
\DoxyCodeLine{244   \}}
\DoxyCodeLine{245 }
\DoxyCodeLine{246   \textcolor{comment}{// Step 3: Deopt maybe tenured allocation sites if necessary.}}
\DoxyCodeLine{247   \textcolor{comment}{// New space capacity was too low for pretenuring but is now above the}}
\DoxyCodeLine{248   \textcolor{comment}{// threshold. Maybe tenured allocation sites may be pretenured on the next GC.}}
\DoxyCodeLine{249   \textcolor{keywordtype}{bool} deopt\_maybe\_tenured = (\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Heap_a854950bc5a3a266324db62d05b62e525}{NewSpaceTargetCapacity}}() >=}
\DoxyCodeLine{250                               min\_new\_space\_capacity\_for\_pretenuring) \&\&}
\DoxyCodeLine{251                              !new\_space\_was\_above\_pretenuring\_threshold;}
\DoxyCodeLine{252   \textcolor{keywordflow}{if} (deopt\_maybe\_tenured) \{}
\DoxyCodeLine{253     \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Heap_adb1f6d50826482943e00761d66eee5d5}{ForeachAllocationSite}}(\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Heap_ae182dd3db732ae64b7d17b0bd9b5f2c2}{allocation\_sites\_list}}(),}
\DoxyCodeLine{254                                  [\&allocation\_sites, \&trigger\_deoptimization](}
\DoxyCodeLine{255                                      Tagged<AllocationSite> site) \{}
\DoxyCodeLine{256                                    \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(IsAllocationSite(site));}
\DoxyCodeLine{257                                    allocation\_sites++;}
\DoxyCodeLine{258                                    \textcolor{keywordflow}{if} (site-\/>IsMaybeTenure()) \{}
\DoxyCodeLine{259                                      site-\/>set\_deopt\_dependent\_code(\textcolor{keyword}{true});}
\DoxyCodeLine{260                                      trigger\_deoptimization = \textcolor{keyword}{true};}
\DoxyCodeLine{261                                    \}}
\DoxyCodeLine{262                                  \});}
\DoxyCodeLine{263   \}}
\DoxyCodeLine{264 }
\DoxyCodeLine{265   \textcolor{keywordflow}{if} (trigger\_deoptimization) \{}
\DoxyCodeLine{266     \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Heap_ae5160ad63bc51ff7b36e8f247be48f63}{isolate}}()-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Isolate_a39a1d363e13113d1ca51a5c032312f3e}{stack\_guard}}()-\/>RequestDeoptMarkedAllocationSites();}
\DoxyCodeLine{267   \}}
\DoxyCodeLine{268 }
\DoxyCodeLine{269   \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.trace\_pretenuring\_statistics) \&\&}
\DoxyCodeLine{270       (allocation\_mementos\_found > 0 || tenure\_decisions > 0 ||}
\DoxyCodeLine{271        dont\_tenure\_decisions > 0)) \{}
\DoxyCodeLine{272     \mbox{\hyperlink{namespacev8_1_1internal_ada9f491dce0173d9e92b0dfaeaf8b64c}{PrintIsolate}}(}
\DoxyCodeLine{273         \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}{heap\_}}-\/>\mbox{\hyperlink{classv8_1_1internal_1_1Heap_ae5160ad63bc51ff7b36e8f247be48f63}{isolate}}(),}
\DoxyCodeLine{274         \textcolor{stringliteral}{"{}pretenuring: threshold=\%.2f deopt\_maybe\_tenured=\%d visited\_sites=\%d "{}}}
\DoxyCodeLine{275         \textcolor{stringliteral}{"{}active\_sites=\%d "{}}}
\DoxyCodeLine{276         \textcolor{stringliteral}{"{}mementos=\%d tenured=\%d not\_tenured=\%d\(\backslash\)n"{}},}
\DoxyCodeLine{277         \mbox{\hyperlink{namespacev8_1_1internal_1_1anonymous__namespace_02pretenuring-handler_8cc_03_a964be9530ee6fe050cc9ed8a499e4d6e}{GetPretenuringRatioThreshold}}(new\_space\_capacity\_target\_capacity),}
\DoxyCodeLine{278         deopt\_maybe\_tenured ? 1 : 0, allocation\_sites, active\_allocation\_sites,}
\DoxyCodeLine{279         allocation\_mementos\_found, tenure\_decisions, dont\_tenure\_decisions);}
\DoxyCodeLine{280   \}}
\DoxyCodeLine{281 }
\DoxyCodeLine{282   \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ad610e3a13ab68e7a0859c53156aded4a}{global\_pretenuring\_feedback\_}}.clear();}
\DoxyCodeLine{283   \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ad610e3a13ab68e7a0859c53156aded4a}{global\_pretenuring\_feedback\_}}.reserve(\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a39e978227fa4328858984891781819e0}{kInitialFeedbackCapacity}});}
\DoxyCodeLine{284 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Heap\+::allocation\+\_\+sites\+\_\+list(), allocation\+\_\+sites\+\_\+to\+\_\+pretenure\+\_\+, v8\+::internal\+::\+Paged\+Space\+Base\+::\+Capacity(), v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+EQ, v8\+::internal\+::anonymous\+\_\+namespace\{pretenuring-\/handler.\+cc\}\+::\+Digest\+Pretenuring\+Feedback(), v8\+::internal\+::\+Heap\+::\+Foreach\+Allocation\+Site(), v8\+::internal\+::anonymous\+\_\+namespace\{pretenuring-\/handler.\+cc\}\+::\+Get\+Pretenuring\+Ratio\+Threshold(), global\+\_\+pretenuring\+\_\+feedback\+\_\+, heap\+\_\+, v8\+::internal\+::\+Heap\+::isolate(), v8\+::internal\+::\+KB, k\+Initial\+Feedback\+Capacity, v8\+::internal\+::k\+Old, v8\+::internal\+::\+Heap\+::k\+Pointer\+Multiplier, v8\+::internal\+::\+New\+Space\+::\+Maximum\+Capacity(), v8\+::internal\+::\+Heap\+::new\+\_\+space(), v8\+::internal\+::\+Heap\+::\+New\+Space\+Target\+Capacity(), v8\+::internal\+::anonymous\+\_\+namespace\{pretenuring-\/handler.\+cc\}\+::\+Pretenure\+Allocation\+Site\+Manually(), v8\+::internal\+::\+Print\+Isolate(), v8\+::internal\+::\+Isolate\+::stack\+\_\+guard(), v8\+::internal\+::\+Heap\+::sticky\+\_\+space(), v8\+::internal\+::\+Heap\+::tracer(), v8\+::internal\+::v8\+\_\+flags, and V8\+\_\+\+UNLIKELY.



Referenced by v8\+::internal\+::\+Heap\+::\+Perform\+Garbage\+Collection().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1PretenuringHandler_a112c244eff162bdadfdbb014b84321e9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1PretenuringHandler_a112c244eff162bdadfdbb014b84321e9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_ab38af427f3e4e918eedc75fad80bd8a4}\label{classv8_1_1internal_1_1PretenuringHandler_ab38af427f3e4e918eedc75fad80bd8a4}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!RemoveAllocationSitePretenuringFeedback@{RemoveAllocationSitePretenuringFeedback}}
\index{RemoveAllocationSitePretenuringFeedback@{RemoveAllocationSitePretenuringFeedback}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{RemoveAllocationSitePretenuringFeedback()}{RemoveAllocationSitePretenuringFeedback()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Pretenuring\+Handler\+::\+Remove\+Allocation\+Site\+Pretenuring\+Feedback (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1AllocationSite}{Allocation\+Site}} $>$}]{site }\end{DoxyParamCaption})}



Definition at line 166 of file pretenuring-\/handler.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{167                                  \{}
\DoxyCodeLine{168   \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_ad610e3a13ab68e7a0859c53156aded4a}{global\_pretenuring\_feedback\_}}.erase(site);}
\DoxyCodeLine{169 \}}

\end{DoxyCode}


References global\+\_\+pretenuring\+\_\+feedback\+\_\+.

\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_ab9d9c25a2b1b39927039595c9fb76c4a}\label{classv8_1_1internal_1_1PretenuringHandler_ab9d9c25a2b1b39927039595c9fb76c4a}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!reset@{reset}}
\index{reset@{reset}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{reset()}{reset()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Pretenuring\+Handler\+::reset (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 295 of file pretenuring-\/handler.\+cc.


\begin{DoxyCode}{0}
\DoxyCodeLine{295 \{ \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_a9dc83c9451368bbb81ffeb35f6113843}{allocation\_sites\_to\_pretenure\_}}.reset(); \}}

\end{DoxyCode}


References allocation\+\_\+sites\+\_\+to\+\_\+pretenure\+\_\+.



Referenced by v8\+::internal\+::\+Heap\+::\+Tear\+Down().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1PretenuringHandler_ab9d9c25a2b1b39927039595c9fb76c4a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_afe6ffac83eddf7cac23594de7d90da1f}\label{classv8_1_1internal_1_1PretenuringHandler_afe6ffac83eddf7cac23594de7d90da1f}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!UpdateAllocationSite@{UpdateAllocationSite}}
\index{UpdateAllocationSite@{UpdateAllocationSite}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{UpdateAllocationSite()}{UpdateAllocationSite()}}
{\footnotesize\ttfamily void v8\+::internal\+::\+Pretenuring\+Handler\+::\+Update\+Allocation\+Site (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Heap}{Heap}} $\ast$}]{heap,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1Map}{Map}} $>$}]{map,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1Tagged}{Tagged}}$<$ \mbox{\hyperlink{classv8_1_1internal_1_1HeapObject}{Heap\+Object}} $>$}]{object,  }\item[{\mbox{\hyperlink{classint}{int}}}]{object\+\_\+size,  }\item[{\mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_af4636a79d24b9944a5f2a8c4b5c7fdcb}{Pretenuring\+Feedback\+Map}} $\ast$}]{pretenuring\+\_\+feedback }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Definition at line 22 of file pretenuring-\/handler-\/inl.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{24                                                   \{}
\DoxyCodeLine{25   \mbox{\hyperlink{src_2base_2logging_8h_a986dc8f4ec6dcd0644efe205c13f8eb7}{DCHECK\_NE}}(pretenuring\_feedback,}
\DoxyCodeLine{26             \&\mbox{\hyperlink{namespaceheap}{heap}}-\/>pretenuring\_handler()-\/>global\_pretenuring\_feedback\_);}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#ifdef DEBUG}}
\DoxyCodeLine{28   MemoryChunk* chunk = \mbox{\hyperlink{classv8_1_1internal_1_1MemoryChunk_a0481ad8f68cb1d4a794d588d80cc8f54}{MemoryChunk::FromHeapObject}}(\textcolor{keywordtype}{object});}
\DoxyCodeLine{29   \textcolor{comment}{// MemoryChunk::IsToPage() is not available with sticky mark-\/bits.}}
\DoxyCodeLine{30   \mbox{\hyperlink{src_2base_2logging_8h_a96a75539aa82216cdde2250a11126ea0}{DCHECK\_IMPLIES}}(\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.sticky\_mark\_bits || chunk-\/>IsToPage(),}
\DoxyCodeLine{31                  \mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.minor\_ms);}
\DoxyCodeLine{32   \mbox{\hyperlink{src_2base_2logging_8h_a96a75539aa82216cdde2250a11126ea0}{DCHECK\_IMPLIES}}(!\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.minor\_ms \&\& !\mbox{\hyperlink{classv8_1_1internal_1_1HeapLayout_a597d0e70459c694743e92d98a9292f92}{HeapLayout::InYoungGeneration}}(\textcolor{keywordtype}{object}),}
\DoxyCodeLine{33                  chunk-\/>IsFlagSet(\mbox{\hyperlink{classv8_1_1internal_1_1MemoryChunk_a3aacf1e5a45f3a0e3728850e6698cdf9a57fdc5dfe8adf74f457803f1a2c9902b}{MemoryChunk::PAGE\_NEW\_OLD\_PROMOTION}}));}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{35   \textcolor{keywordflow}{if} (\mbox{\hyperlink{v8config_8h_a67bd29db07c711b0fb11ff1c324ebb60}{V8\_UNLIKELY}}(!\mbox{\hyperlink{namespacev8_1_1internal_aa9db791c05a0359859a321dcfec42e37}{v8\_flags}}.allocation\_site\_pretenuring) ||}
\DoxyCodeLine{36       !\mbox{\hyperlink{classv8_1_1internal_1_1AllocationSite_a5bce0a6a275e0f9a9c8a3e87babab0d9}{AllocationSite::CanTrack}}(map-\/>instance\_type())) \{}
\DoxyCodeLine{37     \textcolor{keywordflow}{return};}
\DoxyCodeLine{38   \}}
\DoxyCodeLine{39   Tagged<AllocationMemento> memento\_candidate =}
\DoxyCodeLine{40       FindAllocationMemento<kForGC>(\mbox{\hyperlink{namespaceheap}{heap}}, map, \textcolor{keywordtype}{object}, object\_size);}
\DoxyCodeLine{41   \textcolor{keywordflow}{if} (memento\_candidate.is\_null()) \{}
\DoxyCodeLine{42     \textcolor{keywordflow}{return};}
\DoxyCodeLine{43   \}}
\DoxyCodeLine{44   \mbox{\hyperlink{namespacev8_1_1internal_aa6b3743bd5d773c552654f2a6c3efa4a}{DCHECK}}(IsJSObjectMap(map));}
\DoxyCodeLine{45 }
\DoxyCodeLine{46   \textcolor{comment}{// Entering cached feedback is used in the parallel case. We are not allowed}}
\DoxyCodeLine{47   \textcolor{comment}{// to dereference the allocation site and rather have to postpone all checks}}
\DoxyCodeLine{48   \textcolor{comment}{// till actually merging the data.}}
\DoxyCodeLine{49   \mbox{\hyperlink{namespacev8_1_1internal_ab4955debfb9384e59e3d4e9fcab5b0a0}{Address}} \mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}} = memento\_candidate-\/>GetAllocationSiteUnchecked();}
\DoxyCodeLine{50   (*pretenuring\_feedback)[UncheckedCast<AllocationSite>(\mbox{\hyperlink{namespacev8_1_1internal_a5297fd2c72981b2220e6b9a831570fb3}{Tagged<Object>}}(\mbox{\hyperlink{namespacev8_1_1internal_a67a51b6314a9bc8a8c44c5fe14149e6c}{key}}))]++;}
\DoxyCodeLine{51 \}}

\end{DoxyCode}


References v8\+::internal\+::\+Allocation\+Site\+::\+Can\+Track(), v8\+::internal\+::\+DCHECK(), DCHECK\+\_\+\+IMPLIES, DCHECK\+\_\+\+NE, v8\+::internal\+::\+Memory\+Chunk\+::\+From\+Heap\+Object(), v8\+::internal\+::\+Heap\+Layout\+::\+In\+Young\+Generation(), v8\+::internal\+::\+Tagged$<$ Heap\+Object $>$\+::is\+\_\+null(), v8\+::internal\+::\+Memory\+Chunk\+::\+Is\+Flag\+Set(), v8\+::internal\+::\+Memory\+Chunk\+::\+Is\+To\+Page(), v8\+::internal\+::key, v8\+::internal\+::\+Memory\+Chunk\+::\+PAGE\+\_\+\+NEW\+\_\+\+OLD\+\_\+\+PROMOTION, v8\+::internal\+::v8\+\_\+flags, and V8\+\_\+\+UNLIKELY.



Referenced by v8\+::internal\+::\+Scavenger\+::\+Migrate\+Object(), v8\+::internal\+::\+Evacuate\+New\+Space\+Visitor\+::\+Visit(), v8\+::internal\+::\+Evacuate\+New\+To\+Old\+Space\+Page\+Visitor\+::\+Visit(), and v8\+::internal\+::\+Young\+Generation\+Marking\+Visitor$<$ marking\+\_\+mode $>$\+::\+Visit\+JSObject\+Subclass().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1PretenuringHandler_afe6ffac83eddf7cac23594de7d90da1f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classv8_1_1internal_1_1PretenuringHandler_afe6ffac83eddf7cac23594de7d90da1f_icgraph}
\end{center}
\end{figure}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_a9dc83c9451368bbb81ffeb35f6113843}\label{classv8_1_1internal_1_1PretenuringHandler_a9dc83c9451368bbb81ffeb35f6113843}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!allocation\_sites\_to\_pretenure\_@{allocation\_sites\_to\_pretenure\_}}
\index{allocation\_sites\_to\_pretenure\_@{allocation\_sites\_to\_pretenure\_}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{allocation\_sites\_to\_pretenure\_}{allocation\_sites\_to\_pretenure\_}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$\mbox{\hyperlink{classv8_1_1internal_1_1GlobalHandleVector}{Global\+Handle\+Vector}}$<$\mbox{\hyperlink{classv8_1_1internal_1_1AllocationSite}{Allocation\+Site}}$>$ $>$ v8\+::internal\+::\+Pretenuring\+Handler\+::allocation\+\_\+sites\+\_\+to\+\_\+pretenure\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 94 of file pretenuring-\/handler.\+h.



Referenced by Pretenure\+Allocation\+Site\+On\+Next\+Collection(), Process\+Pretenuring\+Feedback(), and reset().

\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_ad610e3a13ab68e7a0859c53156aded4a}\label{classv8_1_1internal_1_1PretenuringHandler_ad610e3a13ab68e7a0859c53156aded4a}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!global\_pretenuring\_feedback\_@{global\_pretenuring\_feedback\_}}
\index{global\_pretenuring\_feedback\_@{global\_pretenuring\_feedback\_}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{global\_pretenuring\_feedback\_}{global\_pretenuring\_feedback\_}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1PretenuringHandler_af4636a79d24b9944a5f2a8c4b5c7fdcb}{Pretenuring\+Feedback\+Map}} v8\+::internal\+::\+Pretenuring\+Handler\+::global\+\_\+pretenuring\+\_\+feedback\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 91 of file pretenuring-\/handler.\+h.



Referenced by Has\+Pretenuring\+Feedback(), Merge\+Allocation\+Site\+Pretenuring\+Feedback(), Process\+Pretenuring\+Feedback(), and Remove\+Allocation\+Site\+Pretenuring\+Feedback().

\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}\label{classv8_1_1internal_1_1PretenuringHandler_a4cec7414a37be5db20d9b76472074e6f}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!heap\_@{heap\_}}
\index{heap\_@{heap\_}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{heap\_}{heap\_}}
{\footnotesize\ttfamily \mbox{\hyperlink{classv8_1_1internal_1_1Heap}{Heap}}$\ast$ const v8\+::internal\+::\+Pretenuring\+Handler\+::heap\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 84 of file pretenuring-\/handler.\+h.



Referenced by Merge\+Allocation\+Site\+Pretenuring\+Feedback(), Pretenure\+Allocation\+Site\+On\+Next\+Collection(), and Process\+Pretenuring\+Feedback().

\mbox{\Hypertarget{classv8_1_1internal_1_1PretenuringHandler_a39e978227fa4328858984891781819e0}\label{classv8_1_1internal_1_1PretenuringHandler_a39e978227fa4328858984891781819e0}} 
\index{v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}!kInitialFeedbackCapacity@{kInitialFeedbackCapacity}}
\index{kInitialFeedbackCapacity@{kInitialFeedbackCapacity}!v8::internal::PretenuringHandler@{v8::internal::PretenuringHandler}}
\doxysubsubsection{\texorpdfstring{kInitialFeedbackCapacity}{kInitialFeedbackCapacity}}
{\footnotesize\ttfamily constexpr \mbox{\hyperlink{classint}{int}} v8\+::internal\+::\+Pretenuring\+Handler\+::k\+Initial\+Feedback\+Capacity = 256\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}}



Definition at line 23 of file pretenuring-\/handler.\+h.



Referenced by Process\+Pretenuring\+Feedback(), and v8\+::internal\+::\+Minor\+Mark\+Sweep\+Collector\+::\+Start\+Marking().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/mnt/\+V8\+Source\+Code/src/heap/\mbox{\hyperlink{pretenuring-handler_8h}{pretenuring-\/handler.\+h}}\item 
/mnt/\+V8\+Source\+Code/src/heap/\mbox{\hyperlink{pretenuring-handler-inl_8h}{pretenuring-\/handler-\/inl.\+h}}\item 
/mnt/\+V8\+Source\+Code/src/heap/\mbox{\hyperlink{pretenuring-handler_8cc}{pretenuring-\/handler.\+cc}}\end{DoxyCompactItemize}
